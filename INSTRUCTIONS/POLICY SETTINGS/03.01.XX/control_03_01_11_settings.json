{
  "version": "1.0.0",
  "batchNumber": 1,
  "batchName": "Access Control & Identity (AC, IA)",
  "lastUpdated": "2024-11-16",
  "nistRevision": "3",
  "controlFamilies": ["AC", "IA"],
  "totalControls": 33,
  "controlsCompleted": 11,
  "totalSettings": 245,
  "description": "Comprehensive M365 settings catalog for NIST 800-171 Rev 3 compliance - Batch 1",
  "settings": [
    {
      "id": "AZ-AC-028",
      "settingName": "SignInFrequency",
      "displayName": "Sign-in Frequency (Session Control)",
      "settingPath": "sessionControls.signInFrequency",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "isEnabled": true,
        "type": "hours",
        "value": 8
      },
      "validationOperator": "==",
      "description": "Automatically terminates user sessions by forcing re-authentication after a defined period of time, regardless of activity. Enforces periodic session termination to limit exposure window for compromised credentials.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Entra admin center > Identity > Protection > Conditional Access\n2. Create or edit Conditional Access policy\n3. Under 'Session' controls, enable 'Sign-in frequency'\n4. Select 'Periodic reauthentication' and set time period (1-24 hours, or specific days)\n5. Choose 'Hours' and enter value (8 hours recommended for standard users, 1-4 hours for privileged access)\n6. Assign to target users/groups\n7. Set policy to 'Report-only' for testing, then enable\n8. IMPORTANT: For mobile devices, authentication after timeout may take 30 seconds on average",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Directly enforces automatic session termination by requiring users to re-authenticate after organization-defined time periods. This is a logical session termination control that ends authentication sessions, requiring new authentication to continue accessing resources.",
          "nistRequirement": "Terminate a user session automatically after organization-defined conditions - specifically addresses time-based session termination triggers"
        }
      ]
    },
    {
      "id": "AZ-AC-029",
      "settingName": "SignInFrequencyEveryTime",
      "displayName": "Sign-in Frequency - Every Time",
      "settingPath": "sessionControls.signInFrequency",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "isEnabled": true,
        "type": "everyTime"
      },
      "validationOperator": "==",
      "description": "Requires full reauthentication every time a user accesses a resource or performs specific actions. Used for high-security scenarios like accessing sensitive applications, privileged role elevation, or risky sign-ins.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Entra admin center > Identity > Protection > Conditional Access\n2. Create new policy for high-security resources\n3. Under 'Cloud apps', select specific sensitive applications (Azure portal, PIM, sensitive SharePoint sites)\n4. Under 'Session' controls, enable 'Sign-in frequency'\n5. Select 'Every time' option\n6. WARNING: Use sparingly - triggers full authentication for EVERY access attempt\n7. Best for: Accessing sensitive applications, VPN/NaaS connections, privileged role elevation, risky users/sign-ins\n8. Test with small pilot group before broad deployment",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-session-lifetime",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Enforces immediate session termination requiring re-authentication for every access attempt to highly sensitive resources. Represents most aggressive session termination policy - logical session is terminated after each transaction completes.",
          "nistRequirement": "Terminate a user session automatically after organization-defined conditions - addresses event-driven termination (e.g., targeted responses to certain types of incidents, accessing sensitive resources)"
        }
      ]
    },
    {
      "id": "AZ-AC-030",
      "settingName": "PersistentBrowserSession",
      "displayName": "Persistent Browser Session Control",
      "settingPath": "sessionControls.persistentBrowser",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "isEnabled": true,
        "mode": "never"
      },
      "validationOperator": "==",
      "description": "Controls whether browser sessions persist after closing and reopening browser windows. Setting to 'Never' ensures sessions are terminated when browser is closed, preventing unauthorized continued access from unattended devices.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Entra admin center > Identity > Protection > Conditional Access\n2. Create or edit Conditional Access policy\n3. Select 'All Cloud Apps' (REQUIRED - persistent browser works only with all apps)\n4. Under 'Session' controls, enable 'Persistent browser session'\n5. Set to 'Never' to disable persistent sessions (force new authentication after browser close)\n6. Alternative: Set to 'Always' only for managed, compliant devices\n7. This overrides the 'Stay signed in?' prompt shown to users\n8. Combine with Sign-in frequency for comprehensive session management",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "Medium",
          "isRequired": true,
          "mappingRationale": "Enforces session termination when users close their browsers by preventing persistent browser sessions. This ensures logical sessions don't continue indefinitely after users leave their workstation, supporting the requirement to automatically terminate sessions under defined conditions (e.g., end of user activity indicated by browser closure).",
          "nistRequirement": "Terminate a user session automatically after organization-defined conditions - specifically addresses session termination when users end their browser sessions"
        }
      ]
    },
    {
      "id": "IN-AC-231",
      "settingName": "InteractiveLogonMachineInactivityLimit",
      "displayName": "Interactive Logon: Machine Inactivity Limit",
      "settingPath": "LocalPoliciesSecurityOptions.InteractiveLogon_MachineInactivityLimit",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 900,
      "validationOperator": "<=",
      "description": "Automatically locks Windows session after specified seconds of inactivity. This is DIFFERENT from device lock - it can trigger actual logoff when combined with screensaver settings. Value in seconds (900 = 15 minutes). NOTE: This was also documented in 03.01.10 but serves dual purpose for both device lock and session termination.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > Settings Catalog\n2. Add setting: Search for 'Interactive Logon Machine Inactivity Limit'\n3. Path: Local Policies Security Options > Interactive Logon > Machine Inactivity Limit\n4. Set value in SECONDS (900 seconds = 15 minutes, 600 = 10 minutes)\n5. WARNING: This can conflict with MaxInactivityTimeDeviceLock - test thoroughly\n6. CRITICAL BUG: Some documentation shows this as boolean, but it's actually integer seconds\n7. Assign to device groups\n8. Verify registry: HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\InactivityTimeoutSecs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/interactive-logon-machine-inactivity-limit",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "Medium",
          "isRequired": true,
          "mappingRationale": "Enforces automatic session termination (lock screen) after defined inactivity period. While primarily a device lock mechanism (covered in 03.01.10), it also serves session termination by preventing continued access after inactivity timeout. Can be configured to trigger actual logoff when used with screensaver password protection.",
          "nistRequirement": "Terminate a user session automatically after organization-defined periods of user inactivity"
        }
      ]
    },
    {
      "id": "IN-AC-232",
      "settingName": "RDPIdleSessionLimit",
      "displayName": "RDP: Set Time Limit for Active But Idle Sessions",
      "settingPath": "RemoteDesktopServices.RemoteDesktopSessionHost.SessionTimeLimit.IdleSessionLimit",
      "policyType": "Intune",
      "policySubType": "AdministrativeTemplate",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 900000,
      "validationOperator": "<=",
      "description": "Automatically disconnects Remote Desktop sessions after specified time of user inactivity (last input time). This is CRITICAL for privileged access and remote workers. Value in milliseconds (900000ms = 15 minutes). Disconnected session remains active until terminated by 'disconnected session' timeout.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > Settings Catalog\n2. Add setting: Search for 'Set time limit for active but idle Remote Desktop Services sessions'\n3. Path: Administrative Templates > Windows Components > Remote Desktop Services > Remote Desktop Session Host > Session Time Limits\n4. Set value in MILLISECONDS (900000ms = 15 min, 1800000ms = 30 min, 3600000ms = 1 hour)\n5. Choose action: 'Disconnect' (recommended) or 'End session'\n6. Best practice: 15 minutes for high-security, 30 minutes for standard users\n7. Works for both RDS hosts and regular Windows with RDP enabled\n8. Verify with: Get-WmiObject -Class Win32_TerminalServiceSetting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-365/enterprise/frontline-cloud-pc-session-time-limits",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Directly enforces automatic termination of Remote Desktop logical sessions after user inactivity. RDP sessions are user-initiated logical sessions that should be automatically terminated per NIST requirements. This is ESSENTIAL for remote access scenarios and privileged user sessions.",
          "nistRequirement": "Terminate a user session automatically after organization-defined periods of user inactivity - specifically for remote access sessions"
        },
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Supports remote access security by automatically terminating idle remote sessions, reducing risk of unauthorized access through abandoned remote connections.",
          "nistRequirement": "Remote access control requirements - session management for remote connections"
        }
      ]
    },
    {
      "id": "IN-AC-233",
      "settingName": "RDPDisconnectedSessionLimit",
      "displayName": "RDP: Set Time Limit for Disconnected Sessions",
      "settingPath": "RemoteDesktopServices.RemoteDesktopSessionHost.SessionTimeLimit.DisconnectedSessionLimit",
      "policyType": "Intune",
      "policySubType": "AdministrativeTemplate",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 60000,
      "validationOperator": "<=",
      "description": "Automatically terminates (logs off) Remote Desktop sessions that remain in 'Disconnected' state for specified time. This ensures background processes are ended and resources freed. Value in milliseconds (60000ms = 1 minute). CRITICAL: This actually ENDS the session, not just disconnects it.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > Settings Catalog\n2. Add setting: Search for 'Set time limit for disconnected sessions'\n3. Path: Administrative Templates > Windows Components > Remote Desktop Services > Remote Desktop Session Host > Session Time Limits\n4. Set value in MILLISECONDS (60000ms = 1 min, 300000ms = 5 min, 900000ms = 15 min)\n5. Recommended values: 1-5 minutes for high-security, 15-30 minutes for standard users\n6. IMPORTANT: This TERMINATES the session (full logoff), closing all processes\n7. Works in combination with idle session limit: Idle timeout disconnects, this terminates\n8. Test impact on long-running processes before deployment",
      "microsoftDocUrl": "https://woshub.com/remote-desktop-session-time-limit/",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Enforces complete termination of Remote Desktop sessions after they become disconnected. This ensures logical sessions are fully terminated (all processes ended) rather than remaining in suspended state indefinitely. Critical for ending sessions when users close RDP clients without logging off properly.",
          "nistRequirement": "Terminate a user session automatically - session termination ends all system processes associated with user's logical session"
        }
      ]
    },
    {
      "id": "IN-AC-234",
      "settingName": "RDPActiveSessionLimit",
      "displayName": "RDP: Set Time Limit for Active Sessions",
      "settingPath": "RemoteDesktopServices.RemoteDesktopSessionHost.SessionTimeLimit.ActiveSessionLimit",
      "policyType": "Intune",
      "policySubType": "AdministrativeTemplate",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 0,
      "validationOperator": "==",
      "description": "Sets maximum duration for active Remote Desktop sessions before automatic termination. Value in milliseconds. Setting to 0 (recommended) means no time limit - rely on idle session timeout instead. USE WITH CAUTION: Non-zero values will disconnect ACTIVE users even while working.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > Settings Catalog\n2. Add setting: Search for 'Set time limit for active Remote Desktop Services sessions'\n3. Path: Administrative Templates > Windows Components > Remote Desktop Services > Remote Desktop Session Host > Session Time Limits\n4. RECOMMENDED: Set to 0 (disabled) - rely on idle timeout instead\n5. Alternative: Set maximum session duration (e.g., 28800000ms = 8 hours)\n6. WARNING: This disconnects users even if actively working - frustrating for users\n7. Only use for extreme high-security scenarios (e.g., privileged access workstations)\n8. If enabled, notify users in advance and provide session warnings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-365/enterprise/frontline-cloud-pc-session-time-limits",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Provides optional hard limit on session duration regardless of activity. Enforces session termination based on time-of-day restrictions or maximum session duration policies. However, typically NOT recommended as it terminates active working sessions, preferring idle-based termination instead.",
          "nistRequirement": "Terminate a user session automatically after organization-defined conditions - addresses time-of-day restrictions and maximum session duration policies"
        }
      ]
    },
    {
      "id": "IN-AC-235",
      "settingName": "RDPEndSessionWhenTimeLimitsReached",
      "displayName": "RDP: End Session When Time Limits Are Reached",
      "settingPath": "RemoteDesktopServices.RemoteDesktopSessionHost.SessionTimeLimit.EndSessionWhenTimeLimitsReached",
      "policyType": "Intune",
      "policySubType": "AdministrativeTemplate",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Determines whether Remote Desktop sessions are terminated (logged off) or merely disconnected when time limits are reached. Setting to TRUE ensures complete session termination with process cleanup. Setting to FALSE only disconnects, leaving processes running.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > Settings Catalog\n2. Add setting: Search for 'End session when time limits are reached'\n3. Path: Administrative Templates > Windows Components > Remote Desktop Services > Remote Desktop Session Host > Session Time Limits\n4. Set to 'Enabled' to force complete logoff (recommended for security)\n5. When enabled: RDP sessions are ENDED (full logoff, all processes terminated)\n6. When disabled: RDP sessions are DISCONNECTED (can reconnect, processes continue)\n7. Recommended: Enable for security - ensures clean session termination\n8. Consider user impact: Enabled = data loss if unsaved work, but better security",
      "microsoftDocUrl": "https://woshub.com/remote-desktop-session-time-limit/",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "CRITICAL setting that ensures RDP sessions are actually TERMINATED (logged off) rather than just disconnected when timeouts are reached. This enforces the NIST requirement that 'session termination ends all system processes associated with a user's logical session' rather than leaving processes running in background.",
          "nistRequirement": "Session termination ends all system processes associated with a user's logical session"
        }
      ]
    },
    {
      "id": "M365-AC-001",
      "settingName": "IdleSessionTimeout",
      "displayName": "Microsoft 365 Idle Session Timeout (Global)",
      "settingPath": "admin.microsoft.com.settings.IdleSessionTimeout",
      "policyType": "Microsoft365",
      "policySubType": "TenantWideSettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 60,
      "validationOperator": "<=",
      "description": "Automatically signs out users from Microsoft 365 web apps (Outlook Web App, SharePoint Online, OneDrive, Office web apps, Microsoft 365 Admin Center) after specified minutes of inactivity across ALL tabs. This is a tenant-wide setting that overrides individual app timeouts.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft 365 admin center (admin.microsoft.com)\n2. Go to Settings > Org Settings > Security & privacy tab\n3. Select 'Idle session timeout'\n4. Enable 'Turn on to set the period of inactivity for users to be signed off of Microsoft 365 web apps'\n5. Select timeout value: Choose preset (1-24 hours) or Custom (12-1440 minutes)\n6. Recommended: 1 hour (60 minutes) for standard users, 15-30 minutes for high-security\n7. Click Save - takes a few minutes to activate\n8. IMPORTANT: Overrides existing OWA and SharePoint timeout policies\n9. Users must be inactive across ALL M365 web app tabs to trigger timeout\n10. Does NOT affect: Desktop apps, mobile apps, managed devices with SSO",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/idle-session-timeout-web-apps",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Directly enforces automatic session termination for all Microsoft 365 web applications after user inactivity. This is a comprehensive cloud application session control that terminates logical user sessions across the Microsoft 365 ecosystem, preventing unauthorized access when users leave workstations unattended.",
          "nistRequirement": "Terminate a user session automatically after organization-defined periods of user inactivity - specifically for cloud application sessions"
        }
      ]
    },
    {
      "id": "M365-AC-002",
      "settingName": "IdleSessionTimeoutUnmanagedDevices",
      "displayName": "Microsoft 365 Idle Session Timeout - Unmanaged Devices Only",
      "settingPath": "ConditionalAccess.SessionControls.UseAppEnforcedRestrictions",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Applies idle session timeout ONLY to unmanaged devices using Conditional Access 'Use app enforced restrictions' control. Allows different timeout values for managed vs. unmanaged devices. Managed devices can have longer timeouts, unmanaged devices get stricter controls.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Entra admin center > Identity > Protection > Conditional Access\n2. Create new policy targeting unmanaged devices\n3. Under Conditions > Filter for devices: Device.isCompliant equals False\n4. Select Cloud apps: Office 365 (selects all M365 apps)\n5. Under Session controls: Select 'Use app enforced restrictions'\n6. This enables idle timeout from M365 Admin Center OR app-specific settings\n7. Configure timeout in: M365 Admin Center (global) OR SharePoint/Exchange PowerShell (app-specific)\n8. For SharePoint: Use Set-SPOBrowserIdleSignOut cmdlet\n9. For Exchange/OWA: Managed via M365 Admin Center global setting\n10. Result: Managed devices exempt from timeout, unmanaged devices subject to timeout",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/idle-session-timeout-web-apps#turn-on-idle-session-timeout-on-unmanaged-devices",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Provides conditional session termination based on device management status. Enforces stricter automatic session termination for higher-risk scenarios (unmanaged devices) while allowing more flexibility for managed, compliant devices. Addresses NIST requirement for organization-defined conditions triggering session termination.",
          "nistRequirement": "Terminate a user session automatically after organization-defined conditions (specifically: device management/compliance status as trigger condition)"
        }
      ]
    },
    {
      "id": "SPO-AC-001",
      "settingName": "SPOBrowserIdleSignOut",
      "displayName": "SharePoint Online Idle Session Sign-Out",
      "settingPath": "SharePoint.IdleSessionSignOut",
      "policyType": "Purview",
      "policySubType": "SharePointOnlineSettings",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "Enabled": true,
        "WarnAfter": "00:45:00",
        "SignOutAfter": "01:00:00"
      },
      "validationOperator": "==",
      "description": "SharePoint and OneDrive-specific idle session timeout. Warns users after specified inactivity, then automatically signs out if no response. WARNING: Microsoft 365 Admin Center global timeout overrides this setting. Only use if NOT using global M365 timeout OR if targeting unmanaged devices only.",
      "implementationGuide": "Step-by-step (PowerShell required):\n1. Install SharePoint Online Management Shell: Install-Module -Name Microsoft.Online.SharePoint.PowerShell\n2. Connect: Connect-SPOService -Url https://tenant-admin.sharepoint.com\n3. Configure timeout:\n   Set-SPOBrowserIdleSignOut -Enabled $true -WarnAfter (New-TimeSpan -Minutes 45) -SignOutAfter (New-TimeSpan -Minutes 60)\n4. Verify: Get-SPOBrowserIdleSignOut\n5. Values:\n   - WarnAfter: Time before warning (e.g., 45 minutes)\n   - SignOutAfter: Time before sign-out (e.g., 60 minutes)\n   - WarnAfter and SignOutAfter CANNOT be the same value\n6. Takes ~15 minutes to apply across organization\n7. Activity = requests sent to SharePoint (mouse clicks), NOT mouse movement or scrolling\n8. IMPORTANT: M365 Admin Center idle timeout OVERRIDES this if configured",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/sign-out-inactive-users",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Enforces automatic session termination specifically for SharePoint Online and OneDrive for Business browser sessions after user inactivity. Provides granular control over SharePoint/OneDrive sessions beyond global M365 timeout. NOTE: Superseded by M365 Admin Center global timeout if both are configured.",
          "nistRequirement": "Terminate a user session automatically after organization-defined periods of user inactivity - application-specific session termination"
        }
      ]
    },
    {
      "id": "EXO-AC-001",
      "settingName": "ActivityBasedAuthenticationTimeout",
      "displayName": "Exchange Online Activity-Based Authentication Timeout",
      "settingPath": "Organization.ActivityBasedAuthenticationTimeout",
      "policyType": "Microsoft365",
      "policySubType": "ExchangeOnlineSettings",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "ActivityBasedAuthenticationTimeoutEnabled": true,
        "ActivityBasedAuthenticationTimeoutInterval": "01:00:00",
        "ActivityBasedAuthenticationTimeoutWithSingleSignOnEnabled": true
      },
      "validationOperator": "==",
      "description": "Outlook Web App (OWA) session timeout based on user activity. Default is 6 hours. NOTE: Microsoft is RETIRING this feature in 2024 in favor of M365 Admin Center global idle timeout. Range: 5 minutes to 8 hours. WARNING: M365 Admin Center global timeout overrides this.",
      "implementationGuide": "Step-by-step (PowerShell required):\n1. Connect to Exchange Online: Connect-ExchangeOnline -UserPrincipalName admin@tenant.com\n2. Check current setting: Get-OrganizationConfig | Select-Object ActivityBasedAuthenticationTimeout*\n3. Configure timeout:\n   Set-OrganizationConfig -ActivityBasedAuthenticationTimeoutEnabled $true -ActivityBasedAuthenticationTimeoutInterval 01:00:00 -ActivityBasedAuthenticationTimeoutWithSingleSignOnEnabled $true\n4. Value format: HH:MM:SS (e.g., 01:00:00 = 1 hour, 00:15:00 = 15 minutes)\n5. Range: Minimum 00:05:00 (5 min), Maximum 08:00:00 (8 hours)\n6. Takes 12+ hours to take effect - be patient!\n7. IMPORTANT: Microsoft started retiring this in January 2024\n8. Use M365 Admin Center global idle timeout instead for new deployments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/idle-session-timeout-web-apps",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Legacy setting for OWA session timeout. Being deprecated in favor of M365 Admin Center global idle timeout. Historically enforced automatic session termination for Outlook Web App after inactivity. NOTE: Only document for environments not yet migrated to M365 Admin Center timeout. Superseded by M365-AC-001.",
          "nistRequirement": "Terminate a user session automatically after organization-defined periods of user inactivity - legacy OWA-specific implementation"
        }
      ]
    },
    {
      "id": "IN-AC-236",
      "settingName": "AppProtectionPolicyOfflineGracePeriod",
      "displayName": "App Protection Policy - Offline Grace Period (Minutes)",
      "settingPath": "IntuneMAMPolicy.ConditionalLaunch.OfflineGracePeriod",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS",
      "dataType": "integer",
      "expectedValue": 720,
      "validationOperator": "<=",
      "description": "Maximum minutes apps can run offline before requiring online authentication check. If exceeded, blocks access or wipes app data. Acts as session timeout for mobile apps - forces re-authentication after extended offline period. Recommended: 720 minutes (12 hours).",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Apps > App protection policies\n2. Create or edit iOS/iPadOS App Protection Policy\n3. Under 'Conditional launch' section > App conditions\n4. Find 'Offline grace period' setting (pre-configured by default)\n5. Set value: 720 minutes (12 hours) - default, OR customize (60-10080 minutes = 1 hour to 7 days)\n6. Choose action when exceeded:\n   - 'Block access' (recommended): User must connect to network and re-authenticate\n   - 'Wipe data': Removes corporate data from app\n7. Best practice: 12 hours for standard users, 4-8 hours for high-security\n8. Applies to: Outlook, OneDrive, Office apps, Teams, other MAM-enabled apps\n9. User experience: After threshold, user sees message requiring network connection",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/apps/app-protection-policy-settings-ios#conditional-launch",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Enforces automatic session termination for mobile app sessions after extended offline periods. Mobile users accessing Microsoft 365 apps must periodically check in online, effectively terminating stale sessions that haven't authenticated recently. Prevents indefinite offline access to potentially stale corporate data.",
          "nistRequirement": "Terminate a user session automatically after organization-defined conditions - specifically addresses offline/disconnected session termination for mobile apps"
        },
        {
          "controlId": "03.01.18",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Supports mobile device access control by ensuring mobile app sessions require periodic online authentication, preventing extended offline access with potentially compromised credentials.",
          "nistRequirement": "Mobile device access control - session management for mobile applications"
        }
      ]
    },
    {
      "id": "IN-AC-237",
      "settingName": "AppProtectionPolicyOfflineGracePeriodAndroid",
      "displayName": "App Protection Policy - Offline Grace Period (Minutes) - Android",
      "settingPath": "IntuneMAMPolicy.ConditionalLaunch.OfflineGracePeriod",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "Android",
      "dataType": "integer",
      "expectedValue": 720,
      "validationOperator": "<=",
      "description": "Maximum minutes apps can run offline before requiring online authentication check on Android devices. If exceeded, blocks access or wipes app data. Acts as session timeout for mobile apps - forces re-authentication after extended offline period. Recommended: 720 minutes (12 hours).",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Apps > App protection policies\n2. Create or edit Android App Protection Policy\n3. Under 'Conditional launch' section > App conditions\n4. Find 'Offline grace period' setting (pre-configured by default)\n5. Set value: 720 minutes (12 hours) - default, OR customize (60-10080 minutes = 1 hour to 7 days)\n6. Choose action when exceeded:\n   - 'Block access' (recommended): User must connect to network and re-authenticate\n   - 'Wipe data': Removes corporate data from app\n7. Best practice: 12 hours for standard users, 4-8 hours for high-security\n8. Applies to: Outlook, OneDrive, Office apps, Teams, other MAM-enabled apps\n9. User experience: After threshold, user sees message requiring network connection\n10. Android-specific: Requires Intune Company Portal app installed on device",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/apps/app-protection-policy-settings-android#conditional-launch",
      "controlMappings": [
        {
          "controlId": "03.01.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Enforces automatic session termination for mobile app sessions on Android devices after extended offline periods. Mobile users accessing Microsoft 365 apps must periodically check in online, effectively terminating stale sessions that haven't authenticated recently.",
          "nistRequirement": "Terminate a user session automatically after organization-defined conditions - specifically addresses offline/disconnected session termination for Android mobile apps"
        },
        {
          "controlId": "03.01.18",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Supports mobile device access control by ensuring Android app sessions require periodic online authentication, preventing extended offline access with potentially compromised credentials.",
          "nistRequirement": "Mobile device access control - session management for mobile applications"
        }
      ]
    }
  ]
}
