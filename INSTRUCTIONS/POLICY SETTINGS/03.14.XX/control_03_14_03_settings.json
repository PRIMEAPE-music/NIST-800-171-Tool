{
  "controlId": "03.14.03",
  "family": "SI",
  "familyName": "System and Information Integrity",
  "title": "Security Alerts, Advisories, and Directives",
  "nistRequirement": "a. Receive system security alerts, advisories, and directives from external organizations on an ongoing basis.\nb. Generate and disseminate internal system security alerts, advisories, and directives, as necessary.",
  "settings": [
    {
      "id": "DF-SI-002",
      "settingName": "Microsoft Defender threat intelligence integration",
      "displayName": "Defender XDR - Threat Intelligence and Analytics",
      "settingPath": "Defender.ThreatIntelligence",
      "policyType": "Defender",
      "policySubType": "Threat Intelligence",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables integration with Microsoft's threat intelligence feeds which continuously receive security alerts and advisories from global threat data sources including CISA, FBI, NSA, and other security organizations. Threat intelligence is automatically applied to Microsoft Defender for Endpoint, providing real-time threat detection based on external security advisories.",
      "implementationGuide": "1. Sign in to Microsoft Defender portal (https://security.microsoft.com)\n2. Navigate to Settings > Microsoft Defender XDR > Threat Intelligence\n3. Verify 'Microsoft Threat Intelligence' is enabled (enabled by default with Defender licensing)\n4. Navigate to Threat analytics to view current threat intelligence reports\n5. Review threat intelligence sources:\n   - Microsoft Defender Threat Intelligence\n   - CISA Cybersecurity Advisories\n   - Industry threat intelligence feeds\n6. Configure custom threat indicators if needed (Settings > Endpoints > Indicators)\n7. Enable email notifications for threat intelligence updates\n8. Review threat analytics reports regularly for relevant threats and recommended actions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/threat-analytics",
      "controlMappings": [
        {
          "controlId": "03.14.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Microsoft Defender threat intelligence automatically receives and applies security alerts, advisories, and directives from external organizations including CISA, FBI, NSA, and software vendors. This directly satisfies the NIST requirement to receive system security alerts and advisories from external organizations on an ongoing basis.",
          "nistRequirement": "Receive system security alerts, advisories, and directives from external organizations on an ongoing basis"
        }
      ]
    },
    {
      "id": "DF-SI-003",
      "settingName": "Microsoft Defender alert policies",
      "displayName": "Microsoft 365 Defender - Alert Policies and Notifications",
      "settingPath": "Defender.AlertPolicies",
      "policyType": "Defender",
      "policySubType": "Alert Policy",
      "platform": "All",
      "dataType": "array",
      "expectedValue": [
        "Malware campaign detected after delivery",
        "Suspicious connector activity",
        "Suspicious email sending patterns detected",
        "Suspicious Email Forwarding Activity",
        "User restricted from sending email"
      ],
      "validationOperator": "contains",
      "description": "Configures Microsoft 365 Defender alert policies to generate and disseminate internal security alerts. Alert policies automatically detect suspicious activities and security events, notifying administrators of potential threats requiring investigation or response.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Navigate to Policies > Alert policies\n3. Review and enable required alert policies, minimum requirements per CISA SCB:\n   - Malware campaign detected after delivery (High severity)\n   - Suspicious connector activity (Medium severity)\n   - Suspicious email sending patterns detected (Medium severity)\n   - User restricted from sending email (High severity)\n4. For each alert policy, click to edit:\n   - Set Status to 'On'\n   - Configure email recipients for notifications\n   - Set appropriate severity thresholds\n5. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n6. Configure additional Defender for Endpoint alert policies\n7. Test alert delivery by triggering test events\n8. Document alert response procedures",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/alert-policies",
      "controlMappings": [
        {
          "controlId": "03.14.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Alert policies generate internal security alerts based on detected threats and suspicious activities. Configured notifications disseminate these alerts to appropriate personnel, satisfying the NIST requirement to generate and disseminate internal system security alerts and advisories.",
          "nistRequirement": "Generate and disseminate internal system security alerts, advisories, and directives, as necessary"
        }
      ]
    },
    {
      "id": "DF-SI-004",
      "settingName": "Email notifications for security alerts",
      "displayName": "Defender XDR - Alert Email Notifications",
      "settingPath": "Defender.AlertNotifications",
      "policyType": "Defender",
      "policySubType": "Notification Settings",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "enabled": true,
        "severity": ["High", "Medium"],
        "recipients": "SecurityTeam@organization.com"
      },
      "validationOperator": "==",
      "description": "Configures automatic email notifications when security alerts are triggered in Microsoft Defender XDR. Notifications ensure security personnel are promptly informed of detected threats, enabling rapid response to security incidents. Supports dissemination of internal security alerts to appropriate organizational roles.",
      "implementationGuide": "1. Sign in to Microsoft Defender portal (https://security.microsoft.com)\n2. Navigate to Settings > Microsoft Defender XDR > Email notifications\n3. Click 'Add item' to create notification rule\n4. Configure notification settings:\n   - Rule name: Descriptive name (e.g., 'High Severity Security Alerts')\n   - Alert severity: Select 'High' and 'Medium' at minimum\n   - Device groups: Select 'All devices' or specific groups\n   - Recipients: Add email addresses or distribution lists\n5. Enable 'Send test email' to verify configuration\n6. Create separate notification rules for different severity levels if needed\n7. Document recipients and escalation procedures\n8. Review notification settings quarterly and update recipients as needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/configure-email-notifications",
      "controlMappings": [
        {
          "controlId": "03.14.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Email notifications provide automated dissemination of internal security alerts to designated security personnel. This ensures timely awareness of detected threats and supports incident response workflows, directly satisfying the requirement to disseminate internal security alerts.",
          "nistRequirement": "Generate and disseminate internal system security alerts, advisories, and directives, as necessary"
        }
      ]
    },
    {
      "id": "DF-SI-005",
      "settingName": "Microsoft Defender incident response",
      "displayName": "Defender XDR - Automated Investigation and Response",
      "settingPath": "Defender.AutomatedInvestigation",
      "policyType": "Defender",
      "policySubType": "Automation Settings",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Full - remediate threats automatically",
      "validationOperator": "==",
      "description": "Configures automated investigation and response (AIR) capabilities to automatically investigate security alerts and take remediation actions. AIR analyzes alerts, correlates incidents, and implements security directives automatically, reducing response time for known threats.",
      "implementationGuide": "1. Sign in to Microsoft Defender portal (https://security.microsoft.com)\n2. Navigate to Settings > Endpoints > Advanced features\n3. Verify 'Automated Investigation' is enabled\n4. Navigate to Settings > Endpoints > Device groups\n5. For each device group, configure automation level:\n   - Select device group\n   - Under 'Automation level', choose 'Full - remediate threats automatically' for production systems\n   - Or choose 'Semi - require approval for any remediation' for sensitive systems\n6. Configure automated investigation settings:\n   - Enable 'Automatically resolve alerts'\n   - Set appropriate threat severity thresholds\n7. Review pending actions in Action Center regularly\n8. Monitor AIR investigation results in Incidents queue\n9. Tune automation rules based on false positive rates",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/automated-investigations",
      "controlMappings": [
        {
          "controlId": "03.14.03",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Automated investigation and response implements security directives automatically by investigating alerts and remediating confirmed threats. This accelerates implementation of security directives from external threat intelligence, though manual review may be preferred for compliance verification.",
          "nistRequirement": "Generate and disseminate internal system security alerts, advisories, and directives, as necessary"
        }
      ]
    },
    {
      "id": "PV-SI-001",
      "settingName": "Audit log retention policy",
      "displayName": "Microsoft Purview - Audit Log Retention",
      "settingPath": "Purview.AuditLogRetention",
      "policyType": "Purview",
      "policySubType": "Audit and Log Management",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "retentionPeriod": 365,
        "recordTypes": ["All"],
        "enabled": true
      },
      "validationOperator": ">=",
      "description": "Configures retention of Microsoft 365 audit logs to maintain records of security events, alerts, and activities. Audit logs capture security-relevant events that support investigation of security alerts and provide evidence of security advisory implementation. Per OMB M-21-31, federal agencies must retain logs for 12 months in active storage plus 18 months in cold storage.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Navigate to Solutions > Audit\n3. Verify 'Audit' is turned on\n4. Navigate to Audit log retention policies\n5. Click 'Create audit log retention policy'\n6. Configure retention settings:\n   - Policy name: Descriptive name\n   - Record types: Select 'All activities' or specific security-related activities\n   - Retention duration: Set to 365 days minimum (or longer per requirements)\n   - Priority: Set appropriate priority if multiple policies exist\n7. Assign policy to users or groups (All users recommended)\n8. Review and create policy\n9. Verify policy is applied using PowerShell: Get-UnifiedAuditLogRetentionPolicy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies",
      "controlMappings": [
        {
          "controlId": "03.14.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Audit logs record security alerts, investigations, and remediation actions, providing documentation of security advisory implementation and alert response. Logs support forensic analysis and demonstrate compliance with security directives. Essential for investigating security incidents and verifying alert response procedures.",
          "nistRequirement": "Receive system security alerts, advisories, and directives from external organizations; generate and disseminate internal security alerts"
        }
      ]
    },
    {
      "id": "AZ-SI-001",
      "settingName": "Azure AD sign-in risk policy",
      "displayName": "Entra ID - Sign-in Risk-based Conditional Access",
      "settingPath": "AzureAD.ConditionalAccess.SignInRiskPolicy",
      "policyType": "AzureAD",
      "policySubType": "Conditional Access",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "state": "enabled",
        "riskLevels": ["high", "medium"],
        "controls": "require MFA or block"
      },
      "validationOperator": "==",
      "description": "Configures conditional access policy based on sign-in risk detected by Azure AD Identity Protection. Risk-based policies automatically respond to threat intelligence indicating compromised credentials or suspicious sign-in patterns, implementing security directives to protect accounts from unauthorized access.",
      "implementationGuide": "1. Verify Azure AD Premium P2 licensing (required for Identity Protection)\n2. Sign in to Entra admin center (https://entra.microsoft.com)\n3. Navigate to Protection > Conditional Access\n4. Click 'New policy' and configure:\n   - Name: 'Block or require MFA for risky sign-ins'\n   - Users: Include all users, exclude emergency access accounts\n   - Cloud apps: All cloud apps\n   - Conditions > Sign-in risk: Select 'High' and 'Medium'\n   - Access controls > Grant: Select 'Require multi-factor authentication' or 'Block access'\n5. Set 'Enable policy' to 'Report-only' initially for testing\n6. Monitor report-only results for 2-4 weeks\n7. Switch to 'On' after validation\n8. Configure risk event detection settings in Identity Protection",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-risk",
      "controlMappings": [
        {
          "controlId": "03.14.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Sign-in risk policies automatically implement security directives based on real-time threat intelligence from Microsoft and external sources. Risk detection incorporates threat advisories about credential compromise, suspicious locations, and attack patterns, automatically protecting accounts when threats are detected.",
          "nistRequirement": "Receive system security alerts, advisories, and directives from external organizations on an ongoing basis"
        }
      ]
    }
  ],
  "totalSettings": 6,
  "highConfidenceSettings": 6,
  "implementationNotes": "All settings establish comprehensive security alert and advisory capabilities. Microsoft Defender threat intelligence automatically receives external advisories from CISA, FBI, NSA, and vendors. Alert policies and notifications generate and disseminate internal alerts. Audit logging maintains records of alert response. Risk-based conditional access implements security directives automatically. Deploy these settings to establish end-to-end alert management.",
  "microsoftBaselineAlignment": "Settings align with Microsoft Security Baselines and CISA Secure Cloud Business Applications (SCuBA) baselines for M365",
  "cisLevel1Compliance": true,
  "estimatedImplementationTime": "4-6 hours for initial configuration including alert policy review, 2-3 hours for testing and notification validation"
}
