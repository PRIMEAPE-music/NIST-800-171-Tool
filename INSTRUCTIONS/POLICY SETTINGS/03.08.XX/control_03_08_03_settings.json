{
  "controlId": "03.08.03",
  "controlTitle": "Media Sanitization",
  "controlFamily": "MP",
  "totalSettings": 5,
  "settings": [
    {
      "id": "IN-MP-008",
      "settingName": "DeviceWipeAction",
      "displayName": "Remote Wipe Device - Full Factory Reset",
      "settingPath": "deviceManagement.remoteActions.wipe",
      "policyType": "Intune",
      "policySubType": "RemoteAction",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "wipeAction": "full",
        "retainEnrollmentState": false,
        "retainUserAccount": false,
        "obliterateSetting": "doObliterate"
      },
      "validationOperator": "contains",
      "description": "Performs full factory reset of device, removing all data, apps, and settings. BitLocker encryption is removed during the process. Use for device decommissioning, loss, theft, or repurposing to ensure complete data sanitization.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > All devices\n3. Select device to be sanitized\n4. Click 'Wipe' action in device overview pane\n5. Configure wipe options:\n   - Wipe device, but keep enrollment state and user account: Leave UNCHECKED for full sanitization\n   - Wipe device, and continue to wipe even if device loses power: CHECK for high-security scenarios\n6. Enter confirmation text and click Wipe\n7. Important: For Windows 11 21H2+, see Note about Windows.old folder issue\n8. Verify wipe completion status in Device Actions monitor\n9. After wipe: Remove device from Intune if not reusing\n10. Document wipe action in asset disposal records\n11. CRITICAL: Before wiping Azure AD joined device, backup BitLocker recovery keys",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/remote-actions/devices-wipe",
      "controlMappings": [
        {
          "controlId": "03.08.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Directly implements media sanitization for device disposal or repurposing. Factory reset removes all CUI and organizational data from device media. BitLocker decryption during wipe ensures media is properly sanitized. Required action before releasing devices from organizational control or reusing for different users.",
          "nistRequirement": "Sanitize system media that contain CUI prior to disposal, release out of organizational control, or release for reuse. Sanitization process removes CUI from media such that information cannot be retrieved or reconstructed."
        }
      ]
    },
    {
      "id": "IN-MP-009",
      "settingName": "AutopilotReset",
      "displayName": "Windows Autopilot Reset for Device Reuse",
      "settingPath": "deviceManagement.remoteActions.autopilotReset",
      "policyType": "Intune",
      "policySubType": "RemoteAction",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Performs Autopilot reset to remove user files and settings while retaining device in Autopilot deployment program. Maintains device encryption and organizational connection. Suitable for device reassignment within organization.",
      "implementationGuide": "1. Prerequisite: Device must be registered in Windows Autopilot service\n2. In Intune admin center, navigate to Devices > All devices\n3. Select target device\n4. Click 'Autopilot reset' from actions menu\n5. Choose reset type:\n   - Local Autopilot reset (initiated by user at device)\n   - Remote Autopilot reset (initiated by admin)\n6. Confirm reset action\n7. Device will:\n   - Remove user installed apps, data, and settings\n   - Retain device management enrollment\n   - Retain Azure AD/Entra ID join\n   - Retain provisioning packages\n   - Keep BitLocker encryption (does not decrypt)\n8. After reset, device automatically goes through OOBE\n9. Apply to new user\n10. Monitor reset status in Intune\n11. Note: More secure than Fresh Start but less complete than full Wipe",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/autopilot/windows-autopilot-reset",
      "controlMappings": [
        {
          "controlId": "03.08.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Provides sanitization method for device reuse within organization. Removes user data and CUI while maintaining device security posture (BitLocker encryption remains). Faster than full wipe for internal device reassignment. Suitable when device remains under organizational control.",
          "nistRequirement": "Sanitize system media that contain CUI prior to release for reuse. The sanitization process removes CUI from media such that the information cannot be retrieved or reconstructed."
        }
      ]
    },
    {
      "id": "IN-MP-010",
      "settingName": "RetireDeviceAction",
      "displayName": "Retire Device - Remove Company Data Only",
      "settingPath": "deviceManagement.remoteActions.retire",
      "policyType": "Intune",
      "policySubType": "RemoteAction",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Removes company data, apps, and MDM policies from device while preserving user personal data. Suspends BitLocker on Azure AD joined devices. Use for BYOD devices or employee separation when device ownership transfers to user.",
      "implementationGuide": "1. Navigate to Devices > All devices in Intune admin center\n2. Select device to retire\n3. Click 'Retire' action\n4. Confirm retirement\n5. Retire action will:\n   - Remove company data (emails, apps, profiles)\n   - Remove MDM enrollment\n   - For Azure AD joined devices: Suspend BitLocker (backup recovery key first!)\n   - Keep user personal data intact\n   - Remove device from Intune management\n6. For corporate-owned devices being returned: Use Wipe instead\n7. Document retire action in HR/IT records\n8. Monitor retire status in Device actions\n9. After retire: Consider removing Azure AD device record\n10. CRITICAL: This is partial sanitization - only use when device ownership transfers to user\n11. For devices with highly sensitive CUI, use full Wipe instead",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/remote-actions/devices-wipe",
      "controlMappings": [
        {
          "controlId": "03.08.03",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Provides targeted sanitization of organizational data and CUI while preserving user personal data. Appropriate for BYOD scenarios or when device ownership transfers to employee. BitLocker suspension ensures user can still access device. Less complete than full wipe but suitable when full media sanitization not required.",
          "nistRequirement": "Sanitize system media that contain CUI prior to release out of organizational control. Removes organizational CUI but not complete media sanitization."
        }
      ]
    },
    {
      "id": "IN-MP-011",
      "settingName": "BitLockerKeyRotation",
      "displayName": "BitLocker Recovery Key Rotation",
      "settingPath": "deviceManagement.remoteActions.rotateBitLockerKeys",
      "policyType": "Intune",
      "policySubType": "RemoteAction",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Rotates BitLocker recovery keys on managed devices to invalidate previous keys. Critical sanitization step when device has been compromised, lost then recovered, or when rotating keys as security measure. Prevents use of old recovery keys to access encrypted data.",
      "implementationGuide": "1. Prerequisite: BitLocker must be enabled and managed by Intune\n2. Prerequisite: User must have 'Rotate BitLockerKeys' permission in Intune RBAC role\n3. Navigate to Devices > All devices\n4. Select device\n5. From device actions, select 'Rotate BitLocker keys' (preview)\n6. Confirm key rotation\n7. Process:\n   - Device generates new BitLocker recovery key\n   - New key uploaded to Azure AD/Entra ID\n   - Old recovery key invalidated\n8. Verify new key in Azure AD device properties\n9. Document key rotation in security logs\n10. Use cases:\n   - Device was lost then recovered\n   - Suspected key compromise\n   - Regular key rotation policy (e.g., annually)\n   - Before device reassignment\n11. Note: Does not decrypt/re-encrypt drive, only rotates recovery keys",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices",
      "controlMappings": [
        {
          "controlId": "03.08.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Provides cryptographic key sanitization without full device wipe. Ensures previously compromised or exposed recovery keys cannot be used to access encrypted CUI. Critical for scenarios where physical device security was temporarily lost. Implements cryptographic erasure concept by invalidating old keys. Part of comprehensive key management hygiene.",
          "nistRequirement": "Sanitization techniques (e.g., cryptographically erasing) prevent the disclosure of CUI to unauthorized individuals when media are reused or released. Cryptographic erasure is a recognized sanitization method."
        }
      ]
    },
    {
      "id": "IN-MP-012",
      "settingName": "AutomaticDeviceCleanup",
      "displayName": "Automatic Device Cleanup Rules",
      "settingPath": "deviceManagement.settings.deviceCompliancePolicy.deviceCleanupRules",
      "policyType": "Intune",
      "policySubType": "TenantAdministration",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "enabled": true,
        "daysInactive": 90
      },
      "validationOperator": "contains",
      "description": "Automatically removes stale or inactive device records from Intune after specified period of inactivity. Ensures device inventory hygiene and prevents accumulation of orphaned device records that may retain CUI metadata.",
      "implementationGuide": "1. Navigate to Tenant administration > Device cleanup rules\n2. Configure cleanup settings:\n   - Delete devices that haven't checked in for this many days: Set to 90 days (adjust based on policy)\n3. Click Save\n4. Behavior:\n   - Devices are hidden/concealed from Intune reports\n   - Device records removed from management\n   - Does NOT trigger wipe or retire actions on actual devices\n   - BitLocker keys and device metadata removed\n5. Important notes:\n   - Rule does not trigger BitLocker suspension\n   - Cleanup is for record keeping only\n   - Actual device sanitization must be done separately via Wipe/Retire\n6. Use in combination with proper device disposal procedures\n7. Document cleanup threshold in data retention policy\n8. Monitor cleanup activity in audit logs\n9. Review cleanup settings quarterly\n10. Coordinate with asset management team on device disposal workflows",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/remote-actions/devices-wipe",
      "controlMappings": [
        {
          "controlId": "03.08.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Provides automated hygiene for device metadata and records. Ensures CUI-related information in device records (BitLocker keys, compliance data) is removed after devices become inactive. Prevents accumulation of stale device data that could be security risk. Supports overall media lifecycle management and data sanitization policies.",
          "nistRequirement": "Sanitize system media that contain CUI prior to disposal or release. Includes sanitization of device management records and associated cryptographic material (recovery keys) when devices are decommissioned."
        }
      ]
    }
  ],
  "implementationNotes": "Establish clear device sanitization procedures before implementing: 1) Define criteria for Wipe vs. Retire vs. Autopilot Reset based on device ownership and sensitivity. 2) Document BitLocker key backup procedures before all sanitization actions. 3) Train IT staff on proper sanitization method selection. 4) Integrate with asset disposal workflows. 5) Be aware of Windows 11 21H2+ wipe limitations with Windows.old folder. 6) Maintain audit log of all sanitization actions for compliance evidence.",
  "validationApproach": "1. Test full wipe on non-production device and verify complete data removal. 2. Verify BitLocker keys are backed up before wipe actions. 3. Test Autopilot reset and confirm user data removed but device manageable. 4. Validate BitLocker key rotation and confirm old keys no longer work. 5. Monitor device cleanup rule execution via audit logs. 6. Document all sanitization procedures in runbooks. 7. Periodically audit sanitization practices against NIST SP 800-88 guidelines.",
  "relatedControls": [
    "03.08.01",
    "03.08.02",
    "03.13.08"
  ],
  "additionalGuidance": "For complete media sanitization aligned with NIST SP 800-88, consider: 1) Clear (overwriting) via Windows built-in tools for non-SSD drives. 2) Cryptographic Erase via BitLocker key destruction for encrypted drives. 3) Purge via manufacturer secure erase commands for SSDs. 4) Physical destruction for devices with highest sensitivity CUI. Intune wipe provides Clear/Cryptographic Erase level sanitization. For higher assurance, use vendor-specific tools or physical destruction."
}
