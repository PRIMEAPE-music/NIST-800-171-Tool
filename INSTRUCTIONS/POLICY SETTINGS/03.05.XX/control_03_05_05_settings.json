{
  "controlId": "03.05.05",
  "controlTitle": "Identifier Management",
  "family": "IA",
  "nistRequirement": "a. Receive authorization from organizational personnel or roles to assign an individual, group, role, service, or device identifier.\nb. Select and assign an identifier that identifies an individual, group, role, service, or device.\nc. Prevent the reuse of identifiers for [Assignment: organization-defined time period].\nd. Manage individual identifiers by uniquely identifying each individual as [Assignment: organization-defined characteristic identifying individual status].",
  "settingsCount": 6,
  "settings": [
    {
      "id": "AZ-IA-006",
      "settingName": "auditLogsEnabled",
      "displayName": "Azure AD Audit Logs Enabled",
      "settingPath": "diagnosticSettings.logs.category",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ["AuditLogs"],
      "validationOperator": "contains",
      "description": "Enables comprehensive audit logging for all user account lifecycle operations including creation, modification, deletion, and assignment of identifiers. Audit logs capture who authorized changes, when changes occurred, and what identifiers were assigned, providing complete accountability for identifier management as required by NIST 800-171.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Global Administrator\n2. Navigate to Identity > Monitoring & health > Diagnostic settings\n3. Select 'Add diagnostic setting'\n4. Provide name: 'Azure AD Audit Logs to Log Analytics'\n5. Under Logs, select 'AuditLogs' category\n6. Under Destination details, select 'Send to Log Analytics workspace'\n7. Select your Log Analytics workspace (create one if needed)\n8. Set retention period to at least 90 days (recommended: 1 year)\n9. Save the diagnostic setting\n10. Verify logs are flowing: Navigate to Log Analytics workspace > Logs > Query: AuditLogs | take 10",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs",
      "controlMappings": [
        {
          "controlId": "03.05.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Audit logs provide complete accountability for identifier management by recording all user account operations including who authorized identifier assignments, when identifiers were created/modified/deleted, and what identifiers were assigned. This satisfies NIST requirements for receiving authorization and maintaining records of identifier assignment. CIS Level 1 control (5.2.5) requires Azure AD logs be collected.",
          "nistRequirement": "Receive authorization from organizational personnel or roles to assign an individual, group, role, service, or device identifier"
        }
      ]
    },
    {
      "id": "AZ-IA-007",
      "settingName": "inactiveUserDisable",
      "displayName": "Disable Inactive User Accounts",
      "settingPath": "conditionalAccess.policy.conditions.users.inactiveThreshold",
      "policyType": "AzureAD",
      "policySubType": "AccessReview",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 90,
      "validationOperator": "<=",
      "description": "Automatically reviews and disables user accounts that have been inactive for 90 days or more. Inactive accounts represent identifiers that are no longer in use and pose security risks. Regular reviews ensure identifiers are only active when needed and are properly managed throughout their lifecycle.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Identity Governance Administrator\n2. Navigate to Identity Governance > Access reviews\n3. Select 'New access review'\n4. Review type: 'Teams + Groups' or 'Applications'\n5. Under Scope, select groups containing all users\n6. Set Review type to 'All users'\n7. Under 'Inactive users (on tenant level only)': Enable and set to 90 days\n8. Set Duration: 30 days\n9. Set Recurrence: Monthly or Quarterly\n10. Under 'Upon completion settings': Select 'Auto apply results to resource'\n11. Select 'Disable user' for users who don't respond\n12. Start review\n13. Configure email notifications to reviewers and affected users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/create-access-review",
      "controlMappings": [
        {
          "controlId": "03.05.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Regular access reviews of inactive accounts ensure identifiers are properly managed and removed when no longer needed. This satisfies NIST requirements for identifier lifecycle management and ensures identifiers are not reused inappropriately. Microsoft security baseline and CIS Level 1 (5.3.2) recommend periodic access reviews.",
          "nistRequirement": "Prevent the reuse of identifiers for [Assignment: organization-defined time period]"
        }
      ]
    },
    {
      "id": "AZ-IA-008",
      "settingName": "deletedUserRetention",
      "displayName": "Deleted User Retention Period",
      "settingPath": "directory.settings.deletedUserRetentionDays",
      "policyType": "AzureAD",
      "policySubType": "DirectorySettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 30,
      "validationOperator": "==",
      "description": "Maintains deleted user accounts in soft-delete state for 30 days before permanent deletion. During this period, the identifier (UPN, Object ID) cannot be reused, preventing confusion and maintaining clear audit trails. After 30 days, identifiers are permanently removed and can only be reused after organization-defined period.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Global Administrator\n2. Navigate to Identity > Users > Deleted users\n3. Note: Azure AD automatically retains deleted users for 30 days (default, cannot be modified)\n4. To permanently delete immediately: Select user > Permanent delete > Confirm\n5. To restore within 30 days: Select user > Restore user > Confirm\n6. Configure organizational policy: Establish waiting period before allowing identifier reuse (e.g., 90 days after permanent deletion)\n7. Document policy in security procedures\n8. Train identity administrators on identifier reuse restrictions\n9. Use Graph API to monitor: GET https://graph.microsoft.com/v1.0/directory/deletedItems/microsoft.graph.user\n10. Create alerts for identifiers approaching reuse eligibility",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/fundamentals/users-restore",
      "controlMappings": [
        {
          "controlId": "03.05.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "The 30-day soft-delete retention prevents immediate reuse of user identifiers, reducing risk of confused deputy attacks and maintaining clear accountability. Organizations should extend this with policies preventing reuse for longer periods (e.g., 90-365 days) after permanent deletion to fully satisfy NIST requirements.",
          "nistRequirement": "Prevent the reuse of identifiers for [Assignment: organization-defined time period]"
        }
      ]
    },
    {
      "id": "AZ-IA-009",
      "settingName": "userTypeIdentification",
      "displayName": "User Status Identification (UserType)",
      "settingPath": "user.userType",
      "policyType": "AzureAD",
      "policySubType": "UserAttribute",
      "platform": "All",
      "dataType": "string",
      "expectedValue": ["Member", "Guest"],
      "validationOperator": "in",
      "description": "Identifies user status through the userType attribute which distinguishes between internal employees (Member) and external users (Guest). This attribute is automatically set and enforced by Azure AD, enabling proper identification of individual status for access control, auditing, and compliance purposes.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as User Administrator\n2. Navigate to Identity > Users > All users\n3. For new internal employees: Create user with type 'Member' (default)\n4. For external collaborators: Use B2B invitation which automatically sets type 'Guest'\n5. View user type: Select user > Properties > Identity section\n6. Configure Conditional Access based on userType:\n   a. Navigate to Protection > Conditional Access\n   b. Create policy for Guest users with additional restrictions\n   c. Under Assignments > Users > Select users > User types\n   d. Select 'Guest or external users'\n7. Create report of user types:\n   GET https://graph.microsoft.com/v1.0/users?$select=userPrincipalName,userType\n8. Note: userType cannot be manually changed after creation\n9. For status changes: Delete and recreate user with correct type",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/external-id/user-properties",
      "controlMappings": [
        {
          "controlId": "03.05.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "The userType attribute uniquely identifies individual status (internal vs. external) as required by NIST 800-171. This enables organizations to apply appropriate access controls, monitor external user activity, and maintain proper segregation between employee and non-employee identifiers. CIS benchmark references this for external user management.",
          "nistRequirement": "Manage individual identifiers by uniquely identifying each individual as [Assignment: organization-defined characteristic identifying individual status]"
        }
      ]
    },
    {
      "id": "AZ-IA-010",
      "settingName": "employeeTypeAttribute",
      "displayName": "Employee Type Classification",
      "settingPath": "user.employeeType",
      "policyType": "AzureAD",
      "policySubType": "UserAttribute",
      "platform": "All",
      "dataType": "string",
      "expectedValue": ["Employee", "Contractor", "Vendor", "Partner"],
      "validationOperator": "in",
      "description": "Identifies individual status through the employeeType attribute which classifies users by employment relationship (Employee, Contractor, Vendor, Partner, etc.). This granular classification enables proper access control, conditional policies, and compliance reporting based on user status.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as User Administrator\n2. Navigate to Identity > Users > All users\n3. Select a user > Properties\n4. Under Job information section, locate 'Employee type' field\n5. Set appropriate value: Employee, Contractor, Vendor, Partner, or custom value\n6. Save changes\n7. Populate for all users via:\n   a. Manual update through portal\n   b. Sync from on-premises AD (employeeType attribute)\n   c. Graph API bulk update: PATCH https://graph.microsoft.com/v1.0/users/{id}\n   d. CSV import with employeeType column\n8. Configure Conditional Access policies based on employeeType:\n   a. Create policy for Contractors with limited access\n   b. Use filter: user.employeeType -eq 'Contractor'\n9. Create report: GET https://graph.microsoft.com/v1.0/users?$select=displayName,employeeType\n10. Establish organizational standards for employeeType values",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/user#properties",
      "controlMappings": [
        {
          "controlId": "03.05.05",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "The employeeType attribute provides granular identification of individual status beyond the basic userType, enabling organizations to distinguish between different types of personnel (employees, contractors, vendors). This satisfies NIST requirements for identifying characteristic status and enables appropriate access controls and monitoring based on employment relationship.",
          "nistRequirement": "Manage individual identifiers by uniquely identifying each individual as [Assignment: organization-defined characteristic identifying individual status]"
        }
      ]
    },
    {
      "id": "AZ-IA-011",
      "settingName": "privilegedAccessReview",
      "displayName": "Access Reviews for Privileged Roles",
      "settingPath": "accessReviews.roleAssignments.recurrence",
      "policyType": "AzureAD",
      "policySubType": "AccessReview",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Monthly",
      "validationOperator": "==",
      "description": "Conducts monthly access reviews of privileged role assignments to ensure identifier assignments remain appropriate and authorized. Regular reviews verify that only authorized personnel retain privileged identifiers and that assignments are removed when no longer needed.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Identity Governance Administrator\n2. Navigate to Identity Governance > Access reviews\n3. Select 'New access review'\n4. Review type: 'Teams + Groups' > Select 'All Microsoft Entra roles'\n5. Scope: 'Select privileged roles'\n6. Select roles: Global Administrator, Privileged Role Administrator, Security Administrator, etc.\n7. Set Duration: 7 days\n8. Set Recurrence: Monthly\n9. Under Reviewers: Select 'Selected users or groups' (role owners or security team)\n10. Under Settings: Enable 'Require reviewer to provide justification'\n11. Under 'Upon completion settings': Set 'If reviewers don't respond' to 'Remove access'\n12. Enable 'Auto apply results to resource'\n13. Start review\n14. Configure email reminders at Day 3 and Day 6",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review",
      "controlMappings": [
        {
          "controlId": "03.05.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Regular access reviews of privileged role assignments ensure that identifier assignments are continuously authorized and appropriate. This satisfies NIST requirements for receiving authorization from organizational personnel before assigning identifiers, particularly for high-privilege identifiers. CIS Level 1 control (5.3.3) requires access reviews for privileged Azure AD roles with monthly frequency (updated from weekly in v4.0.0).",
          "nistRequirement": "Receive authorization from organizational personnel or roles to assign an individual, group, role, service, or device identifier"
        }
      ]
    }
  ]
}
