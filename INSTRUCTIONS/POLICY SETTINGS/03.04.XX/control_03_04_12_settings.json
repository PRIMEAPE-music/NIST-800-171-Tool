{
  "controlId": "03.04.12",
  "controlTitle": "System and Component Configuration for High-Risk Areas",
  "family": "CM",
  "settingsCount": 6,
  "lastUpdated": "2025-11-17",
  "settings": [
    {
      "id": "AZ-CM-001",
      "settingName": "namedLocationsConfigured",
      "displayName": "Named Locations for High-Risk Geographic Areas",
      "settingPath": "microsoft.graph.identity.conditionalAccess.namedLocations",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "configured",
      "validationOperator": "exists",
      "description": "Defines specific geographic locations or IP ranges identified as high-risk areas (e.g., countries with elevated cyber threat profiles) for use in Conditional Access policies to enforce stricter security requirements on devices accessing from those locations",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Named locations\n3. Create new named location with descriptive name (e.g., 'High-Risk Countries')\n4. Select 'Countries location' type\n5. Mark as 'Include unknown countries/regions' if desired\n6. Select all countries considered high-risk based on organizational policy and threat intelligence\n7. Or create IP-based locations for specific high-risk network ranges\n8. Enable 'Mark as trusted location' for known safe locations (inverse approach)\n9. Document location definitions in security policies\n10. Test policies in report-only mode before enforcement",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/location-condition",
      "controlMappings": [
        {
          "controlId": "03.04.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Named Locations enable identification of high-risk geographic areas and provide the foundation for applying enhanced security configurations and access restrictions to devices operating in those locations, directly supporting the requirement to issue systems with specific configurations for high-risk travel",
          "nistRequirement": "Issue systems or system components with the following configurations to individuals traveling to high-risk locations"
        }
      ]
    },
    {
      "id": "AZ-CM-002",
      "settingName": "locationBasedConditionalAccess",
      "displayName": "Location-Based Conditional Access Policies for High-Risk Areas",
      "settingPath": "microsoft.graph.identity.conditionalAccess.policies",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "state": "enabled",
        "conditions": {
          "locations": "excludeTrusted"
        },
        "grantControls": [
          "mfa",
          "compliantDevice"
        ]
      },
      "validationOperator": "contains",
      "description": "Enforces enhanced security requirements (MFA, device compliance, approved apps) when users access corporate resources from high-risk locations, and blocks or restricts access based on geographic risk profile",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Protection > Conditional Access > Policies\n2. Create new policy with name 'High-Risk Location Access Policy'\n3. Under Assignments > Users: Select 'All users' or specific groups traveling to high-risk areas\n4. Under Cloud apps: Select 'All cloud apps' or specific sensitive applications\n5. Under Conditions > Locations: Configure to Yes\n6. Include: 'Any location' or 'Selected locations' (high-risk named locations)\n7. Exclude: 'All trusted locations' and 'Selected locations' (known safe locations)\n8. Under Access controls > Grant: Select 'Grant access' with conditions:\n   - Require multifactor authentication\n   - Require device to be marked as compliant\n   - Require approved client app (optional)\n9. Set 'Require all the selected controls' or 'Require one of the selected controls' based on risk\n10. Enable policy in Report-only mode first, review impact, then set to 'On'",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-location",
      "controlMappings": [
        {
          "controlId": "03.04.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Location-based Conditional Access policies automatically enforce organization-defined security requirements on devices accessing from high-risk locations, ensuring enhanced authentication and device compliance standards are applied when users travel to designated high-risk areas",
          "nistRequirement": "Issue systems or system components with the following configurations to individuals traveling to high-risk locations; Apply the following security requirements to the systems or components when the individuals return from travel"
        }
      ]
    },
    {
      "id": "IN-CM-001",
      "settingName": "enhancedDeviceCompliance",
      "displayName": "Enhanced Device Compliance Policies for High-Risk Scenarios",
      "settingPath": "microsoft.graph.deviceManagement.deviceCompliancePolicies",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "passwordRequired": true,
        "passwordMinimumLength": 14,
        "passwordComplexity": "high",
        "storageRequireEncryption": true,
        "securityRequireVerifyApps": true,
        "defenderEnabled": true,
        "defenderSignatureUpToDate": true,
        "osMinimumVersion": "latest"
      },
      "validationOperator": ">=",
      "description": "Defines stricter device compliance requirements (longer passwords, full disk encryption, up-to-date security, latest OS) that can be selectively enforced on devices used in high-risk travel scenarios through compliance policies and Conditional Access",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Compliance policies > Create policy\n3. Select platform (Windows, iOS, Android, macOS)\n4. Configure enhanced settings:\n   - Device Health: Require BitLocker/encryption, secure boot enabled\n   - Device Properties: Minimum OS version (latest stable)\n   - System Security: Firewall required, antivirus required and up-to-date\n   - Password: Minimum length 14+, complexity required, maximum password age\n   - Defender for Endpoint: Device threat level at or below 'Medium'\n5. Set Actions for noncompliance:\n   - Mark device noncompliant: Immediately\n   - Send email to end user: After 1 day\n   - Retire noncompliant device: After 30 days (optional for high-risk)\n6. Assign policy to groups containing users traveling to high-risk areas\n7. Monitor compliance status in Intune dashboard\n8. Combine with Conditional Access requiring compliant device",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started",
      "controlMappings": [
        {
          "controlId": "03.04.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Enhanced device compliance policies define and enforce the organization-defined system configurations required for high-risk travel, ensuring devices meet stricter security standards including encryption, authentication, and security software requirements before accessing corporate resources",
          "nistRequirement": "Issue systems or system components with the following configurations to individuals traveling to high-risk locations"
        }
      ]
    },
    {
      "id": "IN-CM-002",
      "settingName": "remoteWipeCapability",
      "displayName": "Remote Wipe and Factory Reset for Compromised Devices",
      "settingPath": "microsoft.graph.deviceManagement.remoteActions.wipe",
      "policyType": "Intune",
      "policySubType": "RemoteActions",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables remote factory reset or selective wipe capabilities for devices returning from high-risk areas or suspected of tampering/compromise, allowing complete data erasure and device sanitization as a security requirement",
      "implementationGuide": "1. Ensure devices are enrolled in Microsoft Intune\n2. To wipe a device: Navigate to Devices > All devices\n3. Select the device returning from high-risk travel\n4. In device overview pane, select 'Wipe' from remote actions\n5. Choose wipe options:\n   - For full reset: Uncheck 'Retain enrollment state and user account'\n   - For selective wipe: Use 'Retire' action to remove only corporate data\n   - Enable 'Wipe device, and continue to wipe even if device loses power' for high-security scenarios\n6. For iOS/iPadOS: Optionally remove eSIM data plan\n7. For macOS: Enter 6-digit Recovery PIN and configure Obliteration Behavior\n8. Select 'Wipe' and confirm action (PIN won't be visible after wipe completes)\n9. Monitor wipe status in device actions history\n10. Re-enroll and reconfigure device after successful wipe before returning to normal use",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/remote-actions/device-wipe",
      "controlMappings": [
        {
          "controlId": "03.04.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Remote wipe capabilities fulfill the requirement to apply security measures to devices returning from high-risk travel, enabling organizations to sanitize devices suspected of physical tampering or compromise by performing complete factory resets and data erasure",
          "nistRequirement": "Apply the following security requirements to the systems or components when the individuals return from travel"
        }
      ]
    },
    {
      "id": "IN-CM-003",
      "settingName": "deviceHealthAttestation",
      "displayName": "Device Health Attestation and Integrity Validation",
      "settingPath": "microsoft.graph.deviceManagement.deviceHealthAttestationState",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "bitLockerStatus": "enabled",
        "secureBootEnabled": true,
        "codeIntegrityEnabled": true,
        "bootDebuggingEnabled": false
      },
      "validationOperator": "==",
      "description": "Validates device integrity and detects tampering through hardware-backed attestation (TPM) to ensure devices returning from high-risk areas have not been compromised at the firmware or boot level",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Compliance policies\n2. Create or edit Windows 10/11 compliance policy\n3. Under Device Health section, configure:\n   - Require BitLocker: Require\n   - Require Secure Boot to be enabled: Require\n   - Require code integrity: Require\n   - Require Trusted Platform Module (TPM): Require\n4. Under Additional Settings:\n   - Boot debugging must be disabled: Require\n   - Allow Windows to enable DMA protections: Require\n5. For devices returning from travel, validate attestation status:\n   - Navigate to Devices > All devices > Select device\n   - Review Hardware tab for Device Health Attestation data\n   - Check for any integrity failures or anomalies\n6. For failed attestation: Perform remote wipe and factory reset\n7. Combine with Conditional Access policy requiring attestation pass\n8. Monitor device health attestation service logs in Azure Monitor",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows#device-health",
      "controlMappings": [
        {
          "controlId": "03.04.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Device Health Attestation provides hardware-backed validation that devices returning from high-risk areas have not been compromised through firmware tampering or boot-level attacks, enabling detection of physical tampering as required by the control's discussion section",
          "nistRequirement": "Apply the following security requirements to the systems or components when the individuals return from travel (examining device for signs of physical tampering)"
        }
      ]
    },
    {
      "id": "DF-CM-001",
      "settingName": "defenderThreatLevel",
      "displayName": "Microsoft Defender for Endpoint Threat Level Requirements",
      "settingPath": "microsoft.graph.deviceManagement.deviceCompliancePolicies.advancedThreatProtectionRequiredSecurityLevel",
      "policyType": "Defender",
      "policySubType": "ThreatProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "medium",
      "validationOperator": "<=",
      "description": "Enforces device risk level assessment through Microsoft Defender for Endpoint integration, automatically marking devices noncompliant and blocking access if malware or threats are detected, especially critical for devices returning from high-risk areas",
      "implementationGuide": "1. Enable Microsoft Defender for Endpoint integration with Intune:\n   - Navigate to Endpoint security > Microsoft Defender for Endpoint\n   - Connect Intune to Defender for Endpoint tenant\n2. Create or edit device compliance policy\n3. Under Microsoft Defender for Endpoint section:\n   - Set 'Require the device to be at or under the machine risk score' to 'Medium' or 'Low'\n   - This enforces automatic compliance evaluation based on MDE threat detection\n4. Configure Conditional Access policy:\n   - Navigate to Endpoint security > Conditional Access\n   - Create policy requiring 'Require device to be marked as compliant'\n   - This blocks access when MDE detects threats\n5. When device returns from high-risk travel:\n   - MDE automatically scans for threats and malware\n   - If threats detected, device marked noncompliant\n   - Conditional Access blocks corporate resource access\n   - Automated remediation initiated or manual review required\n6. Monitor device risk in Microsoft Defender Security Center\n7. Investigate and remediate threats before restoring compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/advanced-threat-protection",
      "controlMappings": [
        {
          "controlId": "03.04.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Microsoft Defender for Endpoint integration provides automated threat detection and risk assessment for devices returning from high-risk areas, enabling immediate identification of malware or compromise and automatic enforcement of access restrictions until threats are remediated",
          "nistRequirement": "Apply the following security requirements to the systems or components when the individuals return from travel (examining device for malware, purging and reimaging device storage)"
        }
      ]
    }
  ]
}
