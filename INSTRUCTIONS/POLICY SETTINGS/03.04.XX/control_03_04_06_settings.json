{
  "controlId": "03.04.06",
  "controlFamily": "CM",
  "controlTitle": "Least Functionality",
  "controlRequirement": "a. Configure the system to provide only mission-essential capabilities.\nb. Prohibit or restrict use of the following functions, ports, protocols, connections, and services: [Assignment: organization-defined functions, ports, protocols, connections, and services].\nc. Review the system [Assignment: organization-defined frequency] to identify unnecessary or nonsecure functions, ports, protocols, connections, and services.\nd. Disable or remove functions, ports, protocols, connections, and services that are unnecessary or nonsecure.",
  "researchDate": "2025-11-17",
  "totalSettings": 6,
  "settings": [
    {
      "id": "IN-CM-006",
      "settingName": "WindowsFirewallDomainInboundBlock",
      "displayName": "Windows Firewall - Block Inbound Connections (Domain Profile)",
      "settingPath": "Firewall.DomainProfile.DefaultInboundAction",
      "policyType": "Intune",
      "policySubType": "EndpointSecurityFirewall",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Block",
      "validationOperator": "==",
      "description": "Blocks all unsolicited inbound network connections on domain networks by default, implementing deny-by-default networking to reduce attack surface and prevent unauthorized services",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Firewall\n2. Create policy: Platform 'Windows 10, Windows 11, and Windows Server' > Profile 'Microsoft Defender Firewall'\n3. Configuration settings > Expand 'Firewall'\n4. Domain Profile settings:\n   - Enable Firewall: Yes\n   - Default Inbound Action: Block\n   - Default Outbound Action: Allow (to permit authorized traffic)\n   - Disable Stealth Mode: No (keep stealth mode enabled)\n   - Disable Inbound Notifications: Yes (suppress end-user notifications)\n5. Repeat configuration for Private Profile and Public Profile\n6. Name policy: 'Windows Firewall - Block Inbound (All Profiles)'\n7. Assign to: All Windows devices or appropriate device group\n8. Create separate policies for specific allow rules as needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/endpoint-security-firewall-policy",
      "controlMappings": [
        {
          "controlId": "03.04.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Blocking inbound connections by default implements network-level least functionality by denying all unsolicited network services. This prohibits unauthorized protocols and connections, allowing only explicitly permitted services.",
          "nistRequirement": "Prohibit or restrict use of functions, ports, protocols, connections, and services"
        }
      ]
    },
    {
      "id": "IN-CM-007",
      "settingName": "DisableBluetoothServices",
      "displayName": "Intune - Disable Bluetooth When Not Required",
      "settingPath": "DeviceConfiguration.Connectivity.Bluetooth",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "blocked",
      "validationOperator": "==",
      "description": "Disables Bluetooth functionality on Windows devices where not required for business operations, eliminating an unnecessary wireless protocol that can be exploited for unauthorized data transfer or device connection",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > New Policy\n2. Platform: Windows 10 and later\n3. Profile type: Templates > Device restrictions\n4. Configuration settings > Connectivity:\n   - Bluetooth: Block\n   - Bluetooth discoverability: Block\n   - Bluetooth pre-pairing: Block\n   - Bluetooth advertising: Block (if available)\n5. Alternative using Settings Catalog:\n   - Configuration > Create > Settings Catalog\n   - Settings > Connectivity > Bluetooth\n   - Allow Bluetooth: Disabled\n6. Name: 'Windows - Disable Bluetooth'\n7. Assign to device groups where Bluetooth is not mission-essential\n8. Create separate allowing policy for devices requiring Bluetooth (e.g., executives with wireless peripherals)\n9. Document business justification for any exceptions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-restrictions-windows-10",
      "controlMappings": [
        {
          "controlId": "03.04.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Disabling Bluetooth eliminates an unnecessary wireless communication protocol, directly implementing least functionality by removing a service that is not mission-essential for most organizational systems and prevents unauthorized device connections and data exfiltration.",
          "nistRequirement": "Disable or remove functions, ports, protocols, connections, and services that are unnecessary or nonsecure"
        }
      ]
    },
    {
      "id": "IN-CM-008",
      "settingName": "DisableSMBv1Protocol",
      "displayName": "Windows - Disable SMBv1 Protocol",
      "settingPath": "DeviceConfiguration.CustomOMAURI.SMBv1",
      "policyType": "Intune",
      "policySubType": "CustomConfiguration",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "0",
      "validationOperator": "==",
      "description": "Disables the insecure SMBv1 file sharing protocol which has known vulnerabilities (WannaCry, NotPetya), removing an outdated protocol that is not necessary for modern Windows networking",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create\n2. Platform: Windows 10 and later\n3. Profile type: Templates > Custom\n4. Name: 'Windows - Disable SMBv1 Protocol'\n5. Add OMA-URI Setting:\n   - Name: Disable SMBv1 Client\n   - OMA-URI: ./Vendor/MSFT/Policy/Config/LanmanWorkstation/EnableInsecureGuestLogons\n   - Data type: Integer\n   - Value: 0\n6. Alternative using PowerShell script:\n   - Create Proactive Remediation or Platform Script\n   - Detection: Get-WindowsOptionalFeature -Online -FeatureName SMB1Protocol | Select State\n   - Remediation: Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol -NoRestart\n7. Assign to: All Windows devices\n8. CIS Benchmark reference: CIS Control 4.4.1\n9. Test in pilot group before broad deployment\n10. Verify no legacy systems require SMBv1",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-server/storage/file-server/troubleshoot/detect-enable-and-disable-smbv1-v2-v3",
      "controlMappings": [
        {
          "controlId": "03.04.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "SMBv1 is a legacy, insecure protocol with known critical vulnerabilities. Disabling it removes an unnecessary and nonsecure service, directly implementing least functionality by eliminating protocols that present security risks without supporting mission-essential capabilities.",
          "nistRequirement": "Review the system to identify unnecessary or nonsecure protocols and disable or remove them"
        }
      ]
    },
    {
      "id": "IN-CM-009",
      "settingName": "RestrictMicrosoftStoreApps",
      "displayName": "Intune - Require Private Store Only",
      "settingPath": "DeviceConfiguration.App.Store.PrivateStoreOnly",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Restricts access to public Microsoft Store, allowing only organization-approved apps from private store, limiting software installation to mission-essential applications and preventing unauthorized functionality",
      "implementationGuide": "1. Configure Microsoft Store for Business (if not already set up):\n   - Navigate to businessstore.microsoft.com\n   - Sign in with admin account\n   - Set up private store for your organization\n2. Navigate to Microsoft Intune admin center > Devices > Configuration\n3. Create policy: Platform 'Windows 10 and later' > Profile 'Device restrictions'\n4. App Store settings:\n   - Require private store only: Yes\n   - App store auto-update: Block (control updates centrally)\n   - Trusted app installation: Allow (for LOB apps)\n   - Developer unlock: Block\n5. Using Settings Catalog (alternative/additional):\n   - Create > Settings Catalog\n   - Settings > App Runtime > 'Allow deployment operations in special profiles'\n   - Settings > App Runtime > 'Allow all trusted apps'\n6. Name: 'Windows - Microsoft Store Restrictions'\n7. Assign to: All corporate devices\n8. Curate approved apps in private store\n9. Communicate approved app list to users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-restrictions-windows-10",
      "controlMappings": [
        {
          "controlId": "03.04.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Restricting store access to organization-curated private store implements application-level least functionality by limiting available software to mission-essential applications only, preventing installation of unnecessary consumer applications and unauthorized functionality.",
          "nistRequirement": "Configure the system to provide only mission-essential capabilities"
        }
      ]
    },
    {
      "id": "IN-CM-010",
      "settingName": "DisableUnnecessaryWindowsServices",
      "displayName": "Windows - Disable Non-Essential Services",
      "settingPath": "DeviceConfiguration.Services.Disabled",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": ["XboxNetApiSvc", "XblAuthManager", "XblGameSave", "RemoteRegistry", "RemoteAccess"],
      "validationOperator": "contains",
      "description": "Disables Windows services not required for business operations including Xbox services, remote registry, and other consumer-focused features, reducing attack surface and eliminating unnecessary functionality",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Configuration\n2. Create policy: Platform 'Windows 10 and later' > Profile 'Settings Catalog'\n3. Name: 'Windows - Disable Non-Essential Services'\n4. Add settings for each service:\n   Settings > System Services > [Service Name]\n   - Xbox Live services (XboxNetApiSvc, XblAuthManager, XblGameSave): Disabled\n   - Remote Registry (RemoteRegistry): Disabled\n   - Remote Access (RemoteAccess): Disabled if not using VPN\n   - Fax service: Disabled\n   - Windows Media Player Network Sharing: Disabled\n5. CIS Benchmark references:\n   - 5.4 (L1): Xbox Live Networking Service disabled\n   - 5.24 (L1): Remote Registry disabled\n6. Assign to: All corporate devices\n7. Test in pilot group first\n8. Document any services that must remain enabled for business requirements\n9. Review quarterly for additional services to disable",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-security-configuration-framework/windows-security-baselines",
      "controlMappings": [
        {
          "controlId": "03.04.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Disabling unnecessary Windows services directly implements least functionality by removing services and features not required for organizational missions. Services like Xbox, remote registry, and legacy protocols represent unnecessary functionality that expands the attack surface.",
          "nistRequirement": "Configure system to provide only mission-essential capabilities and disable unnecessary functions and services"
        }
      ]
    },
    {
      "id": "IN-CM-011",
      "settingName": "WindowsFirewallRulesReview",
      "displayName": "Firewall Rule Review and Management",
      "settingPath": "Intune.EndpointSecurity.Firewall.RuleReview",
      "policyType": "Intune",
      "policySubType": "EndpointSecurityFirewall",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "reviewFrequency": "Quarterly",
        "documentationRequired": true
      },
      "validationOperator": "==",
      "description": "Establishes process for quarterly review of all Windows Firewall rules deployed via Intune to identify and remove unnecessary or outdated port/protocol exceptions, maintaining least functionality principle over time",
      "implementationGuide": "1. Document current state:\n   - Navigate to Intune admin center > Endpoint security > Firewall\n   - Export all firewall rule policies\n   - Document business justification for each allow rule\n2. Create firewall rule naming standard:\n   - Format: [Purpose]-[Protocol]-[Port]-[Direction]\n   - Example: 'FileShare-TCP-445-Inbound'\n3. Implement rule categories:\n   - Critical (cannot be removed)\n   - Standard (required for normal operations)\n   - Temporary (time-bound exceptions)\n4. Establish quarterly review process:\n   - Review team: Security + Network + Application owners\n   - Review all Firewall policies in Endpoint Security\n   - Validate continued need for each rule\n   - Remove or disable rules no longer required\n   - Update rule descriptions with review date\n5. Use Intune Reports:\n   - Monitor > Device configuration > Select firewall policies\n   - Review compliance status\n6. Document review in change management system\n7. Maintain firewall rule inventory spreadsheet",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/endpoint-security-firewall-policy",
      "controlMappings": [
        {
          "controlId": "03.04.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Regular review of firewall rules enforces the requirement to periodically identify unnecessary or nonsecure connections and services. This ensures the deny-by-default posture is maintained and exceptions remain justified and current, preventing configuration drift from least functionality principles.",
          "nistRequirement": "Review the system [organization-defined frequency] to identify unnecessary or nonsecure functions, ports, protocols, connections, and services"
        }
      ]
    }
  ]
}
