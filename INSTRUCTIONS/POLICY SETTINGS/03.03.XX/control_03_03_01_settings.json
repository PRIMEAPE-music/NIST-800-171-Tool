{
  "controlId": "03.03.01",
  "controlTitle": "Event Logging",
  "controlFamily": "AU",
  "settings": [
    {
      "id": "PV-AU-001",
      "settingName": "UnifiedAuditLogIngestionEnabled",
      "displayName": "Microsoft 365 Unified Audit Log",
      "settingPath": "UnifiedAuditLogIngestionEnabled",
      "policyType": "Purview",
      "policySubType": "AuditConfiguration",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables the unified audit log to record user and admin activities across Microsoft 365 services including Exchange, SharePoint, OneDrive, Teams, Azure AD, and more. This is the foundational setting that enables event logging for all M365 services.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell\n2. Run command: Set-AdminAuditLogConfig -UnifiedAuditLogIngestionEnabled $true\n3. Verify with: Get-AdminAuditLogConfig | FL UnifiedAuditLogIngestionEnabled\n4. Note: Changes take up to 60 minutes to take effect\n5. Confirm logging is active in Microsoft Purview Compliance portal > Audit > New Search",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-enable-disable",
      "controlMappings": [
        {
          "controlId": "03.03.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "This setting enables the core audit logging infrastructure for Microsoft 365, allowing the system to record event types across all services. Without this enabled, no audit records are generated for user and admin activities.",
          "nistRequirement": "Identify the types of events that the system is capable of logging in support of the audit logging function"
        }
      ]
    },
    {
      "id": "AZ-AU-001",
      "settingName": "AuditLogs",
      "displayName": "Azure AD Audit Logs Diagnostic Settings",
      "settingPath": "properties.logs[?(@.category=='AuditLogs')].enabled",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Azure AD audit logs to capture directory changes, user/group modifications, role assignments, application changes, and other Azure AD activities. Critical for tracking identity and access management events.",
      "implementationGuide": "1. Navigate to Azure Portal > Azure Active Directory > Monitoring > Diagnostic settings\n2. Click '+ Add diagnostic setting'\n3. Enter name (e.g., 'AzureAD-Audit-Logs')\n4. Check 'AuditLogs' category\n5. Select destination: Send to Log Analytics workspace (recommended for retention) or Archive to storage account\n6. Click Save\n7. Verify logs appear within 15 minutes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/howto-integrate-activity-logs-with-log-analytics",
      "controlMappings": [
        {
          "controlId": "03.03.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Azure AD audit logs capture critical identity and access events including account creation, permission changes, role assignments, and policy modifications. These events are essential for NIST compliance and must be logged to track administrative activities.",
          "nistRequirement": "Identify the types of events that the system is capable of logging, specifically for authentication and authorization events"
        }
      ]
    },
    {
      "id": "AZ-AU-002",
      "settingName": "SignInLogs",
      "displayName": "Azure AD Sign-In Logs Diagnostic Settings",
      "settingPath": "properties.logs[?(@.category=='SignInLogs')].enabled",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Azure AD sign-in logs to capture all authentication attempts including successful and failed logins, authentication methods used, conditional access policy results, and location/device information. Essential for detecting unauthorized access attempts.",
      "implementationGuide": "1. Navigate to Azure Portal > Azure Active Directory > Monitoring > Diagnostic settings\n2. Click '+ Add diagnostic setting'\n3. Enter name (e.g., 'AzureAD-SignIn-Logs')\n4. Check 'SignInLogs' category\n5. Select destination: Send to Log Analytics workspace (recommended) or Archive to storage account\n6. Configure retention period (minimum 180 days recommended)\n7. Click Save\n8. Verify logs appear within 15 minutes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-sign-ins",
      "controlMappings": [
        {
          "controlId": "03.03.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Sign-in logs are critical for auditing user authentication events including successful logins, failed login attempts, authentication methods, and conditional access policy enforcement. These logs support incident response and forensic investigations.",
          "nistRequirement": "Log authentication events and coordinate event logging function with other organizational entities"
        }
      ]
    },
    {
      "id": "PV-AU-002",
      "settingName": "AuditDisabled",
      "displayName": "Exchange Online Mailbox Auditing (Organization-wide)",
      "settingPath": "AuditDisabled",
      "policyType": "Purview",
      "policySubType": "MailboxAudit",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Ensures mailbox auditing is enabled organization-wide to log mailbox activities including message access, modifications, deletions, and permissions changes. CIS Benchmark Level 1 requirement.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell\n2. Check current status: Get-OrganizationConfig | FL AuditDisabled\n3. Enable auditing: Set-OrganizationConfig -AuditDisabled $false\n4. Verify mailbox auditing for users: Get-Mailbox -ResultSize Unlimited | Select UserPrincipalName, AuditEnabled\n5. Enable for specific mailbox if needed: Set-Mailbox -Identity user@domain.com -AuditEnabled $true\n6. View audit events: Search-UnifiedAuditLog -StartDate (Get-Date).AddDays(-7) -EndDate (Get-Date) -RecordType ExchangeItem",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/mailbox-auditing",
      "controlMappings": [
        {
          "controlId": "03.03.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Mailbox auditing captures email-related activities including message access, modifications, and permissions changes. This is essential for tracking CUI access and modifications in email systems and is a CIS Benchmark Level 1 requirement (6.1.1).",
          "nistRequirement": "Log events related to email systems and coordinate with audit logging requirements for CUI protection"
        }
      ]
    },
    {
      "id": "IN-AU-001",
      "settingName": "DeviceComplianceMonitoring",
      "displayName": "Intune Device Compliance Audit Logging",
      "settingPath": "microsoft.intune/deviceComplianceMonitoring",
      "policyType": "Intune",
      "policySubType": "CompliancePolicy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables logging of device compliance state changes, policy assignments, and device enrollment activities in Intune. Logs are automatically sent to the unified audit log.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://intune.microsoft.com)\n2. Navigate to Devices > Monitor > Audit logs\n3. Verify audit logging is enabled (enabled by default)\n4. Configure Azure AD diagnostic settings to export Intune logs:\n   - Azure Portal > Monitor > Diagnostic settings\n   - Select subscription > Add diagnostic setting\n   - Check 'Intune' service\n5. Review logs: Intune admin center > Tenant administration > Audit logs\n6. Search unified audit log for Intune events: Search-UnifiedAuditLog -RecordType AzureActiveDirectory -Operations 'Update device'",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/fundamentals/monitor-audit-logs",
      "controlMappings": [
        {
          "controlId": "03.03.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Intune audit logs capture device compliance status changes, policy enforcement events, and device enrollment activities. These events are critical for tracking mobile device security posture and enforcement of access controls for devices accessing CUI.",
          "nistRequirement": "Log device compliance and configuration events as part of comprehensive audit logging for systems accessing CUI"
        }
      ]
    },
    {
      "id": "DF-AU-001",
      "settingName": "DefenderAuditLogging",
      "displayName": "Microsoft Defender for Office 365 Audit Logging",
      "settingPath": "microsoft.defender/auditLogging",
      "policyType": "Defender",
      "policySubType": "ThreatProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables audit logging for Microsoft Defender for Office 365 security events including threat detections, quarantine actions, policy hits, and security investigations. Automatically logs to unified audit log.",
      "implementationGuide": "1. Defender for Office 365 automatically logs to unified audit log when enabled\n2. Verify unified audit log is enabled (prerequisite)\n3. Access Defender logs: Microsoft Defender portal > Audit\n4. Search for Defender events: Search-UnifiedAuditLog -RecordType ThreatIntelligence\n5. Common Defender operations:\n   - 'AlertTriggered' - Security alert generated\n   - 'ThreatIntelligenceDetection' - Threat detected\n   - 'QuarantineAction' - Message quarantined\n6. Configure alert policies for Defender events in Microsoft Purview\n7. Export to SIEM: Use Office 365 Management Activity API",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-office-365/audit-log-search-defender-portal",
      "controlMappings": [
        {
          "controlId": "03.03.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Defender for Office 365 audit logs capture security-related events including malware detections, phishing attempts, malicious links, and suspicious activities. These logs are essential for identifying security incidents affecting CUI and supporting incident response investigations.",
          "nistRequirement": "Log security events and threats to support audit logging requirements for systems protecting CUI"
        }
      ]
    }
  ]
}
