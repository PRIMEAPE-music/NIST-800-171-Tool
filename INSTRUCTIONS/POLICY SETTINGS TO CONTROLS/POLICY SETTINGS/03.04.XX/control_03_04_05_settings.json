{
  "controlId": "03.04.05",
  "controlFamily": "CM",
  "controlTitle": "Access Restrictions for Change",
  "controlRequirement": "Define, document, approve, and enforce physical and logical access restrictions associated with changes to the system.",
  "researchDate": "2025-11-17",
  "totalSettings": 5,
  "settings": [
    {
      "id": "AZ-CM-001",
      "settingName": "EnablePrivilegedIdentityManagement",
      "displayName": "Privileged Identity Management - Require Approval for Role Activation",
      "settingPath": "EntraID.PIM.RoleSettings.RequireApproval",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires approval workflow before privileged roles (Global Admin, Intune Admin, etc.) can be activated, ensuring changes to privileged access are authorized",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity Governance > Privileged Identity Management\n2. Select Azure AD Roles > Roles > Select privileged role (e.g., Global Administrator)\n3. Select Role settings > Edit\n4. Under Activation, enable 'Require approval to activate'\n5. Add at least 2 approvers (do not rely on default Global Admins)\n6. Enable 'Require justification on activation'\n7. Set maximum activation duration to 8 hours or less\n8. Save settings and repeat for all highly privileged roles",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings",
      "controlMappings": [
        {
          "controlId": "03.04.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "PIM approval workflow directly enforces logical access restrictions for system changes by requiring authorization before privileged role activation. This ensures only qualified and authorized individuals can access systems for making changes.",
          "nistRequirement": "Approve and enforce physical and logical access restrictions associated with changes to the system"
        }
      ]
    },
    {
      "id": "AZ-CM-002",
      "settingName": "ConditionalAccessForPrivilegedRoles",
      "displayName": "Conditional Access - MFA and Compliance for Privileged Accounts",
      "settingPath": "EntraID.ConditionalAccess.Policy",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "state": "enabled",
        "grantControls": {
          "operator": "AND",
          "builtInControls": ["mfa", "compliantDevice"]
        }
      },
      "validationOperator": "contains",
      "description": "Enforces MFA and device compliance requirements for users with privileged directory roles, restricting access for system changes to authorized, authenticated users on compliant devices",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Protection > Conditional Access > Policies\n2. Create new policy: 'Require MFA and Compliant Device for Privileged Roles'\n3. Assignments > Users: Select Directory roles > Include all privileged roles (Global Admin, Intune Admin, Security Admin, etc.)\n4. Assignments > Cloud apps: Select 'All cloud apps'\n5. Access controls > Grant: Select 'Grant access' and check both 'Require multifactor authentication' AND 'Require device to be marked as compliant'\n6. Access controls > Grant: Set multiple controls to 'Require all the selected controls'\n7. Session > Sign-in frequency: Set to 'Every time' for maximum security\n8. Enable policy: Set to 'On'\n9. Exclude at least one emergency access account",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/plan-conditional-access",
      "controlMappings": [
        {
          "controlId": "03.04.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Conditional Access policies enforce logical access restrictions by requiring MFA and device compliance before privileged users can make system changes. This validates user identity and device security posture, preventing unauthorized access.",
          "nistRequirement": "Enforce physical and logical access restrictions associated with changes to the system"
        }
      ]
    },
    {
      "id": "AZ-CM-003",
      "settingName": "AuthenticationContextForPIM",
      "displayName": "PIM - Authentication Context with Conditional Access",
      "settingPath": "EntraID.PIM.RoleSettings.AuthenticationContext",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "c1",
      "validationOperator": "==",
      "description": "Links PIM role activation to specific Conditional Access authentication contexts requiring reauthentication and stricter controls during privileged role activation for system changes",
      "implementationGuide": "1. Create Authentication Context: Entra admin center > Protection > Conditional Access > Authentication context > New authentication context\n2. Name: 'Privileged Role Activation' with ID 'c1'\n3. Create CA Policy: Conditional Access > New policy\n4. Name: 'Require Reauthentication for Privileged Activation'\n5. Assignments > Users: All users\n6. Assignments > Cloud apps or actions: Authentication context > Select 'Privileged Role Activation'\n7. Grant controls: Require MFA AND 'Sign-in frequency: Every time'\n8. Enable policy\n9. Configure in PIM: PIM > Azure AD Roles > Select role > Role settings > Edit\n10. Enable 'On activation, require Microsoft Entra Conditional Access authentication context'\n11. Select 'Privileged Role Activation' context\n12. Update role settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings",
      "controlMappings": [
        {
          "controlId": "03.04.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Authentication context enforces continuous verification during role activation, preventing token theft attacks and ensuring users must reauthenticate before gaining privileged access to make system changes. This provides strong access restrictions during the change window.",
          "nistRequirement": "Enforce logical access restrictions associated with changes to the system"
        }
      ]
    },
    {
      "id": "AZ-CM-004",
      "settingName": "DisablePermanentPrivilegedRoles",
      "displayName": "PIM - Convert Permanent to Eligible Role Assignments",
      "settingPath": "EntraID.PIM.Assignments.EligibleOnly",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Eliminates standing privileged access by requiring Just-In-Time (JIT) activation for all privileged roles, ensuring access for system changes is time-bound and monitored",
      "implementationGuide": "1. Navigate to Entra admin center > Identity Governance > Privileged Identity Management\n2. Select Azure AD Roles > Assignments\n3. Review all 'Active assignments' (permanent roles)\n4. For each permanent privileged role assignment:\n   a. Select the assignment\n   b. Remove the permanent assignment\n   c. Add as 'Eligible assignment' instead\n   d. Set appropriate eligibility duration (typically 1 year)\n5. Ensure emergency access accounts remain permanent but are cloud-only and monitored\n6. Use PIM Discovery and Insights page to identify all permanent assignments\n7. Document justification for any remaining permanent assignments\n8. Configure PIM alerts for new permanent assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-deployment-plan",
      "controlMappings": [
        {
          "controlId": "03.04.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Eliminating permanent privileged access enforces temporal access restrictions for system changes. JIT access ensures users only have privileges when needed and access is time-bound, reducing the window of opportunity for unauthorized changes.",
          "nistRequirement": "Define and enforce access restrictions associated with changes to the system"
        }
      ]
    },
    {
      "id": "IN-CM-005",
      "settingName": "RestrictIntuneAdminRoles",
      "displayName": "Intune - Limit Device Configuration and Policy Admin Roles",
      "settingPath": "Intune.RBAC.RoleAssignments",
      "policyType": "Intune",
      "policySubType": "RoleBasedAccessControl",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "minimumRoles": true,
        "scopeTags": "required"
      },
      "validationOperator": "==",
      "description": "Restricts Intune administrative capabilities using built-in or custom RBAC roles with scope tags, limiting who can create or modify device configurations and compliance policies that affect system settings",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Tenant administration > Roles > All roles\n2. Review current role assignments: Select 'Assignments' for each role\n3. Identify administrators with full access roles (Intune Administrator, Policy and Profile manager)\n4. For device configuration changes, assign only these roles as needed:\n   - Policy and Profile Manager: Can manage compliance and configuration policies\n   - Endpoint Security Manager: Can manage security settings only\n5. Implement scope tags: Tenant administration > Roles > Scope tags\n6. Create scope tags for different device groups (e.g., 'Production', 'Test', 'Executives')\n7. When assigning roles, specify scope: Assignments > Scope (tags) > Select appropriate tags\n8. Remove broad 'All devices' assignments\n9. Document all role assignments and their justifications\n10. Review role assignments quarterly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/role-based-access-control",
      "controlMappings": [
        {
          "controlId": "03.04.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Intune RBAC with scope tags enforces granular logical access restrictions for configuration changes across the device estate. This ensures only authorized administrators can modify policies that change system configurations, and limits their scope to specific device groups.",
          "nistRequirement": "Define, document, approve, and enforce logical access restrictions associated with changes to the system"
        }
      ]
    }
  ]
}
