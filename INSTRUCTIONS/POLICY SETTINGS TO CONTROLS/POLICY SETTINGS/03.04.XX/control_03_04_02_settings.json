{
  "controlId": "03.04.02",
  "controlFamily": "CM",
  "controlTitle": "Configuration Settings",
  "nistRequirement": "a. Establish, document, and implement the following configuration settings for the system that reflect the most restrictive mode consistent with operational requirements: [Assignment: organization-defined configuration settings].\nb. Identify, document, and approve any deviations from established configuration settings.",
  "settings": [
    {
      "id": "IN-CM-006",
      "settingName": "SecuritySettings.RestrictiveMode",
      "displayName": "Most Restrictive Configuration Settings Enforcement",
      "settingPath": "policies.deviceConfiguration.restrictiveSettings",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces most restrictive security configuration settings consistent with operational requirements through Intune device configuration profiles, including password policies, encryption, firewall rules, and application controls.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration > Create profile\n2. Select Platform: Windows 10 and later, Profile type: Settings catalog\n3. Name profile (e.g., 'Windows Restrictive Security Settings')\n4. Add key restrictive settings:\n   - Windows Security > Firewall: Enable Windows Defender Firewall (all profiles)\n   - Security > Encryption: Require device encryption\n   - Security > Password: Minimum password length (14 chars)\n   - Security > User Rights: Deny access to this computer from network (Guest)\n   - Windows Components > Remote Desktop: Do not allow passwords to be saved\n5. Document any deviations from most restrictive mode in description\n6. Assign to device groups and deploy\n7. Monitor compliance via Devices > Monitor > Device assignment status",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-profile-create",
      "controlMappings": [
        {
          "controlId": "03.04.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Device configuration profiles establish and enforce the most restrictive security settings across managed endpoints, directly satisfying the requirement to implement restrictive configuration settings",
          "nistRequirement": "Establish, document, and implement configuration settings that reflect the most restrictive mode consistent with operational requirements"
        }
      ]
    },
    {
      "id": "IN-CM-007",
      "settingName": "ConfigurationProfile.Documentation",
      "displayName": "Configuration Settings Documentation",
      "settingPath": "policies.deviceConfiguration.documentation",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Documented",
      "validationOperator": "==",
      "description": "Requires all device configuration profiles to include detailed documentation of settings, rationale, and any deviations from most restrictive mode. Documentation maintained in profile description and change control records.",
      "implementationGuide": "1. Establish configuration documentation standard template\n2. For each Intune configuration profile, include in Description field:\n   - Purpose and scope of configuration\n   - List of critical settings configured\n   - Justification for any settings less restrictive than maximum\n   - Approval authority and date\n   - Version number and last review date\n3. Maintain separate Configuration Settings Register (Excel/SharePoint):\n   - Profile name, ID, and description\n   - List of all settings with values\n   - Deviations from most restrictive mode with business justification\n   - Approval records\n4. Review and update documentation quarterly or when profiles change",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-profiles",
      "controlMappings": [
        {
          "controlId": "03.04.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Comprehensive documentation of configuration settings and deviations provides the audit trail and justification required by NIST for configuration management",
          "nistRequirement": "Establish, document configuration settings and identify, document, and approve any deviations"
        }
      ]
    },
    {
      "id": "IN-CM-008",
      "settingName": "PasswordPolicy.Complexity",
      "displayName": "Windows Hello for Business Password Complexity",
      "settingPath": "policies.deviceConfiguration.passwordComplexity",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "minimumLength": 14,
        "requireUppercase": true,
        "requireLowercase": true,
        "requireNumbers": true,
        "requireSpecialCharacters": true,
        "passwordHistory": 24,
        "maximumAge": 60
      },
      "validationOperator": "==",
      "description": "Enforces restrictive password complexity requirements for Windows Hello for Business PIN and convenience PIN, implementing NIST password guidelines for authentication security.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration > Create profile\n2. Select Platform: Windows 10 and later, Profile type: Settings catalog\n3. Name profile 'Windows Hello Password Policy'\n4. Add settings from 'Windows Hello for Business' category:\n   - Use Windows Hello for Business: Yes\n   - Minimum PIN length: 14\n   - PIN complexity: Require digits, uppercase, lowercase, special characters\n   - PIN expiration (days): 60\n   - Remember PIN history: 24\n   - Allow simple passwords: No\n   - Require TPM: Yes (for hardware-backed credentials)\n5. Add from 'Local Security Options' > Security Options:\n   - Password must meet complexity requirements: Enabled\n6. Assign to user or device groups\n7. Deploy and monitor compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/hello-manage-in-organization",
      "controlMappings": [
        {
          "controlId": "03.04.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Password complexity configuration represents critical security parameters that must be set to most restrictive values to protect authentication mechanisms",
          "nistRequirement": "Implement configuration settings that reflect the most restrictive mode consistent with operational requirements"
        }
      ]
    },
    {
      "id": "IN-CM-009",
      "settingName": "BitLocker.EncryptionSettings",
      "displayName": "BitLocker Drive Encryption Configuration",
      "settingPath": "policies.deviceConfiguration.bitLocker",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "systemDriveEncryption": "XTS-AES 256-bit",
        "fixedDriveEncryption": "XTS-AES 256-bit",
        "removableDriveEncryption": "AES-CBC 256-bit",
        "enablePrebootAuthentication": true,
        "requireTPM": true
      },
      "validationOperator": "==",
      "description": "Configures BitLocker with most secure encryption algorithms and settings including XTS-AES 256-bit encryption, TPM requirement, and preboot authentication for comprehensive data protection.",
      "implementationGuide": "1. Navigate to Intune admin center > Endpoint security > Disk encryption\n2. Click 'Create policy' > Platform: Windows 10 and later > Profile: BitLocker\n3. Name policy 'BitLocker Restrictive Encryption'\n4. Configure BitLocker settings:\n   - Operating System Drives:\n     * Require BitLocker: Yes\n     * Encryption method: XTS-AES 256-bit\n     * Require TPM: Yes\n     * Allow BitLocker without compatible TPM: No\n     * Require startup authentication: TPM with startup PIN\n   - Fixed Data Drives:\n     * Require encryption: Yes\n     * Encryption method: XTS-AES 256-bit\n   - Removable Data Drives:\n     * Require encryption: Yes\n     * Encryption method: AES-CBC 256-bit\n5. Assign to device groups\n6. Monitor encryption status via Reports > Device compliance > Encryption report",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/encrypt-devices",
      "controlMappings": [
        {
          "controlId": "03.04.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "BitLocker encryption settings are critical security parameters that must be configured to most secure values to protect data at rest on endpoints",
          "nistRequirement": "Establish and implement configuration settings that reflect the most restrictive mode"
        }
      ]
    },
    {
      "id": "IN-CM-010",
      "settingName": "FirewallRules.RestrictivePolicy",
      "displayName": "Windows Defender Firewall Restrictive Rules",
      "settingPath": "policies.deviceConfiguration.firewallRules",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "domainProfile": "enabled",
        "privateProfile": "enabled",
        "publicProfile": "enabled",
        "defaultInboundAction": "block",
        "defaultOutboundAction": "allow",
        "logDroppedPackets": true
      },
      "validationOperator": "==",
      "description": "Enforces Windows Defender Firewall in most restrictive mode with block-by-default inbound rules, enabled on all network profiles, and comprehensive logging of dropped packets.",
      "implementationGuide": "1. Navigate to Intune admin center > Endpoint security > Firewall\n2. Click 'Create policy' > Platform: Windows 10 and later > Profile: Microsoft Defender Firewall Rules\n3. Name policy 'Windows Firewall Restrictive Configuration'\n4. Configure firewall settings for each profile (Domain, Private, Public):\n   - Firewall: Enable\n   - Default action for inbound connections: Block\n   - Default action for outbound connections: Allow\n   - Log dropped packets: Yes\n   - Log successful connections: Yes (optional, may impact performance)\n   - Stealth mode: Enabled\n5. Add specific firewall rules only for required services:\n   - Create allow rules for essential services (RDP, file sharing if needed)\n   - Document business justification for each allow rule\n6. Assign to device groups\n7. Test with pilot group before broad deployment\n8. Monitor via Endpoint security > Firewall > Monitor",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/endpoint-security-firewall-policy",
      "controlMappings": [
        {
          "controlId": "03.04.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Firewall configuration in most restrictive (block-by-default) mode is a critical security parameter that limits attack surface and controls network communications",
          "nistRequirement": "Implement configuration settings that reflect the most restrictive mode consistent with operational requirements"
        }
      ]
    },
    {
      "id": "IN-CM-011",
      "settingName": "ConfigurationDeviation.ApprovalProcess",
      "displayName": "Configuration Deviation Approval Workflow",
      "settingPath": "policies.changeManagement.deviationApproval",
      "policyType": "Intune",
      "policySubType": "ChangeManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces formal approval process for any configuration settings that deviate from most restrictive mode. Requires documented business justification, risk assessment, and approval from security team before implementation.",
      "implementationGuide": "1. Establish Configuration Deviation Approval Process:\n   - Create deviation request form template (include: setting name, current value, proposed value, business justification, risk assessment)\n   - Define approval authority (e.g., Security team, CISO)\n   - Set approval SLA (e.g., 5 business days)\n2. Integrate with Intune deployment process:\n   - For any configuration profile with less restrictive settings, require deviation approval before deployment\n   - Document approved deviations in profile description field\n   - Maintain Configuration Deviation Register (SharePoint/Database):\n     * Profile ID and name\n     * Setting(s) deviated\n     * Justification and risk assessment\n     * Approver name and date\n     * Review date (annual minimum)\n3. Include deviation review in quarterly configuration baseline reviews\n4. Revoke deviations when no longer needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/deployment-plan-compliance-policies",
      "controlMappings": [
        {
          "controlId": "03.04.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Formal deviation approval process ensures all exceptions to most restrictive configuration mode are identified, documented, approved, and tracked per NIST requirements",
          "nistRequirement": "Identify, document, and approve any deviations from established configuration settings"
        }
      ]
    }
  ],
  "metadata": {
    "researchDate": "2025-11-17",
    "totalSettings": 6,
    "confidenceLevel": "High",
    "primarySources": [
      "Microsoft Intune Device Configuration Documentation",
      "Microsoft Security Baselines",
      "CIS Microsoft Intune Benchmark Level 1",
      "NIST SP 800-70 - Security Configuration Checklists"
    ],
    "notes": "These settings enforce the most restrictive security configurations across key areas: authentication, encryption, network security, and change management. The combination ensures systems operate in a secure-by-default posture with formal controls for any deviations."
  }
}
