{
  "controlId": "03.04.08",
  "controlFamily": "CM",
  "controlTitle": "Authorized Software â€“ Allow by Exception",
  "controlRequirement": "a. Identify software programs authorized to execute on the system.\nb. Implement a deny-all, allow-by-exception policy for the execution of authorized software programs on the system.\nc. Review and update the list of authorized software programs [Assignment: organization-defined frequency].",
  "researchDate": "2025-11-17",
  "totalSettings": 6,
  "settings": [
    {
      "id": "IN-CM-012",
      "settingName": "WindowsDefenderApplicationControl",
      "displayName": "Windows Defender Application Control (WDAC) - Allow by Exception Policy",
      "settingPath": "Intune.AppControlForBusiness.WDACPolicy",
      "policyType": "Intune",
      "policySubType": "AppControlForBusiness",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Base policy with allow-by-exception mode",
      "validationOperator": "==",
      "description": "Implements Windows Defender Application Control with deny-all, permit-by-exception enforcement for application execution, controlling which applications and drivers can run based on code signing certificates and reputation",
      "implementationGuide": "1. Create WDAC Policy using WDAC Wizard:\n   - Download: https://webapp-wdac-wizard.azurewebsites.net/\n   - Policy Creator > Multiple Policy Format > Base Policy\n   - Select template: 'Allow Microsoft Mode' or 'Signed and Reputable Mode'\n   - Enable recommended options:\n     * Enabled:Audit Mode (for initial deployment)\n     * Enabled:Advanced Boot Options Menu\n     * Enabled:Update Policy Without Rebooting\n     * Disabled:Script Enforcement (initially, enable after testing)\n2. Build policy and export .xml and .cip files\n3. Convert to Base64 for Intune:\n   - PowerShell: [Convert]::ToBase64String([IO.File]::ReadAllBytes('policy.xml'))\n4. Deploy via Intune:\n   - Navigate to Endpoint security > App control for Business (Preview)\n   - Create policy > Enter Base64 XML data\n   - Name: 'WDAC - Base Allow Microsoft/Reputable'\n5. Enable Managed Installer:\n   - Policy > Managed Installer > Add > Enable for Intune\n   - This allows Intune-deployed apps automatically\n6. Start in Audit Mode for 30-60 days\n7. Review logs: Event Viewer > Applications and Services > Microsoft > Windows > CodeIntegrity > Operational\n8. Add supplemental policies for approved LOB apps\n9. Switch to Enforced mode after validation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/wdac-and-applocker-overview",
      "controlMappings": [
        {
          "controlId": "03.04.08",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "WDAC implements kernel-level deny-all, allow-by-exception application control, preventing execution of any software not explicitly authorized through code signing certificates or reputation. This is the strongest implementation of NIST's authorized software requirement.",
          "nistRequirement": "Implement a deny-all, allow-by-exception policy for the execution of authorized software programs on the system"
        }
      ]
    },
    {
      "id": "IN-CM-013",
      "settingName": "AppLockerExecutableRules",
      "displayName": "AppLocker - Executable and DLL Rules",
      "settingPath": "Intune.AppLocker.Rules",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "executable": "configured",
        "dll": "configured",
        "defaultDeny": true
      },
      "validationOperator": "contains",
      "description": "Implements user-mode application control using AppLocker to restrict which executables, DLLs, and scripts can run, complementing WDAC with user-level granular controls for authorized software enforcement",
      "implementationGuide": "1. Navigate to Intune admin center > Endpoint security > App control for Business\n2. Create Supplemental Policy for AppLocker rules:\n   - Policy Type: Supplemental\n   - Name: 'AppLocker - Standard Rules'\n3. Configure default rules (minimum):\n   Executable Rules:\n   - Allow: Windows System files\n     Path: %windir%\\* (signed by Microsoft)\n   - Allow: Program Files\n     Path: %ProgramFiles%\\* (signed by Microsoft)\n   - Allow: Intune-managed apps\n     Publisher rule for approved vendors\n   DLL Rules:\n   - Allow: Windows System DLLs\n     Path: %windir%\\* (signed by Microsoft)\n   - Allow: Program Files DLLs\n     Path: %ProgramFiles%\\* (signed by Microsoft)\n4. Script Rules (PowerShell, VBS):\n   - Allow: Signed scripts from approved publishers\n   - Block: All unsigned scripts (or use AllSigned execution policy)\n5. Set enforcement mode:\n   - Start with 'Audit only'\n   - Monitor Event Viewer: Event Viewer > Applications and Services > Microsoft > Windows > AppLocker\n   - Add exceptions for legitimate business apps\n   - Change to 'Enforce rules' after 30-60 days\n6. Assign to device groups\n7. Document all allow rules and business justification",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/applocker/applocker-overview",
      "controlMappings": [
        {
          "controlId": "03.04.08",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "AppLocker provides user-mode application whitelisting, implementing deny-by-default for executables, DLLs, and scripts. Combined with WDAC, it provides comprehensive allow-by-exception software control across user and system levels, meeting Essential Eight ML1 requirements.",
          "nistRequirement": "Implement a deny-all, allow-by-exception policy for the execution of authorized software programs"
        }
      ]
    },
    {
      "id": "IN-CM-014",
      "settingName": "IntuneManagedInstaller",
      "displayName": "Intune Managed Installer for Application Control",
      "settingPath": "Intune.ManagedInstaller.Enabled",
      "policyType": "Intune",
      "policySubType": "AppControlForBusiness",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Designates Intune as a trusted managed installer, automatically authorizing applications deployed through Intune for execution under WDAC/AppLocker policies, simplifying authorized software management while maintaining deny-by-default",
      "implementationGuide": "1. Enable via Endpoint Protection Profile:\n   - Navigate to Devices > Configuration > Create\n   - Platform: Windows 10 and later\n   - Profile: Endpoint Protection\n   - Microsoft Defender Application Control:\n     * Enable: 'Code integrity policies' > 'Enforce'\n     * Enable: 'Managed Installer'\n2. Alternative - Enable via App Control Policy:\n   - Endpoint security > App control for Business\n   - Managed Installer > Add\n   - Read instructions and confirm\n   - This enables managed installer for all enrolled devices\n3. Verify configuration:\n   - Registry: HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AppModel\\StateRepository\n   - Service: Check AppModel service is running\n4. Deploy applications through Intune:\n   - Apps > Windows apps > Add\n   - Any app deployed via Intune is automatically trusted\n5. Test:\n   - Deploy test app via Intune\n   - Verify it runs without AppLocker/WDAC blocks\n   - Verify manually downloaded apps are blocked\n6. Create AppLocker policy to enforce managed installer:\n   - Executable rule: Allow apps from Intune managed installer\n7. Monitor: Event Viewer > AppLocker logs for managed installer events",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/configure-authorized-apps-deployed-with-a-managed-installer",
      "controlMappings": [
        {
          "controlId": "03.04.08",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Managed Installer automates the identification and authorization of software deployed through Intune, maintaining deny-by-default while streamlining the process of adding legitimate business applications to the allowed list. This ensures all software goes through organizational approval channels.",
          "nistRequirement": "Identify software programs authorized to execute on the system"
        }
      ]
    },
    {
      "id": "IN-CM-015",
      "settingName": "BlockConsumerMicrosoftStoreApps",
      "displayName": "Block Consumer Microsoft Store Apps",
      "settingPath": "DeviceConfiguration.Experience.ConsumerExperiences",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Prevents installation of consumer applications from public Microsoft Store, enforcing that only organization-vetted applications can be installed, supporting authorized software policy",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration\n2. Create policy: Platform 'Windows 10 and later' > Profile 'Device restrictions'\n3. Configuration settings:\n   - Experience section:\n     * Block Windows consumer features: Yes\n     * Block manual unenrollment: Yes\n4. App Store settings:\n   - App store auto-update: Block\n   - Developer unlock: Block\n   - Require private store only: Yes (if private store configured)\n5. Alternative - Settings Catalog:\n   - Create > Settings Catalog\n   - Settings > Experience > 'Turn off Microsoft consumer experiences'\n   - Value: Enabled\n6. Configure Private Store (if using):\n   - Microsoft Store for Business integration\n   - Curate approved applications only\n7. Name: 'Windows - Block Consumer Apps and Features'\n8. Assign to: All corporate devices\n9. Alternative Group Policy for comparison:\n   - Computer Configuration > Administrative Templates > Windows Components > Cloud Content\n   - 'Turn off Microsoft consumer experiences': Enabled\n10. Test: Users should not see consumer app suggestions or be able to install consumer apps",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-restrictions-windows-10",
      "controlMappings": [
        {
          "controlId": "03.04.08",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Blocking consumer store apps prevents users from installing software outside organizational control, supporting the authorized software policy by ensuring applications must come from approved enterprise sources (private store or Intune deployment).",
          "nistRequirement": "Identify software programs authorized to execute and implement allow-by-exception policy"
        }
      ]
    },
    {
      "id": "IN-CM-016",
      "settingName": "PowerShellExecutionPolicy",
      "displayName": "PowerShell - Restricted Execution Policy",
      "settingPath": "DeviceConfiguration.PowerShell.ExecutionPolicy",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "AllSigned",
      "validationOperator": "==",
      "description": "Enforces PowerShell script execution policy requiring all scripts to be digitally signed by trusted publisher, preventing execution of unauthorized or malicious scripts while allowing signed organizational scripts",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration\n2. Create policy: Platform 'Windows 10 and later' > Profile 'Settings Catalog'\n3. Name: 'Windows - PowerShell Execution Policy'\n4. Add setting:\n   - Settings > Administrative Templates > Windows Components > Windows PowerShell\n   - 'Turn on Script Execution': Enabled\n   - Execution Policy: 'Allow only signed scripts' (AllSigned)\n5. Alternative execution policies (in order of restrictiveness):\n   - AllSigned: Requires signature on all scripts (recommended)\n   - RemoteSigned: Local scripts run unsigned, downloaded must be signed\n   - Restricted: No scripts run (too restrictive)\n6. Configure code signing:\n   - Obtain code signing certificate from internal CA or public CA\n   - Sign organizational PowerShell scripts\n   - Distribute signing certificate to Trusted Publishers\n7. For Intune-deployed scripts:\n   - Scripts run in system context bypass execution policy\n   - But enforce for user-initiated scripts\n8. Assign to: All Windows devices\n9. Verify: PowerShell command 'Get-ExecutionPolicy -List'\n10. CIS Benchmark: 18.9.102.1.1 (L1) Configure execution policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies",
      "controlMappings": [
        {
          "controlId": "03.04.08",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "PowerShell execution policy requiring signed scripts implements allow-by-exception for script execution, a common attack vector. Only scripts signed by authorized publishers can execute, preventing unauthorized script-based software and malware.",
          "nistRequirement": "Implement deny-all, allow-by-exception policy for authorized software programs including scripts"
        }
      ]
    },
    {
      "id": "IN-CM-017",
      "settingName": "ApplicationControlReviewProcess",
      "displayName": "Quarterly Application Control Policy Review",
      "settingPath": "Intune.AppControl.ReviewProcess",
      "policyType": "Intune",
      "policySubType": "ProcessControl",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "reviewFrequency": "Quarterly",
        "documentationRequired": true,
        "auditLogs": "required"
      },
      "validationOperator": "==",
      "description": "Establishes formal quarterly review process for all application control policies (WDAC, AppLocker, Managed Installer) to validate continued need for authorized applications and remove obsolete approvals",
      "implementationGuide": "1. Create review documentation template:\n   - Current WDAC/AppLocker policies inventory\n   - List of all allow rules and supplemental policies\n   - Business justification for each exception\n   - Last review date and reviewer\n   - Risk assessment for each allowed application\n2. Establish review team:\n   - Security team representative\n   - IT operations representative\n   - Application owners/business stakeholders\n3. Quarterly review process:\n   a. Export current policies:\n      - Endpoint security > App control > Export each policy\n   b. Review WDAC audit logs:\n      - Check blocked applications in audit mode\n      - Event Viewer > CodeIntegrity > Operational\n   c. Review AppLocker logs:\n      - Event Viewer > AppLocker logs\n      - Identify blocked applications and assess need\n   d. Analyze application usage:\n      - Use Endpoint Analytics for application inventory\n      - Identify unused authorized applications\n   e. Update policies:\n      - Remove applications no longer used\n      - Add newly approved applications\n      - Update code signing certificates\n4. Document review:\n   - Change management ticket for all modifications\n   - Maintain authorized software list\n   - Sign-off from security team\n5. Update Intune policies with changes\n6. Communicate changes to IT staff and users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/wdac-deployment-guide",
      "controlMappings": [
        {
          "controlId": "03.04.08",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Regular review of authorized software list ensures the allow-by-exception policy remains current and doesn't accumulate unnecessary exceptions over time. This periodic validation prevents configuration drift and maintains the security posture of application control.",
          "nistRequirement": "Review and update the list of authorized software programs at organization-defined frequency"
        }
      ]
    }
  ]
}
