{
  "controlId": "03.04.03",
  "controlFamily": "CM",
  "controlTitle": "Configuration Change Control",
  "nistRequirement": "a. Define the types of changes to the system that are configuration-controlled.\nb. Review proposed configuration-controlled changes to the system, and approve or disapprove such changes with explicit consideration for security impacts.\nc. Implement and document approved configuration-controlled changes to the system.\nd. Monitor and review activities associated with configuration-controlled changes to the system.",
  "settings": [
    {
      "id": "IN-CM-012",
      "settingName": "UpdateRings.DeploymentControl",
      "displayName": "Windows Update Rings - Change Control Deployment",
      "settingPath": "policies.windowsUpdate.updateRings",
      "policyType": "Intune",
      "policySubType": "WindowsUpdateRings",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": ["Ring1-Pilot", "Ring2-Validation", "Ring3-Production"],
      "validationOperator": "contains",
      "description": "Implements phased deployment rings for Windows updates with mandatory testing phases before production rollout. Enables controlled, monitored deployment of system configuration changes through updates.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Update rings for Windows 10 and later\n2. Create Ring 1 - Pilot (IT department, 3-5% of devices):\n   - Click 'Create policy', name 'Update Ring 1 - Pilot'\n   - Quality update deferral: 0 days (immediate)\n   - Feature update deferral: 0 days\n   - Assign to pilot device group (IT department)\n3. Create Ring 2 - Validation (early adopters, 20% of devices):\n   - Name 'Update Ring 2 - Validation'\n   - Quality update deferral: 3-7 days\n   - Feature update deferral: 7-14 days\n   - Assign to validation user group\n4. Create Ring 3 - Production (all remaining devices):\n   - Name 'Update Ring 3 - Production'\n   - Quality update deferral: 7-14 days\n   - Feature update deferral: 14-30 days\n   - Assign to all devices group (exclude Ring 1 & 2)\n5. Configure each ring with:\n   - Automatic update behavior: Auto install and restart\n   - Restart grace period: 3 days\n   - Deadline for quality updates: 7 days after deferral\n6. Document ring strategy in organizational change control procedures\n7. Monitor deployment via Reports > Windows updates > Windows update report",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/windows-10-update-rings",
      "controlMappings": [
        {
          "controlId": "03.04.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Update rings provide structured change control by defining deployment phases with mandatory pilot and validation stages before production rollout, ensuring changes are reviewed and monitored",
          "nistRequirement": "Review proposed configuration-controlled changes and implement approved changes with monitoring"
        }
      ]
    },
    {
      "id": "IN-CM-013",
      "settingName": "FeatureUpdates.ApprovalRequired",
      "displayName": "Windows Feature Updates - Manual Approval Control",
      "settingPath": "policies.windowsUpdate.featureUpdates",
      "policyType": "Intune",
      "policySubType": "FeatureUpdates",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "requireApproval": true,
        "targetVersion": "specified",
        "automaticUpgrade": false
      },
      "validationOperator": "==",
      "description": "Requires explicit approval for Windows feature updates (major version changes) through Intune Feature Updates policy. Prevents automatic major OS upgrades and ensures change control review process.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Update rings for Windows 10 and later > Feature updates\n2. Click 'Create profile' for Feature Updates policy\n3. Name 'Windows Feature Update Control - [Target Version]'\n4. Deployment settings:\n   - Select specific Windows version (e.g., Windows 11 23H2)\n   - Do NOT select 'Make update available as soon as possible'\n   - Configure rollout options:\n     * Start date: Specify after change approval\n     * Make available for this many days: 90\n5. Set 'Gradual rollout' if available (requires Windows Autopatch)\n6. In Update Ring policy, set Feature update deferral to 0 days (control via Feature Updates policy)\n7. Document approval process:\n   - Security assessment of new feature set\n   - Compatibility testing requirements\n   - Change advisory board approval\n   - Pilot deployment plan and success criteria\n8. Only create/deploy Feature Updates policy after formal change approval\n9. Assign to device groups following ring deployment model\n10. Monitor via Reports > Windows feature updates > Windows feature updates (Organizational)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/windows-10-feature-updates",
      "controlMappings": [
        {
          "controlId": "03.04.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Feature Updates policy enforces explicit approval and controlled deployment of major system changes (OS version upgrades), preventing unauthorized configuration changes",
          "nistRequirement": "Review proposed configuration-controlled changes to the system, and approve or disapprove such changes with explicit consideration for security impacts"
        }
      ]
    },
    {
      "id": "IN-CM-014",
      "settingName": "ConfigurationProfile.VersionControl",
      "displayName": "Configuration Profile Version Control",
      "settingPath": "policies.deviceConfiguration.versionControl",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Versioned",
      "validationOperator": "==",
      "description": "Implements version control for all Intune configuration profiles using naming convention and change tracking. Maintains history of configuration changes with documented approvals and rollback capability.",
      "implementationGuide": "1. Establish Configuration Profile Naming Convention:\n   - Format: '[Platform]-[Category]-[Description]-v[X.Y]'\n   - Example: 'Windows-Security-BitLocker-v1.2'\n   - Increment minor version (X.Y) for minor changes\n   - Increment major version (X.0) for significant changes\n2. For each configuration change:\n   a. Copy existing profile (do not modify in-place)\n   b. Rename with incremented version number\n   c. Update description with:\n      - Version number and date\n      - Change summary\n      - Change request/ticket number\n      - Approver name\n      - Previous version reference\n   d. Make configuration changes to new version\n   e. Test new version with pilot group\n   f. After validation, reassign groups from old to new version\n   g. Keep old version for 90 days (for rollback), then delete\n3. Maintain Configuration Change Log (SharePoint/Database):\n   - Profile name and version\n   - Change date and author\n   - Change description\n   - Approval record\n   - Deployment dates by ring\n4. Use Intune audit logs for tracking: Settings > Audit logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/review-logs-using-azure-monitor",
      "controlMappings": [
        {
          "controlId": "03.04.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Version control of configuration profiles enables tracking of all configuration changes, maintains change history, and supports rollback capability for approved changes",
          "nistRequirement": "Implement and document approved configuration-controlled changes to the system"
        }
      ]
    },
    {
      "id": "IN-CM-015",
      "settingName": "ChangeMonitoring.AuditLogs",
      "displayName": "Configuration Change Audit Logging",
      "settingPath": "monitoring.auditLogs.configurationChanges",
      "policyType": "Intune",
      "policySubType": "AuditLogging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables comprehensive audit logging of all configuration changes in Intune including policy creation, modification, deletion, and assignment changes. Provides change tracking and accountability.",
      "implementationGuide": "1. Verify Intune audit logging is enabled (enabled by default):\n   - Navigate to Intune admin center > Tenant administration > Audit logs\n   - Audit logs automatically capture all configuration changes\n2. Configure Azure Monitor integration for long-term retention:\n   - Go to Intune admin center > Reports > Diagnostics settings\n   - Click 'Add diagnostic setting'\n   - Name: 'Intune Audit Logs to Log Analytics'\n   - Select logs: AuditLogs, OperationalLogs\n   - Send to: Log Analytics workspace\n   - Configure retention: 365 days minimum\n3. Review audit logs regularly:\n   - Filter by Category: 'DeviceConfiguration', 'DeviceCompliance', 'MobileApplicationManagement'\n   - Filter by Activity: 'Create', 'Update', 'Delete', 'Assign'\n   - Review 'Initiated by (actor)' for accountability\n4. Set up automated alerts for unauthorized changes:\n   - Create Azure Monitor alert rule for Intune changes by non-admin users\n   - Alert on policy deletions\n   - Alert on changes outside approved maintenance windows\n5. Include audit log review in monthly security review process\n6. Export audit logs for compliance reporting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/review-logs-using-azure-monitor",
      "controlMappings": [
        {
          "controlId": "03.04.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Audit logging provides comprehensive monitoring and review capability for all configuration changes, ensuring accountability and supporting incident investigation",
          "nistRequirement": "Monitor and review activities associated with configuration-controlled changes to the system"
        }
      ]
    },
    {
      "id": "IN-CM-016",
      "settingName": "UpdatePause.EmergencyControl",
      "displayName": "Windows Update Pause - Emergency Change Control",
      "settingPath": "policies.windowsUpdate.pauseUpdates",
      "policyType": "Intune",
      "policySubType": "WindowsUpdateRings",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "allowPause": true,
        "maxPauseDays": 35,
        "requireApproval": true
      },
      "validationOperator": "==",
      "description": "Enables emergency pause capability for Windows updates when issues are identified during pilot deployment. Provides immediate change control response to problematic updates while maintaining audit trail.",
      "implementationGuide": "1. Configure pause capability in each Update Ring:\n   - Edit existing Update Ring policy\n   - Under 'Update settings':\n     * Quality update deferral period (days): Set as per ring (0, 3-7, 7-14)\n     * Feature update deferral period (days): Set as per ring\n   - Pause feature is available via Intune console (not in policy settings)\n2. Establish Emergency Update Pause Process:\n   - Define triggers for pause (e.g., critical bug reported, widespread device issues)\n   - Require approval from Change Advisory Board or IT Director\n   - Document reason, affected rings, and duration\n3. To pause updates when issues identified:\n   - Navigate to Update rings policy\n   - Select specific ring to pause\n   - Click 'Pause' button\n   - Select pause duration (up to 35 days for quality updates, 35 days for feature updates)\n   - Document pause reason in tenant notes\n4. Monitor paused updates:\n   - Review regularly (weekly minimum during pause)\n   - Evaluate vendor patches/fixes\n   - Test resolution in Ring 1\n   - Resume updates once validated safe\n5. Resume updates:\n   - Click 'Resume' in Update Ring policy\n   - Monitor deployment closely post-resume\n6. Document all pause/resume actions in change log",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/windows-update-pause-resume",
      "controlMappings": [
        {
          "controlId": "03.04.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Update pause capability provides emergency change control mechanism to halt problematic configuration changes, supporting the review and approval requirements for system changes",
          "nistRequirement": "Review proposed configuration-controlled changes and approve or disapprove such changes with explicit consideration for security impacts"
        }
      ]
    },
    {
      "id": "AZ-CM-002",
      "settingName": "ConditionalAccess.ConfigurationProtection",
      "displayName": "Conditional Access - Protect Configuration Changes",
      "settingPath": "conditionalAccess.adminProtection",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "requireMFA": true,
        "requireCompliantDevice": true,
        "blockLegacyAuth": true
      },
      "validationOperator": "==",
      "description": "Enforces MFA and compliant device requirements for administrators accessing Intune and making configuration changes. Ensures proper authentication and authorization for configuration control activities.",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Protection > Conditional Access\n2. Click 'New policy' and name 'Intune Admin - Require MFA and Compliant Device'\n3. Assignments:\n   - Users: Include > Directory roles > Select roles:\n     * Intune Administrator\n     * Cloud Device Administrator\n     * Global Administrator\n     * Security Administrator\n   - Exclude: Emergency access accounts\n4. Target resources:\n   - Select apps > Include > Select apps\n   - Search and add:\n     * 'Microsoft Intune'\n     * 'Microsoft Intune Enrollment'\n     * 'Microsoft Endpoint Manager'\n5. Conditions:\n   - Client apps: Configure > Browser and Mobile apps and desktop clients\n6. Grant:\n   - Select 'Grant access'\n   - Check: 'Require multifactor authentication'\n   - Check: 'Require device to be marked as compliant'\n   - For multiple controls: 'Require all the selected controls'\n7. Session: (optional)\n   - Sign-in frequency: 8 hours\n8. Enable policy: On\n9. Save policy\n10. Test with non-production admin account first\n11. Monitor via Entra ID > Sign-in logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-admin-mfa",
      "controlMappings": [
        {
          "controlId": "03.04.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Conditional Access policies enforce strong authentication and device compliance for administrators performing configuration changes, ensuring accountability and reducing unauthorized change risk",
          "nistRequirement": "Review and approve configuration-controlled changes with explicit consideration for security impacts"
        }
      ]
    }
  ],
  "metadata": {
    "researchDate": "2025-11-17",
    "totalSettings": 6,
    "confidenceLevel": "High",
    "primarySources": [
      "Microsoft Intune Windows Update Management Documentation",
      "Microsoft Intune Change Management Best Practices",
      "CIS Microsoft Intune Benchmark Level 1",
      "Microsoft Conditional Access Security Best Practices"
    ],
    "notes": "These settings implement comprehensive change control for system configurations through deployment rings, version control, audit logging, and administrative controls. The combination ensures all configuration changes are reviewed, approved, documented, and monitored."
  }
}
