{
  "controlId": "03.14.06",
  "controlFamily": "SI",
  "controlTitle": "System Monitoring",
  "controlDescription": "a. Monitor the system to detect: 1. Attacks and indicators of potential attacks and 2. Unauthorized connections. b. Identify unauthorized use of the system. c. Monitor inbound and outbound communications traffic to detect unusual or unauthorized activities or conditions.",
  "totalSettings": 6,
  "settings": [
    {
      "id": "PV-SI-001",
      "settingName": "UnifiedAuditLogIngestionEnabled",
      "displayName": "Microsoft Purview Unified Audit Logging",
      "settingPath": "UnifiedAuditLogConfig.UnifiedAuditLogIngestionEnabled",
      "policyType": "Purview",
      "policySubType": "AuditLogging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables unified audit logging in Microsoft Purview to capture and record user and admin activities across Microsoft 365 services. This setting is fundamental for detecting attacks, monitoring system access, and identifying unauthorized use by providing comprehensive audit trails for security investigations and compliance monitoring.",
      "implementationGuide": "1. Navigate to Microsoft Purview Compliance Portal (https://compliance.microsoft.com)\n2. Select 'Audit' under Solutions\n3. If auditing is not enabled, click 'Start recording user and admin activity' banner\n4. Alternatively, use PowerShell: Connect-ExchangeOnline, then run Set-AdminAuditLogConfig -UnifiedAuditLogIngestionEnabled $true\n5. Verify with: Get-AdminAuditLogConfig | Format-List UnifiedAuditLogIngestionEnabled\n6. Note: Changes may take up to 60 minutes to take effect",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-enable-disable",
      "controlMappings": [
        {
          "controlId": "03.14.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Unified audit logging is the foundation for system monitoring in M365, capturing activities that indicate attacks, unauthorized connections, and system misuse. Without audit logging enabled, organizations cannot detect or investigate security incidents effectively.",
          "nistRequirement": "Monitor the system to detect attacks and indicators of potential attacks; Identify unauthorized use of the system"
        }
      ]
    },
    {
      "id": "DF-SI-001",
      "settingName": "DisableRealtimeMonitoring",
      "displayName": "Defender Real-Time Protection",
      "settingPath": "microsoft.policies.sensors.microsoftDefenderAntivirus.disableRealtimeMonitoring",
      "policyType": "Defender",
      "policySubType": "Antivirus",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Enables real-time protection in Microsoft Defender Antivirus to continuously monitor file and process activity for malicious behavior. Real-time protection detects attacks as they occur, identifies malware propagation, and blocks unauthorized executables, providing immediate threat detection required for system monitoring.",
      "implementationGuide": "1. Navigate to Microsoft Intune Admin Center (https://intune.microsoft.com)\n2. Select Endpoint Security > Antivirus\n3. Create or edit Microsoft Defender Antivirus profile\n4. In Configuration settings, expand 'Real-time Protection'\n5. Set 'Turn on real-time protection' to 'Yes'\n6. Set 'Turn on behavior monitoring' to 'Yes'\n7. Assign policy to appropriate device groups\n8. Verify with PowerShell: Get-MpComputerStatus | select RealTimeProtectionEnabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/configure-real-time-protection-microsoft-defender-antivirus",
      "controlMappings": [
        {
          "controlId": "03.14.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Real-time protection is critical for detecting attacks and indicators of potential attacks in real-time. This setting enables always-on scanning using file and process behavior monitoring to identify malicious activity as it occurs on endpoints.",
          "nistRequirement": "Monitor the system to detect attacks and indicators of potential attacks"
        }
      ]
    },
    {
      "id": "DF-SI-002",
      "settingName": "DisableBehaviorMonitoring",
      "displayName": "Defender Behavior Monitoring",
      "settingPath": "microsoft.policies.sensors.microsoftDefenderAntivirus.disableBehaviorMonitoring",
      "policyType": "Defender",
      "policySubType": "Antivirus",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Enables behavior monitoring in Microsoft Defender Antivirus to detect suspicious activities and attack patterns through heuristic analysis. Behavior monitoring identifies unusual system behavior that may indicate attacks, including fileless malware, living-off-the-land techniques, and advanced persistent threats that traditional signature-based detection might miss.",
      "implementationGuide": "1. Navigate to Microsoft Intune Admin Center\n2. Select Endpoint Security > Antivirus\n3. Create or edit Microsoft Defender Antivirus profile\n4. In Configuration settings, expand 'Real-time Protection'\n5. Set 'Turn on behavior monitoring' to 'Yes'\n6. Ensure 'Monitoring for incoming and outgoing files' is set to 'Monitor all files'\n7. Assign policy to device groups\n8. Verify with PowerShell: Get-MpComputerStatus | select BehaviorMonitorEnabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/configure-protection-features-microsoft-defender-antivirus",
      "controlMappings": [
        {
          "controlId": "03.14.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Behavior monitoring uses heuristics to detect attack indicators and unusual system activities that signature-based protection cannot identify. This capability is essential for monitoring inbound and outbound activities to detect sophisticated threats and attack patterns.",
          "nistRequirement": "Monitor the system to detect attacks and indicators of potential attacks; Monitor inbound and outbound communications traffic to detect unusual or unauthorized activities"
        }
      ]
    },
    {
      "id": "DF-SI-003",
      "settingName": "AllowCloudProtection",
      "displayName": "Defender Cloud-Delivered Protection",
      "settingPath": "microsoft.policies.sensors.microsoftDefenderAntivirus.allowCloudProtection",
      "policyType": "Defender",
      "policySubType": "Antivirus",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables cloud-delivered protection in Microsoft Defender Antivirus to leverage Microsoft's global threat intelligence for near-instant detection and blocking of new and emerging threats. Cloud protection provides access to machine learning models, behavioral analysis, and threat intelligence that detect zero-day attacks and indicators of compromise within seconds.",
      "implementationGuide": "1. Navigate to Microsoft Intune Admin Center\n2. Select Endpoint Security > Antivirus\n3. Create or edit Microsoft Defender Antivirus profile\n4. In Configuration settings, expand 'Cloud Protection'\n5. Set 'Turn on cloud-delivered protection' to 'Yes'\n6. Set 'Cloud-delivered protection level' to 'High' or 'High+'\n7. Set 'Submit samples consent' to 'Send safe samples automatically'\n8. Assign policy to device groups\n9. Verify with PowerShell: Get-MpComputerStatus | select CloudProtectionEnabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/enable-cloud-protection-microsoft-defender-antivirus",
      "controlMappings": [
        {
          "controlId": "03.14.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Cloud-delivered protection enables real-time detection of attacks and indicators of potential attacks by leveraging Microsoft's threat intelligence based on trillions of signals analyzed daily. This setting is critical for detecting new malware, zero-day exploits, and emerging attack patterns that local detection cannot identify.",
          "nistRequirement": "Monitor the system to detect attacks and indicators of potential attacks"
        }
      ]
    },
    {
      "id": "AZ-SI-001",
      "settingName": "SignInLogsEnabled",
      "displayName": "Azure AD Sign-In Logs Monitoring",
      "settingPath": "azureAD.diagnosticSettings.logs.category.SignInLogs.enabled",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Azure AD sign-in log collection to monitor authentication activities and detect unauthorized access attempts, suspicious sign-ins, and risky connections. Sign-in logs capture detailed information about user authentication including IP addresses, locations, devices, and authentication methods, essential for detecting unauthorized connections and system misuse.",
      "implementationGuide": "1. Navigate to Azure Portal (https://portal.azure.com)\n2. Select Azure Active Directory > Diagnostic settings\n3. Add diagnostic setting or edit existing\n4. Under Logs, enable 'SignInLogs', 'NonInteractiveUserSignInLogs', and 'ServicePrincipalSignInLogs'\n5. Configure destination: Log Analytics workspace, Storage account, or Event Hub\n6. Set retention period (minimum 90 days recommended)\n7. Save diagnostic settings\n8. Verify logs appear in destination within 15 minutes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/concept-sign-ins",
      "controlMappings": [
        {
          "controlId": "03.14.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Azure AD sign-in logs are essential for detecting unauthorized connections and identifying unauthorized system use. These logs capture all authentication attempts, enabling detection of brute force attacks, credential stuffing, impossible travel, and other indicators of unauthorized access.",
          "nistRequirement": "Monitor the system to detect unauthorized connections; Identify unauthorized use of the system"
        }
      ]
    },
    {
      "id": "AZ-SI-002",
      "settingName": "IdentityProtectionEnabled",
      "displayName": "Azure AD Identity Protection Risk Detection",
      "settingPath": "azureAD.identityProtection.policies.signInRiskPolicy.state",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "enabled",
      "validationOperator": "==",
      "description": "Enables Azure AD Identity Protection to automatically detect and respond to identity-based risks including compromised accounts, risky sign-ins, and attack indicators. Identity Protection uses machine learning and Microsoft's threat intelligence to detect unusual sign-in patterns, leaked credentials, anonymous IP usage, malware-linked IPs, and impossible travel scenarios that indicate attacks or unauthorized connections.",
      "implementationGuide": "1. Navigate to Azure Portal (https://portal.azure.com)\n2. Select Azure Active Directory > Security > Identity Protection\n3. Select 'Sign-in risk policy'\n4. Set 'Sign-in risk' level to 'Medium and above' or 'High'\n5. Under Access controls, select 'Allow access' and 'Require multi-factor authentication'\n6. Set 'Enforce Policy' to 'On'\n7. Configure 'User risk policy' similarly with 'Require password change'\n8. Review 'Risky sign-ins' and 'Risky users' reports regularly\n9. Note: Requires Azure AD Premium P2 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/overview-identity-protection",
      "controlMappings": [
        {
          "controlId": "03.14.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Identity Protection provides automated monitoring for attacks and indicators of potential attacks by detecting risky sign-in behaviors, compromised credentials, and unauthorized access patterns. This capability is critical for identifying unauthorized connections and system misuse through machine learning and threat intelligence analysis.",
          "nistRequirement": "Monitor the system to detect attacks and indicators of potential attacks; Detect unauthorized connections; Identify unauthorized use of the system"
        }
      ]
    }
  ],
  "implementationNotes": "These six critical settings provide comprehensive system monitoring capabilities across M365 services. Audit logging captures activity records, Defender provides endpoint threat detection, and Identity Protection monitors authentication security. Together, these settings enable detection of attacks, unauthorized connections, and system misuse as required by NIST 800-171 Rev 3 control 03.14.06.",
  "licensingRequirements": "Microsoft 365 E3 provides Unified Audit Log, Defender Antivirus, and basic sign-in logs. Azure AD Premium P2 (included in E5) is required for Identity Protection risk detection policies. Microsoft Defender for Endpoint P2 provides advanced behavior monitoring and cloud protection features.",
  "complianceValidation": "1. Verify audit logging: Get-AdminAuditLogConfig | FL UnifiedAuditLogIngestionEnabled\n2. Check Defender protection: Get-MpComputerStatus\n3. Review sign-in logs in Azure AD portal\n4. Monitor Identity Protection dashboard for risky detections\n5. Validate alerts are generated for suspicious activities\n6. Test incident response procedures",
  "relatedControls": [
    "03.14.01 - Flaw Remediation",
    "03.14.02 - Malicious Code Protection",
    "03.14.03 - Security Alerts and Advisories",
    "03.03.01 - Audit Record Generation",
    "03.03.02 - Audit Record Content"
  ]
}
