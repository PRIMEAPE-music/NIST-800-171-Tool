{
  "controlId": "03.05.07",
  "controlTitle": "Password Management",
  "family": "IA",
  "nistRequirement": "a. Maintain a list of commonly-used, expected, or compromised passwords, and update the list [Assignment: organization-defined frequency] and when organizational passwords are suspected to have been compromised.\nb. Verify that passwords are not found on the list of commonly used, expected, or compromised passwords when users create or update passwords.\nc. Transmit passwords only over cryptographically protected channels.\nd. Store passwords in a cryptographically protected form.\ne. Select a new password upon first use after account recovery.\nf. Enforce the following composition and complexity rules for passwords: [Assignment: organization-defined composition and complexity rules].",
  "settingsCount": 6,
  "settings": [
    {
      "id": "AZ-IA-012",
      "settingName": "customBannedPasswordList",
      "displayName": "Custom Banned Passwords List",
      "settingPath": "authenticationMethods.password.customBannedPasswords",
      "policyType": "AzureAD",
      "policySubType": "PasswordProtection",
      "platform": "All",
      "dataType": "array",
      "expectedValue": [],
      "validationOperator": ">=",
      "description": "Maintains organization-specific list of banned passwords including company name, product names, common terms, and industry-specific vocabulary. Combined with Microsoft's global banned password list, this prevents users from selecting commonly-used, expected, or easily guessable passwords specific to the organization.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Authentication Administrator\n2. Navigate to Protection > Authentication methods > Password protection\n3. Under 'Custom banned password list': Set to 'Yes'\n4. Add terms to ban (up to 1,000 entries):\n   - Company name and variations\n   - Product/service names\n   - Location names (offices, cities)\n   - Industry-specific terms\n   - Common substitutions (P@ssw0rd, etc.)\n   - Previously breached organizational passwords\n5. Example entries: CompanyName, CompanyName123, ProductName, OfficeLoc\n6. Set 'Enforce custom list': Yes\n7. Save configuration\n8. Test: Attempt password change with banned term to verify enforcement\n9. Review and update list quarterly or when new terms identified\n10. Document update frequency in security procedures (recommended: quarterly)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-password-ban-bad",
      "controlMappings": [
        {
          "controlId": "03.05.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Custom banned password list allows organizations to maintain a list of commonly-used, expected, or compromised passwords specific to their environment, satisfying NIST 800-171 requirement 03.05.07.a. The list is enforced at password creation/change and can be updated as needed. This is a CIS Level 1 control (5.2.3.2) and aligns with NIST 800-63B password guidelines.",
          "nistRequirement": "Maintain a list of commonly-used, expected, or compromised passwords, and update the list [Assignment: organization-defined frequency] and when organizational passwords are suspected to have been compromised"
        }
      ]
    },
    {
      "id": "AZ-IA-013",
      "settingName": "passwordProtectionEnforcement",
      "displayName": "Azure AD Password Protection Enforcement",
      "settingPath": "authenticationMethods.password.enableBannedPasswordCheck",
      "policyType": "AzureAD",
      "policySubType": "PasswordProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Enforced",
      "validationOperator": "==",
      "description": "Enforces Azure AD Password Protection which prevents users from setting passwords found on Microsoft's global banned password list (updated continuously based on real-world password attacks) and the organization's custom banned list. Verification occurs in real-time during password creation and changes.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Authentication Administrator\n2. Navigate to Protection > Authentication methods > Password protection\n3. Under 'Mode': Select 'Enforced' (not 'Audit')\n4. Verify 'Enable password protection on Windows Server Active Directory': Yes (for hybrid)\n5. Verify 'Enable custom banned password list': Yes\n6. Save configuration\n7. Test enforcement:\n   a. Attempt to set password with common term (e.g., 'Password123')\n   b. Verify rejection with message about password protection\n8. Monitor adoption:\n   a. Navigate to Reports > Authentication methods > Password protection\n   b. Review blocked password attempts\n9. For hybrid environments: Deploy Password Protection DC Agents\n10. Document enforcement policy in security procedures",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-password-ban-bad",
      "controlMappings": [
        {
          "controlId": "03.05.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Azure AD Password Protection enforces verification that passwords are not found on banned/compromised password lists, satisfying NIST 800-171 requirement 03.05.07.b. The global list is continuously updated by Microsoft based on real-world attacks and breaches. This is essential for preventing common password attacks and is a Microsoft security baseline recommendation.",
          "nistRequirement": "Verify that passwords are not found on the list of commonly used, expected, or compromised passwords when users create or update passwords"
        }
      ]
    },
    {
      "id": "AZ-IA-014",
      "settingName": "passwordProtectionOnPremises",
      "displayName": "Password Protection for On-Premises AD",
      "settingPath": "authenticationMethods.password.enableBannedPasswordCheckOnPremises",
      "policyType": "AzureAD",
      "policySubType": "PasswordProtection",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Extends Azure AD Password Protection to on-premises Active Directory environments, ensuring password protection policies apply consistently across hybrid environments. DC agents enforce the same banned password lists and smart lockout policies on-premises as in the cloud.",
      "implementationGuide": "1. Prerequisites: Windows Server 2012 or later, Azure AD Connect\n2. Download Password Protection Proxy and DC Agent installers from Microsoft\n3. Install Password Protection Proxy:\n   a. Install on 2+ member servers (not DCs) for redundancy\n   b. Run installer as domain admin\n   c. Restart server after installation\n4. Register Proxy with Azure AD:\n   a. Open PowerShell as admin\n   b. Import-Module AzureADPasswordProtection\n   c. Register-AzureADPasswordProtectionProxy -AccountUpn admin@domain.com\n5. Install DC Agent on all Domain Controllers:\n   a. Run installer as domain admin\n   b. Restart DC after installation\n6. Register forest with Azure AD:\n   a. Register-AzureADPasswordProtectionForest -AccountUpn admin@domain.com\n7. Configure enforcement in Azure portal (step 1-6 from previous setting)\n8. Test on-premises password changes\n9. Monitor: Review DC Agent event logs (Event Viewer > Microsoft > AzureADPasswordProtection)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/howto-password-ban-bad-on-premises-deploy",
      "controlMappings": [
        {
          "controlId": "03.05.07",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "For hybrid organizations, extending password protection to on-premises AD ensures consistent enforcement of banned password policies across the entire environment, fully satisfying NIST requirements regardless of where password changes occur. This is a CIS Level 1 control (5.2.3.3) for organizations with on-premises AD.",
          "nistRequirement": "Verify that passwords are not found on the list of commonly used, expected, or compromised passwords when users create or update passwords"
        }
      ]
    },
    {
      "id": "AZ-IA-015",
      "settingName": "tlsEncryptionRequired",
      "displayName": "TLS Encryption for Password Transmission",
      "settingPath": "authentication.protocol.requireTLS",
      "policyType": "AzureAD",
      "policySubType": "SecurityDefaults",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces TLS encryption for all authentication traffic to Azure AD, ensuring passwords are only transmitted over cryptographically protected channels (TLS 1.2+). Modern authentication protocols automatically enforce this requirement, and legacy protocols that don't support TLS are blocked.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Security Administrator\n2. Verify modern authentication is enforced:\n   a. Navigate to Protection > Conditional Access > Policies\n   b. Verify 'Block Legacy Authentication' policy exists and is enabled\n3. Verify TLS 1.2+ is required:\n   a. Azure AD automatically enforces TLS 1.2+ for all connections\n   b. No additional configuration needed for cloud-only environments\n4. For hybrid environments, configure TLS on-premises:\n   a. Enable TLS 1.2 on all DCs and ADFS servers\n   b. Disable TLS 1.0 and 1.1\n   c. Use PowerShell: New-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Server' -Name 'Enabled' -Value 1\n5. Test connections: Use SSL Labs or similar to verify TLS 1.2+\n6. Monitor sign-in logs for TLS version (available in Azure AD P1/P2)\n7. Document TLS requirements in security standards",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-authentication-authenticator-app",
      "controlMappings": [
        {
          "controlId": "03.05.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Azure AD enforces TLS 1.2+ encryption for all authentication traffic, ensuring passwords are transmitted only over cryptographically protected channels as required by NIST 800-171 03.05.07.c. Modern authentication protocols (OAuth 2.0, OpenID Connect) mandate TLS, and blocking legacy authentication ensures this requirement is universally enforced.",
          "nistRequirement": "Transmit passwords only over cryptographically protected channels"
        }
      ]
    },
    {
      "id": "AZ-IA-016",
      "settingName": "passwordHashStorage",
      "displayName": "Cryptographically Protected Password Storage",
      "settingPath": "directory.passwordHashSync",
      "policyType": "AzureAD",
      "policySubType": "PasswordStorage",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Azure AD stores passwords using salted, iterated PBKDF2-HMAC-SHA256 hashing, providing cryptographically strong protection. Passwords are never stored in plaintext or with reversible encryption. For hybrid environments, password hash sync replicates these protected hashes to the cloud.",
      "implementationGuide": "1. Azure AD automatically stores passwords with strong cryptographic protection\n2. For hybrid environments, enable Password Hash Sync:\n   a. Open Azure AD Connect on sync server\n   b. Select 'Customize synchronization options'\n   c. Sign in with Azure AD Global Admin credentials\n   d. Under 'Optional features', enable 'Password hash synchronization'\n   e. Complete wizard and let sync cycle run\n3. Verify sync status:\n   a. Sign in to Microsoft Entra admin center\n   b. Navigate to Identity > Hybrid management > Azure AD Connect\n   c. Verify 'Password hash sync' shows 'Enabled'\n   d. Check last sync timestamp\n4. Benefits of PHS:\n   - Leaked credential detection\n   - Seamless SSO capability\n   - Disaster recovery option\n   - No direct authentication to on-prem\n5. Document that Azure AD uses PBKDF2-HMAC-SHA256 with per-user salt\n6. Note: Passwords are NEVER transmitted or stored in reversible form",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/whatis-phs",
      "controlMappings": [
        {
          "controlId": "03.05.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Azure AD's use of PBKDF2-HMAC-SHA256 with salting for password storage satisfies NIST 800-171 requirement 03.05.07.d for cryptographically protected password storage. This aligns with NIST 800-63B requirements for memorized secret verifiers. Password hash sync is a CIS Level 1 control (1.1.7 in v2.0.0) for hybrid environments.",
          "nistRequirement": "Store passwords in a cryptographically protected form"
        }
      ]
    },
    {
      "id": "AZ-IA-017",
      "settingName": "forcePasswordChangeOnReset",
      "displayName": "Force Password Change After Reset",
      "settingPath": "authenticationMethods.passwordReset.requireChangeOnFirstSignIn",
      "policyType": "AzureAD",
      "policySubType": "SelfServicePasswordReset",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to select a new password on first sign-in after password reset or account recovery. Ensures temporary passwords are immediately replaced with user-selected passwords, preventing use of potentially compromised or weak temporary credentials.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Authentication Administrator\n2. For administrator-reset passwords:\n   a. Navigate to Identity > Users > All users\n   b. Select user > Reset password\n   c. Temporary password is auto-generated\n   d. 'Require this user to change their password when they first sign in' is CHECKED by default\n   e. Complete reset\n3. For Self-Service Password Reset (SSPR):\n   a. Navigate to Protection > Password reset\n   b. Verify 'Self-service password reset enabled' is 'All' or 'Selected'\n   c. SSPR automatically requires new password selection during reset\n   d. No temporary password is used - user creates new password immediately\n4. Verify force-change behavior:\n   a. Reset test user password\n   b. Sign in with temporary password\n   c. Confirm immediate prompt for new password\n5. This setting is enforced by default and cannot be disabled for cloud users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-sspr-howitworks",
      "controlMappings": [
        {
          "controlId": "03.05.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Requiring immediate password change after reset ensures temporary passwords are replaced with user-selected passwords, satisfying NIST 800-171 requirement 03.05.07.e. This prevents extended use of potentially weak temporary credentials and ensures users establish new authenticators after account recovery. This is enforced by default in Azure AD.",
          "nistRequirement": "Select a new password upon first use after account recovery"
        }
      ]
    }
  ]
}
