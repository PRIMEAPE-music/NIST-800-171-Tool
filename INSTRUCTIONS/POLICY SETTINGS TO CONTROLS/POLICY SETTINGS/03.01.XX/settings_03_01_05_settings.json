{
  "control": {
    "id": "03.01.05",
    "title": "Least Privilege",
    "family": "AC",
    "nistSource": "AC-06, AC-06(01), AC-06(07), AU-09(04)",
    "requirements": [
      "a. Allow only authorized system access for users (or processes acting on behalf of users) that is necessary to accomplish assigned organizational tasks.",
      "b. Authorize access to [Assignment: organization-defined security functions] and [Assignment: organization-defined security-relevant information].",
      "c. Review the privileges assigned to roles or classes of users [Assignment: organization-defined frequency] to validate the need for such privileges.",
      "d. Reassign or remove privileges, as necessary."
    ]
  },
  "researchDate": "2024-11-16",
  "totalSettings": 32,
  "categories": [
    "Azure AD Role Management (8 settings)",
    "Privileged Identity Management (PIM) (6 settings)",
    "Access Reviews (6 settings)",
    "Intune Local Administrator Management (6 settings)",
    "Application Permissions Management (4 settings)",
    "Administrative Units (2 settings)"
  ],
  "settings": [
    {
      "id": "AZ-LP-001",
      "settingName": "GlobalAdministratorRoleAssignmentCount",
      "displayName": "Global Administrator Role Assignment Limit",
      "settingPath": "roleAssignments.filter(roleDefinitionId eq 'Global Administrator').count",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Limit the number of Global Administrator role assignments to a maximum of 5 users to reduce attack surface and implement least privilege",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Roles and administrators\n2. Select 'Global Administrator' role\n3. Review all assignments under 'Assignments' tab\n4. Remove unnecessary assignments by selecting user and clicking 'Remove assignment'\n5. Ensure 2-5 Global Administrators remain (Microsoft recommendation: minimum 2, maximum 5)\n6. Document remaining Global Admins and justification for their access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/best-practices",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Limiting Global Administrator assignments directly implements least privilege by restricting the number of accounts with highest-level access to organization-wide resources",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-LP-002",
      "settingName": "BuiltInRoleUsagePolicy",
      "displayName": "Use Least Privileged Built-in Roles",
      "settingPath": "roleAssignments.roleDefinitionId",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Use least privileged role appropriate for task (e.g., User Administrator instead of Global Administrator for user management tasks)",
      "validationOperator": "policy",
      "description": "Assign users the least privileged built-in role necessary to perform their job functions instead of Global Administrator",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Roles and administrators\n2. Review all role assignments by clicking 'All roles' and examining assignment counts\n3. For each user with overly broad permissions:\n   a. Identify specific tasks they need to perform\n   b. Reference Microsoft's least privileged roles guide for task-appropriate role\n   c. Remove broad role (e.g., Global Administrator)\n   d. Assign appropriate least privileged role (e.g., User Administrator, Security Administrator)\n4. Use Microsoft's delegate-by-task documentation for role selection\n5. Document role assignment decisions and periodic review schedule",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/delegate-by-task",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Using least privileged built-in roles ensures users have exactly the permissions needed for their tasks, no more and no less, directly implementing the principle of least privilege",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-LP-003",
      "settingName": "CustomRoleDefinitionForPreciseDuties",
      "displayName": "Custom Role Definitions for Precise Duties",
      "settingPath": "roleDefinitions.isBuiltIn",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "custom_role_exists",
      "description": "Create custom roles when built-in roles are too broad to achieve precise least privilege access for specific job functions",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Roles and administrators > All roles\n2. Click 'New custom role'\n3. Provide role name, description, and baseline permissions\n4. On 'Permissions' tab, select only specific permissions required\n5. Use JSON to define granular permission sets if needed\n6. Review and create custom role\n7. Assign custom role with appropriate scope (tenant, administrative unit, or resource)\n8. Requires Azure AD Premium P1 or P2 license\n9. Document custom role purpose, permissions, and approved assignees",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/custom-create",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Custom roles enable organizations to define precise permission sets tailored to specific job functions, achieving greater least privilege granularity than built-in roles allow",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks; b. Authorize access to organization-defined security functions"
        }
      ]
    },
    {
      "id": "AZ-LP-004",
      "settingName": "RoleAssignableGroupsForManagement",
      "displayName": "Role-Assignable Groups for Simplified Management",
      "settingPath": "groups.isAssignableToRole",
      "policyType": "AzureAD",
      "policySubType": "GroupManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Use role-assignable groups to simplify role management and ensure consistent least privilege across group members",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Groups > All groups\n2. Click 'New group'\n3. Set 'Group type' to 'Security'\n4. Enable 'Azure AD roles can be assigned to the group'\n5. Add appropriate members who need same role\n6. Navigate to Roles and administrators\n7. Select appropriate role and assign the group\n8. Use with PIM for just-in-time access (recommended)\n9. Requires Azure AD Premium P1 license minimum\n10. Document group membership criteria and approval process",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/groups-concept",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Role-assignable groups simplify management of least privilege by allowing consistent permission sets across users with similar job functions, reducing risk of permission drift",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-LP-005",
      "settingName": "PrivilegedRoleAssignmentLimit",
      "displayName": "Privileged Role Assignment Limit",
      "settingPath": "roleAssignments.filter(roleDefinition.isPrivileged eq true).count",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 10,
      "validationOperator": "<=",
      "description": "Limit the number of privileged role assignments (roles with privileged permissions like credential management) to fewer than 10 to minimize security risk",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Roles and administrators\n2. Identify roles marked as 'PRIVILEGED' (e.g., Application Administrator, Cloud Application Administrator)\n3. For each privileged role, review assignment count\n4. If total assignments across privileged roles exceed 10:\n   a. Review business justification for each assignment\n   b. Remove unnecessary privileged access\n   c. Consider using PIM for eligible assignments instead of permanent\n   d. Use custom roles with limited permissions where possible\n5. Monitor via Azure AD reporting for excessive privileged assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/best-practices#limit-the-number-of-privileged-role-assignments",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Limiting privileged role assignments prevents accumulation of excessive high-level permissions and reduces the attack surface for credential compromise and privilege escalation",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks; b. Authorize access to organization-defined security functions"
        }
      ]
    },
    {
      "id": "AZ-LP-006",
      "settingName": "EmergencyAccessAccountConfiguration",
      "displayName": "Emergency Access Accounts (Break Glass)",
      "settingPath": "users.filter(displayName contains 'emergency' or displayName contains 'breakglass').count",
      "policyType": "AzureAD",
      "policySubType": "AccountManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 2,
      "validationOperator": ">=",
      "description": "Configure at least 2 cloud-only emergency access accounts with Global Administrator role to prevent lockout while maintaining least privilege for normal operations",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Users > All users\n2. Create 2 cloud-only accounts (not synced from on-premises)\n3. Use strong, unique passwords stored in secure physical location (e.g., safe)\n4. Assign Global Administrator role to both accounts\n5. Exclude from all Conditional Access policies\n6. Exclude from MFA requirements (or use hardware token)\n7. Configure monitoring and alerting for usage\n8. Document storage location of credentials\n9. Test access quarterly\n10. Review usage logs monthly for unauthorized access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-emergency-access",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "Medium",
          "isRequired": true,
          "mappingRationale": "Emergency access accounts ensure administrative access during system failures while supporting overall least privilege strategy by enabling removal of permanent Global Administrator assignments from regular accounts",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-LP-007",
      "settingName": "RoleAssignmentScopeRestriction",
      "displayName": "Role Assignment Scope Restriction",
      "settingPath": "roleAssignments.directoryScopeId",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Administrative Unit or resource scope (not '/' for tenant-wide)",
      "validationOperator": "!=",
      "description": "Limit role assignment scope to specific Administrative Units or resources instead of tenant-wide to implement least privilege at the scope level",
      "implementationGuide": "1. Create Administrative Units for organizational/geographic boundaries:\n   a. Navigate to Identity > Administrative units > Add\n   b. Define AU by department, location, or function\n2. Assign users or devices to Administrative Units\n3. When assigning roles:\n   a. Select role in Roles and administrators\n   b. Click 'Add assignments'\n   c. Under 'Assignment type', choose 'Scoped to administrative unit'\n   d. Select specific Administrative Unit\n4. Review existing tenant-wide role assignments\n5. Migrate to scoped assignments where possible\n6. Requires Azure AD Premium P1 or P2 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/administrative-units",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Scoping role assignments to Administrative Units or specific resources limits the blast radius of privileged access, implementing least privilege at both the permission and scope dimensions",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-LP-008",
      "settingName": "ServicePrincipalRoleAssignmentLimit",
      "displayName": "Service Principal Role Assignment Limit (100 per principal)",
      "settingPath": "servicePrincipals.appRoleAssignments.count + roleAssignments.count",
      "policyType": "AzureAD",
      "policySubType": "ServiceLimits",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 100,
      "validationOperator": "<=",
      "description": "Azure AD enforces a maximum of 100 role assignments per service principal at non-tenant scope to prevent privilege accumulation",
      "implementationGuide": "1. This is a built-in Azure AD service limit that cannot be configured\n2. Monitor service principal role assignments:\n   a. Use Microsoft Graph API: GET /servicePrincipals/{id}/appRoleAssignments\n   b. Count total assignments per service principal\n3. If approaching limit:\n   a. Review necessity of each role assignment\n   b. Consolidate permissions into fewer, more appropriate roles\n   c. Use resource-specific permissions instead of broad directory roles\n4. Alert when service principal has >80 role assignments\n5. Document and justify service principals with high assignment counts",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/users/directory-service-limits-restrictions",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "The service limit prevents excessive privilege accumulation by service principals, naturally enforcing least privilege through technical constraints",
          "nistRequirement": "a. Allow only authorized system access for users (or processes acting on behalf of users) that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-PIM-001",
      "settingName": "PimEnabledForPrivilegedRoles",
      "displayName": "PIM Enabled for Privileged Roles",
      "settingPath": "privilegedAccess.azureResources/roleSettings.isDefault",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Enable Privileged Identity Management for all privileged Azure AD roles to provide just-in-time access and reduce standing privileges",
      "implementationGuide": "1. Requires Azure AD Premium P2 license for all users with PIM roles\n2. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n3. Select 'Azure AD roles'\n4. Click 'Roles' and identify privileged roles (Global Admin, Privileged Role Admin, Security Admin, etc.)\n5. For each privileged role:\n   a. Click role name\n   b. Click 'Settings'\n   c. Click 'Edit'\n   d. Configure activation requirements:\n      - Enable 'Require multifactor authentication on activation'\n      - Enable 'Require justification on activation'\n      - Set 'Activation maximum duration' to 8 hours or less\n      - Enable 'Require approval to activate' for highly privileged roles\n   e. Save settings\n6. Migrate permanent assignments to eligible assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "PIM implements just-in-time privileged access, ensuring users only have elevated permissions when needed for specific tasks, directly implementing temporal least privilege",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-PIM-002",
      "settingName": "PimActivationMfaRequired",
      "displayName": "PIM Activation Requires MFA",
      "settingPath": "privilegedAccess.azureResources/roleSettings.userMemberSettings.mfaRule",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require multifactor authentication when activating privileged roles in PIM to verify identity before granting elevated access",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n2. Select 'Azure AD roles' > 'Roles'\n3. For each privileged role:\n   a. Click role name\n   b. Click 'Settings' > 'Edit'\n   c. Under 'Activation' tab\n   d. Check 'Require multifactor authentication on activation'\n   e. Click 'Update'\n4. Verify users have MFA methods registered\n5. Test role activation to confirm MFA prompt appears\n6. Apply to all privileged roles without exception",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "MFA on role activation provides strong authentication before granting privileged access, ensuring only authorized and verified users can elevate permissions",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks; b. Authorize access to organization-defined security functions"
        }
      ]
    },
    {
      "id": "AZ-PIM-003",
      "settingName": "PimActivationJustificationRequired",
      "displayName": "PIM Activation Requires Justification",
      "settingPath": "privilegedAccess.azureResources/roleSettings.userMemberSettings.justificationRule",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require business justification when activating privileged roles to create audit trail and ensure appropriate use of elevated permissions",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n2. Select 'Azure AD roles' > 'Roles'\n3. For each role:\n   a. Click role name\n   b. Click 'Settings' > 'Edit'\n   c. Under 'Activation' tab\n   d. Check 'Require justification on activation'\n   e. Click 'Update'\n4. Educate users on providing meaningful justifications\n5. Review justifications in PIM audit logs\n6. Implement monitoring for generic or suspicious justifications",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "Medium",
          "isRequired": true,
          "mappingRationale": "Activation justifications create accountability and audit trail for privileged access, helping organizations validate that elevated permissions are used only for legitimate business needs",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-PIM-004",
      "settingName": "PimMaximumActivationDuration",
      "displayName": "PIM Maximum Activation Duration",
      "settingPath": "privilegedAccess.azureResources/roleSettings.userMemberSettings.maximumGrantPeriod",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 8,
      "validationOperator": "<=",
      "description": "Set maximum role activation duration to 8 hours or less to limit the time window of elevated privileges",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n2. Select 'Azure AD roles' > 'Roles'\n3. For each privileged role:\n   a. Click role name\n   b. Click 'Settings' > 'Edit'\n   c. Under 'Activation' tab\n   d. Set 'Activation maximum duration (hours)' to 8 or less\n   e. Consider shorter durations (4-6 hours) for highest privileged roles\n   f. Click 'Update'\n4. Inform users they can re-activate if additional time needed\n5. Monitor activation patterns to optimize duration settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Limited activation duration implements temporal least privilege by automatically removing elevated permissions after a defined period, reducing the window of exposure",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-PIM-005",
      "settingName": "PimApprovalRequiredForHighPrivilegedRoles",
      "displayName": "PIM Approval Required for Highly Privileged Roles",
      "settingPath": "privilegedAccess.azureResources/roleSettings.userMemberSettings.approvalRule",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require approval workflow for activating highly privileged roles (Global Administrator, Privileged Role Administrator) to add human oversight",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n2. Select 'Azure AD roles' > 'Roles'\n3. For highly privileged roles (Global Administrator, Privileged Role Administrator):\n   a. Click role name\n   b. Click 'Settings' > 'Edit'\n   c. Under 'Activation' tab\n   d. Check 'Require approval to activate'\n   e. Click 'Select approver(s)'\n   f. Add appropriate approvers (avoid single point of failure)\n   g. Click 'Update'\n4. Configure notification settings for approval requests\n5. Document approval SLA (recommended: <2 hours)\n6. Implement backup approvers for 24/7 coverage",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Approval workflows for highest privileged roles add human oversight and prevent unauthorized self-elevation, implementing principle of separation of duties alongside least privilege",
          "nistRequirement": "b. Authorize access to organization-defined security functions"
        }
      ]
    },
    {
      "id": "AZ-PIM-006",
      "settingName": "PimEligibleAssignmentsOverPermanent",
      "displayName": "PIM Eligible Assignments Over Permanent",
      "settingPath": "roleAssignments.assignmentState",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Eligible",
      "validationOperator": "==",
      "description": "Use eligible PIM assignments instead of permanent role assignments for privileged roles to eliminate standing access",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n2. Select 'Azure AD roles' > 'Roles'\n3. For each privileged role with permanent assignments:\n   a. Click role name\n   b. View 'Assignments' tab\n   c. Identify users with 'Permanent' assignment type\n   d. For each permanent assignment:\n      - Click '...' menu > 'Update assignment'\n      - Change assignment type to 'Eligible'\n      - Set appropriate start/end dates\n      - Click 'Update'\n4. Exception: Keep 2 emergency access accounts as permanent Global Administrators\n5. Monitor for new permanent assignments via alerts\n6. Quarterly review to ensure no unauthorized permanent assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-add-role-to-user",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Eligible assignments eliminate standing privileged access, ensuring users only have elevated permissions when explicitly activated for specific tasks, core implementation of just-in-time least privilege",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-AR-001",
      "settingName": "PrivilegedRoleAccessReviewEnabled",
      "displayName": "Access Reviews Enabled for Privileged Roles",
      "settingPath": "identityGovernance.accessReviews.definitions.instanceEnumerationScope.principalScoped",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable recurring access reviews for all privileged Azure AD roles to periodically validate continued need for elevated permissions",
      "implementationGuide": "1. Requires Azure AD Premium P2 license for all reviewers\n2. Navigate to Microsoft Entra admin center > Identity Governance > Privileged Identity Management\n3. Select 'Azure AD roles' > 'Access reviews'\n4. Click 'New access review'\n5. Configure review:\n   a. Name: 'Privileged Role Access Review - [Role Name]'\n   b. Start date: Immediate or scheduled\n   c. Frequency: Weekly, Monthly, or Quarterly (recommend monthly minimum)\n   d. Duration: 3-7 days\n   e. End: Never (recurring)\n6. Select roles to review (Global Admin, Security Admin, etc.)\n7. Assignment type: All active and eligible assignments\n8. Reviewers: Manager or specific security personnel\n9. Enable 'Auto apply results to resource'\n10. Set 'If reviewers don't respond' to 'Remove access'\n11. Create separate review for each critical privileged role",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Periodic access reviews validate the continued need for privileged role assignments, directly implementing the requirement to review and reassign/remove privileges as necessary",
          "nistRequirement": "c. Review the privileges assigned to roles or classes of users to validate the need for such privileges; d. Reassign or remove privileges, as necessary"
        }
      ]
    },
    {
      "id": "AZ-AR-002",
      "settingName": "AccessReviewFrequencyForHighPrivilegedRoles",
      "displayName": "Access Review Frequency for High Privileged Roles",
      "settingPath": "identityGovernance.accessReviews.definitions.settings.recurrence.pattern.type",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "weekly",
      "validationOperator": "in",
      "description": "Configure access reviews for highly privileged roles (Global Admin, Privileged Role Admin) to run at least weekly or monthly",
      "implementationGuide": "1. Navigate to Identity Governance > Privileged Identity Management > Azure AD roles > Access reviews\n2. For existing reviews of highly privileged roles:\n   a. Select review > 'Settings'\n   b. Set 'Frequency' to 'Weekly' or 'Monthly'\n3. For new reviews:\n   a. Click 'New access review'\n   b. Select Global Administrator, Privileged Role Administrator roles\n   c. Set Frequency to 'Weekly' (for highest risk) or 'Monthly' (acceptable)\n   d. Duration: 3-7 days maximum\n4. CIS Benchmark recommends weekly for: Global Admin, Exchange Admin, SharePoint Admin, Teams Admin, Security Admin\n5. Configure notifications to reviewers\n6. Enable 'Show recommendations' based on sign-in activity",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Frequent access reviews for highest privileged roles ensure rapid identification and removal of unnecessary privileged access, reducing the window of excessive privilege",
          "nistRequirement": "c. Review the privileges assigned to roles or classes of users [organization-defined frequency] to validate the need for such privileges"
        }
      ]
    },
    {
      "id": "AZ-AR-003",
      "settingName": "AccessReviewAutoApplyResults",
      "displayName": "Access Review Auto-Apply Results",
      "settingPath": "identityGovernance.accessReviews.definitions.settings.autoApplyDecisionsEnabled",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable automatic application of access review results to immediately remove access when reviewers deny or don't respond",
      "implementationGuide": "1. Navigate to Identity Governance > Access reviews\n2. When creating or editing access review:\n   a. Expand 'Advanced settings'\n   b. Enable 'Auto apply results to resource'\n   c. Set 'If reviewers don't respond' to 'Remove access' or 'Take recommendations'\n3. For existing reviews:\n   a. Select review > 'Settings'\n   b. Enable 'Auto apply results to resource'\n   c. Update 'Default decision' setting\n4. Test with non-critical role first\n5. Configure notifications to affected users before removal\n6. Document exception process for restoring accidentally removed access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Auto-applying review results ensures timely removal of unnecessary privileges without manual intervention, implementing the requirement to reassign or remove privileges",
          "nistRequirement": "d. Reassign or remove privileges, as necessary"
        }
      ]
    },
    {
      "id": "AZ-AR-004",
      "settingName": "AccessReviewDurationLimit",
      "displayName": "Access Review Duration Limit",
      "settingPath": "identityGovernance.accessReviews.definitions.settings.recurrence.pattern.daysOfMonth",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 3,
      "validationOperator": "<=",
      "description": "Set access review duration to 3 days or less to ensure timely completion and prevent stale privileged access",
      "implementationGuide": "1. Navigate to Identity Governance > Access reviews\n2. When creating access review:\n   a. Set 'Duration (in days)' to 3 or less\n   b. Shorter duration increases urgency\n3. For existing reviews:\n   a. Edit review settings\n   b. Reduce duration to 3 days maximum\n4. Configure reminder notifications:\n   a. Send reminder 1 day before end\n   b. Escalate to backup reviewer if no response\n5. Monitor review completion rates\n6. Adjust duration if completion rates drop below 90%",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Short review durations ensure timely validation of privilege need and prevent prolonged periods of potentially unnecessary elevated access",
          "nistRequirement": "c. Review the privileges assigned to roles or classes of users to validate the need for such privileges"
        }
      ]
    },
    {
      "id": "AZ-AR-005",
      "settingName": "AccessReviewRecommendationsEnabled",
      "displayName": "Access Review Recommendations Enabled",
      "settingPath": "identityGovernance.accessReviews.definitions.settings.recommendationsEnabled",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable system recommendations in access reviews based on user sign-in activity and access patterns to assist reviewers",
      "implementationGuide": "1. Navigate to Identity Governance > Access reviews\n2. When creating or editing access review:\n   a. Enable 'Show recommendations'\n   b. Recommendations based on:\n      - Last sign-in activity\n      - Role usage patterns\n      - Access history\n3. System recommends 'Deny' for:\n   - Users who haven't signed in for 30+ days\n   - Inactive role assignments\n4. Educate reviewers to:\n   a. Consider recommendations but verify business need\n   b. Document reason if overriding recommendation\n5. Review recommendation accuracy quarterly\n6. Adjust recommendation thresholds if needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "System recommendations help reviewers identify potentially unnecessary privileges based on actual usage data, improving review quality and privilege removal accuracy",
          "nistRequirement": "c. Review the privileges assigned to roles or classes of users to validate the need for such privileges; d. Reassign or remove privileges, as necessary"
        }
      ]
    },
    {
      "id": "AZ-AR-006",
      "settingName": "AccessReviewJustificationRequired",
      "displayName": "Access Review Justification Required",
      "settingPath": "identityGovernance.accessReviews.definitions.settings.justificationRequiredOnApproval",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require reviewers to provide business justification when approving continued privileged access",
      "implementationGuide": "1. Navigate to Identity Governance > Access reviews\n2. When creating or editing access review:\n   a. Enable 'Require reason on approval'\n   b. Optionally enable 'Require reason on denial'\n3. Educate reviewers on providing meaningful justifications:\n   a. Specific job function requiring privilege\n   b. Recent tasks performed with elevated access\n   c. Expected duration of continued need\n4. Review justifications for quality\n5. Flag generic justifications (e.g., 'needs access') for follow-up\n6. Store justifications for audit trail and compliance reporting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "Medium",
          "isRequired": true,
          "mappingRationale": "Requiring justifications for privilege continuation creates accountability and audit trail, ensuring reviewers actively validate business need rather than rubber-stamping approvals",
          "nistRequirement": "c. Review the privileges assigned to roles or classes of users to validate the need for such privileges"
        }
      ]
    },
    {
      "id": "IN-LP-001",
      "settingName": "AutopilotStandardUserProvisioning",
      "displayName": "Windows Autopilot Standard User Provisioning",
      "settingPath": "deviceEnrollmentConfigurations.windowsAutopilot.settings.enableWhiteGlove",
      "policyType": "Intune",
      "policySubType": "WindowsAutopilot",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Standard",
      "validationOperator": "==",
      "description": "Configure Windows Autopilot to provision user accounts as Standard users instead of Local Administrators during device setup",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Windows > Windows enrollment\n2. Select 'Deployment Profiles'\n3. Edit existing profile or create new:\n   a. Click 'Create profile' > 'Windows PC'\n   b. Provide name and description\n4. On 'Out-of-box experience (OOBE)' page:\n   a. Set 'Apply device name template' (optional)\n   b. Set 'User account type' to 'Standard'\n   c. Configure other OOBE settings as needed\n5. Assign profile to appropriate device groups\n6. Applies to new device enrollments only\n7. Existing devices require manual local admin removal\n8. Document exceptions requiring local admin (if any)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/autopilot/windows-autopilot",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Provisioning standard user accounts prevents end users from having unnecessary local administrative privileges, implementing least privilege at the endpoint level from initial device setup",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "IN-LP-002",
      "settingName": "IntuneAccountProtectionLocalAdminRestriction",
      "displayName": "Intune Account Protection - Local Admin Restriction",
      "settingPath": "deviceConfigurations.endpointSecurityAccountProtection.localUsersAndGroups.configure",
      "policyType": "Intune",
      "policySubType": "EndpointSecurityAccountProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "groupName": "Administrators",
        "action": "remove_update",
        "members": ["Azure AD joined device local administrator role group"]
      },
      "validationOperator": "contains",
      "description": "Use Intune Account Protection policy to manage local Administrators group membership, removing unnecessary users and adding only authorized administrators",
      "implementationGuide": "1. Navigate to Intune admin center > Endpoint security > Account protection\n2. Click 'Create Policy'\n3. Platform: Windows 10 and later\n4. Profile: Local user group membership\n5. Click 'Create'\n6. On 'Configuration settings':\n   a. Click 'Add group'\n   b. Local Group: Administrators (S-1-5-32-544)\n   c. Action: Select 'Remove and Update' or 'Add Update'\n   d. Members: Add Azure AD security group or specific users\n7. To remove user who joined device:\n   a. Action: 'Remove'\n   b. Members: Add placeholder or specific user SID\n8. Assign to device groups\n9. Monitor compliance status\n10. Requires Windows 10 20H2 or later",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-account-protection-policy",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Account Protection policies enforce least privilege by programmatically managing local administrator group membership, ensuring only authorized users have elevated access on endpoints",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "IN-LP-003",
      "settingName": "AdministratorProtectionUACEnabled",
      "displayName": "Administrator Protection (UAC Enhancement)",
      "settingPath": "deviceConfigurations.settingsCatalog.localPoliciesSecurityOptions.userAccountControlTypeOfAdminApprovalMode",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Admin Approval Mode with Administrator protection",
      "validationOperator": "==",
      "description": "Enable Administrator Protection to require users with admin privileges to consent before elevated operations, implementing just-in-time privilege elevation",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration profiles\n2. Click 'Create profile'\n3. Platform: Windows 10 and later\n4. Profile type: Settings catalog\n5. Click 'Add settings'\n6. Search for 'User Account Control'\n7. Select 'Local Policies Security Options'\n8. Add these settings:\n   a. 'User Account Control: Configure type of Admin Approval Mode'\n      - Set to 'Admin Approval Mode with Administrator protection'\n   b. 'User Account Control: Behavior of the elevation prompt for administrators running with Administrator protection'\n      - Set to 'Prompt for credentials' or 'Prompt for consent'\n9. Assign to user or device groups with admin rights\n10. Requires Windows 11 24H2 build 26100.7019 or later\n11. Integrates with Windows Hello for authentication",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/administrator-protection/",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Administrator Protection implements just-in-time privilege elevation by requiring explicit user consent for admin operations, ensuring users operate with least privilege by default",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "IN-LP-004",
      "settingName": "EndpointPrivilegeManagementPolicies",
      "displayName": "Endpoint Privilege Management (EPM) Policies",
      "settingPath": "deviceManagement.elevationRequests.elevationRules",
      "policyType": "Intune",
      "policySubType": "EndpointPrivilegeManagement",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": {
        "ruleType": "fileHash",
        "action": "allow",
        "requireJustification": true
      },
      "validationOperator": "exists",
      "description": "Deploy Endpoint Privilege Management policies to allow standard users to run specific applications with elevated privileges without granting full admin rights",
      "implementationGuide": "1. Requires Microsoft Intune Suite license\n2. Navigate to Intune admin center > Endpoint security > Endpoint Privilege Management\n3. Click 'Create policy'\n4. Select 'Windows elevation rules'\n5. Configure elevation rules:\n   a. Rule name and description\n   b. File type: Certificate, File hash, or File name\n   c. For critical applications:\n      - Add file details (hash, path, or certificate)\n      - Select 'Elevation type': Automatic or User-confirmed\n      - Enable 'Require business justification'\n6. Create separate rules for different applications\n7. Assign to user groups (standard users who need occasional elevation)\n8. Monitor elevation requests and justifications\n9. Review and update rules quarterly\n10. Currently in Public Preview",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/epm-overview",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "EPM enables granular just-in-time privilege elevation for specific applications, allowing users to remain standard users while still completing necessary elevated tasks",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "IN-LP-005",
      "settingName": "WindowsLAPSConfiguration",
      "displayName": "Windows LAPS (Local Administrator Password Solution)",
      "settingPath": "deviceConfigurations.settingsCatalog.laps",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "backupDirectory": "1",
        "passwordComplexity": "4",
        "passwordLength": 14,
        "postAuthenticationActions": "3"
      },
      "validationOperator": "configured",
      "description": "Configure Windows LAPS to automatically manage and rotate local administrator passwords, reducing shared credential risk",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration profiles\n2. Create Settings Catalog profile\n3. Add settings from 'LAPS' category:\n   a. 'Backup Directory' = 'Backup the password to Azure AD only' (1)\n   b. 'Password Complexity' = 'Large letters + small letters + numbers + special characters' (4)\n   c. 'Password Length' = 14 or greater\n   d. 'Password Age Days' = 30 (or organization-defined)\n   e. 'Post Authentication Actions' = 'Reset the password and logoff the managed account' (3)\n4. Assign to Azure AD joined Windows devices\n5. Verify Azure AD Premium P1 or P2 license\n6. Grant access to LAPS passwords:\n   a. Azure AD role with appropriate permissions\n   b. Or use RBAC with custom role\n7. Monitor password retrieval via audit logs\n8. Supported on Azure AD joined devices only",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-server/identity/laps/laps-scenarios-azure-active-directory",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "LAPS implements least privilege for local administrator access by ensuring unique, complex passwords per device and just-in-time access to local admin credentials",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks; b. Authorize access to organization-defined security functions"
        }
      ]
    },
    {
      "id": "IN-LP-006",
      "settingName": "IntuneRBACCustomRoles",
      "displayName": "Intune RBAC Custom Roles for Scoped Administration",
      "settingPath": "roleManagement.roleDefinitions",
      "policyType": "Intune",
      "policySubType": "RoleBasedAccessControl",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "isBuiltIn": false,
        "permissions": ["specific_permissions_only"]
      },
      "validationOperator": "exists",
      "description": "Create custom Intune RBAC roles with minimum required permissions for device management tasks instead of using broad built-in roles",
      "implementationGuide": "1. Navigate to Intune admin center > Tenant administration > Roles\n2. Click 'Create' to create custom role\n3. Provide role name and description\n4. On 'Permissions' tab:\n   a. Select only required permission categories\n   b. Within each category, grant specific permissions needed\n   c. Avoid granting all permissions in a category\n5. Common least privilege roles:\n   a. Help Desk Operator: Device read + remote actions only\n   b. Policy Manager: Policy create/edit, no device wipe\n   c. Read-Only Operator: Read permissions only\n6. On 'Scope tags' tab:\n   a. Add scope tags to limit device visibility\n7. Assign custom role to security groups\n8. Review and update permissions quarterly\n9. Document role purpose and approved assignees",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/fundamentals/create-custom-role",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Custom Intune RBAC roles enable precise least privilege for device management functions, ensuring administrators only have permissions necessary for their specific job duties",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks; b. Authorize access to organization-defined security functions"
        }
      ]
    },
    {
      "id": "AZ-APP-001",
      "settingName": "ApplicationPermissionsLeastPrivilege",
      "displayName": "Application Permissions - Least Privilege Principle",
      "settingPath": "servicePrincipals.appRoles",
      "policyType": "AzureAD",
      "policySubType": "ApplicationManagement",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "Minimum required permissions only (no *.All permissions unless absolutely necessary)",
      "validationOperator": "policy",
      "description": "Grant applications only the minimum Microsoft Graph API and Azure AD permissions required for their functionality",
      "implementationGuide": "1. For each application registration:\n   a. Navigate to Azure AD > App registrations > [Application]\n   b. Select 'API permissions'\n   c. Review existing permissions\n2. Apply least privilege:\n   a. Prefer delegated permissions over application permissions when user context exists\n   b. Request specific resource permissions (e.g., User.Read.All) instead of broad permissions (e.g., Directory.ReadWrite.All)\n   c. Avoid *.ReadWrite.All permissions unless required\n   d. Use resource-specific permissions when available\n3. Remove unnecessary permissions:\n   a. Select permission > 'Remove permission'\n4. Document permission justification\n5. Implement approval workflow for high-privilege permissions\n6. Quarterly permission review and cleanup\n7. Use Microsoft Graph permissions reference for least privilege guidance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/permissions-overview",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Granting applications minimum required permissions implements least privilege for automated processes and service principals, reducing the impact of application compromise",
          "nistRequirement": "a. Allow only authorized system access for processes acting on behalf of users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-APP-002",
      "settingName": "AdminConsentRequiredForHighPrivilegePermissions",
      "displayName": "Admin Consent Required for High Privilege Permissions",
      "settingPath": "servicePrincipals.appRoleAssignments.appRoleId",
      "policyType": "AzureAD",
      "policySubType": "ApplicationManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require administrator consent for applications requesting high-privilege permissions (e.g., Application.ReadWrite.All, RoleManagement.ReadWrite.Directory)",
      "implementationGuide": "1. This is default behavior in Azure AD - admin consent required for application permissions\n2. Configure user consent settings:\n   a. Navigate to Azure AD > Enterprise applications > Consent and permissions\n   b. Under 'User consent settings':\n      - Select 'Do not allow user consent' for high-risk permissions\n      - Or 'Allow user consent for apps from verified publishers, for selected permissions'\n3. Review and approve consent requests:\n   a. Navigate to Enterprise applications > Admin consent requests\n   b. Review business justification\n   c. Verify least privilege principle\n   d. Approve or deny with documentation\n4. Monitor high-privilege permission grants via audit logs\n5. Implement approval workflow for permissions allowing credential management or role assignment\n6. Quarterly review of all granted application permissions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/configure-admin-consent-workflow",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Requiring admin consent for high-privilege application permissions ensures human oversight and approval before granting broad access to organizational resources",
          "nistRequirement": "b. Authorize access to organization-defined security functions and security-relevant information"
        }
      ]
    },
    {
      "id": "AZ-APP-003",
      "settingName": "ServicePrincipalPermissionReview",
      "displayName": "Service Principal Permission Periodic Review",
      "settingPath": "servicePrincipals.appRoleAssignments",
      "policyType": "AzureAD",
      "policySubType": "ApplicationManagement",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "Reviewed quarterly",
      "validationOperator": "periodic_review",
      "description": "Periodically review application and service principal permissions to identify and remove unnecessary or excessive permissions",
      "implementationGuide": "1. Create quarterly review process:\n   a. Export all service principals: GET /servicePrincipals via Graph API\n   b. For each service principal, retrieve permissions:\n      - GET /servicePrincipals/{id}/appRoleAssignments\n      - GET /servicePrincipals/{id}/oauth2PermissionGrants\n2. Review each permission grant:\n   a. Validate business need with application owner\n   b. Verify permission is minimum required\n   c. Check for unused applications (no sign-in activity)\n   d. Identify overly broad permissions (*.All)\n3. Remove unnecessary permissions:\n   a. DELETE /servicePrincipals/{id}/appRoleAssignments/{assignmentId}\n   b. DELETE /oauth2PermissionGrants/{grantId}\n4. Document review findings and actions taken\n5. Create alert for new high-privilege permission grants\n6. Implement approval for permission changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/serviceprincipal-list-approleassignments",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Periodic review of application permissions validates continued need for granted privileges and identifies permission creep, directly implementing the requirement to review and remove unnecessary privileges",
          "nistRequirement": "c. Review the privileges assigned to roles or classes of users to validate the need for such privileges; d. Reassign or remove privileges, as necessary"
        }
      ]
    },
    {
      "id": "AZ-APP-004",
      "settingName": "DelegatedPermissionsOverApplicationPermissions",
      "displayName": "Prefer Delegated Permissions Over Application Permissions",
      "settingPath": "servicePrincipals.oauth2PermissionGrants.scope",
      "policyType": "AzureAD",
      "policySubType": "ApplicationManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Delegated permissions used when user context available",
      "validationOperator": "policy",
      "description": "Use delegated permissions instead of application permissions when user context is available, limiting access to user's own permissions intersection",
      "implementationGuide": "1. For applications requiring user context:\n   a. Navigate to App registrations > [Application] > API permissions\n   b. Request delegated permissions (Type: Delegated) instead of application permissions (Type: Application)\n   c. Understand permission intersection: Effective access = MIN(delegated permission, user's permissions)\n2. Examples:\n   a. User with User role + User.ReadWrite.All delegated = Can only modify own profile\n   b. User with User Admin role + User.ReadWrite.All delegated = Can modify all users\n3. Reserve application permissions for:\n   a. Background services without user sign-in\n   b. Daemon/service applications\n   c. Automation requiring access beyond user permissions\n4. Document why application permissions required\n5. Review application permission usage quarterly\n6. Migrate to delegated permissions where feasible",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/permissions-overview#delegated-permissions",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Delegated permissions implement least privilege by limiting application access to the intersection of granted permissions and user's actual permissions, preventing privilege escalation",
          "nistRequirement": "a. Allow only authorized system access for processes acting on behalf of users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-AU-001",
      "settingName": "AdministrativeUnitForScopedAdministration",
      "displayName": "Administrative Units for Scoped Administration",
      "settingPath": "administrativeUnits",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnits",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "membershipType": "Dynamic",
        "membershipRule": "Defined based on user/device attributes"
      },
      "validationOperator": "exists",
      "description": "Create Administrative Units to scope role assignments to specific organizational boundaries, implementing least privilege at the scope level",
      "implementationGuide": "1. Requires Azure AD Premium P1 or P2 license\n2. Navigate to Azure AD > Administrative units\n3. Click 'New administrative unit'\n4. Configure AU:\n   a. Name: Organizational unit name (e.g., 'Marketing Department', 'US Region')\n   b. Description: Purpose and scope\n   c. Membership type:\n      - Dynamic: Auto-populate based on attributes\n      - Assigned: Manually add users/devices/groups\n5. For dynamic membership:\n   a. Define membership rules (e.g., department equals Marketing)\n6. Add role assignments scoped to AU:\n   a. Select AU > 'Roles and administrators'\n   b. Add role assignment\n   c. Select role (e.g., User Administrator)\n   d. Select user/group to assign\n7. Common AU scenarios:\n   a. Geographic regions\n   b. Departments/business units\n   c. Device types or locations\n8. Document AU structure and role assignment strategy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/administrative-units",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Administrative Units implement least privilege by limiting the scope of role assignments to specific organizational boundaries, reducing the blast radius of administrative access",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks"
        }
      ]
    },
    {
      "id": "AZ-AU-002",
      "settingName": "RestrictedManagementAdministrativeUnits",
      "displayName": "Restricted Management Administrative Units",
      "settingPath": "administrativeUnits.isMemberManagementRestricted",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnits",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable restricted management on Administrative Units to prevent modifications by administrators outside the AU scope",
      "implementationGuide": "1. Navigate to Azure AD > Administrative units\n2. Select existing AU or create new\n3. Under AU settings:\n   a. Enable 'Restrict management'\n   b. This prevents Global Administrators from modifying AU members unless they have scoped role on the AU\n4. Use for sensitive organizational units:\n   a. Executive leadership\n   b. Security/compliance team\n   c. Finance department\n5. Assign AU-scoped administrators:\n   a. Only users with role assignment scoped to this AU can manage members\n6. Verify Global Admins cannot bypass restriction (except specific scoped assignments)\n7. Document restricted AUs and justification\n8. Requires Azure AD Premium P1 or P2 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-restricted-management",
      "controlMappings": [
        {
          "controlId": "03.01.05",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Restricted management AUs implement additional least privilege controls by preventing even Global Administrators from managing sensitive organizational units without explicit scoped access",
          "nistRequirement": "a. Allow only authorized system access for users that is necessary to accomplish assigned organizational tasks; b. Authorize access to organization-defined security functions"
        }
      ]
    }
  ],
  "summary": {
    "totalSettings": 32,
    "byPolicyType": {
      "AzureAD": 16,
      "Intune": 6,
      "AzureAD_PIM": 6,
      "AzureAD_Governance": 6
    },
    "byPlatform": {
      "All": 26,
      "Windows": 6
    },
    "byConfidence": {
      "High": 28,
      "Medium": 4,
      "Low": 0
    },
    "byRequired": {
      "Required": 24,
      "Recommended": 8
    }
  },
  "implementationNotes": [
    "Least privilege implementation requires multi-layered approach across Azure AD roles, PIM, access reviews, endpoint management, and application permissions",
    "PIM is critical for implementing just-in-time privileged access and requires Azure AD Premium P2 licensing",
    "Access reviews should run at minimum monthly for highly privileged roles (Global Admin, Privileged Role Admin, Security Admin)",
    "Endpoint Privilege Management (EPM) is currently in preview and requires Microsoft Intune Suite license",
    "Windows LAPS supports only Azure AD joined devices; hybrid joined devices require legacy LAPS",
    "Administrative Units require Azure AD Premium P1 minimum, with restricted management requiring P2",
    "Emergency access accounts are exempt from least privilege restrictions to prevent lockout scenarios",
    "Custom roles enable precise permission grants but require careful design and documentation",
    "Application permission reviews should occur quarterly minimum to prevent permission creep",
    "Service principal role assignment limit (100 per principal at non-tenant scope) is enforced by Azure AD"
  ],
  "graphApiLimitations": [
    "Full support for Azure AD role assignments, PIM configuration, and Administrative Units via Microsoft Graph",
    "Access review management fully supported via Microsoft Graph API",
    "Intune RBAC and Account Protection policies accessible via Microsoft Graph",
    "Application and service principal permission management fully supported",
    "Real-time permission revocation via Graph API for immediate least privilege enforcement"
  ],
  "powerShellAlternatives": [
    "AzureAD PowerShell: Get-AzureADDirectoryRole, Add-AzureADDirectoryRoleMember (legacy, being deprecated)",
    "Microsoft Graph PowerShell: Get-MgDirectoryRole, New-MgDirectoryRoleMemberByRef (recommended)",
    "Microsoft Graph PowerShell: Get-MgIdentityGovernanceAccessReview* cmdlets for access review management",
    "Azure AD PowerShell: Get-AzureADMSPrivilegedRoleDefinition (for PIM, legacy)",
    "Microsoft.Graph.Identity.Governance module for PIM and access reviews"
  ]
}
