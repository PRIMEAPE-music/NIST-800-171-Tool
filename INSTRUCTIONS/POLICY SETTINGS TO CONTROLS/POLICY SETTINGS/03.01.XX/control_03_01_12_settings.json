{
  "version": "1.0.0",
  "controlId": "03.01.12",
  "controlTitle": "Remote Access",
  "nistRevision": "3",
  "lastUpdated": "2024-11-16",
  "researchDate": "2024-11-16",
  "totalSettings": 20,
  "description": "Comprehensive M365 settings catalog for NIST 800-171 Rev 3 Control 03.01.12 - Remote Access. Covers Conditional Access Named Locations, Application Proxy, PIM/JIT access, VPN profiles, and remote desktop settings.",
  "categories": {
    "conditionalAccessLocations": 8,
    "applicationProxy": 6,
    "privilegedIdentityManagement": 8,
    "vpnProfiles": 10,
    "remoteDesktopSettings": 6,
    "additionalRemoteAccessControls": 4
  },
  "settings": [
    {
      "id": "AZ-AC-036",
      "settingName": "displayName",
      "displayName": "Named Location Display Name",
      "settingPath": "displayName",
      "policyType": "AzureAD",
      "policySubType": "NamedLocations",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "<organization-defined-name>",
      "validationOperator": "matches",
      "description": "Human-readable name for the named location used to define authorized access points for remote access",
      "implementationGuide": "Step-by-step:\n1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Named locations\n3. Click 'New location'\n4. Enter descriptive name (e.g., 'Corporate VPN IP Ranges', 'Authorized Remote Offices', or 'Trusted Cloud Gateways')\n5. Choose location type: IP ranges location or Countries/Regions location\n6. Configure location details based on type selected\n7. Save the named location",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Named locations define authorized access control points for remote access to the system, directly satisfying the requirement to route remote access through managed access control points",
          "nistRequirement": "03.01.12.c - Route remote access to the system through authorized and managed access control points"
        }
      ]
    },
    {
      "id": "AZ-AC-037",
      "settingName": "isTrusted",
      "displayName": "Mark as Trusted Location",
      "settingPath": "isTrusted",
      "policyType": "AzureAD",
      "policySubType": "NamedLocations",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Designates whether the named location represents a trusted network location (e.g., corporate network, authorized VPN endpoints, managed remote access points)",
      "implementationGuide": "Step-by-step:\n1. When creating or editing an IP ranges named location\n2. Enable the 'Mark as trusted location' checkbox\n3. Only mark locations as trusted if they represent organization-controlled network infrastructure\n4. Trusted locations are used by Azure AD Identity Protection to reduce false positives\n5. Can be used in Conditional Access policies to reduce MFA prompts from corporate networks\n6. Review and validate trusted location designations quarterly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Trusted location designation establishes usage restrictions and configuration requirements for allowable remote system access by explicitly identifying authorized access control points",
          "nistRequirement": "03.01.12.a - Establish usage restrictions, configuration requirements, and connection requirements for each type of allowable remote system access"
        }
      ]
    },
    {
      "id": "AZ-AC-038",
      "settingName": "ipRanges",
      "displayName": "IP Address Ranges",
      "settingPath": "ipRanges",
      "policyType": "AzureAD",
      "policySubType": "NamedLocations",
      "platform": "All",
      "dataType": "array",
      "expectedValue": [
        "<cidr-notation-ip-ranges>"
      ],
      "validationOperator": "contains",
      "description": "List of IPv4/IPv6 address ranges in CIDR notation that define authorized remote access points (e.g., VPN gateway IPs, office network ranges)",
      "implementationGuide": "Step-by-step:\n1. Gather all authorized remote access IP ranges (VPN gateways, cloud proxies, office locations)\n2. Convert IP ranges to CIDR notation (e.g., 203.0.113.0/24)\n3. In Named location configuration, select 'IP ranges location'\n4. Add each IP range using the + button\n5. Ensure CIDR masks are /8 or greater (smaller subnets)\n6. Maximum 2000 IP ranges per named location\n7. Document the purpose of each IP range for audit purposes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "IP address ranges define the specific network locations through which remote access connections must be routed, providing technical enforcement of managed access control points",
          "nistRequirement": "03.01.12.c - Route remote access to the system through authorized and managed access control points"
        }
      ]
    },
    {
      "id": "AZ-AC-039",
      "settingName": "countriesAndRegions",
      "displayName": "Countries and Regions",
      "settingPath": "countriesAndRegions",
      "policyType": "AzureAD",
      "policySubType": "NamedLocations",
      "platform": "All",
      "dataType": "array",
      "expectedValue": [
        "<country-codes>"
      ],
      "validationOperator": "in",
      "description": "List of countries/regions from which remote access is authorized, supporting geographic-based access restrictions",
      "implementationGuide": "Step-by-step:\n1. Determine which countries/regions have authorized remote workers or offices\n2. In Named locations, select 'Countries location'\n3. Choose location determination method: IP address or GPS coordinates\n4. Select authorized countries from the list\n5. Optionally include 'unknown countries/regions' for IP addresses that can't be mapped\n6. GPS coordinate method requires Microsoft Authenticator app on user devices\n7. Document business justification for each authorized country",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Country-based location restrictions establish geographic usage restrictions for remote access, providing an additional layer of access control for organizations with defined geographic presence",
          "nistRequirement": "03.01.12.a - Establish usage restrictions, configuration requirements, and connection requirements for each type of allowable remote system access"
        }
      ]
    },
    {
      "id": "AZ-AC-040",
      "settingName": "conditions.locations.includeLocations",
      "displayName": "Conditional Access - Include Locations",
      "settingPath": "conditions.locations.includeLocations",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": [
        "<named-location-ids>",
        "AllTrusted"
      ],
      "validationOperator": "in",
      "description": "Specifies which named locations are included in the Conditional Access policy scope for enforcing remote access requirements",
      "implementationGuide": "Step-by-step:\n1. Create or edit a Conditional Access policy\n2. Under Conditions, select 'Locations'\n3. Configure to 'Yes'\n4. Under Include, select 'Selected locations'\n5. Choose specific named locations OR 'All trusted locations' OR 'Any location'\n6. Include locations represent WHERE the policy applies\n7. Combine with grant/session controls to enforce access requirements\n8. Test in report-only mode before enabling",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Including specific locations in Conditional Access policies authorizes those remote access types and enforces that connections must originate from designated access control points",
          "nistRequirement": "03.01.12.b - Authorize each type of remote system access prior to establishing such connections"
        }
      ]
    },
    {
      "id": "AZ-AC-041",
      "settingName": "conditions.locations.excludeLocations",
      "displayName": "Conditional Access - Exclude Locations",
      "settingPath": "conditions.locations.excludeLocations",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": [
        "<named-location-ids>"
      ],
      "validationOperator": "in",
      "description": "Specifies which named locations are excluded from Conditional Access policy enforcement, allowing differentiated requirements based on access location",
      "implementationGuide": "Step-by-step:\n1. In Conditional Access policy location conditions\n2. Under Exclude, select 'Selected locations'\n3. Choose named locations to exclude from policy enforcement\n4. Common use: Exclude trusted office locations from MFA requirements\n5. Exclude locations override include statements\n6. Use carefully to avoid security gaps\n7. Document exclusion rationale for compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Excluding trusted locations from certain policy requirements establishes differentiated configuration requirements based on the type and source of remote access",
          "nistRequirement": "03.01.12.a - Establish usage restrictions, configuration requirements, and connection requirements for each type of allowable remote system access"
        }
      ]
    },
    {
      "id": "AZ-AC-042",
      "settingName": "grantControls.builtInControls",
      "displayName": "Conditional Access Grant Controls for Remote Access",
      "settingPath": "grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": [
        "mfa",
        "compliantDevice",
        "domainJoinedDevice"
      ],
      "validationOperator": "contains",
      "description": "Enforces specific security controls (MFA, device compliance, domain join) before granting remote access to resources",
      "implementationGuide": "Step-by-step:\n1. In Conditional Access policy, navigate to Grant section\n2. Select 'Grant access'\n3. Check required controls: 'Require multifactor authentication', 'Require device to be marked as compliant', 'Require Hybrid Azure AD joined device'\n4. Choose 'Require all the selected controls' for strongest security\n5. Apply policy to remote access scenarios (e.g., exclude trusted locations)\n6. Test policy in report-only mode\n7. Monitor sign-in logs for blocked users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Grant controls enforce configuration and security requirements that must be met before authorizing remote access connections, directly implementing usage restrictions and connection requirements",
          "nistRequirement": "03.01.12.a - Establish usage restrictions, configuration requirements, and connection requirements for each type of allowable remote system access; 03.01.12.b - Authorize each type of remote system access prior to establishing such connections"
        }
      ]
    },
    {
      "id": "AZ-AC-043",
      "settingName": "conditions.locations.includeLocations",
      "displayName": "Block Access from Untrusted Locations",
      "settingPath": "grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": [
        "block"
      ],
      "validationOperator": "==",
      "description": "Blocks remote access attempts from locations not defined as authorized access points, enforcing routing through managed infrastructure",
      "implementationGuide": "Step-by-step:\n1. Create new Conditional Access policy for blocking unauthorized locations\n2. Under Assignments > Users, select 'All users' (exclude break-glass accounts)\n3. Under Conditions > Locations, set to 'Any location'\n4. Under Exclude locations, select only authorized named locations\n5. Under Grant controls, select 'Block access'\n6. Set policy to report-only initially for testing\n7. Review sign-in logs for legitimate blocks\n8. Enable policy after validation period",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-location",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Blocking access from unauthorized locations enforces that all remote access must be routed through defined and managed access control points",
          "nistRequirement": "03.01.12.c - Route remote access to the system through authorized and managed access control points"
        }
      ]
    },
    {
      "id": "AZ-AC-044",
      "settingName": "onPremisesPublishing.externalUrl",
      "displayName": "Application Proxy External URL",
      "settingPath": "onPremisesPublishing.externalUrl",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "https://<appname>-<tenant>.msappproxy.net",
      "validationOperator": "matches",
      "description": "External URL through which remote users access on-premises applications, serving as a managed access control point",
      "implementationGuide": "Step-by-step:\n1. Sign in to Microsoft Entra admin center\n2. Navigate to Enterprise applications > Application proxy\n3. Select 'Configure an app'\n4. Enter Internal URL of on-premises application\n5. Azure AD assigns external URL automatically (format: https://<appname>-<tenant>.msappproxy.net)\n6. Optionally configure custom domain after initial setup\n7. This external URL becomes the authorized access point for remote users\n8. Internal application remains protected behind firewall",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-add-on-premises-application",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Application Proxy external URL serves as the authorized and managed access control point for remote access to on-premises applications, routing all remote connections through Azure AD authentication",
          "nistRequirement": "03.01.12.c - Route remote access to the system through authorized and managed access control points"
        }
      ]
    },
    {
      "id": "AZ-AC-045",
      "settingName": "onPremisesPublishing.internalUrl",
      "displayName": "Application Proxy Internal URL",
      "settingPath": "onPremisesPublishing.internalUrl",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "http://internal-server.contoso.com",
      "validationOperator": "matches",
      "description": "Internal URL of the on-premises application that Application Proxy connectors will access on behalf of remote users",
      "implementationGuide": "Step-by-step:\n1. Identify the internal URL/FQDN of the application (e.g., http://sharepoint.internal.local)\n2. In Application Proxy configuration, enter this URL in 'Internal URL' field\n3. Internal URL must be accessible from connector servers\n4. Can use HTTP or HTTPS\n5. Ensure DNS resolution works from connector servers\n6. Test connectivity from connector to internal URL before completing setup",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-add-on-premises-application",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "Medium",
          "isRequired": true,
          "mappingRationale": "Internal URL configuration establishes the connection requirements between the managed access control point (Application Proxy) and the protected system",
          "nistRequirement": "03.01.12.a - Establish usage restrictions, configuration requirements, and connection requirements for each type of allowable remote system access"
        }
      ]
    },
    {
      "id": "AZ-AC-046",
      "settingName": "onPremisesPublishing.isOnPremPublishingEnabled",
      "displayName": "Application Proxy Publishing Enabled",
      "settingPath": "onPremisesPublishing.isOnPremPublishingEnabled",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Indicates whether the application is published for remote access through Application Proxy, establishing it as an authorized remote access method",
      "implementationGuide": "Step-by-step:\n1. Complete Application Proxy configuration with external and internal URLs\n2. Assign at least one connector group\n3. Configure pre-authentication (Azure AD recommended)\n4. Save the application\n5. Publishing is automatically enabled when configuration is complete\n6. Verify publishing status in application properties\n7. Test remote access through external URL",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-add-on-premises-application",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Enabling Application Proxy publishing authorizes this specific remote access method and activates the managed access control point for the application",
          "nistRequirement": "03.01.12.b - Authorize each type of remote system access prior to establishing such connections"
        }
      ]
    },
    {
      "id": "AZ-AC-047",
      "settingName": "onPremisesPublishing.externalAuthenticationType",
      "displayName": "Application Proxy Pre-Authentication",
      "settingPath": "onPremisesPublishing.externalAuthenticationType",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "aadPreAuthentication",
      "validationOperator": "==",
      "description": "Requires Azure AD authentication before allowing remote access through Application Proxy, enforcing authorization requirements",
      "implementationGuide": "Step-by-step:\n1. In Application Proxy configuration, locate 'Pre Authentication' setting\n2. Select 'Azure Active Directory' (recommended for security)\n3. Alternative 'Passthrough' should only be used for public content\n4. With Azure AD pre-authentication:\n   - Users must authenticate to Azure AD first\n   - Conditional Access policies apply\n   - MFA can be enforced\n   - Only authenticated users reach backend application\n5. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-security",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Pre-authentication with Azure AD ensures users are authorized before remote access connections are established, enforcing authentication and authorization requirements",
          "nistRequirement": "03.01.12.b - Authorize each type of remote system access prior to establishing such connections"
        }
      ]
    },
    {
      "id": "AZ-AC-048",
      "settingName": "onPremisesPublishing.applicationServerTimeout",
      "displayName": "Application Proxy Backend Timeout",
      "settingPath": "onPremisesPublishing.applicationServerTimeout",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Long",
      "validationOperator": "in",
      "description": "Configures timeout settings for connections between Application Proxy connector and backend applications",
      "implementationGuide": "Step-by-step:\n1. In Application Proxy advanced settings\n2. Locate 'Backend application timeout' setting\n3. Options: Default (85 seconds) or Long (180 seconds)\n4. Choose based on application requirements\n5. Long timeout recommended for:\n   - Applications with slow authentication\n   - Large file uploads/downloads\n   - Report generation\n6. Monitor connector logs for timeout issues",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-add-on-premises-application",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "Low",
          "isRequired": false,
          "mappingRationale": "Timeout configuration establishes connection requirements for the specific type of remote access through Application Proxy",
          "nistRequirement": "03.01.12.a - Establish usage restrictions, configuration requirements, and connection requirements for each type of allowable remote system access"
        }
      ]
    },
    {
      "id": "AZ-AC-049",
      "settingName": "onPremisesPublishing.connectorGroupId",
      "displayName": "Application Proxy Connector Group",
      "settingPath": "onPremisesPublishing.connectorGroupId",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "<connector-group-guid>",
      "validationOperator": "matches",
      "description": "Assigns the application to a specific connector group, defining which physical connectors serve as managed access points",
      "implementationGuide": "Step-by-step:\n1. Navigate to Application proxy > Connector groups\n2. Create logical connector groups (e.g., by location, network segment, security zone)\n3. Assign installed connectors to appropriate groups\n4. In application configuration, select connector group\n5. Connector group determines which physical servers handle traffic\n6. Use multiple connectors per group for high availability\n7. Place connectors close to backend applications to reduce latency",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-connector-groups",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Connector group assignment defines the specific managed access control points (physical connector servers) through which remote access traffic is routed",
          "nistRequirement": "03.01.12.c - Route remote access to the system through authorized and managed access control points"
        }
      ]
    },
    {
      "id": "AZ-AC-050",
      "settingName": "roleSettings.activationDuration",
      "displayName": "PIM Maximum Activation Duration",
      "settingPath": "roleSettings.activationDuration",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "PT8H",
      "validationOperator": "<=",
      "description": "Maximum duration for which privileged remote access roles can be activated via PIM",
      "implementationGuide": "Step-by-step:\\n1. Sign in to Microsoft Entra admin center\\n2. Navigate to Identity Governance > Privileged Identity Management > Azure AD roles\\n3. Select Roles > Select role (e.g., Global Administrator)\\n4. Click 'Settings' > 'Edit'\\n5. Set 'Activation maximum duration (hours)'\\n6. Recommended: 4-8 hours maximum\\n7. Save settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "PIM activation duration establishes time-based usage restrictions for privileged remote access",
          "nistRequirement": "03.01.12.a - Establish usage restrictions; 03.01.12.d - Authorize remote execution of privileged commands"
        }
      ]
    },
    {
      "id": "AZ-AC-051",
      "settingName": "roleSettings.approvalRequired",
      "displayName": "PIM Approval Requirement",
      "settingPath": "roleSettings.approvalRequired",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires approval before activating privileged roles for remote administrative access",
      "implementationGuide": "Step-by-step:\\n1. In PIM role settings\\n2. Enable 'Require approval to activate'\\n3. Add specific approvers\\n4. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Approval requirements ensure privileged remote access is explicitly authorized",
          "nistRequirement": "03.01.12.b - Authorize remote system access; 03.01.12.d - Authorize privileged commands"
        }
      ]
    },
    {
      "id": "IN-AC-036",
      "settingName": "servers",
      "displayName": "VPN Server Configuration",
      "settingPath": "servers",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-VPN",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": [
        "vpn.contoso.com"
      ],
      "validationOperator": "contains",
      "description": "Defines VPN gateway servers for managed remote access",
      "implementationGuide": "Step-by-step:\\n1. In Intune VPN profile\\n2. Add VPN servers\\n3. Configure authentication\\n4. Deploy to users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/vpn-settings-windows-10",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "VPN server configuration defines managed access control points",
          "nistRequirement": "03.01.12.c - Route remote access through managed access control points"
        }
      ]
    },
    {
      "id": "IN-AC-037",
      "settingName": "connectionType",
      "displayName": "VPN Connection Type",
      "settingPath": "connectionType",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-VPN",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "ikEv2",
      "validationOperator": "in",
      "description": "Specifies VPN protocol type for secure remote connections",
      "implementationGuide": "Step-by-step:\\n1. Select IKEv2 connection type\\n2. Configure certificates\\n3. Deploy profile",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/vpn-settings-windows-10",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Connection type establishes technical configuration requirements",
          "nistRequirement": "03.01.12.a - Establish configuration requirements"
        }
      ]
    },
    {
      "id": "IN-AC-042",
      "settingName": "fDenyTSConnections",
      "displayName": "Allow Remote Desktop Connections",
      "settingPath": "fDenyTSConnections",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-AdministrativeTemplates",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 0,
      "validationOperator": "==",
      "description": "Authorizes RDP as approved remote access method",
      "implementationGuide": "Step-by-step:\\n1. Create Administrative Templates profile\\n2. Enable RDP connections\\n3. Configure firewall\\n4. Deploy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/administrative-templates-windows",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Authorizes RDP as remote access type",
          "nistRequirement": "03.01.12.b - Authorize remote system access"
        }
      ]
    },
    {
      "id": "IN-AC-043",
      "settingName": "UserAuthentication",
      "displayName": "Require Network Level Authentication",
      "settingPath": "UserAuthentication",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-AdministrativeTemplates",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 1,
      "validationOperator": "==",
      "description": "Requires NLA for RDP connections",
      "implementationGuide": "Step-by-step:\\n1. Enable NLA requirement\\n2. Deploy to devices\\n3. Test connections",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-server/remote/remote-desktop-services/clients/remote-desktop-allow-access",
      "controlMappings": [
        {
          "controlId": "03.01.12",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "NLA enforces authorization before connection",
          "nistRequirement": "03.01.12.b - Authorize remote access"
        }
      ]
    }
  ]
}