{
  "controlId": "03.01.02",
  "controlTitle": "Access Enforcement",
  "requirementText": "Enforce approved authorizations for logical access to CUI and system resources in accordance with applicable access control policies.",
  "researchDate": "2024-11-16",
  "totalSettings": 32,
  "settings": [
    {
      "id": "AZ-CA-036",
      "settingName": "state",
      "displayName": "Conditional Access Policy State",
      "settingPath": "properties.state",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "enabled",
      "validationOperator": "==",
      "description": "Enforces that Conditional Access policies are in enabled state to actively enforce access controls",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Entra ID > Protection > Conditional Access\n3. Select the policy\n4. Set 'Enable policy' to 'On'\n5. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Ensures that access control policies are actively enforced rather than in report-only or disabled state",
          "nistRequirement": "Enforce approved authorizations for logical access"
        }
      ]
    },
    {
      "id": "AZ-CA-037",
      "settingName": "builtInControls",
      "displayName": "Conditional Access - Require MFA",
      "settingPath": "properties.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ["mfa"],
      "validationOperator": "contains",
      "description": "Enforces multi-factor authentication as an access control before granting access to CUI and system resources",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Grant\n4. Check 'Require multifactor authentication'\n5. Set 'For multiple controls' to appropriate setting\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "MFA is a critical access enforcement mechanism that validates user authorization before granting access",
          "nistRequirement": "Enforce approved authorizations for logical access"
        }
      ]
    },
    {
      "id": "AZ-CA-038",
      "settingName": "builtInControls",
      "displayName": "Conditional Access - Require Compliant Device",
      "settingPath": "properties.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ["compliantDevice"],
      "validationOperator": "contains",
      "description": "Enforces device compliance as an access requirement, ensuring only authorized and compliant devices can access CUI",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Grant\n4. Check 'Require device to be marked as compliant'\n5. Configure compliance policies in Intune\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Device compliance enforcement ensures only authorized devices meeting security baselines can access resources",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "AZ-CA-039",
      "settingName": "builtInControls",
      "displayName": "Conditional Access - Require Hybrid Azure AD Joined Device",
      "settingPath": "properties.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": ["domainJoinedDevice"],
      "validationOperator": "contains",
      "description": "Enforces that devices must be hybrid Azure AD joined to access resources, ensuring device identity verification",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Grant\n4. Check 'Require Hybrid Azure AD joined device'\n5. Configure Azure AD Connect for hybrid join\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Hybrid Azure AD joined devices provide strong device identity verification for access enforcement",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "AZ-CA-040",
      "settingName": "builtInControls",
      "displayName": "Conditional Access - Require Approved Client App",
      "settingPath": "properties.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "iOS,Android",
      "dataType": "array",
      "expectedValue": ["approvedApplication"],
      "validationOperator": "contains",
      "description": "Enforces use of approved client applications for mobile access, controlling which apps can access CUI",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Grant\n4. Check 'Require approved client app'\n5. Configure approved apps in Intune\n6. Save and enable policy\n\nNote: This control is being deprecated in March 2026, migrate to 'Require app protection policy'",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Approved client apps enforce application-level access controls for mobile devices accessing CUI",
          "nistRequirement": "Access enforcement mechanisms at the application level for increased protection"
        }
      ]
    },
    {
      "id": "AZ-CA-041",
      "settingName": "builtInControls",
      "displayName": "Conditional Access - Require App Protection Policy",
      "settingPath": "properties.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "iOS,Android",
      "dataType": "array",
      "expectedValue": ["compliantApplication"],
      "validationOperator": "contains",
      "description": "Enforces that apps must have an Intune app protection policy applied before accessing CUI, providing application-level access control",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Grant\n4. Check 'Require app protection policy'\n5. Create and assign app protection policies in Intune\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "App protection policies provide application-level access enforcement and data protection for CUI accessed on mobile devices",
          "nistRequirement": "Access enforcement mechanisms at the application level to provide increased protection for CUI"
        }
      ]
    },
    {
      "id": "AZ-CA-042",
      "settingName": "operator",
      "displayName": "Conditional Access - Grant Control Operator",
      "settingPath": "properties.grantControls.operator",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "AND",
      "validationOperator": "==",
      "description": "Defines whether all selected grant controls must be satisfied (AND) or at least one (OR) to enforce access",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Grant\n4. Select 'Require all the selected controls' (for AND) or 'Require one of the selected controls' (for OR)\n5. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Determines the enforcement logic for multiple access controls, ensuring appropriate authorization requirements",
          "nistRequirement": "Enforce approved authorizations in accordance with applicable access control policies"
        }
      ]
    },
    {
      "id": "AZ-CA-043",
      "settingName": "sessionControls.applicationEnforcedRestrictions.isEnabled",
      "displayName": "Conditional Access - Application Enforced Restrictions",
      "settingPath": "properties.sessionControls.applicationEnforcedRestrictions.isEnabled",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables application-enforced restrictions for SharePoint Online and Exchange Online to limit access based on device state",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Session\n4. Check 'Use app enforced restrictions'\n5. Configure for SharePoint Online and Exchange Online\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Application-level access restrictions enforce additional controls within applications for accessing CUI",
          "nistRequirement": "Access enforcement mechanisms at the application level"
        }
      ]
    },
    {
      "id": "AZ-CA-044",
      "settingName": "sessionControls.cloudAppSecurity.isEnabled",
      "displayName": "Conditional Access - Defender for Cloud Apps Control",
      "settingPath": "properties.sessionControls.cloudAppSecurity.isEnabled",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Defender for Cloud Apps to enforce access policies and monitor sessions accessing CUI",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Session\n4. Check 'Use Conditional Access App Control'\n5. Select enforcement mode (Monitor only or Block downloads)\n6. Configure policies in Microsoft Defender for Cloud Apps\n7. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Defender for Cloud Apps provides real-time access enforcement and session monitoring for cloud applications",
          "nistRequirement": "Enforce approved authorizations for logical access to CUI"
        }
      ]
    },
    {
      "id": "AZ-CA-045",
      "settingName": "sessionControls.signInFrequency.isEnabled",
      "displayName": "Conditional Access - Sign-in Frequency",
      "settingPath": "properties.sessionControls.signInFrequency.isEnabled",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces how often users must re-authenticate when accessing CUI, ensuring continuous authorization validation",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Session\n4. Check 'Sign-in frequency'\n5. Set frequency value (e.g., 1 hour, 1 day)\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Regular re-authentication enforces continuous validation of approved authorizations",
          "nistRequirement": "Enforce approved authorizations for logical access"
        }
      ]
    },
    {
      "id": "AZ-RBAC-001",
      "settingName": "roleDefinitionId",
      "displayName": "Azure AD Role Assignment - Role Definition",
      "settingPath": "properties.roleDefinitionId",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "<valid-role-guid>",
      "validationOperator": "matches",
      "description": "Defines which Azure AD role is assigned to principals, enforcing role-based access control for administration",
      "implementationGuide": "1. Navigate to Entra ID > Roles and administrators\n2. Select appropriate role\n3. Click 'Add assignments'\n4. Select users/groups/service principals\n5. Define scope (directory, administrative unit, or application)\n6. Add assignment",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/manage-roles-portal",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "RBAC role assignments enforce approved authorizations for administrative access to directory and system resources",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "AZ-RBAC-002",
      "settingName": "principalId",
      "displayName": "Azure AD Role Assignment - Principal ID",
      "settingPath": "properties.principalId",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "<valid-principal-guid>",
      "validationOperator": "matches",
      "description": "Identifies the user, group, or service principal that is granted role-based access",
      "implementationGuide": "1. Navigate to Entra ID > Roles and administrators\n2. Select role\n3. Review 'Assignments' tab\n4. Verify principal IDs match authorized users/groups/service principals\n5. Remove unauthorized assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/manage-roles-portal",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Principal assignments determine which entities are authorized for specific access levels",
          "nistRequirement": "Enforce approved authorizations for logical access"
        }
      ]
    },
    {
      "id": "AZ-RBAC-003",
      "settingName": "directoryScopeId",
      "displayName": "Azure AD Role Assignment - Directory Scope",
      "settingPath": "properties.directoryScopeId",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "/",
      "validationOperator": "matches",
      "description": "Defines the scope of the role assignment (tenant-wide '/', administrative unit '/administrativeUnits/{id}', or application '/{id}')",
      "implementationGuide": "1. Navigate to Entra ID > Roles and administrators\n2. Select role\n3. When adding assignment, choose scope:\n   - Tenant: Leave at root '/'\n   - Administrative Unit: Select specific AU\n   - Application: Select specific app registration\n4. Complete assignment",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/custom-overview",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Scoped role assignments enforce least-privilege access by limiting administrative permissions to specific resources",
          "nistRequirement": "Enforce approved authorizations in accordance with applicable access control policies"
        }
      ]
    },
    {
      "id": "AZ-RBAC-004",
      "settingName": "assignmentType",
      "displayName": "Azure AD Role Assignment - Assignment Type",
      "settingPath": "properties.assignmentType",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Assigned",
      "validationOperator": "in",
      "description": "Indicates if assignment is direct (Assigned), inherited (Inherited), or eligible for activation (Eligible via PIM)",
      "implementationGuide": "1. Navigate to Entra ID > Roles and administrators\n2. Select role\n3. Review 'Assignments' tab\n4. Check 'Assignment type' column\n5. For PIM-eligible: Navigate to Privileged Identity Management > Azure AD roles\n6. Configure eligible assignments with activation requirements",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Assignment types control how and when administrative access is granted, enforcing just-in-time access principles",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "AZ-AU-001",
      "settingName": "isMemberManagementRestricted",
      "displayName": "Administrative Unit - Restricted Management",
      "settingPath": "properties.isMemberManagementRestricted",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnit",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Restricted Management Administrative Unit (RMAU) to prevent unauthorized modification of privileged objects",
      "implementationGuide": "1. Navigate to Entra ID > Administrative units\n2. Select or create administrative unit\n3. Under 'Properties'\n4. Enable 'Restricted management administrative unit'\n5. Save changes\n6. Only Global Admins or scoped AU admins can manage members",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-restricted-management",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "RMAUs enforce access restrictions on privileged users and groups, preventing unauthorized access escalation",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "AZ-AU-002",
      "settingName": "members",
      "displayName": "Administrative Unit - Member Assignments",
      "settingPath": "members",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnit",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Defines users and groups that are members of the administrative unit, limiting scope of administrative access",
      "implementationGuide": "1. Navigate to Entra ID > Administrative units\n2. Select administrative unit\n3. Under 'Users' or 'Groups'\n4. Add members that should be managed by scoped administrators\n5. These members can only be administered by AU-scoped role assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-members-add",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "AU membership restricts which users/groups administrators can manage, enforcing scoped access control",
          "nistRequirement": "Enforce approved authorizations for logical access"
        }
      ]
    },
    {
      "id": "AZ-AU-003",
      "settingName": "scopedRoleMembers",
      "displayName": "Administrative Unit - Scoped Role Assignments",
      "settingPath": "scopedRoleMembers",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnit",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Defines which administrators have role permissions limited to this administrative unit's scope",
      "implementationGuide": "1. Navigate to Entra ID > Administrative units\n2. Select administrative unit\n3. Under 'Roles and administrators'\n4. Assign roles to specific users/groups\n5. These assignments only grant permissions over AU members\n6. Review and validate scoped assignments regularly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-assign-roles",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Scoped role assignments enforce least-privilege by limiting administrative access to specific resource subsets",
          "nistRequirement": "Enforce approved authorizations in accordance with applicable access control policies"
        }
      ]
    },
    {
      "id": "IN-APP-001",
      "settingName": "assignments",
      "displayName": "Intune App Protection Policy - User/Group Assignment",
      "settingPath": "assignments",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Defines which users or groups receive the app protection policy, enforcing application-level access controls",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Apps > App protection policies\n3. Select policy (iOS or Android)\n4. Under 'Assignments'\n5. Add user groups that should receive the policy\n6. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "App protection policy assignments enforce which users can access CUI through mobile applications",
          "nistRequirement": "Access enforcement mechanisms at the application level for increased protection"
        }
      ]
    },
    {
      "id": "IN-APP-002",
      "settingName": "dataProtection.blockDataIngestionIntoOrganizationDocuments",
      "displayName": "Intune App Protection - Block Data Ingestion",
      "settingPath": "apps[].mobileAppPolicyConfiguration.dataProtection.blockDataIngestionIntoOrganizationDocuments",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Prevents copying data from personal apps into organization-managed apps, enforcing data access boundaries",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Apps > App protection policies\n3. Select policy\n4. Under 'Data protection'\n5. Configure 'Receive data from other apps' to 'None' or 'Policy managed apps'\n6. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Data ingestion controls enforce access boundaries between personal and organizational data",
          "nistRequirement": "Access enforcement mechanisms at the application level"
        }
      ]
    },
    {
      "id": "IN-APP-003",
      "settingName": "accessRequirements.pinRequired",
      "displayName": "Intune App Protection - Require PIN",
      "settingPath": "apps[].mobileAppPolicyConfiguration.accessRequirements.pinRequired",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to enter a PIN before accessing organization apps, enforcing application-level authentication",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Apps > App protection policies\n3. Select policy\n4. Under 'Access requirements'\n5. Set 'PIN for access' to 'Required'\n6. Configure PIN type and complexity\n7. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "App PIN requirement enforces authentication before granting access to CUI at application level",
          "nistRequirement": "Enforce approved authorizations for logical access at application level"
        }
      ]
    },
    {
      "id": "IN-APP-004",
      "settingName": "conditionalLaunch.maxPinAttempts",
      "displayName": "Intune App Protection - Maximum PIN Attempts",
      "settingPath": "apps[].mobileAppPolicyConfiguration.conditionalLaunch.maxPinAttempts",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Limits failed PIN attempts before blocking or wiping app data, preventing unauthorized access",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Apps > App protection policies\n3. Select policy\n4. Under 'Conditional launch'\n5. Add condition: 'Max PIN attempts'\n6. Set value (e.g., 5)\n7. Set action (Block access or Wipe data)\n8. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "PIN attempt limits enforce access controls by preventing brute force attacks on application authentication",
          "nistRequirement": "Enforce approved authorizations for logical access"
        }
      ]
    },
    {
      "id": "IN-APP-005",
      "settingName": "conditionalLaunch.offlineGracePeriod",
      "displayName": "Intune App Protection - Offline Grace Period",
      "settingPath": "apps[].mobileAppPolicyConfiguration.conditionalLaunch.offlineGracePeriod",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "integer",
      "expectedValue": 720,
      "validationOperator": "<=",
      "description": "Defines how long (in minutes) an app can run offline before re-authentication is required",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Apps > App protection policies\n3. Select policy\n4. Under 'Conditional launch'\n5. Add condition: 'Offline grace period'\n6. Set value (e.g., 720 minutes = 12 hours)\n7. Set action (Block access or Wipe data)\n8. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "Medium",
          "isRequired": true,
          "mappingRationale": "Offline grace period ensures periodic re-validation of access authorizations even when device is offline",
          "nistRequirement": "Enforce approved authorizations for logical access"
        }
      ]
    },
    {
      "id": "SPO-PERM-001",
      "settingName": "roles",
      "displayName": "SharePoint Site Permissions - Application Role",
      "settingPath": "permissions[].roles",
      "policyType": "SharePoint",
      "policySubType": "SitePermissions",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ["read", "write", "owner"],
      "validationOperator": "in",
      "description": "Defines application-level permissions granted to Azure AD apps for SharePoint sites containing CUI (read, write, owner/fullcontrol)",
      "implementationGuide": "1. Use Microsoft Graph API or PowerShell\n2. POST to /sites/{siteId}/permissions\n3. Specify application ID and desired role\n4. Requires Sites.FullControl.All permission to grant\n5. Example roles: 'read', 'write', 'owner'\n6. Validate assignment with GET /sites/{siteId}/permissions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/permissions-selected-overview",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Site-level permissions enforce granular access control for applications accessing CUI in SharePoint",
          "nistRequirement": "Enforce approved authorizations for logical access to CUI"
        }
      ]
    },
    {
      "id": "SPO-PERM-002",
      "settingName": "grantedToIdentities",
      "displayName": "SharePoint Site Permissions - Granted Applications",
      "settingPath": "permissions[].grantedToIdentities[].application.id",
      "policyType": "SharePoint",
      "policySubType": "SitePermissions",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Lists application IDs that have been granted permissions to specific SharePoint sites, enforcing application access control",
      "implementationGuide": "1. Use Microsoft Graph API\n2. GET /sites/{siteId}/permissions\n3. Review grantedToIdentities array\n4. Verify only authorized applications have access\n5. Remove unauthorized apps with DELETE /sites/{siteId}/permissions/{permissionId}",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/permissions-selected-overview",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Application identity tracking ensures only approved applications can access CUI in SharePoint sites",
          "nistRequirement": "Enforce approved authorizations for logical access to CUI"
        }
      ]
    },
    {
      "id": "SPO-PERM-003",
      "settingName": "Sites.Selected",
      "displayName": "SharePoint - Sites.Selected Permission Scope",
      "settingPath": "requiredResourceAccess[].resourceAccess[].type",
      "policyType": "AzureAD",
      "policySubType": "ApplicationPermissions",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Role",
      "validationOperator": "==",
      "description": "Grants application permission to access only specific SharePoint sites rather than all sites, enforcing least-privilege access",
      "implementationGuide": "1. Navigate to Entra ID > App registrations\n2. Select application\n3. Under 'API permissions'\n4. Add permission > Microsoft Graph > Application permissions\n5. Select 'Sites.Selected'\n6. Grant admin consent\n7. Use Graph API to grant site-specific access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/permissions-selected-overview",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Sites.Selected permission enforces granular, site-specific access rather than tenant-wide access to CUI",
          "nistRequirement": "Enforce approved authorizations in accordance with applicable access control policies"
        }
      ]
    },
    {
      "id": "AZ-APP-001",
      "settingName": "appRoleAssignments",
      "displayName": "Azure AD Application - App Role Assignments",
      "settingPath": "appRoleAssignments",
      "policyType": "AzureAD",
      "policySubType": "ApplicationPermissions",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Lists app role assignments granted to service principals for accessing Microsoft Graph and other APIs",
      "implementationGuide": "1. Use Microsoft Graph API or PowerShell\n2. GET /servicePrincipals/{id}/appRoleAssignments\n3. Review assigned app roles\n4. Validate only required permissions are granted\n5. Remove excessive permissions\n6. Monitor for privilege escalation risks (e.g., RoleManagement.ReadWrite.Directory)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/serviceprincipal-list-approleassignments",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "App role assignments control which applications can access organizational resources and APIs",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "AZ-APP-002",
      "settingName": "resourceAppId",
      "displayName": "Azure AD Application - Resource Application ID",
      "settingPath": "appRoleAssignments[].resourceAppId",
      "policyType": "AzureAD",
      "policySubType": "ApplicationPermissions",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "00000003-0000-0000-c000-000000000000",
      "validationOperator": "==",
      "description": "Identifies the resource application (e.g., Microsoft Graph) that the app has permissions to access",
      "implementationGuide": "1. Use Microsoft Graph API\n2. GET /servicePrincipals/{id}/appRoleAssignments\n3. Check resourceAppId field\n4. Common values:\n   - Microsoft Graph: 00000003-0000-0000-c000-000000000000\n   - SharePoint: 00000003-0000-0ff1-ce00-000000000000\n5. Validate assignments are for approved resources only",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/approleassignment",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Resource application tracking ensures apps only access approved APIs and services",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "AZ-APP-003",
      "settingName": "appRoleId",
      "displayName": "Azure AD Application - Specific App Role ID",
      "settingPath": "appRoleAssignments[].appRoleId",
      "policyType": "AzureAD",
      "policySubType": "ApplicationPermissions",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "<valid-role-guid>",
      "validationOperator": "matches",
      "description": "Identifies the specific permission/app role granted (e.g., User.Read.All, Sites.Read.All)",
      "implementationGuide": "1. Use Microsoft Graph API\n2. GET /servicePrincipals/{id}/appRoleAssignments\n3. Review appRoleId values\n4. Cross-reference with resource application's appRoles\n5. Identify high-risk permissions:\n   - RoleManagement.ReadWrite.Directory\n   - AppRoleAssignment.ReadWrite.All\n   - Application.ReadWrite.All\n6. Remove or justify high-risk assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/approleassignment",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Specific app role IDs define exact permissions granted, enabling granular access enforcement",
          "nistRequirement": "Enforce approved authorizations in accordance with applicable access control policies"
        }
      ]
    },
    {
      "id": "IN-COMP-001",
      "settingName": "complianceState",
      "displayName": "Intune Device Compliance - Compliance State",
      "settingPath": "managedDevices[].complianceState",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "compliant",
      "validationOperator": "==",
      "description": "Indicates whether a device meets compliance requirements and can access CUI",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Devices > Monitor > Device compliance\n3. Review compliance state for each device\n4. Investigate non-compliant devices\n5. Remediate or block access based on policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Device compliance state enforcement ensures only authorized, compliant devices can access CUI",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "IN-COMP-002",
      "settingName": "compliancePolicyAssignments",
      "displayName": "Intune Compliance Policy - Group Assignments",
      "settingPath": "deviceCompliancePolicies[].assignments",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Defines which user/device groups receive compliance policies that enforce access requirements",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Devices > Compliance policies\n3. Select policy (Windows, iOS, Android, macOS)\n4. Under 'Assignments'\n5. Add groups that should receive the policy\n6. Configure inclusion and exclusion groups\n7. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Compliance policy assignments determine which devices must meet requirements before accessing CUI",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "AZ-PIM-001",
      "settingName": "justInTimeAccess",
      "displayName": "Privileged Identity Management - Just-in-Time Access",
      "settingPath": "roleManagementPolicies[].rules[].ruleType",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "ExpirationRule",
      "validationOperator": "==",
      "description": "Enforces time-limited activation of privileged roles, ensuring access is granted only when needed",
      "implementationGuide": "1. Navigate to Entra ID > Privileged Identity Management\n2. Select Azure AD roles or Azure resources\n3. Select role to configure\n4. Under 'Settings'\n5. Configure activation duration (max 8 hours recommended)\n6. Require justification on activation\n7. Require approval if needed\n8. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Just-in-time access enforces time-bound authorization for privileged access to system resources",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "AZ-PIM-002",
      "settingName": "approvalRequired",
      "displayName": "Privileged Identity Management - Approval Required",
      "settingPath": "roleManagementPolicies[].rules[].setting.isApprovalRequired",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires approval before privileged role activation, enforcing multi-person authorization",
      "implementationGuide": "1. Navigate to Entra ID > Privileged Identity Management\n2. Select Azure AD roles\n3. Select role to configure\n4. Under 'Settings' > 'Activation'\n5. Check 'Require approval to activate'\n6. Add approvers (minimum 2 recommended)\n7. Configure approval timeout\n8. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-resource-roles-approval-workflow",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Approval requirements enforce multi-person authorization before granting privileged access",
          "nistRequirement": "Enforce approved authorizations for logical access to system resources"
        }
      ]
    },
    {
      "id": "AZ-CA-046",
      "settingName": "conditions.applications.includeApplications",
      "displayName": "Conditional Access - Cloud App Targeting",
      "settingPath": "properties.conditions.applications.includeApplications",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ["All", "Office365"],
      "validationOperator": "in",
      "description": "Specifies which cloud applications the access enforcement policy applies to, controlling access to CUI-containing apps",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Assignments' > Cloud apps or actions\n4. Select 'Include' > Choose 'All cloud apps' or 'Select apps'\n5. If specific apps, search and select (e.g., Office 365, SharePoint, Exchange)\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-cloud-apps",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Cloud app targeting ensures access controls are enforced for applications that process CUI",
          "nistRequirement": "Enforce approved authorizations for logical access to CUI"
        }
      ]
    },
    {
      "id": "AZ-CA-047",
      "settingName": "conditions.users.includeUsers",
      "displayName": "Conditional Access - User/Group Targeting",
      "settingPath": "properties.conditions.users.includeUsers",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ["All"],
      "validationOperator": "in",
      "description": "Specifies which users or groups the access enforcement policy applies to",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Assignments' > Users and groups\n4. Select 'Include' > Choose 'All users' or 'Select users and groups'\n5. If specific, select groups/roles\n6. Configure exclusions if needed (emergency access accounts)\n7. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-users-groups",
      "controlMappings": [
        {
          "controlId": "03.01.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "User/group targeting ensures access enforcement applies to all users accessing CUI",
          "nistRequirement": "Enforce approved authorizations for logical access"
        }
      ]
    }
  ]
}
