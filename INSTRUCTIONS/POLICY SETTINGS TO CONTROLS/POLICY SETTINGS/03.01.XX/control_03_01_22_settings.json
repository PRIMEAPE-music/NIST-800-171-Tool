{
  "controlId": "03.01.22",
  "controlTitle": "Publicly Accessible Content",
  "controlFamily": "AC",
  "nistRequirement": "a. Train authorized individuals to ensure that publicly accessible information does not contain CUI.\nb. Review the content on publicly accessible systems for CUI and remove such information, if discovered.",
  "totalSettings": 5,
  "settings": [
    {
      "id": "PV-AC-001",
      "settingName": "BlockExternalSharingBySensitivityLabel",
      "displayName": "DLP Policy - Block External Sharing of Sensitive Content",
      "settingPath": "DlpPolicy.Rules.Conditions.ContentContainsSensitivityLabel",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "action": "BlockAccess",
        "condition": "ContentShared.External"
      },
      "validationOperator": "==",
      "description": "Prevents external sharing of documents and emails containing sensitive information or CUI by detecting sensitivity labels and blocking access to external recipients, ensuring CUI does not become publicly accessible.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal\n2. Navigate to Data loss prevention > Policies\n3. Create policy > Custom > Custom policy\n4. Name: 'Block External Sharing of CUI'\n5. Locations: SharePoint sites, OneDrive accounts, Teams chat and channel messages, Exchange email\n6. Create rule: 'Block Sensitive External Sharing'\n7. Conditions: Content contains > Sensitivity labels > Select 'Internal', 'Confidential', 'Restricted' (or equivalent CUI labels)\n8. AND Content is shared from Microsoft 365 > with people outside my organization\n9. Actions: Restrict access or encrypt the content > Block people from sharing and restrict access to shared content\n10. User notifications: Enable with policy tips\n11. Test mode: Run in simulation first\n12. Turn on policy after validation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-create-deploy-policy",
      "controlMappings": [
        {
          "controlId": "03.01.22",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "This DLP policy directly enforces the requirement to prevent CUI from appearing on publicly accessible systems by automatically blocking external sharing of content labeled as sensitive. It provides technical enforcement that supplements user training by preventing accidental or intentional public exposure of CUI.",
          "nistRequirement": "Review the content on publicly accessible systems for CUI and remove such information, if discovered"
        }
      ]
    },
    {
      "id": "PV-AC-002",
      "settingName": "SharePointExternalSharingRestriction",
      "displayName": "SharePoint External Sharing - Restricted to Authenticated Users",
      "settingPath": "SharingCapability",
      "policyType": "Purview",
      "policySubType": "SharePointAdminCenter",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "ExistingExternalUserSharingOnly",
      "validationOperator": "==",
      "description": "Restricts SharePoint and OneDrive external sharing to only authenticated users who are already in the directory, preventing anonymous public links that could expose CUI.",
      "implementationGuide": "1. Sign in to SharePoint Admin Center as Global Admin or SharePoint Admin\n2. Navigate to Policies > Sharing\n3. Under 'External sharing' section\n4. For SharePoint: Move slider to 'Existing guests' (most restrictive that allows external sharing)\n5. OR set to 'Only people in your organization' to block all external sharing\n6. For OneDrive: Set same or more restrictive level\n7. Expand 'More external sharing settings'\n8. Uncheck 'Allow guests to share items they don't own'\n9. Uncheck 'Anyone links' (anonymous sharing)\n10. Set default link type to 'Only people in your organization'\n11. Save changes\n12. Communicate changes to users\n13. Monitor sharing activity through audit logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off",
      "controlMappings": [
        {
          "controlId": "03.01.22",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Prevents creation of anonymous 'Anyone with the link' sharing links that would make content publicly accessible. By restricting external sharing to authenticated users only, this setting ensures CUI cannot be inadvertently shared via public links that don't require authentication, directly supporting the NIST requirement to prevent public exposure of CUI.",
          "nistRequirement": "Train authorized individuals to ensure that publicly accessible information does not contain CUI"
        }
      ]
    },
    {
      "id": "PV-AC-003",
      "settingName": "SensitivityLabelsPublished",
      "displayName": "Sensitivity Labels with External Sharing Controls",
      "settingPath": "InformationProtection.SensitivityLabels",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Implements sensitivity labels that classify CUI and automatically apply protection settings including external sharing restrictions, encryption, and content markings to prevent public exposure.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal\n2. Navigate to Information protection > Labels\n3. Create label for CUI: 'CUI - Controlled Unclassified Information'\n4. Enable label for: Files & emails, Groups & sites\n5. Items tab > Encryption: Set 'Apply or remove encryption'\n6. Configure encryption: Restrict access > Assign permissions > Only organization members\n7. Content marking: Add header/footer 'CUI - Internal Use Only'\n8. Files and emails tab > External sharing: 'Block external sharing'\n9. Auto-labeling: Create auto-labeling policy to detect CUI patterns\n10. Create label policy to publish labels to all users\n11. Label policy settings: Require users to apply a label to email and documents\n12. Train users on label usage and CUI identification\n13. Monitor label usage through Information protection analytics",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/create-sensitivity-labels",
      "controlMappings": [
        {
          "controlId": "03.01.22",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Sensitivity labels provide persistent classification and protection of CUI that travels with the content. Labels with external sharing restrictions and encryption ensure that even if users attempt to share CUI externally, technical controls prevent public exposure. This supports both training requirements (users learn to identify and label CUI) and review requirements (labeled content is easily identified for auditing).",
          "nistRequirement": "Train authorized individuals to ensure that publicly accessible information does not contain CUI"
        }
      ]
    },
    {
      "id": "PV-AC-004",
      "settingName": "DlpPolicyForPublicWebsites",
      "displayName": "DLP Policy - Detect CUI in Public Communications",
      "settingPath": "DlpPolicy.Rules.Conditions.ContentContainsSensitiveInformation",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "action": "BlockAccessOrEncrypt",
        "detectCUI": true
      },
      "validationOperator": "==",
      "description": "Scans content for patterns indicating CUI (SSN, financial data, ITAR information, etc.) and blocks or restricts external sharing to prevent CUI from being posted to public websites or shared externally.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal\n2. Navigate to Data loss prevention > Policies > Create policy\n3. Template: Custom or select 'U.S. Personally Identifiable Information (PII) Data'\n4. Name: 'Detect and Block CUI in External Communications'\n5. Locations: Exchange email, SharePoint sites, OneDrive accounts, Teams chat, Devices\n6. Create advanced DLP rule: 'Block CUI External Sharing'\n7. Conditions: Content contains\n8. Add sensitive info types: Social Security numbers, Credit card numbers, Financial data, HIPAA data, Export-controlled information\n9. AND Content is shared > with people outside my organization\n10. Actions: Restrict access > Block everyone\n11. User notifications: Notify users with policy tips and email\n12. Incident reports: Send to admins when rule match occurs\n13. Test mode first, then enable\n14. Review and adjust based on false positives",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-create-deploy-policy",
      "controlMappings": [
        {
          "controlId": "03.01.22",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Provides automated detection and prevention of CUI exposure in external communications by scanning content for sensitive information patterns. This directly supports the NIST requirement to review content for CUI and prevent its public disclosure through technical controls that identify and block CUI before it reaches public systems.",
          "nistRequirement": "Review the content on publicly accessible systems for CUI and remove such information, if discovered"
        }
      ]
    },
    {
      "id": "AZ-AC-005",
      "settingName": "TeamsExternalAccessRestriction",
      "displayName": "Microsoft Teams - Restrict External Access and Guest Sharing",
      "settingPath": "TeamsClientConfiguration.AllowPublicUsers",
      "policyType": "AzureAD",
      "policySubType": "TeamsAdmin",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Controls external access and guest user capabilities in Microsoft Teams to prevent CUI from being shared in public or external team channels, meetings, or chats.",
      "implementationGuide": "1. Sign in to Microsoft Teams Admin Center\n2. Navigate to Users > External access\n3. Review 'Users can communicate with Skype for Business and Teams users' setting\n4. Set to allow only specific external domains (whitelist) or block all\n5. Navigate to Users > Guest access\n6. Review guest permissions and set restrictive settings:\n7. Make private calls: Off\n8. Allow IP video: Off (or On based on business need)\n9. Edit messages: Off\n10. Delete messages: Off\n11. Navigate to Meetings > Meeting policies\n12. Create policy for handling sensitive information\n13. Set 'Anonymous users can join a meeting' to Off\n14. Set 'Automatically admit people' to 'People in my organization only'\n15. In Org-wide settings > External access: Restrict to specific approved domains only\n16. Deploy information barriers if needed for additional segregation\n17. Train users on proper Teams usage for CUI discussions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoftteams/manage-external-access",
      "controlMappings": [
        {
          "controlId": "03.01.22",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Teams external access controls prevent CUI from being discussed or shared in public team channels, external meetings, or anonymous join scenarios. By restricting external communications and guest capabilities, organizations prevent CUI from being inadvertently exposed through Teams collaboration features, supporting the requirement to ensure publicly accessible information does not contain CUI.",
          "nistRequirement": "Train authorized individuals to ensure that publicly accessible information does not contain CUI"
        }
      ]
    }
  ],
  "researchSummary": "Control 03.01.22 addresses preventing CUI exposure on publicly accessible systems through user training and content review. Critical M365 settings leverage Purview DLP policies to automatically detect and block external sharing of CUI (Settings 1 & 4), SharePoint/OneDrive sharing restrictions to prevent anonymous public links (Setting 2), sensitivity labels that classify and protect CUI (Setting 3), and Teams external access controls to prevent collaboration-based exposure (Setting 5). These five high-confidence settings provide comprehensive technical enforcement supplementing user training requirements.",
  "securityBaselines": [
    "CIS Microsoft 365 Foundations Benchmark - Section 2.1 (Data Loss Prevention)",
    "CIS Microsoft 365 Foundations Benchmark - Section 3.1 (External Sharing)",
    "Microsoft 365 Security Baseline - Information Protection and DLP"
  ],
  "implementationNotes": "Begin by implementing sensitivity labels and training users to classify CUI properly. Deploy DLP policies in test/audit mode initially to assess false positive rates. Start with restrictive SharePoint external sharing settings (organization only) and gradually enable authenticated external sharing if business requires. For Teams, maintain restrictive external access while allowing necessary business partner communication through approved domains only. Regular auditing of external sharing activity through Microsoft Purview reports is essential for ongoing compliance."
}
