{
  "controlId": "03.01.03",
  "controlTitle": "Information Flow Enforcement",
  "controlRequirement": "Enforce approved authorizations for controlling the flow of CUI within the system and between connected systems.",
  "researchDate": "2024-11-16",
  "settingsCount": 32,
  "settings": [
    {
      "id": "PV-DLP-001",
      "settingName": "state",
      "displayName": "DLP Policy State",
      "settingPath": "policy.state",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Enabled",
      "validationOperator": "==",
      "description": "Enables the DLP policy to actively enforce information flow restrictions and prevent CUI exfiltration",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Go to Data loss prevention > Policies\n3. Select the CUI protection policy or create new policy\n4. Ensure 'Turn it on right away' is selected (Enabled state)\n5. Save the policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-create-deploy-policy",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "DLP policies must be in 'Enabled' state to actively enforce information flow controls and prevent unauthorized CUI transfer",
          "nistRequirement": "Enforce approved authorizations for controlling the flow of CUI within the system and between connected systems"
        }
      ]
    },
    {
      "id": "PV-DLP-002",
      "settingName": "locations",
      "displayName": "DLP Policy Locations",
      "settingPath": "policy.locations",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ["Exchange", "SharePoint", "OneDrive", "Teams", "Devices"],
      "validationOperator": "contains",
      "description": "Specifies which Microsoft 365 workloads the DLP policy monitors to control CUI information flow across all communication channels",
      "implementationGuide": "1. In Microsoft Purview portal, navigate to Data loss prevention > Policies\n2. Create or edit DLP policy\n3. On 'Choose locations' page, enable:\n   - Exchange email\n   - SharePoint sites\n   - OneDrive accounts\n   - Teams chat and channel messages\n   - Devices (Windows/Mac endpoints)\n4. Select 'All' for each location or specify included/excluded groups\n5. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-policy-reference",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "DLP policies must monitor all communication channels (email, file sharing, messaging, endpoints) to comprehensively control information flow and prevent CUI exfiltration",
          "nistRequirement": "Controlling the flow of CUI within the system and between connected systems across all platforms"
        }
      ]
    },
    {
      "id": "PV-DLP-003",
      "settingName": "contentContainsSensitiveInformation",
      "displayName": "DLP Sensitive Information Detection",
      "settingPath": "rule.conditions.contentContainsSensitiveInformation",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ["Custom.CUI", "U.S._Social_Security_Number", "Credit_Card_Number", "Custom.ITAR"],
      "validationOperator": "contains",
      "description": "Defines sensitive information types that DLP detects to identify CUI content and trigger information flow controls",
      "implementationGuide": "1. Navigate to Purview portal > Data loss prevention > Policies\n2. Edit DLP policy rules\n3. Under 'Conditions', select 'Content contains'\n4. Add sensitive information types:\n   - Built-in types (SSN, Credit Card, etc.)\n   - Custom sensitive info types for CUI classification\n   - ITAR/Export controlled data types\n5. Configure confidence level (High/Medium/Low)\n6. Set instance count threshold\n7. Save rule configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-policy-reference",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "DLP must detect CUI and sensitive information within content to determine when information flow restrictions should be enforced",
          "nistRequirement": "Flow control based on characteristics of the information (content-based detection)"
        }
      ]
    },
    {
      "id": "PV-DLP-004",
      "settingName": "contentContainsSensitivityLabel",
      "displayName": "DLP Sensitivity Label Detection",
      "settingPath": "rule.conditions.contentContainsSensitivityLabel",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ["CUI", "Confidential", "Highly Confidential"],
      "validationOperator": "contains",
      "description": "Detects sensitivity labels applied to content to enforce label-based information flow restrictions for classified CUI",
      "implementationGuide": "1. In Purview portal, go to Data loss prevention > Policies\n2. Edit DLP policy rules\n3. Under 'Conditions', select 'Content contains sensitivity labels'\n4. Choose sensitivity labels that classify CUI:\n   - CUI label\n   - Confidential label\n   - Highly Confidential label\n5. Configure rule to trigger on any or all selected labels\n6. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-policy-reference",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Label-based DLP rules enforce information flow controls based on CUI classification, preventing labeled content from flowing to unauthorized destinations",
          "nistRequirement": "Limiting CUI transfers based on data structures and content (classification-based flow control)"
        }
      ]
    },
    {
      "id": "PV-DLP-005",
      "settingName": "blockAccess",
      "displayName": "DLP Block Action for External Sharing",
      "settingPath": "rule.actions.blockAccess",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Blocks sharing of CUI content to external recipients, preventing unauthorized information flow outside the organization",
      "implementationGuide": "1. Navigate to Purview > Data loss prevention > Policies\n2. Edit DLP rule actions\n3. Under 'Actions', select 'Restrict access or encrypt the content'\n4. Choose 'Block users from accessing shared SharePoint, OneDrive, and Teams content'\n5. Select 'Block only people from outside your organization'\n6. For Exchange, select 'Block the message'\n7. For Devices, select 'Block'\n8. Save action configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-policy-reference",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Blocking external sharing directly enforces the NIST requirement to restrict CUI flow to unauthorized external parties",
          "nistRequirement": "Keeping CUI from being transmitted in the clear to the internet; limiting CUI transfers between organizations"
        }
      ]
    },
    {
      "id": "PV-DLP-006",
      "settingName": "notifyUser",
      "displayName": "DLP User Notification",
      "settingPath": "rule.actions.notifyUser",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Notifies users when they attempt unauthorized CUI information flow, providing policy tips and awareness",
      "implementationGuide": "1. In Purview portal, navigate to Data loss prevention > Policies\n2. Edit DLP rule\n3. Under 'User notifications', toggle 'On'\n4. Select notification options:\n   - Notify users in Office 365 service with a policy tip\n   - Send email notification to user who sent, shared, or modified content\n5. Customize policy tip text to explain CUI restrictions\n6. Save notification settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-policy-reference",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "User notifications provide awareness of information flow restrictions and help prevent unintentional CUI exfiltration",
          "nistRequirement": "Supporting enforcement of approved authorizations through user awareness and education"
        }
      ]
    },
    {
      "id": "PV-DLP-007",
      "settingName": "restrictedCloudAppDomains",
      "displayName": "DLP Restricted Cloud Service Domains",
      "settingPath": "endpointSettings.restrictedCloudAppDomains",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": ["gmail.com", "dropbox.com", "box.com", "icloud.com"],
      "validationOperator": "contains",
      "description": "Blocks file uploads containing CUI to specified unmanaged cloud services from managed endpoints",
      "implementationGuide": "1. Navigate to Purview > Data loss prevention > Settings > Endpoint DLP settings\n2. Go to 'Browser and domain restrictions to sensitive data'\n3. Configure 'Service domains' list mode:\n   - Set to 'Block' to create blocklist\n4. Add cloud service domains to block:\n   - gmail.com\n   - dropbox.com\n   - box.com\n   - icloud.com\n   - Other unapproved cloud storage\n5. Save endpoint DLP settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-configure-endpoint-settings",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Blocking CUI uploads to unauthorized cloud services prevents information flow to unapproved external systems",
          "nistRequirement": "Restricting CUI transfers between organizations; blocking external communications"
        }
      ]
    },
    {
      "id": "PV-DLP-008",
      "settingName": "advancedClassification",
      "displayName": "DLP Advanced Classification Scanning",
      "settingPath": "endpointSettings.advancedClassification",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables cloud-based classification service to scan and detect CUI in files on endpoints for information flow enforcement",
      "implementationGuide": "1. Navigate to Purview portal > Data loss prevention > Settings\n2. Select 'Endpoint DLP settings'\n3. Locate 'Advanced classification scanning and protection' section\n4. Toggle the setting to 'On'\n5. This enables cloud-based scanning for:\n   - Trainable classifiers\n   - Named entities\n   - Enhanced sensitive information detection\n6. Save endpoint settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-configure-endpoint-settings",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Advanced classification enhances CUI detection accuracy on endpoints, improving information flow control effectiveness",
          "nistRequirement": "Message filtering capability based on message content (content characteristics detection)"
        }
      ]
    },
    {
      "id": "PV-DLP-009",
      "settingName": "policyMode",
      "displayName": "DLP Policy Mode (Enforcement vs Test)",
      "settingPath": "policy.mode",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Enforce",
      "validationOperator": "==",
      "description": "Sets DLP policy to enforcement mode to actively block unauthorized CUI information flow (vs test-only mode)",
      "implementationGuide": "1. In Purview portal, navigate to Data loss prevention > Policies\n2. Select or create DLP policy\n3. In policy settings, choose policy mode:\n   - 'Turn it on right away' = Enforce mode (REQUIRED)\n   - 'Test it out first' = Test mode (not compliant)\n   - 'Keep it off' = Disabled (not compliant)\n4. Select 'Turn it on right away' for production enforcement\n5. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-create-deploy-policy",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Policy must be in enforcement mode to actively enforce information flow controls, not just detect violations",
          "nistRequirement": "Enforce approved authorizations (active enforcement, not passive monitoring)"
        }
      ]
    },
    {
      "id": "PV-DLP-010",
      "settingName": "encryptContent",
      "displayName": "DLP Encrypt Content Action",
      "settingPath": "rule.actions.encryptContent",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically encrypts CUI content when shared externally to enforce information protection during transit",
      "implementationGuide": "1. Navigate to Purview > Data loss prevention > Policies\n2. Edit DLP rule actions\n3. Under 'Actions', select 'Restrict access or encrypt the content in Microsoft 365 locations'\n4. Choose 'Encrypt email messages' for Exchange\n5. Select encryption template (Office 365 Message Encryption)\n6. For files, enable 'Apply sensitivity label' that includes encryption\n7. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-exchange-conditions-and-actions",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Encryption provides additional information flow protection when CUI must be shared externally per approved authorizations",
          "nistRequirement": "Keeping CUI from being transmitted in the clear to the internet (encryption for external transfers)"
        }
      ]
    },
    {
      "id": "PV-SL-001",
      "settingName": "isMandatory",
      "displayName": "Mandatory Sensitivity Labeling",
      "settingPath": "labelPolicy.settings.isMandatory",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to apply sensitivity labels to CUI content, ensuring all information is classified before flow decisions",
      "implementationGuide": "1. Navigate to Microsoft Purview portal > Information protection > Labels > Label policies\n2. Select or create label publishing policy\n3. On 'Policy settings' page, enable 'Require users to apply a label to their email and documents'\n4. This forces labeling before save/send operations\n5. Publish policy to users\n6. Allow 24 hours for replication",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/create-sensitivity-labels",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Mandatory labeling ensures CUI is classified before information flow, enabling label-based flow enforcement",
          "nistRequirement": "Flow control based on characteristics of the information (classification labels)"
        }
      ]
    },
    {
      "id": "PV-SL-002",
      "settingName": "isDowngradeJustificationRequired",
      "displayName": "Downgrade Justification Required",
      "settingPath": "labelPolicy.settings.isDowngradeJustificationRequired",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires justification when downgrading CUI sensitivity label, preventing unauthorized label changes that bypass flow controls",
      "implementationGuide": "1. In Purview portal, navigate to Information protection > Label policies\n2. Edit label publishing policy\n3. On 'Policy settings', enable 'Require users to provide justification to remove a label or lower classification label'\n4. This creates audit trail for label downgrades\n5. Users must provide business justification to downgrade CUI labels\n6. Save and publish policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/create-sensitivity-labels",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Preventing unauthorized label downgrades maintains CUI classification integrity and associated information flow restrictions",
          "nistRequirement": "Maintaining information flow controls based on classification (preventing bypass through reclassification)"
        }
      ]
    },
    {
      "id": "PV-SL-003",
      "settingName": "encryptionSettings",
      "displayName": "Sensitivity Label Encryption for CUI",
      "settingPath": "label.encryptionSettings.enabled",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Applies encryption to CUI-labeled content to restrict access and prevent unauthorized information flow",
      "implementationGuide": "1. Navigate to Purview > Information protection > Labels\n2. Select CUI/Confidential sensitivity label\n3. On 'Encryption' page, select 'Configure encryption settings'\n4. Choose 'Apply encryption'\n5. Configure encryption options:\n   - Assign permissions now or let users assign\n   - Set access expiration\n   - Allow offline access with restrictions\n6. Define who can access encrypted content\n7. Save label configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/encryption-sensitivity-labels",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Encryption on CUI labels enforces access controls during information flow, preventing unauthorized access even if content leaves organization",
          "nistRequirement": "Keeping CUI from being transmitted in the clear; employing hardware mechanisms to enforce one-way information flows"
        }
      ]
    },
    {
      "id": "PV-SL-004",
      "settingName": "externalSharingSettings",
      "displayName": "Block External Sharing for CUI Labels",
      "settingPath": "label.siteAndGroupSettings.privacy",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Private",
      "validationOperator": "==",
      "description": "Restricts external sharing of Teams/Groups/Sites labeled with CUI sensitivity labels",
      "implementationGuide": "1. In Purview portal, go to Information protection > Labels\n2. Select CUI sensitivity label\n3. On 'Define protection settings for groups and sites', enable scope\n4. Configure 'Privacy and external user access settings':\n   - Privacy: Select 'Private'\n   - External user access: Uncheck 'Let Microsoft 365 group owners add people outside your organization to the group'\n5. Configure 'External sharing and Conditional Access':\n   - External sharing: Select appropriate restriction level\n6. Save label configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/sensitivity-labels-teams-groups-sites",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Label-based external sharing restrictions prevent CUI information flow to unauthorized external parties via collaboration platforms",
          "nistRequirement": "Limiting CUI transfers between organizations; blocking external communications"
        }
      ]
    },
    {
      "id": "PV-SL-005",
      "settingName": "defaultSharingLinkType",
      "displayName": "Sensitivity Label Default Sharing Link Type",
      "settingPath": "label.defaultSharingLinkType",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Direct",
      "validationOperator": "==",
      "description": "Sets default sharing link type for CUI-labeled content to 'Specific people' to prevent anonymous sharing",
      "implementationGuide": "1. Navigate to Purview > Information protection > Labels\n2. Select CUI sensitivity label\n3. Use PowerShell to configure default link type (not available in UI):\n   Set-Label -Identity \"CUI\" -AdvancedSettings @{DefaultSharingScope=\"SpecificPeople\"}\n4. This ensures CUI content shares default to specific people, not 'Anyone' links\n5. Users must explicitly choose broader sharing",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/sensitivity-labels-default-sharing-link",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Default sharing link restrictions reduce risk of accidental CUI exposure through overly permissive anonymous links",
          "nistRequirement": "Preventing CUI from being transmitted to unauthorized recipients (safe defaults)"
        }
      ]
    },
    {
      "id": "PV-SL-006",
      "settingName": "autoLabelingPolicy",
      "displayName": "Auto-Labeling for CUI Content",
      "settingPath": "autoLabelingPolicy.enabled",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically applies CUI sensitivity labels to content matching CUI criteria, ensuring consistent flow enforcement",
      "implementationGuide": "1. Navigate to Purview > Information protection > Auto-labeling\n2. Create new auto-labeling policy\n3. Name policy (e.g., 'Auto-label CUI content')\n4. Choose locations (Exchange, SharePoint, OneDrive)\n5. Define rules matching CUI sensitive info types\n6. Select CUI sensitivity label to auto-apply\n7. Choose 'Apply label automatically' mode\n8. Save and publish policy\n9. Allow up to 7 days for initial labeling",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/apply-sensitivity-label-automatically",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Auto-labeling ensures CUI is consistently classified, enabling reliable label-based information flow controls",
          "nistRequirement": "Flow control based on characteristics of the information (automated classification)"
        }
      ]
    },
    {
      "id": "SP-ES-001",
      "settingName": "sharingCapability",
      "displayName": "SharePoint/OneDrive Organization Sharing Capability",
      "settingPath": "tenant.sharingCapability",
      "policyType": "SharePoint",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "ExternalUserSharingOnly",
      "validationOperator": "in",
      "description": "Restricts external sharing to authenticated guests only, preventing anonymous CUI sharing via 'Anyone' links",
      "implementationGuide": "1. Navigate to SharePoint admin center (https://admin.microsoft.com/sharepoint)\n2. Go to Policies > Sharing\n3. Under 'External sharing', configure SharePoint slider:\n   - For highest security: 'Only people in your organization'\n   - For controlled external sharing: 'New and existing guests' (ExternalUserSharingOnly)\n   - Avoid: 'Anyone' (allows anonymous links)\n4. Set OneDrive to same or more restrictive level\n5. Save settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Restricting external sharing prevents unauthorized CUI flow to unauthenticated external users via anonymous links",
          "nistRequirement": "Limiting CUI transfers between organizations; restricting information flow to authorized destinations"
        }
      ]
    },
    {
      "id": "SP-ES-002",
      "settingName": "defaultSharingLinkType",
      "displayName": "Default Sharing Link Type",
      "settingPath": "tenant.defaultSharingLinkType",
      "policyType": "SharePoint",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Direct",
      "validationOperator": "==",
      "description": "Sets default sharing link to 'Specific people' instead of 'Anyone' to prevent accidental CUI over-sharing",
      "implementationGuide": "1. In SharePoint admin center, navigate to Policies > Sharing\n2. Scroll to 'File and folder links' section\n3. Under 'Choose the type of link that's selected by default', select:\n   - 'Specific people' (recommended for CUI)\n   - Alternative: 'Only people in your organization'\n4. Under 'Choose the permission that's selected by default', select 'View'\n5. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/change-default-sharing-link",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Default sharing link type reduces risk of unintentional CUI disclosure through overly permissive default sharing settings",
          "nistRequirement": "Preventing accidental CUI transmission to unauthorized parties (secure defaults)"
        }
      ]
    },
    {
      "id": "SP-ES-003",
      "settingName": "requireAnonymousLinksExpireInDays",
      "displayName": "Anonymous Link Expiration",
      "settingPath": "tenant.requireAnonymousLinksExpireInDays",
      "policyType": "SharePoint",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 30,
      "validationOperator": "<=",
      "description": "Enforces expiration on anonymous sharing links to limit duration of CUI exposure if anonymous sharing is permitted",
      "implementationGuide": "1. Navigate to SharePoint admin center > Policies > Sharing\n2. Under 'Advanced settings for Anyone links', enable 'These links must expire within this many days'\n3. Set value to 30 days or less (recommended: 14-30 days)\n4. Note: This only applies if 'Anyone' sharing is enabled\n5. For CUI environments, consider disabling 'Anyone' sharing entirely\n6. Save settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Link expiration limits temporal window for unauthorized CUI access via anonymous links (defense-in-depth)",
          "nistRequirement": "Time-limiting information flow authorizations to reduce exposure risk"
        }
      ]
    },
    {
      "id": "SP-ES-004",
      "settingName": "guestAccessExpirationDays",
      "displayName": "Guest Access Expiration Days",
      "settingPath": "tenant.externalUserExpirationRequired",
      "policyType": "SharePoint",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 90,
      "validationOperator": "<=",
      "description": "Requires periodic re-authorization of external guest access to CUI content in SharePoint/OneDrive",
      "implementationGuide": "1. In SharePoint admin center, go to Policies > Sharing\n2. Under 'Advanced settings for Anyone links', scroll to 'Guest access to a site or OneDrive will expire automatically after this many days'\n3. Enable the setting\n4. Set value (recommended: 60-90 days)\n5. Guests must be re-invited after expiration\n6. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Guest access expiration enforces periodic review of external CUI access authorizations",
          "nistRequirement": "Periodic review of approved authorizations for information flow to external parties"
        }
      ]
    },
    {
      "id": "SP-ES-005",
      "settingName": "defaultLinkPermission",
      "displayName": "Default Link Permission Level",
      "settingPath": "tenant.defaultLinkPermission",
      "policyType": "SharePoint",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "View",
      "validationOperator": "==",
      "description": "Sets default sharing permission to 'View' instead of 'Edit' to prevent unauthorized CUI modification",
      "implementationGuide": "1. Navigate to SharePoint admin center > Policies > Sharing\n2. Under 'File and folder links' section\n3. Find 'Choose the permission that's selected by default for sharing links'\n4. Select 'View' (recommended for CUI protection)\n5. This prevents accidental 'Edit' permissions on CUI shares\n6. Users must explicitly grant 'Edit' if needed\n7. Save settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/change-default-sharing-link",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "View-only default permissions reduce risk of unauthorized CUI modification through shared links",
          "nistRequirement": "Controlling information flow with appropriate access restrictions (read vs. write)"
        }
      ]
    },
    {
      "id": "EX-MF-001",
      "settingName": "transportRuleState",
      "displayName": "Mail Flow Rule State for External CUI Blocking",
      "settingPath": "transportRule.state",
      "policyType": "Exchange",
      "policySubType": "TransportRule",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Enabled",
      "validationOperator": "==",
      "description": "Enables mail flow rule to block or encrypt CUI emails to external recipients",
      "implementationGuide": "1. Navigate to Exchange admin center (https://admin.exchange.microsoft.com)\n2. Go to Mail flow > Rules\n3. Create new rule or enable existing CUI protection rule\n4. Configure rule:\n   - Name: 'Block CUI to External Recipients'\n   - Apply if: Recipient is outside organization AND (message contains sensitive info OR has CUI label)\n   - Do the following: Block the message / Reject with explanation\n5. Set rule state to 'Enabled'\n6. Save rule\nNote: Mail flow rules managed via PowerShell (New-TransportRule), not Graph API",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/manage-mail-flow-rules",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Mail flow rules enforce information flow restrictions on CUI sent via email to external recipients",
          "nistRequirement": "Blocking external communications traffic; restricting CUI transfers between organizations"
        }
      ]
    },
    {
      "id": "EX-MF-002",
      "settingName": "encryptAction",
      "displayName": "Mail Flow Rule Encryption Action",
      "settingPath": "transportRule.actions.applyOME",
      "policyType": "Exchange",
      "policySubType": "TransportRule",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Applies Office 365 Message Encryption to CUI emails sent to approved external recipients",
      "implementationGuide": "1. In Exchange admin center, go to Mail flow > Rules\n2. Create rule for CUI encryption:\n   - Name: 'Encrypt CUI to External Recipients'\n   - Apply if: Recipient is outside organization AND message has CUI label\n   - Do the following: Modify message security > Apply Office 365 Message Encryption\n3. Select encryption template (e.g., 'Encrypt')\n4. Enable rule\n5. Save configuration\nNote: Requires Azure Information Protection / Office 365 Message Encryption",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/use-rules-to-encrypt-email",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Email encryption prevents CUI from being transmitted in cleartext when external sharing is authorized",
          "nistRequirement": "Keeping CUI from being transmitted in the clear to the internet (encryption in transit)"
        }
      ]
    },
    {
      "id": "EX-MF-003",
      "settingName": "fromScope",
      "displayName": "Mail Flow Rule Sender Scope Condition",
      "settingPath": "transportRule.conditions.fromScope",
      "policyType": "Exchange",
      "policySubType": "TransportRule",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "InOrganization",
      "validationOperator": "==",
      "description": "Applies CUI flow rule only to internal senders to prevent external spoofing bypass",
      "implementationGuide": "1. In Exchange admin center, navigate to Mail flow > Rules\n2. Edit CUI protection mail flow rule\n3. Under conditions, select 'The sender is located...'\n4. Choose 'Inside the organization'\n5. This ensures rule applies to genuine internal users, not external spoofers\n6. Combine with other conditions (CUI labels, sensitive info)\n7. Save rule configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Sender scope filtering ensures CUI flow rules apply to legitimate internal communications, preventing bypass",
          "nistRequirement": "Blocking external communications traffic that claims to be from within the organization"
        }
      ]
    },
    {
      "id": "TM-EA-001",
      "settingName": "allowTeamsConsumer",
      "displayName": "Block Teams Communication with Personal Accounts",
      "settingPath": "teamsClientConfiguration.allowTeamsConsumer",
      "policyType": "Teams",
      "policySubType": "ExternalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Blocks Teams users from communicating with personal Microsoft accounts to prevent CUI data leakage",
      "implementationGuide": "1. Navigate to Teams admin center (https://admin.teams.microsoft.com)\n2. Go to Users > External access\n3. Under 'Teams accounts not managed by an organization', toggle OFF:\n   - 'People in my organization can communicate with Teams users whose accounts aren't managed by an organization'\n4. This blocks chat/calls with personal Teams accounts\n5. Save configuration\nNote: Configured via Teams admin center or PowerShell (Set-CsExternalAccessPolicy)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoftteams/manage-external-access",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Blocking communication with unmanaged personal accounts prevents CUI exfiltration through Teams chat to external parties",
          "nistRequirement": "Limiting CUI transfers between organizations; restricting flow to authorized external entities"
        }
      ]
    },
    {
      "id": "TM-GA-001",
      "settingName": "allowGuestAccess",
      "displayName": "Teams Guest Access Control",
      "settingPath": "guestAccessConfiguration.allowGuestAccess",
      "policyType": "Teams",
      "policySubType": "GuestAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Controls whether external guests can be added to Teams, preventing CUI exposure to unauthorized external users",
      "implementationGuide": "1. Navigate to Teams admin center > Users > Guest access\n2. Set 'Allow guest access in Teams' toggle:\n   - OFF: Completely blocks guest access (highest security for CUI)\n   - ON: Allows controlled guest access with restrictions\n3. If enabling guest access for CUI environment:\n   - Messaging: Limit guest capabilities\n   - Calling: Disable make/receive calls\n   - Meeting: Restrict screen sharing\n4. Save settings\n5. Use Azure AD guest access policies for additional controls",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoftteams/guest-access",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Guest access controls prevent unauthorized CUI flow to external parties via Teams collaboration",
          "nistRequirement": "Limiting CUI transfers between organizations; controlling flow to external entities"
        }
      ]
    },
    {
      "id": "TM-GA-002",
      "settingName": "allowGuestEditChannelPosts",
      "displayName": "Block Guest Channel Post Editing",
      "settingPath": "guestAccessConfiguration.allowGuestEditChannelPosts",
      "policyType": "Teams",
      "policySubType": "GuestAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Prevents guests from editing channel posts containing CUI to maintain information integrity",
      "implementationGuide": "1. In Teams admin center, navigate to Users > Guest access\n2. Under 'Messaging', find 'Edit sent messages'\n3. Toggle to 'Off' to prevent guests from editing channel posts\n4. This prevents modification of CUI messages by external guests\n5. Save guest access configuration\nNote: Only applicable if guest access is enabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoftteams/guest-access",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Restricting guest editing capabilities prevents unauthorized modification of CUI information flow records",
          "nistRequirement": "Maintaining integrity of information during external collaboration"
        }
      ]
    },
    {
      "id": "IN-MAM-001",
      "settingName": "sendOrgDataToOtherApps",
      "displayName": "Intune MAM - Block Org Data to Unmanaged Apps",
      "settingPath": "appProtectionPolicy.dataProtection.allowedOutboundDataTransferDestinations",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS,Android",
      "dataType": "string",
      "expectedValue": "ManagedApps",
      "validationOperator": "==",
      "description": "Blocks CUI from being sent from managed apps (Outlook, OneDrive) to unmanaged personal apps on mobile devices",
      "implementationGuide": "1. Navigate to Intune admin center (https://intune.microsoft.com)\n2. Go to Apps > App protection policies\n3. Create or edit iOS/Android policy\n4. Under 'Data protection', configure 'Send org data to other apps':\n   - Select 'Policy managed apps' (blocks transfer to unmanaged apps)\n   - Alternative: 'None' (most restrictive, blocks all transfers)\n5. Apply policy to users/groups\n6. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Restricting data transfer to managed apps prevents CUI exfiltration from mobile devices to personal apps and services",
          "nistRequirement": "Controlling the flow of CUI within the system (between managed and unmanaged apps)"
        }
      ]
    },
    {
      "id": "IN-MAM-002",
      "settingName": "receiveDataFromOtherApps",
      "displayName": "Intune MAM - Receive Data from Other Apps",
      "settingPath": "appProtectionPolicy.dataProtection.allowedInboundDataTransferSources",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS,Android",
      "dataType": "string",
      "expectedValue": "AllApps",
      "validationOperator": "==",
      "description": "Controls whether managed apps can receive data from unmanaged apps (typically allowed for usability)",
      "implementationGuide": "1. In Intune admin center, navigate to Apps > App protection policies\n2. Edit iOS/Android policy\n3. Under 'Data protection', configure 'Receive data from other apps':\n   - 'All apps': Allows receiving from any app (typical setting)\n   - 'Policy managed apps': Only from other managed apps\n   - 'None': Blocks all incoming data\n4. For CUI environments, consider 'Policy managed apps' for maximum protection\n5. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Controlling inbound data flow prevents potential CUI injection from unmanaged sources",
          "nistRequirement": "Regulating where CUI can transit (inbound flow control)"
        }
      ]
    },
    {
      "id": "IN-MAM-003",
      "settingName": "restrictCutCopyPaste",
      "displayName": "Intune MAM - Restrict Cut/Copy/Paste",
      "settingPath": "appProtectionPolicy.dataProtection.allowedOutboundClipboardSharingLevel",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS,Android",
      "dataType": "string",
      "expectedValue": "ManagedAppsWithPasteIn",
      "validationOperator": "==",
      "description": "Restricts clipboard sharing of CUI between managed and unmanaged apps on mobile devices",
      "implementationGuide": "1. Navigate to Intune > Apps > App protection policies\n2. Edit iOS/Android policy\n3. Under 'Data protection', configure 'Restrict cut, copy, and paste between other apps':\n   - 'Blocked': Completely blocks clipboard (most restrictive)\n   - 'Policy managed apps': Only clipboard between managed apps\n   - 'Policy managed apps with paste in': Allows paste FROM unmanaged (recommended)\n   - 'Any app': No restrictions (not recommended for CUI)\n4. Save policy configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Clipboard restrictions prevent CUI from being copied from managed apps and pasted into unmanaged apps (e.g., personal messaging apps)",
          "nistRequirement": "Controlling CUI flow through device-level data transfer mechanisms"
        }
      ]
    },
    {
      "id": "IN-MAM-004",
      "settingName": "saveAsBlocked",
      "displayName": "Intune MAM - Block Save As to Unmanaged Locations",
      "settingPath": "appProtectionPolicy.dataProtection.allowUserToSaveCopy",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS,Android",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Blocks saving CUI documents to unmanaged cloud storage or local device storage from managed apps",
      "implementationGuide": "1. In Intune admin center, go to Apps > App protection policies\n2. Edit policy under 'Data protection' settings\n3. Configure 'Allow user to save copies to selected services':\n   - Toggle OFF to block all 'Save As'\n   - Or select only approved services (OneDrive, SharePoint)\n4. This prevents CUI from being saved to:\n   - Local device storage\n   - Personal cloud storage (iCloud, Google Drive)\n   - Unmanaged file locations\n5. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Blocking 'Save As' to unmanaged locations prevents CUI exfiltration through file system operations on mobile devices",
          "nistRequirement": "Limiting CUI transfers to unauthorized storage locations and cloud services"
        }
      ]
    },
    {
      "id": "IN-MAM-005",
      "settingName": "printBlocked",
      "displayName": "Intune MAM - Block Print of Org Data",
      "settingPath": "appProtectionPolicy.dataProtection.printBlocked",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS,Android",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Blocks printing of CUI content from managed mobile apps to prevent physical information leakage",
      "implementationGuide": "1. Navigate to Intune > Apps > App protection policies\n2. Edit iOS/Android policy\n3. Under 'Data protection', locate 'Printing org data' setting\n4. Set to 'Block' to prevent printing CUI from managed apps\n5. This prevents:\n   - Printing to local printers\n   - Printing to cloud print services\n   - Print-to-PDF operations\n6. Apply policy to users\n7. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios",
      "controlMappings": [
        {
          "controlId": "03.01.03",
          "confidence": "Medium",
          "isRequired": false,
          "mappingRationale": "Print blocking prevents CUI information flow to physical media from mobile devices",
          "nistRequirement": "Controlling information flow through all output mechanisms including physical media"
        }
      ]
    }
  ]
}
