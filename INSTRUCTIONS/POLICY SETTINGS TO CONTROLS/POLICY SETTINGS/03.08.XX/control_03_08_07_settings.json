{
  "controlId": "03.08.07",
  "controlFamily": "MP",
  "controlTitle": "Media Use",
  "nistRequirement": "a. Restrict or prohibit the use of [Assignment: organization-defined types of system media]. b. Prohibit the use of removable system media without an identifiable owner.",
  "researchDate": "2025-11-17",
  "totalSettings": 6,
  "settings": [
    {
      "id": "IN-MP-001",
      "settingName": "RemovableStorageAccess",
      "displayName": "Block Removable Storage Devices",
      "settingPath": "DeviceConfiguration.Windows.RemovableStorage.DenyAccess",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Block",
      "validationOperator": "==",
      "description": "Restricts or blocks the use of removable storage devices (USB drives, external hard drives, SD cards) on Windows devices. This prevents unauthorized use of removable media that could contain or receive CUI.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://intune.microsoft.com)\n2. Navigate to Devices > Configuration profiles > Create profile\n3. Platform: Windows 10 and later\n4. Profile type: Templates > Device restrictions\n5. Under General settings, configure:\n   - Removable storage: Block\n   - USB connection (mobile only): Block (if applicable)\n6. Under Storage settings:\n   - Removable storage: Block\n7. Alternatively, use Settings Catalog profile:\n   - Create profile > Settings catalog\n   - Add setting: Storage > Removable Disk Classes > Deny All Access\n8. Assign policy to appropriate device groups (all devices or specific groups)\n9. Set applicability rules if needed (e.g., only for devices handling CUI)\n10. Monitor deployment status\n11. Test by attempting to access USB drive on enrolled device\n12. For exceptions, create separate policy with 'Allow' for specific approved devices or users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-windows-10#storage",
      "controlMappings": [
        {
          "controlId": "03.08.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Blocking removable storage directly enforces the restriction or prohibition of organization-defined types of system media (USB drives, external storage). This is one of the most effective technical controls for preventing unauthorized use of removable media that could be used to exfiltrate CUI or introduce it into uncontrolled environments.",
          "nistRequirement": "Restrict or prohibit the use of [Assignment: organization-defined types of system media]"
        }
      ]
    },
    {
      "id": "IN-MP-002",
      "settingName": "BitLockerRemovableDrivesEncryption",
      "displayName": "Require BitLocker Encryption for Removable Drives",
      "settingPath": "DeviceConfiguration.Windows.BitLocker.RemovableDrivesEncryption.Required",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enable",
      "validationOperator": "==",
      "description": "Requires BitLocker encryption for all removable drives before they can be written to or accessed. This ensures that if removable media is used (when permitted), CUI stored on it is protected through encryption.",
      "implementationGuide": "1. In Microsoft Intune admin center, go to Endpoint security > Disk encryption\n2. Create policy > Platform: Windows 10 and later > Profile: BitLocker\n3. Configure BitLocker base settings:\n   - Enable full disk encryption for OS and fixed data drives: Yes\n   - Require device encryption: Yes\n4. Configure BitLocker removable drive settings:\n   - Removable drive encryption: Enable\n   - Block write access to removable data-drives not protected by BitLocker: Block\n   - Deny write access to devices configured in another organization: Yes\n5. Configure encryption method:\n   - Encryption method: XTS-AES 256-bit (recommended for NIST compliance)\n6. For recovery options:\n   - Allow users to suspend and decrypt BitLocker protection: Block\n   - Configure BitLocker recovery information to store in AD: Required (if applicable)\n7. Assign policy to device groups\n8. Monitor compliance via Endpoint security dashboard\n9. Test by connecting USB drive - should prompt for BitLocker encryption\n10. Verify write-blocking works for unencrypted removable drives",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices",
      "controlMappings": [
        {
          "controlId": "03.08.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "BitLocker encryption for removable drives provides cryptographic protection for CUI when removable media use is permitted. This is a Microsoft security baseline recommendation and CIS Benchmark Level 1 control. When removable media cannot be completely blocked, encryption ensures CUI protection aligns with NIST requirements for media security.",
          "nistRequirement": "Restrict or prohibit the use of [Assignment: organization-defined types of system media]"
        }
      ]
    },
    {
      "id": "IN-MP-003",
      "settingName": "AllowedUSBDevicesByVID_PID",
      "displayName": "Allow Only Approved USB Devices (Device ID)",
      "settingPath": "DeviceConfiguration.Windows.ControlledFolder.AllowedDevices",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "OrganizationDefinedDeviceList",
      "validationOperator": "in",
      "description": "Configures a whitelist of approved USB devices using Vendor ID (VID) and Product ID (PID), allowing only organization-issued removable media. This enforces the requirement that removable media have an identifiable owner.",
      "implementationGuide": "1. Identify approved USB device VID/PID:\n   - Connect approved device to test machine\n   - Open Device Manager > USB device > Properties > Details > Hardware IDs\n   - Note VID and PID (e.g., VID_0781&PID_5581 for SanDisk)\n2. In Intune admin center, create Configuration profile:\n   - Platform: Windows 10 and later\n   - Profile type: Templates > Custom\n3. Add OMA-URI settings for device control:\n   - Name: Allow Approved USB Devices\n   - OMA-URI: ./Vendor/MSFT/Defender/Configuration/DeviceControl/PolicyGroups\n   - Data type: String (XML)\n   - Value: (XML defining approved device VIDs/PIDs)\n4. Alternatively use Settings Catalog:\n   - Defender > Device Control > Device Installation\n   - Configure 'Allow installation of devices that match any of these device IDs'\n   - Add approved device VID_XXXX&PID_YYYY entries\n5. Block all other devices:\n   - Configure 'Prevent installation of devices not described by other policy settings': Enabled\n6. Assign policy to device groups\n7. Test with both approved and non-approved USB devices\n8. Monitor via Endpoint security reports\n9. Maintain inventory of approved devices with serial numbers (identifiable owners)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/administrative-templates-windows",
      "controlMappings": [
        {
          "controlId": "03.08.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Device ID whitelisting ensures only organization-approved removable media can be used, directly satisfying the requirement to prohibit use of removable media without an identifiable owner. By limiting to specific VID/PID combinations that correspond to organization-issued devices, accountability is maintained through device tracking.",
          "nistRequirement": "Prohibit the use of removable system media without an identifiable owner"
        }
      ]
    },
    {
      "id": "IN-MP-004",
      "settingName": "USBWriteProtection",
      "displayName": "Enable Write Protection for Removable Storage",
      "settingPath": "DeviceConfiguration.Windows.RemovableStorage.WriteProtection",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enable",
      "validationOperator": "==",
      "description": "Configures write protection for removable storage devices, allowing read access but preventing data from being written to removable media. This controls the use of removable media by preventing CUI from being copied to unauthorized removable storage.",
      "implementationGuide": "1. In Microsoft Intune admin center, go to Devices > Configuration profiles\n2. Create profile > Settings catalog\n3. Add settings category: Storage\n4. Configure settings:\n   - 'Removable Disks: Deny write access': Enabled\n5. Or use Administrative Templates profile:\n   - Profile type: Templates > Administrative Templates\n   - Navigate to: System > Removable Storage Access\n   - Configure: 'Removable Disks: Deny write access' = Enabled\n6. For exceptions, create separate policies:\n   - Use Windows Filtering Platform (WFP) to allow specific applications to write\n   - Or create exemption groups for authorized users\n7. Assign policy to device groups handling CUI\n8. Test by attempting to copy file to USB drive (should be blocked)\n9. Test read access to ensure files can still be opened from USB\n10. Monitor enforcement via device configuration reports\n11. Document exceptions and approvals for audit trail",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/administrative-templates-windows",
      "controlMappings": [
        {
          "controlId": "03.08.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Write protection for removable storage restricts the use of removable media by preventing data exfiltration while still allowing read access when needed. This is a balanced approach that controls media use without completely prohibiting it, which is suitable for environments that need some removable media access but want to prevent unauthorized data copying.",
          "nistRequirement": "Restrict or prohibit the use of [Assignment: organization-defined types of system media]"
        }
      ]
    },
    {
      "id": "IN-MP-005",
      "settingName": "DefenderDeviceControlPolicy",
      "displayName": "Microsoft Defender Device Control Policy",
      "settingPath": "DeviceConfiguration.Windows.Defender.DeviceControl.Enabled",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "enabled": true,
        "defaultEnforcement": "Deny"
      },
      "validationOperator": "contains",
      "description": "Configures Microsoft Defender for Endpoint device control policies to manage removable storage and peripheral device usage. Provides granular control over what types of removable media can be used and under what conditions.",
      "implementationGuide": "1. Ensure devices are onboarded to Microsoft Defender for Endpoint\n2. In Microsoft 365 Defender portal (security.microsoft.com), go to Settings > Endpoints > Device control\n3. Enable Device Control feature\n4. In Intune, create Device Control policy:\n   - Endpoint security > Attack surface reduction > Create Policy\n   - Platform: Windows 10, Windows 11, and Windows Server\n   - Profile: Device control\n5. Configure device classes to control:\n   - Removable storage: Deny (or Allow with conditions)\n   - CD/DVD: Deny\n   - Windows Portable Devices: Deny\n   - Bluetooth: Allow (or customize)\n6. Configure exceptions/allow rules:\n   - Create groups for authorized devices (by VID/PID)\n   - Create groups for authorized users\n   - Define read-only access for specific scenarios\n7. Configure audit-only mode initially for testing:\n   - Set Default Enforcement to 'Audit'\n   - Monitor for 2-4 weeks via Defender Advanced Hunting\n8. Switch to enforcement mode:\n   - Set Default Enforcement to 'Deny'\n   - Create allow rules for legitimate use cases\n9. Monitor device control events via Advanced Hunting:\n   - Query: DeviceEvents | where ActionType has 'DeviceControl'\n10. Create alerts for policy violations\n11. Maintain documentation of approved devices and authorized users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/device-control-overview",
      "controlMappings": [
        {
          "controlId": "03.08.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Microsoft Defender Device Control provides comprehensive enforcement of removable media restrictions with detailed logging and granular exceptions. This is a Microsoft security baseline recommendation that provides both prevention (blocking unauthorized devices) and detection (auditing device usage), satisfying both aspects of the NIST requirement to restrict media use.",
          "nistRequirement": "Restrict or prohibit the use of [Assignment: organization-defined types of system media]"
        }
      ]
    },
    {
      "id": "AZ-MP-001",
      "settingName": "ConditionalAccessBlockUnmanagedDevices",
      "displayName": "Conditional Access - Block Access from Unmanaged Devices",
      "settingPath": "ConditionalAccess.GrantControls.RequireCompliantDevice",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces Conditional Access policy requiring device compliance before accessing Microsoft 365 resources. This ensures only devices under management (with enforced removable media controls) can access CUI, preventing access from uncontrolled devices with unrestricted media use.",
      "implementationGuide": "1. Sign in to Azure portal (portal.azure.com) or Entra admin center\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create new policy: 'Block Unmanaged Device Access'\n4. Configure Assignments:\n   - Users: All users (or specific groups handling CUI)\n   - Cloud apps: All cloud apps (or specific M365 apps: Office 365, SharePoint, Exchange)\n   - Conditions: Device platforms: All platforms\n5. Configure Access controls:\n   - Grant: Require device to be marked as compliant (checked)\n   - OR: Require Hybrid Azure AD joined device (checked)\n   - For multiple controls: Require one of the selected controls\n6. Configure Session controls (optional):\n   - Use app enforced restrictions (for SharePoint/Exchange)\n7. Enable policy:\n   - Set 'Enable policy' to 'Report-only' initially\n   - Test for 1-2 weeks, review sign-in logs\n   - Switch to 'On' for enforcement\n8. Create break-glass account exemption for emergency access\n9. Test policy:\n   - Attempt access from non-compliant device (should be blocked)\n   - Attempt access from compliant device (should succeed)\n10. Monitor via Azure AD sign-in logs and Conditional Access insights\n11. Document policy exceptions and review quarterly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/require-managed-devices",
      "controlMappings": [
        {
          "controlId": "03.08.07",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Conditional Access ensures that only managed devices with enforced removable media controls can access CUI-containing resources. This provides organizational-level control over media use by preventing access from devices that don't have removable storage restrictions enforced, creating a complete control framework that extends beyond just device-level policies.",
          "nistRequirement": "Restrict or prohibit the use of [Assignment: organization-defined types of system media]"
        }
      ]
    }
  ]
}
