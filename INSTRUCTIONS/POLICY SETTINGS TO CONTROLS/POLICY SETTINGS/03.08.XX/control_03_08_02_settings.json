{
  "controlId": "03.08.02",
  "controlTitle": "Media Access",
  "controlFamily": "MP",
  "totalSettings": 6,
  "settings": [
    {
      "id": "IN-MP-005",
      "settingName": "RemovableDiskDenyWriteAccess",
      "displayName": "Block Write Access to Removable Storage",
      "settingPath": "deviceConfiguration.storage.removableDiskDenyWriteAccess",
      "policyType": "Intune",
      "policySubType": "AttackSurfaceReduction",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enabled",
      "validationOperator": "==",
      "description": "Blocks write access to removable storage devices (USB drives) to prevent unauthorized copying of CUI to external media. Users can read from removable media but cannot write data to it.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Endpoint security > Attack surface reduction\n3. Select Create Policy > Platform: Windows 10 and later > Profile: Device Control\n4. Provide policy Name and Description\n5. Under Storage settings, configure:\n   - Removable Disk Deny Write Access: Enabled\n6. Assign policy to device groups (start with pilot group)\n7. Monitor via Endpoint security > Attack surface reduction > Policy name\n8. Validate: Users can read from USB but cannot write/copy files to USB drives\n9. Note: Does not block read access, only write operations",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-asr-policy",
      "controlMappings": [
        {
          "controlId": "03.08.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Restricts write access to removable media, effectively controlling which users/roles can store CUI on external storage. Prevents unauthorized data exfiltration while maintaining read capability for legitimate business needs. Aligns with CIS Benchmark recommendations for removable storage control.",
          "nistRequirement": "Restrict access to CUI on system media to authorized personnel or roles. Access to CUI on system media can be restricted by physically controlling such media."
        }
      ]
    },
    {
      "id": "IN-MP-006",
      "settingName": "RemovableStorageBlocked",
      "displayName": "Block Removable Storage via Device Restrictions",
      "settingPath": "deviceConfiguration.deviceRestrictions.general.storageBlockRemovableStorage",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Completely blocks use of removable storage devices (USB drives, external drives) on managed devices. Provides strictest control over media access for high-security environments.",
      "implementationGuide": "1. Navigate to Devices > Configuration > Create > New Policy\n2. Select Platform: Windows 10 and later\n3. Select Profile type: Templates > Device restrictions\n4. Provide policy Name and Description\n5. Under Configuration settings > General:\n   - Removable storage: Block\n6. Optionally configure related settings:\n   - USB connections (except for charging): Block\n7. Assign to device groups requiring highest security\n8. Test with USB device to verify complete blocking\n9. Note: This is an alternative to write-only blocking for environments requiring complete USB restriction",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-windows-10",
      "controlMappings": [
        {
          "controlId": "03.08.02",
          "confidence": "High",
          "isRequired": false,
          "mappingRationale": "Provides most restrictive access control for removable media by completely blocking usage. Suitable for roles/users who should have no access to removable storage. Implements principle of least privilege for media access. Use as alternative to write-blocking when complete restriction is required.",
          "nistRequirement": "Restrict access to CUI on system media to authorized personnel or roles"
        }
      ]
    },
    {
      "id": "PV-MP-001",
      "settingName": "EndpointDLPRemovableMediaBlocking",
      "displayName": "DLP Policy - Block Sensitive Data Copy to Removable Media",
      "settingPath": "dlpPolicy.conditions.contentContainsSensitiveInformation.actions.blockAccess",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "action": "BlockAccess",
        "location": "Devices",
        "activities": [
          "CopyToRemovableMedia"
        ]
      },
      "validationOperator": "contains",
      "description": "Prevents copying of files containing CUI or sensitive information to removable storage devices. Uses content inspection to identify sensitive data and blocks transfer to USB/external media.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal\n2. Navigate to Data loss prevention > Policies > Create policy\n3. Select template or Custom policy\n4. Name: Block Sensitive Data to Removable Media\n5. Configure Locations:\n   - Turn on: Devices\n6. Define policy conditions:\n   - Content contains: Sensitive info types (e.g., Social Security Number, Credit Card, Custom SITs)\n   - Add sensitivity labels if using Information Protection\n7. Configure Actions:\n   - Activity: Copy to removable USB device\n   - Action: Block with override / Block\n8. Set User notifications: Enable with policy tips\n9. Assign to user groups\n10. Test: Try copying sensitive file to USB device\n11. Monitor in Activity Explorer and DLP Alerts",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/endpoint-dlp-learn-about",
      "controlMappings": [
        {
          "controlId": "03.08.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Implements content-aware access control for removable media. Restricts access based on data classification/sensitivity rather than blanket blocking. Allows legitimate use of removable storage while preventing CUI exfiltration. Enables granular control over which users can copy what types of data.",
          "nistRequirement": "Restrict access to CUI on system media to authorized personnel or roles. For digital media, access to CUI can be restricted by using cryptographic means."
        }
      ]
    },
    {
      "id": "IN-MP-007",
      "settingName": "PreventDeviceInstallation",
      "displayName": "Prevent Installation of Removable Devices",
      "settingPath": "deviceConfiguration.deviceInstallation.preventInstallationOfMatchingDeviceIDs",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "enabled": true,
        "preventInstallationOfDevicesNotDescribedByOtherPolicySettings": true,
        "allowedDeviceSetupClasses": []
      },
      "validationOperator": "contains",
      "description": "Prevents installation of unauthorized removable storage devices by blocking device driver installation. Only explicitly allowed devices can be installed, enforcing strict device control.",
      "implementationGuide": "1. Navigate to Devices > Configuration > Create policy\n2. Select Platform: Windows 10 and later\n3. Select Profile type: Settings catalog\n4. Name: Restrict USB Device Installation\n5. Add settings from Device Installation category:\n   - 'Prevent installation of devices not described by other policy settings': Enable\n   - 'Allow installation of devices using drivers that match these device setup classes': Configure with approved classes (keyboard, mouse if needed)\n   - 'Allow installation of devices that match any of these Device IDs': Add approved USB device IDs\n6. To find device IDs: Device Manager > Properties > Hardware IDs\n7. Assign to device groups\n8. Test: Attempt to install non-approved USB device\n9. Monitor: Review setupapi.dev.log on devices for blocked installations",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/settings-catalog-restrict-usb",
      "controlMappings": [
        {
          "controlId": "03.08.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Implements allow-list approach for removable media devices. Only explicitly approved devices can be installed and accessed. Prevents unauthorized personal USB devices while allowing approved organizational media. CIS Benchmark recommendation for device control.",
          "nistRequirement": "Restrict access to CUI on system media to authorized personnel or roles. Physically controlling stored media includes conducting inventories and maintaining accountability for stored media."
        }
      ]
    },
    {
      "id": "PV-MP-002",
      "settingName": "RemovableStorageDeviceGroups",
      "displayName": "Configure Authorized Removable Storage Device Groups",
      "settingPath": "purview.endpointDLP.settings.removableUsbDeviceGroups",
      "policyType": "Purview",
      "policySubType": "EndpointDLPSettings",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": [
        {
          "groupName": "Approved Corporate USB Devices",
          "matchType": "DeviceId",
          "descriptors": [
            {
              "vendorId": "organization-specific",
              "productId": "organization-specific"
            }
          ]
        }
      ],
      "validationOperator": "contains",
      "description": "Defines groups of authorized removable storage devices based on Vendor ID, Product ID, Serial Number, or Hardware ID. Enables granular DLP policies with device-level exceptions.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal\n2. Go to Settings > Data Loss Prevention > Endpoint DLP settings\n3. Select 'Removable USB device groups'\n4. Create new device group:\n   - Name: Approved Corporate USB Devices\n   - Description: Company-issued encrypted USB drives\n5. Add device identifiers:\n   - Match type: Select from Vendor ID, Product ID, Serial Number, Device ID, Hardware ID, or Instance Path ID\n   - Get values from Device Manager on Windows device\n6. Repeat for different device groups (e.g., Executive USB devices)\n7. Reference these groups in DLP policies under 'Exceptions'\n8. Test: Copy sensitive file to device in approved group (should allow)\n9. Test: Copy to unapproved device (should block)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-configure-endpoint-settings",
      "controlMappings": [
        {
          "controlId": "03.08.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Enables role-based access control for removable media by defining authorized device groups. Different user roles can have different approved devices. Supports business need for selective media access while maintaining strict control. Facilitates audit trails showing which specific devices accessed CUI.",
          "nistRequirement": "Restrict access to CUI on system media to authorized personnel or roles. Conducting inventories and maintaining accountability for stored media."
        }
      ]
    },
    {
      "id": "AZ-MP-002",
      "settingName": "ConditionalAccessDeviceFilter",
      "displayName": "Conditional Access Device Filter - Require Managed Devices",
      "settingPath": "conditionalAccessPolicy.conditions.devices.deviceFilter",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "mode": "include",
        "rule": "device.isManaged -eq True"
      },
      "validationOperator": "contains",
      "description": "Restricts resource access to Intune-managed devices with enforced media access controls. Ensures only devices with proper removable storage policies can access CUI resources.",
      "implementationGuide": "1. Navigate to Azure AD > Security > Conditional Access\n2. Create new policy: Require Managed Devices for CUI Access\n3. Configure:\n   - Users: Include users with CUI access\n   - Cloud apps: Select apps containing CUI\n4. Under Conditions > Device state (preview):\n   - Configure: Yes\n   - Select 'Require device to be hybrid Azure AD joined or compliant'\n5. Under Conditions > Filter for devices:\n   - Configure: Yes\n   - Rule: device.isManaged -eq True\n6. Grant controls:\n   - Require device to be marked as compliant\n   - Require Hybrid Azure AD joined device\n7. Session: Configure as needed\n8. Enable policy\n9. Test with unmanaged device to verify blocking\n10. Monitor sign-in logs for policy application",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-grant",
      "controlMappings": [
        {
          "controlId": "03.08.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Ensures media access controls are enforced at the authentication layer. Only devices with Intune-managed removable storage policies can access CUI. Prevents BYOD or unmanaged devices from accessing sensitive data without proper media controls. Defense-in-depth approach combining device management with access control.",
          "nistRequirement": "Restrict access to CUI on system media to authorized personnel or roles. Controlled areas provide physical and procedural controls to meet requirements for protecting information."
        }
      ]
    }
  ],
  "implementationNotes": "Deploy settings in phases: 1) Start with Endpoint DLP for content-aware blocking (least disruptive), 2) Add device installation restrictions for unapproved devices, 3) Implement write-blocking or full blocking based on organizational risk tolerance. Configure removable storage device groups before enforcing strict DLP policies to allow exceptions. Test thoroughly in pilot groups before organization-wide rollout.",
  "validationApproach": "1. Test USB write blocking with various file types. 2. Verify DLP policy blocks sensitive data copy to removable media. 3. Confirm approved device groups work as exceptions. 4. Monitor DLP Activity Explorer for removable media events. 5. Review setupapi.dev.log on test devices for device installation blocks. 6. Validate Conditional Access policy blocks unmanaged device access.",
  "relatedControls": [
    "03.08.01",
    "03.08.07",
    "03.01.02"
  ]
}
