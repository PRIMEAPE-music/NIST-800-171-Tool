{
  "controlId": "03.08.01",
  "controlTitle": "Media Storage",
  "controlFamily": "MP",
  "totalSettings": 5,
  "settings": [
    {
      "id": "IN-MP-001",
      "settingName": "RequireDeviceEncryption",
      "displayName": "Require BitLocker Encryption via Device Compliance",
      "settingPath": "deviceCompliancePolicy.properties.requireBitLocker",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces BitLocker encryption on Windows devices to protect system media containing CUI at rest. Uses Device Health Attestation (DHA) service to validate encryption status at the TPM level.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Compliance policies > Create policy\n3. Select Platform: Windows 10 and later\n4. Under Device Health section, set 'Require BitLocker' to 'Require'\n5. Configure 'Require encryption of data storage on device' to 'Require' as secondary validation\n6. Assign policy to device groups\n7. Note: Device reboot required after BitLocker enablement for compliance reporting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows",
      "controlMappings": [
        {
          "controlId": "03.08.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Directly enforces secure storage of CUI on system media through full-disk encryption, ensuring physical control over encrypted data even if device is lost or stolen. BitLocker encryption is the primary Microsoft security baseline recommendation for protecting data at rest.",
          "nistRequirement": "Physically control and securely store system media that contain CUI"
        }
      ]
    },
    {
      "id": "IN-MP-002",
      "settingName": "BitLockerOSDriveEncryption",
      "displayName": "BitLocker Operating System Drive Encryption Policy",
      "settingPath": "endpointProtection.bitLocker.operatingSystemDrives",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "encryptionMethod": "xtsAes256",
        "startupAuthenticationRequired": true,
        "minimumPinLength": 6,
        "recoveryOptions": {
          "enableRecoveryInformationSaveToStore": true,
          "recoveryInformationToStore": "passwordAndKey",
          "blockDataRecoveryAgent": false
        }
      },
      "validationOperator": "contains",
      "description": "Configures BitLocker encryption for operating system drives with XTS-AES 256-bit encryption, startup authentication, and recovery key backup to Azure AD/Entra ID. Ensures secure storage of system media containing CUI.",
      "implementationGuide": "1. Navigate to Endpoint security > Disk encryption > Create Policy\n2. Select Platform: Windows 10 and later, Profile: BitLocker\n3. Configure OS Drive Settings:\n   - Encryption method: XTS-AES 256-bit\n   - Additional authentication at startup: Require\n   - Minimum PIN length: 6 characters\n4. Configure Recovery Options:\n   - Save BitLocker recovery information to Azure AD: Enable\n   - Store recovery information: Backup recovery passwords and key packages\n5. Assign to device groups\n6. Verify recovery keys stored in Azure AD device properties",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices",
      "controlMappings": [
        {
          "controlId": "03.08.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Implements full-disk encryption using industry-standard XTS-AES 256-bit algorithm to physically protect system media. Recovery key backup ensures controlled access to encrypted media. Aligns with CIS Benchmark BitLocker recommendations and Microsoft Security Baseline.",
          "nistRequirement": "Physically control and securely store system media that contain CUI. Secure storage includes controlled media library with physical controls."
        }
      ]
    },
    {
      "id": "IN-MP-003",
      "settingName": "BitLockerFixedDriveEncryption",
      "displayName": "BitLocker Fixed Data Drive Encryption Policy",
      "settingPath": "endpointProtection.bitLocker.fixedDrives",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "encryptionMethod": "xtsAes256",
        "requireEncryptionForWriteAccess": true,
        "recoveryOptions": {
          "enableRecoveryInformationSaveToStore": true,
          "recoveryInformationToStore": "passwordAndKey"
        }
      },
      "validationOperator": "contains",
      "description": "Enforces BitLocker encryption on fixed data drives to protect stored CUI. Requires encryption before write access is granted, preventing unencrypted data storage.",
      "implementationGuide": "1. In BitLocker policy, navigate to Fixed Data Drive Settings\n2. Configure:\n   - Encryption method: XTS-AES 256-bit\n   - Block write access to drives not protected by BitLocker: Enable\n3. Configure Recovery Options:\n   - Save BitLocker recovery information to Azure AD: Enable\n   - Store recovery information: Backup recovery passwords and key packages\n4. Set 'Allow standard users to enable encryption during Azure AD join': Enable\n5. Deploy policy to device groups\n6. Validate via Intune Encryption Report",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices",
      "controlMappings": [
        {
          "controlId": "03.08.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Extends physical protection to all fixed storage media on devices. Write-access blocking for unencrypted drives ensures all CUI storage is protected. Critical for multi-drive systems and prevents creation of unencrypted storage locations.",
          "nistRequirement": "Physically control and securely store system media that contain CUI"
        }
      ]
    },
    {
      "id": "IN-MP-004",
      "settingName": "BitLockerRemovableDriveEncryption",
      "displayName": "BitLocker Removable Drive Encryption Enforcement",
      "settingPath": "endpointProtection.bitLocker.removableDrives",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": {
        "encryptionMethod": "aesCbc256",
        "requireEncryptionForWriteAccess": true,
        "blockCrossOrganizationWriteAccess": true
      },
      "validationOperator": "contains",
      "description": "Requires BitLocker encryption on removable drives before write access is permitted. Prevents CUI from being written to unencrypted removable media (USB drives, external drives).",
      "implementationGuide": "1. In BitLocker policy, navigate to Removable Data Drive Settings\n2. Configure:\n   - Encryption method: AES-CBC 256-bit (for compatibility with non-Windows systems)\n   - Deny write access to removable drives not protected by BitLocker: Enable\n   - Block write access to devices configured in another organization: Enable\n3. Configure user options:\n   - Allow users to suspend and decrypt BitLocker: Block\n4. Deploy to device groups\n5. Test with unencrypted USB drive to verify write blocking\n6. Educate users on BitLocker To Go setup process",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices",
      "controlMappings": [
        {
          "controlId": "03.08.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Directly enforces encryption requirement for removable media, a key component of physical media control. Prevents accidental or intentional storage of CUI on unprotected removable media. Aligns with CIS Benchmark Level 1 control for removable drive encryption.",
          "nistRequirement": "Physically control and securely store system media that contain CUI. System media include digital and non-digital media including external or removable drives."
        }
      ]
    },
    {
      "id": "AZ-MP-001",
      "settingName": "CompliantDeviceRequired",
      "displayName": "Conditional Access - Require Compliant Device for Resource Access",
      "settingPath": "conditionalAccessPolicy.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": [
        "compliantDevice"
      ],
      "validationOperator": "contains",
      "description": "Enforces device compliance checks (including BitLocker encryption requirement) before granting access to resources. Prevents access from devices with unencrypted storage containing CUI.",
      "implementationGuide": "1. Sign in to Azure AD/Entra admin center\n2. Navigate to Security > Conditional Access > Create new policy\n3. Configure:\n   - Name: Require Compliant Device for All Apps\n   - Users: Include All users (or specific groups)\n   - Cloud apps: Include All cloud apps\n4. Under Access controls > Grant:\n   - Select 'Require device to be marked as compliant'\n5. Under Session: Configure as needed\n6. Enable policy: Report-only (test), then On\n7. Validate with non-compliant device to verify blocking\n8. Monitor via Sign-in logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-policy-compliant-device",
      "controlMappings": [
        {
          "controlId": "03.08.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Enforces the encryption compliance requirement at the access control layer. Devices without proper media encryption (BitLocker) cannot access CUI resources. Creates defense-in-depth by combining storage encryption with access controls. Microsoft Security Baseline recommendation for Zero Trust architecture.",
          "nistRequirement": "Physically control and securely store system media that contain CUI. Controlled areas provide physical and procedural controls to meet requirements for protecting information and systems."
        }
      ]
    }
  ],
  "implementationNotes": "Settings should be deployed in sequence: 1) BitLocker encryption policies first, 2) Device compliance policies after encryption rollout, 3) Conditional Access policies last. Allow 24-48 hours for initial BitLocker encryption to complete on devices. Device reboots are required for compliance detection via Device Health Attestation.",
  "validationApproach": "1. Use Intune Encryption Report to verify BitLocker status across devices. 2. Monitor Device Compliance dashboard for encryption compliance rates. 3. Test Conditional Access blocking with non-compliant device. 4. Verify BitLocker recovery keys stored in Azure AD device properties. 5. Audit failed sign-in attempts due to compliance failures.",
  "relatedControls": [
    "03.08.02",
    "03.13.08",
    "03.13.11"
  ]
}
