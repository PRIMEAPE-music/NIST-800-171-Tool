{
  "controlId": "03.06.01",
  "controlFamily": "IR",
  "controlTitle": "Incident Handling",
  "controlRequirement": "Implement an incident-handling capability that is consistent with the incident response plan and includes preparation, detection and analysis, containment, eradication, and recovery.",
  "controlPriority": "High",
  "settingsCount": 5,
  "settings": [
    {
      "id": "DF-IR-001",
      "settingName": "AutomatedInvestigation",
      "displayName": "Automated Investigation and Response (AIR) - Full Automation",
      "settingPath": "security.microsoft.com/securitysettings/deviceManagement",
      "policyType": "Defender",
      "policySubType": "AutomatedInvestigation",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Full",
      "validationOperator": "==",
      "description": "Enables Microsoft Defender XDR to automatically investigate alerts and take remediation actions without manual approval. This setting ensures incidents are automatically analyzed and threats are contained, eradicated, and recovered from in real-time, supporting the preparation, detection, analysis, containment, eradication, and recovery phases of incident handling required by NIST 03.06.01.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. Go to Settings > Endpoints > Advanced features\n3. Under 'Automated Investigation', select 'Full - remediate threats automatically'\n4. Click 'Save preferences'\n5. For Defender for Office 365, go to Email & collaboration > Policies & rules > Threat policies > Automated investigation & response\n6. Select automation level 'Full - remediate threats automatically' for all device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/m365d-autoir",
      "controlMappings": [
        {
          "controlId": "03.06.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Automated Investigation and Response (AIR) directly implements the detection and analysis, containment, eradication, and recovery phases of incident handling. AIR automatically investigates security alerts, correlates related alerts into incidents, determines threat verdicts, and executes remediation actions such as quarantining malicious files, blocking URLs, isolating devices, and disabling compromised user accounts. This automation ensures consistent, rapid incident response 24/7 without requiring manual intervention, which is essential for effective incident handling capability.",
          "nistRequirement": "Implement an incident-handling capability that includes detection and analysis, containment, eradication, and recovery"
        }
      ]
    },
    {
      "id": "DF-IR-002",
      "settingName": "IncidentCorrelation",
      "displayName": "Microsoft Defender XDR Incident Correlation",
      "settingPath": "security.microsoft.com/incidents",
      "policyType": "Defender",
      "policySubType": "IncidentManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Defender XDR to automatically correlate related alerts from multiple workloads (Defender for Endpoint, Defender for Office 365, Defender for Identity, Defender for Cloud Apps) into unified incidents. This provides comprehensive visibility into the full attack story across devices, users, mailboxes, and cloud apps, enabling effective incident analysis and coordinated response across all vectors as required for incident handling preparation and detection phases.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. Go to Settings > Microsoft Defender XDR > Account\n3. Verify 'Microsoft Defender XDR' is turned on\n4. Under 'Incidents and alerts', ensure correlation is enabled\n5. Configure incident assignment and notification preferences\n6. Review Settings > Microsoft Defender XDR > Preview features to enable latest correlation capabilities\n7. Validate by checking Incidents page shows correlated alerts from multiple sources",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/investigate-incidents",
      "controlMappings": [
        {
          "controlId": "03.06.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Incident correlation is critical for effective incident handling preparation and detection/analysis phases. By automatically grouping related security events from across Microsoft 365 workloads into unified incidents, security teams can see the complete attack story, understand the scope and impact, identify all affected assets (devices, users, mailboxes, apps), and implement coordinated containment and eradication measures. This unified view prevents fragmented response and ensures all components of an attack are addressed together, which is essential for comprehensive incident handling.",
          "nistRequirement": "Implement an incident-handling capability that is consistent with the incident response plan and includes preparation, detection and analysis"
        }
      ]
    },
    {
      "id": "DF-IR-003",
      "settingName": "ThreatIntelligence",
      "displayName": "Microsoft Threat Intelligence Integration",
      "settingPath": "security.microsoft.com/securitysettings/threat-intelligence",
      "policyType": "Defender",
      "policySubType": "ThreatIntelligence",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables integration with Microsoft Threat Intelligence to provide real-time threat indicators, context, and recommended response actions during incident investigations. This setting enhances the detection and analysis phase by providing security teams with up-to-date information about threat actors, attack techniques, indicators of compromise (IOCs), and proven remediation strategies, enabling more effective preparation and response to security incidents.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. Go to Settings > Endpoints > Advanced features\n3. Enable 'Threat intelligence' setting\n4. Go to Threat analytics (https://security.microsoft.com/threatanalytics3)\n5. Review analyst reports for latest threat intelligence\n6. Configure custom threat indicators under Settings > Endpoints > Indicators\n7. Set up alert notifications for high-priority threats\n8. Integrate with Microsoft Defender Threat Intelligence Premium if licensed for enhanced IOC feeds",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/threat-indicator-concepts",
      "controlMappings": [
        {
          "controlId": "03.06.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Threat intelligence integration directly supports the preparation and detection/analysis phases of incident handling. By providing real-time information about current threats, attack techniques, and indicators of compromise, threat intelligence enables security teams to proactively prepare defenses, quickly identify known attack patterns during detection, understand the tactics and procedures used by attackers during analysis, and implement proven containment and eradication strategies. This intelligence-driven approach ensures incident handling is based on current threat landscape knowledge rather than reactive measures.",
          "nistRequirement": "Implement an incident-handling capability that includes preparation, detection and analysis"
        }
      ]
    },
    {
      "id": "DF-IR-004",
      "settingName": "AutomatedRemediation",
      "displayName": "Automated Remediation Actions Configuration",
      "settingPath": "security.microsoft.com/preferences2/integration",
      "policyType": "Defender",
      "policySubType": "RemediationActions",
      "platform": "All",
      "dataType": "array",
      "expectedValue": [
        "QuarantineFile",
        "RemoveFile",
        "StopProcess",
        "IsolateDevice",
        "BlockUrl",
        "DisableUser"
      ],
      "validationOperator": "contains",
      "description": "Configures which automated remediation actions Microsoft Defender XDR can execute during investigations. Critical actions include quarantining malicious files, removing threats, stopping malicious processes, isolating compromised devices, blocking malicious URLs, and disabling compromised user accounts. These automated actions directly implement the containment, eradication, and recovery phases of incident handling by automatically removing threats and preventing spread without requiring manual intervention.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. Go to Settings > Microsoft Defender XDR > Automated investigation and remediation\n3. For Defender for Endpoint: Settings > Endpoints > Device groups > Create/edit device group\n4. Set Automation level to 'Full - remediate threats automatically'\n5. Ensure the following remediation actions are enabled:\n   - Quarantine file\n   - Remove file\n   - Stop and quarantine process\n   - Isolate device\n   - Block URL\n   - Disable user account\n6. For Defender for Office 365: Email & collaboration > Threat policies > Automated investigation\n7. Configure similar remediation actions for email threats (soft delete, move to junk, block sender)\n8. Review Action Center regularly to monitor automated remediation effectiveness",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/m365d-autoir-actions",
      "controlMappings": [
        {
          "controlId": "03.06.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Automated remediation actions are essential for the containment, eradication, and recovery phases of incident handling. These actions enable immediate, automated response to threats - containing the incident by isolating affected systems and blocking malicious resources, eradicating threats by removing malware and disabling compromised accounts, and supporting recovery by preventing further spread. The automation ensures consistent execution of incident response procedures 24/7 with minimal delay, which is critical for effective incident handling as required by NIST 03.06.01.",
          "nistRequirement": "Implement an incident-handling capability that includes containment, eradication, and recovery"
        }
      ]
    },
    {
      "id": "PV-IR-005",
      "settingName": "IncidentResponsePlaybooks",
      "displayName": "Security Playbooks and Automated Workflows",
      "settingPath": "security.microsoft.com/automation",
      "policyType": "Purview",
      "policySubType": "AutomationRules",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables security playbooks and automated workflows that define step-by-step procedures for responding to specific types of security incidents. Playbooks ensure consistent incident handling processes across the organization by automating investigation steps, evidence collection, notification procedures, and remediation actions. This supports the preparation phase by pre-defining response procedures and ensures all phases (detection, analysis, containment, eradication, recovery) follow documented, tested processes.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. For built-in playbooks: Go to Automated investigation under Email & collaboration\n3. Review available playbook types:\n   - User-reported phishing\n   - Malware in email\n   - Suspicious email forwarding\n   - Compromised user detection\n4. For custom workflows: Settings > Microsoft Defender XDR > Automation & orchestration\n5. Create custom automation rules for specific incident types\n6. Define automated actions such as:\n   - Assign to specific analyst or team\n   - Add tags for categorization\n   - Close low-severity incidents automatically\n   - Escalate high-severity incidents\n   - Notify stakeholders via email or Teams\n7. Test playbooks using simulated incidents to validate effectiveness\n8. Document playbook logic and decision trees for audit purposes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/m365d-autoir",
      "controlMappings": [
        {
          "controlId": "03.06.01",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Security playbooks directly implement the requirement for incident-handling capability that is consistent with the incident response plan. Playbooks codify the organization's incident response procedures into automated workflows, ensuring that all incidents are handled according to documented plans and follow the required phases of preparation, detection and analysis, containment, eradication, and recovery. By automating the execution of response procedures, playbooks ensure consistency, reduce human error, accelerate response times, and provide audit trails of incident handling activities, all of which are essential for effective incident handling as required by NIST 03.06.01.",
          "nistRequirement": "Implement an incident-handling capability that is consistent with the incident response plan and includes all incident handling phases"
        }
      ]
    }
  ],
  "implementationNotes": "These settings represent the core incident handling capabilities in Microsoft 365 that directly map to NIST 800-171 Rev 3 control 03.06.01. All settings are HIGH confidence and align with Microsoft security baselines and CIS Microsoft 365 Foundations Benchmark recommendations. Organizations should configure full automation level for AIR to ensure 24/7 incident response capability. Regular review of automated investigation outcomes and adjustment of remediation actions based on organizational needs is recommended. These capabilities require Microsoft Defender for Office 365 Plan 2 or Microsoft 365 E5 licensing.",
  "complianceReferences": [
    "CIS Microsoft 365 Foundations Benchmark - Incident Response controls",
    "Microsoft Security Baseline - Automated Investigation and Response",
    "NIST SP 800-61 Rev 2 - Computer Security Incident Handling Guide",
    "NIST SP 800-171 Rev 3 - Control 03.06.01"
  ]
}
