{
  "controlId": "03.11.02",
  "family": "RA",
  "familyName": "Risk Assessment",
  "title": "Vulnerability Monitoring and Scanning",
  "requirementText": "a. Monitor and scan the system for vulnerabilities [Assignment: organization-defined frequency] and when new vulnerabilities affecting the system are identified.\nb. Remediate system vulnerabilities within [Assignment: organization-defined response times].\nc. Update system vulnerabilities to be scanned [Assignment: organization-defined frequency] and when new vulnerabilities are identified and reported.",
  "settings": [
    {
      "id": "DF-RA-004",
      "settingName": "vulnerabilityManagement.scanning.enabled",
      "displayName": "Microsoft Defender Vulnerability Management Scanning",
      "settingPath": "DefenderForEndpoint.VulnerabilityManagement.Scanning",
      "policyType": "Defender",
      "policySubType": "VulnerabilityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables continuous vulnerability scanning across all endpoints using Microsoft Defender Vulnerability Management. Provides agentless, real-time vulnerability detection for software, configurations, missing patches, and security weaknesses using CVE database and Microsoft threat intelligence.",
      "implementationGuide": "1. Navigate to Microsoft 365 Defender portal\n2. Go to Settings > Endpoints > Advanced features\n3. Enable 'Microsoft Defender Vulnerability Management'\n4. Verify devices are onboarded to Defender for Endpoint\n5. Go to Vulnerability management > Dashboard\n6. Confirm continuous scanning is active (real-time, no schedule needed)\n7. Review discovered vulnerabilities organized by CVE\n8. Configure vulnerability severity thresholds\n9. Enable automatic vulnerability database updates (daily)\n10. Set up alerts for new critical/high vulnerabilities\n11. Monitor scan coverage to ensure all devices are assessed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-vulnerability-management/defender-vulnerability-management",
      "controlMappings": [
        {
          "controlId": "03.11.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Defender Vulnerability Management provides continuous, automated vulnerability scanning across all endpoints. It monitors for software vulnerabilities, missing patches, and misconfigurations, and automatically updates its vulnerability database when new CVEs are published, directly satisfying requirement to monitor and scan for vulnerabilities.",
          "nistRequirement": "Monitor and scan the system for vulnerabilities at organization-defined frequency and when new vulnerabilities are identified"
        }
      ]
    },
    {
      "id": "DF-RA-005",
      "settingName": "vulnerabilityManagement.automaticUpdates.enabled",
      "displayName": "Automatic Vulnerability Database Updates",
      "settingPath": "DefenderForEndpoint.VulnerabilityManagement.AutomaticUpdates",
      "policyType": "Defender",
      "policySubType": "VulnerabilityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables automatic updates to the vulnerability scanning database including CVE definitions, software version mappings, and threat intelligence. Ensures vulnerability scans include latest known vulnerabilities without manual intervention.",
      "implementationGuide": "1. Navigate to Microsoft 365 Defender portal\n2. Go to Vulnerability management > Settings\n3. Verify 'Automatic updates' is enabled (default enabled)\n4. Confirm update frequency is set to daily minimum\n5. Review update log to verify successful updates\n6. Enable notifications for failed updates\n7. Monitor for new vulnerability definitions being applied\n8. Verify CVE database version is current\n9. Test scanning detects recently published CVEs\n10. Document update schedule for audit evidence",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-vulnerability-management/tvm-software-inventory",
      "controlMappings": [
        {
          "controlId": "03.11.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Automatic vulnerability database updates ensure that scanning includes the latest CVE definitions and vulnerability information. This directly satisfies requirement to update system vulnerabilities to be scanned when new vulnerabilities are identified and reported.",
          "nistRequirement": "Update system vulnerabilities to be scanned at organization-defined frequency and when new vulnerabilities are identified and reported"
        }
      ]
    },
    {
      "id": "IN-RA-001",
      "settingName": "compliance.policy.deviceComplianceRequired",
      "displayName": "Intune Device Compliance Policy Required",
      "settingPath": "Intune.Compliance.DeviceComplianceRequired",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires all devices to meet compliance policies that include vulnerability checks such as minimum OS version, required security updates, encryption status, and threat level. Non-compliant devices are blocked from accessing corporate resources until vulnerabilities are remediated.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center (https://intune.microsoft.com)\n2. Go to Devices > Compliance policies\n3. Create policy for each platform (Windows, iOS, Android)\n4. Configure minimum OS version requirements\n5. Set 'Require device to be at or under device threat level' to Medium\n6. Enable 'Firewall required'\n7. Set 'Encryption of data storage on device' to Required\n8. Configure 'Microsoft Defender for Endpoint integration' if available\n9. Set compliance check frequency to Daily\n10. Configure Conditional Access to block non-compliant devices\n11. Set grace period for remediation (24-48 hours recommended)\n12. Assign policies to all users/devices",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started",
      "controlMappings": [
        {
          "controlId": "03.11.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Device compliance policies enforce vulnerability remediation by blocking access for devices with missing patches, outdated OS versions, or security issues. This directly supports requirement to remediate system vulnerabilities within defined response times by preventing non-compliant device access.",
          "nistRequirement": "Remediate system vulnerabilities within organization-defined response times"
        }
      ]
    },
    {
      "id": "IN-RA-002",
      "settingName": "updateRings.windowsUpdate.automaticUpdates",
      "displayName": "Windows Update Automatic Updates Enabled",
      "settingPath": "Intune.UpdateRings.WindowsUpdate.AutomaticUpdates",
      "policyType": "Intune",
      "policySubType": "UpdateRings",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 4,
      "validationOperator": "==",
      "description": "Configures Windows Update to automatically download and install security updates and patches. Setting value 4 enables 'Auto download and schedule the install' which ensures timely vulnerability remediation without user intervention.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Go to Devices > Windows > Update rings\n3. Create new update ring policy\n4. Set 'Automatic update behavior' to 'Auto download and schedule install'\n5. Configure 'Quality update deferral period' to 0-7 days maximum\n6. Set 'Feature update deferral period' to 0-30 days\n7. Enable 'Automatic update maintenance window' with appropriate hours\n8. Configure 'Deadline for feature updates' to 7 days\n9. Configure 'Deadline for quality updates' to 3 days\n10. Set 'Grace period' to 2 days for user-initiated restarts\n11. Enable 'Update notifications' to inform users\n12. Assign policy to all Windows devices\n13. Monitor update installation status regularly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/windows-update-for-business-configure",
      "controlMappings": [
        {
          "controlId": "03.11.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Automatic Windows Updates ensure security patches and vulnerability fixes are deployed promptly and consistently across all Windows endpoints. This directly supports requirement to remediate system vulnerabilities within defined response times by automating patch deployment.",
          "nistRequirement": "Remediate system vulnerabilities within organization-defined response times"
        }
      ]
    },
    {
      "id": "DF-RA-006",
      "settingName": "defenderForEndpoint.realTimeProtection.enabled",
      "displayName": "Microsoft Defender Real-Time Protection",
      "settingPath": "DefenderForEndpoint.RealTimeProtection",
      "policyType": "Defender",
      "policySubType": "AntivirusPolicy",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Defender real-time protection which continuously monitors for malware, exploits, and vulnerabilities. Provides real-time scanning of files, processes, and network activity to detect and block exploitation of known vulnerabilities.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Go to Endpoint security > Antivirus\n3. Create Microsoft Defender Antivirus policy\n4. Set 'Turn on real-time protection' to Enabled\n5. Set 'Scan all downloaded files and attachments' to Enabled\n6. Enable 'Monitor file and program activity'\n7. Set 'Turn on behavior monitoring' to Enabled\n8. Configure 'Cloud-delivered protection' to Enabled\n9. Set 'Scan archive files' to Enabled\n10. Enable 'Scan removable drives during full scan'\n11. Assign policy to all Windows devices\n12. Monitor protection status in Microsoft 365 Defender portal\n13. Review detection and prevention events regularly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-real-time-protection-microsoft-defender-antivirus",
      "controlMappings": [
        {
          "controlId": "03.11.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Real-time protection continuously monitors for active exploitation of vulnerabilities and malware attempting to leverage security weaknesses. This provides immediate detection and response to vulnerability exploitation attempts, supporting requirement to monitor system for vulnerabilities and threats.",
          "nistRequirement": "Monitor and scan the system for vulnerabilities continuously and respond to exploitation attempts"
        }
      ]
    },
    {
      "id": "DF-RA-007",
      "settingName": "vulnerabilityManagement.securityRecommendations.tracking",
      "displayName": "Vulnerability Management Security Recommendations",
      "settingPath": "DefenderForEndpoint.VulnerabilityManagement.SecurityRecommendations",
      "policyType": "Defender",
      "policySubType": "VulnerabilityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables security recommendations feature which provides prioritized, actionable remediation guidance for discovered vulnerabilities. Tracks remediation status, assigns remediation tasks, and measures time-to-remediation to ensure vulnerabilities are addressed within required timeframes.",
      "implementationGuide": "1. Navigate to Microsoft 365 Defender portal\n2. Go to Vulnerability management > Recommendations\n3. Review security recommendations sorted by risk score\n4. Enable 'Remediation tracking' for all recommendations\n5. Configure remediation SLAs: Critical (24-48 hours), High (7 days), Medium (30 days)\n6. Assign recommendations to IT staff using 'Request remediation' feature\n7. Track remediation progress in dashboard\n8. Enable 'Exception management' for accepted risks\n9. Configure email notifications for new critical vulnerabilities\n10. Export remediation reports weekly for compliance evidence\n11. Monitor 'Mean time to remediate' metric\n12. Review recommendation compliance rate monthly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-vulnerability-management/tvm-security-recommendation",
      "controlMappings": [
        {
          "controlId": "03.11.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Security recommendations provide structured workflow for vulnerability remediation including assignment, tracking, and SLA monitoring. This directly supports requirement to remediate system vulnerabilities within organization-defined response times by providing remediation tracking and enforcement.",
          "nistRequirement": "Remediate system vulnerabilities within organization-defined response times and track remediation activities"
        }
      ]
    }
  ],
  "totalSettings": 6,
  "implementationNotes": "These settings provide comprehensive, continuous vulnerability monitoring and automated remediation enforcement. Defender Vulnerability Management provides the core scanning engine with automatic updates, while Intune compliance policies and update rings enforce remediation. Organizations should define response time SLAs based on vulnerability severity (e.g., Critical: 24-48 hours, High: 7 days, Medium: 30 days, Low: 90 days). Real-time protection and security recommendations ensure both preventive and detective controls are in place.",
  "complianceEvidence": "Export vulnerability scan reports, remediation tracking data, update deployment status, and compliance policy reports to demonstrate continuous vulnerability monitoring and timely remediation. Maintain documentation of vulnerability scanning frequency, remediation SLAs, and exception approvals.",
  "microsoftBaselineReference": "Microsoft Security Baseline for Microsoft 365 - Vulnerability Management and Patch Management sections",
  "cisReference": "CIS Microsoft 365 Foundations Benchmark v3.0 - Sections on Defender for Endpoint and Update Management; CIS Microsoft Intune Benchmark - Update Ring configurations",
  "priority": "High"
}
