{
  "controlId": "03.03.02",
  "controlTitle": "Audit Record Content",
  "controlFamily": "AU",
  "settings": [
    {
      "id": "AZ-AU-003",
      "settingName": "SignInLogDetailedContent",
      "displayName": "Azure AD Sign-In Log Content Configuration",
      "settingPath": "properties.logs[?(@.category=='SignInLogs')].enabled",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Ensures sign-in logs capture comprehensive event details including: what occurred (authentication event), when it occurred (timestamp), where (location/IP), source (application/device), outcome (success/failure), and user identity. This satisfies all NIST audit record content requirements.",
      "implementationGuide": "1. Navigate to Azure Portal > Azure Active Directory > Monitoring > Diagnostic settings\n2. Verify 'SignInLogs' category is enabled (prerequisite from 03.03.01)\n3. Sign-in logs automatically capture required fields:\n   - What: Operation name (e.g., 'Sign-in activity')\n   - When: TimeGenerated (UTC timestamp)\n   - Where: Location, IPAddress, City, State, Country\n   - Source: AppDisplayName, DeviceDetail, UserAgent\n   - Outcome: ResultType (0=success, other=failure)\n   - Identity: UserPrincipalName, UserId\n4. Export sample log to verify content: Azure AD > Sign-in logs > Select event > Download\n5. Query Log Analytics to verify fields present if using workspace destination",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-sign-ins",
      "controlMappings": [
        {
          "controlId": "03.03.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Azure AD sign-in logs automatically capture all required NIST audit record content elements: event type (authentication), timestamp, location (IP/geo), source (app/device), outcome (success/failure), and user identity. This built-in content structure directly satisfies NIST 03.03.02 requirements.",
          "nistRequirement": "Ensure audit records contain: (a) What type of event occurred; (b) When the event occurred; (c) Where the event occurred; (d) Source of the event; (e) Outcome of the event; (f) Identity of individuals, subjects, or objects/entities"
        }
      ]
    },
    {
      "id": "AZ-AU-004",
      "settingName": "AuditLogDetailedContent",
      "displayName": "Azure AD Audit Log Content Configuration",
      "settingPath": "properties.logs[?(@.category=='AuditLogs')].enabled",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Ensures Azure AD audit logs capture comprehensive event details for directory operations including account changes, role modifications, policy updates with full NIST-required content fields automatically populated.",
      "implementationGuide": "1. Verify Azure AD Audit Logs diagnostic setting is enabled\n2. Audit logs automatically capture:\n   - What: ActivityDisplayName (e.g., 'Add user', 'Update role')\n   - When: ActivityDateTime (ISO 8601 format)\n   - Where: Derived from actor location when available\n   - Source: InitiatedBy (actor), TargetResources (objects affected)\n   - Outcome: Result (success, failure, or partial success)\n   - Identity: InitiatedBy.user.userPrincipalName, id, ipAddress\n3. Verify content in Azure Portal: Azure AD > Audit logs > Select event > View details\n4. Additional detail fields: CorrelationId, Category, OperationType, AdditionalDetails\n5. Query sample: AuditLogs | where TimeGenerated > ago(1h) | project TimeGenerated, ActivityDisplayName, InitiatedBy, Result",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-audit-logs",
      "controlMappings": [
        {
          "controlId": "03.03.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Azure AD audit logs automatically include all NIST-required content fields for directory operations: activity type, precise timestamps, actor/initiator identity and location, target resources, and operation outcome. This built-in structure satisfies audit record content requirements for identity management operations.",
          "nistRequirement": "Ensure audit records contain comprehensive information establishing what, when, where, source, outcome, and identity for all directory and authentication events"
        }
      ]
    },
    {
      "id": "PV-AU-003",
      "settingName": "MailboxAuditLogContent",
      "displayName": "Exchange Mailbox Audit Log Content",
      "settingPath": "AuditOwner,AuditDelegate,AuditAdmin",
      "policyType": "Purview",
      "policySubType": "MailboxAudit",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "ApproveMessagesWithDLExpansion,Create,FolderBind,HardDelete,MailboxLogin,MessageBind,Move,MoveToDeletedItems,SendAs,SendOnBehalf,SoftDelete,Update,UpdateCalendarDelegation,UpdateFolderPermissions,UpdateInboxRules",
      "validationOperator": "contains",
      "description": "Configures mailbox audit logging to capture detailed content for owner, delegate, and admin actions including what action occurred, timestamp, user identity, affected items, source IP, and outcome. Logs automatically include all NIST-required fields.",
      "implementationGuide": "1. Verify mailbox auditing is enabled: Get-OrganizationConfig | FL AuditDisabled\n2. Check default logged actions: Get-Mailbox -ResultSize Unlimited | Select UserPrincipalName,AuditOwner,AuditDelegate,AuditAdmin | FL\n3. Mailbox audit records automatically capture:\n   - What: Operation (e.g., 'HardDelete', 'SendAs', 'MailboxLogin')\n   - When: CreationTime (UTC timestamp)\n   - Where: ClientIPAddress, ClientInfoString\n   - Source: LogonUserDisplayName, LogonUserSid\n   - Outcome: ResultStatus (Succeeded/Failed)\n   - Identity: MailboxOwnerUPN, MailboxResolvedOwnerName\n4. View sample record: Search-UnifiedAuditLog -StartDate (Get-Date).AddDays(-1) -EndDate (Get-Date) -RecordType ExchangeItem -ResultSize 1 | FL\n5. Verify content fields present in AuditData property",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/mailbox-auditing",
      "controlMappings": [
        {
          "controlId": "03.03.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Exchange mailbox audit logs automatically capture all NIST-required content for email operations: operation type, UTC timestamp, client IP/location, actor identity, operation outcome, and affected mailbox. This comprehensive content supports forensic investigations of email-based CUI access.",
          "nistRequirement": "Capture complete audit record content for mailbox operations including event type, timing, location, identity, and outcome"
        }
      ]
    },
    {
      "id": "PV-AU-004",
      "settingName": "UnifiedAuditLogRecordContent",
      "displayName": "Microsoft 365 Unified Audit Log Record Schema",
      "settingPath": "UnifiedAuditLogRecordType",
      "policyType": "Purview",
      "policySubType": "AuditConfiguration",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "StandardSchema",
      "validationOperator": "==",
      "description": "The unified audit log uses a standardized schema across all M365 services that automatically includes required NIST content fields: CreationTime, Operation, OrganizationId, RecordType, UserType, UserId, ClientIP, ObjectId, and service-specific data.",
      "implementationGuide": "1. Verify unified audit log is enabled (prerequisite)\n2. Unified audit records automatically contain standard fields:\n   - What: Operation (activity name)\n   - When: CreationTime (UTC ISO 8601)\n   - Where: ClientIP, Workload (service)\n   - Source: UserId, UserKey, UserType\n   - Outcome: ResultStatus (when applicable)\n   - Identity: UserId, UserKey, ObjectId (target)\n3. View schema: Search-UnifiedAuditLog -StartDate (Get-Date).AddDays(-1) -EndDate (Get-Date) -ResultSize 1 | Select -ExpandProperty AuditData\n4. Standard fields always present: CreationTime, Id, Operation, OrganizationId, RecordType, UserKey, UserType, Version, Workload\n5. Additional fields vary by RecordType (service)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-schema",
      "controlMappings": [
        {
          "controlId": "03.03.02",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "The M365 unified audit log schema enforces consistent content structure across all services, ensuring every audit record contains the NIST-required fields. This standardization enables reliable parsing, analysis, and reporting of audit events for compliance verification.",
          "nistRequirement": "Maintain consistent audit record content structure that includes all required elements across all logged services and activities"
        }
      ]
    }
  ]
}
