{
  "controlId": "03.03.05",
  "controlTitle": "Audit Record Review, Analysis, and Reporting",
  "controlFamily": "AU",
  "settings": [
    {
      "id": "PV-AU-001",
      "settingName": "UnifiedAuditLogIngestionEnabled",
      "displayName": "Unified Audit Log Enabled",
      "settingPath": "AdminAuditLogConfig.UnifiedAuditLogIngestionEnabled",
      "policyType": "Purview",
      "policySubType": "AuditLogging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables unified audit logging across Microsoft 365 services to capture user and admin activities for review and analysis. This is the foundational setting that enables audit log collection for Exchange Online, SharePoint Online, OneDrive, Azure AD, Teams, and other M365 services.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Select 'Audit' from the left navigation\n3. Click 'Start recording user and admin activity' if not already enabled\n4. Verify status by running PowerShell: Connect-ExchangeOnline; Get-AdminAuditLogConfig | Format-List UnifiedAuditLogIngestionEnabled\n5. Document the enablement date and verify logs are being generated within 24 hours",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-enable-disable",
      "controlMappings": [
        {
          "controlId": "03.03.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Unified audit logging is the primary mechanism for capturing and reviewing audit records across Microsoft 365 services, directly satisfying the requirement to review and analyze system audit records for inappropriate or unusual activity.",
          "nistRequirement": "Review and analyze system audit records for indications and the potential impact of inappropriate or unusual activity"
        }
      ]
    },
    {
      "id": "PV-AU-002",
      "settingName": "AuditLogRetentionPolicy",
      "displayName": "Audit Log Retention Duration",
      "settingPath": "AuditRetentionPolicy.RetentionDuration",
      "policyType": "Purview",
      "policySubType": "AuditRetention",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 365,
      "validationOperator": ">=",
      "description": "Sets the retention period for audit logs to minimum 1 year (365 days) to enable historical analysis and incident investigations. E5 licensed users automatically get 1-year retention; non-E5 users get 180 days by default.",
      "implementationGuide": "1. Ensure users have E5 or Microsoft 365 E5 Compliance licenses for 1-year retention\n2. Navigate to Microsoft Purview compliance portal\n3. Go to Solutions > Audit > Retention policies\n4. Review default retention policy (retains all Exchange, SharePoint, OneDrive, Azure AD logs for 1 year for E5 users)\n5. Create custom retention policies if needed for specific record types or longer retention (up to 10 years with add-on licenses)\n6. Verify retention settings: Get-UnifiedAuditLogRetentionPolicy in PowerShell",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies",
      "controlMappings": [
        {
          "controlId": "03.03.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Extended retention of audit records (minimum 1 year) ensures that historical audit data is available for trend analysis, long-term investigation of security incidents, and correlation of events over extended time periods.",
          "nistRequirement": "Review and analyze system audit records [organization-defined frequency] for indications of inappropriate or unusual activity"
        }
      ]
    },
    {
      "id": "AZ-AU-003",
      "settingName": "DiagnosticSettings",
      "displayName": "Azure AD Diagnostic Settings for SIEM Integration",
      "settingPath": "AzureAD.DiagnosticSettings",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {"enabled": true, "destination": "LogAnalytics or EventHub"},
      "validationOperator": "==",
      "description": "Configures Azure AD to export audit and sign-in logs to Log Analytics workspace or Event Hub for centralized monitoring, correlation, and analysis in Microsoft Sentinel or third-party SIEM solutions. This enables automated analysis and correlation of audit records across different repositories.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as at least Security Administrator\n2. Navigate to Entra ID > Monitoring & health > Diagnostic settings\n3. Click '+ Add diagnostic setting'\n4. Name the setting (e.g., 'Export to Sentinel')\n5. Select log categories: AuditLogs, SignInLogs, RiskyUsers (at minimum)\n6. Choose destination: 'Send to Log Analytics workspace' or 'Stream to an event hub'\n7. Select the Log Analytics workspace where Microsoft Sentinel is deployed\n8. Click Save\n9. Verify logs are flowing to destination within 15 minutes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs",
      "controlMappings": [
        {
          "controlId": "03.03.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Exporting Azure AD audit logs to a centralized SIEM enables organization-wide situational awareness through correlation of audit records across different repositories (Azure AD, Exchange, SharePoint, etc.), directly satisfying the requirement to analyze and correlate audit records.",
          "nistRequirement": "Analyze and correlate audit records across different repositories to gain organization-wide situational awareness"
        }
      ]
    },
    {
      "id": "DF-AU-004",
      "settingName": "SentinelAnalyticsRules",
      "displayName": "Microsoft Sentinel Analytics Rules for Audit Log Monitoring",
      "settingPath": "Sentinel.AnalyticsRules",
      "policyType": "Defender",
      "policySubType": "SentinelAnalytics",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ["AnomalousSignIn", "PrivilegedAccountActivity", "UnusualAdminActivity"],
      "validationOperator": "contains",
      "description": "Implements automated analytics rules in Microsoft Sentinel to continuously monitor and analyze audit logs for suspicious patterns, anomalous behavior, and security incidents. Rules should detect unusual sign-ins, privileged account abuse, unauthorized access attempts, and configuration changes.",
      "implementationGuide": "1. Ensure Microsoft Sentinel is enabled on Log Analytics workspace\n2. Navigate to Microsoft Sentinel > Analytics\n3. Enable recommended built-in rules from templates including:\n   - 'Anomalous sign-in location by user account and authenticating application'\n   - 'Admin promotion after Role Management Application Permission Grant'\n   - 'Multiple admin membership removals from newly created admin'\n   - 'Rare application consent'\n4. Configure rule frequency (recommended: 5 minutes to hourly based on rule type)\n5. Set appropriate severity levels and entity mappings\n6. Configure alert grouping and incident creation\n7. Test rules and adjust thresholds to minimize false positives\n8. Document alerting procedures and assign incident response personnel",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/sentinel/detect-threats-built-in",
      "controlMappings": [
        {
          "controlId": "03.03.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Automated analytics rules provide continuous, real-time review and analysis of audit records to detect indicators of inappropriate or unusual activity, enabling timely reporting to security personnel and incident response teams.",
          "nistRequirement": "Review and analyze system audit records for indications of inappropriate or unusual activity and report findings to organizational personnel or roles"
        }
      ]
    },
    {
      "id": "PV-AU-005",
      "settingName": "MailboxAuditingEnabled",
      "displayName": "Mailbox Audit Logging Enabled",
      "settingPath": "OrganizationConfig.AuditDisabled",
      "policyType": "Purview",
      "policySubType": "ExchangeAuditing",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Ensures mailbox audit logging is enabled organization-wide to capture mailbox access and actions by owners, delegates, and administrators. When AuditDisabled is False, mailbox auditing is active. This captures critical email-related activities for security review and compliance.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell: Connect-ExchangeOnline\n2. Check organization-wide status: Get-OrganizationConfig | Format-List AuditDisabled\n3. If AuditDisabled is True, enable by running: Set-OrganizationConfig -AuditDisabled $false\n4. Verify mailbox auditing for specific mailbox: Get-Mailbox user@domain.com | Format-List AuditEnabled\n5. Mailbox auditing logs are retained for 180 days by default\n6. Search mailbox audit logs in Purview compliance portal: Audit > Search > Mailbox activities\n7. Document that mailbox auditing is enabled for all mailboxes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-mailboxes",
      "controlMappings": [
        {
          "controlId": "03.03.05",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Mailbox audit logging captures access and modifications to email data, which often contains CUI. Regular review of these logs helps detect unauthorized access, data exfiltration, or inappropriate email activities.",
          "nistRequirement": "Review and analyze system audit records for indications of inappropriate or unusual activity including monitoring of account usage and remote access"
        }
      ]
    }
  ]
}
