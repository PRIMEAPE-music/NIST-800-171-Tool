{
  "controlId": "03.13.11",
  "controlTitle": "Cryptographic Protection",
  "controlFamily": "SC",
  "familyName": "System and Communications Protection",
  "nistRequirement": "Implement the following types of cryptography to protect the confidentiality of CUI: [Assignment: organization-defined types of cryptography].",
  "researchDate": "2025-11-17",
  "settingsCount": 6,
  "settings": [
    {
      "id": "IN-SC-004",
      "settingName": "BitLockerEncryptionEnabled",
      "displayName": "BitLocker - Require Encryption for OS Drive",
      "settingPath": "Intune.EndpointSecurity.DiskEncryption.BitLocker.RequireDeviceEncryption",
      "policyType": "Intune",
      "policySubType": "DiskEncryption",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires BitLocker encryption for operating system drives on Windows devices. BitLocker uses AES-256 encryption to protect data at rest, preventing unauthorized access to CUI stored on device hard drives. Encryption is transparent to users and encrypts entire volumes including system files, hibernation files, and page files.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (intune.microsoft.com)\n2. Navigate to Endpoint security > Disk encryption\n3. Create policy: Platform = Windows 10 and later, Profile = BitLocker\n4. Configure settings:\n   - 'Encrypt devices' = 'Require'\n   - 'BitLocker base settings' > 'Warning for other disk encryption' = 'Block'\n   - 'Operating system drive' > 'Operating system drive encryption method' = 'XTS-AES 256-bit'\n   - 'Operating system drive' > 'Startup authentication required' = 'Yes'\n5. Set recovery options (see control 03.13.10 settings)\n6. Assign to device groups\n7. Create compliance policy:\n   - Devices > Compliance policies > Create policy\n   - Platform = Windows 10 and later\n   - Settings > System Security > 'Require BitLocker' = 'Require'\n   - Set non-compliance actions\n8. Save policies\n\nVerification: Devices > All devices > [Device] > Encryption report",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/encrypt-devices",
      "controlMappings": [
        {
          "controlId": "03.13.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "BitLocker implements FIPS 140-2 validated AES-256 encryption to protect CUI at rest. This is the primary cryptographic protection mechanism for data stored on Windows devices. It protects confidentiality by rendering data inaccessible without proper authentication, meeting NIST requirements for cryptographic protection of stored CUI.",
          "nistRequirement": "Implement cryptography to protect the confidentiality of CUI stored on devices and in databases"
        }
      ]
    },
    {
      "id": "IN-SC-005",
      "settingName": "BitLockerFixedDriveEncryption",
      "displayName": "BitLocker - Fixed Data Drive Encryption",
      "settingPath": "Intune.EndpointSecurity.DiskEncryption.BitLocker.FixedDriveSettings",
      "policyType": "Intune",
      "policySubType": "DiskEncryption",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "XTS-AES 256-bit",
      "validationOperator": "==",
      "description": "Requires AES-256 encryption for fixed data drives (non-OS drives) where CUI may be stored. Extends cryptographic protection beyond the OS drive to all internal fixed drives, ensuring comprehensive data protection.",
      "implementationGuide": "1. In the same BitLocker policy (see IN-SC-004)\n2. Under 'BitLocker - Fixed Data Drive Settings':\n   - Enable 'Fixed data drive recovery'\n   - Set 'Block write access to fixed data-drives not protected by BitLocker' = 'Yes'\n   - Set 'Fixed drive encryption method' = 'XTS-AES 256-bit'\n   - Configure recovery options same as OS drive\n3. Save policy\n\nNote: This setting ensures all fixed drives containing CUI are encrypted, not just the operating system drive.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-overview",
      "controlMappings": [
        {
          "controlId": "03.13.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Extends cryptographic protection to all fixed data drives where CUI may be stored. Many organizations store data on separate data partitions or drives, so OS drive encryption alone is insufficient. This setting ensures comprehensive cryptographic protection for all on-device CUI storage locations.",
          "nistRequirement": "Implement cryptography to protect the confidentiality of CUI on all storage devices"
        }
      ]
    },
    {
      "id": "AZ-SC-007",
      "settingName": "TLS12Minimum",
      "displayName": "Exchange Online - Minimum TLS Version 1.2",
      "settingPath": "ExchangeOnline.TransportConfig.TLSMinimumVersion",
      "policyType": "Purview",
      "policySubType": "ExchangeTransport",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "1.2",
      "validationOperator": ">=",
      "description": "Enforces TLS 1.2 or higher for all email communications in Exchange Online. TLS (Transport Layer Security) provides cryptographic protection for CUI in transit by encrypting email messages between mail servers and clients. Older TLS versions (1.0, 1.1) have known vulnerabilities and should not be used.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell:\n   Install-Module -Name ExchangeOnlineManagement\n   Connect-ExchangeOnline\n\n2. Configure minimum TLS version:\n   Set-TransportConfig -TLSMinimumVersion 1.2\n\n3. Verify setting:\n   Get-TransportConfig | Select TLSMinimumVersion\n\n4. For client connections, also configure:\n   Set-OrganizationConfig -SmtpClientAuthenticationDisabled $false\n\n5. Monitor TLS usage:\n   - Use Exchange Online message trace\n   - Review TLS connection logs\n   - Identify clients using older TLS versions\n\nNote: Microsoft 365 supports TLS 1.2 and 1.3. TLS 1.0 and 1.1 are deprecated as of October 2022.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/technical-reference-details-about-encryption",
      "controlMappings": [
        {
          "controlId": "03.13.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "TLS 1.2+ implements cryptographic protection for CUI in transit via email. It provides authenticated encryption using modern cipher suites that protect confidentiality and integrity. This is critical for protecting CUI exchanged via email both internally and with external parties.",
          "nistRequirement": "Implement cryptography to protect the confidentiality of CUI during transmission"
        }
      ]
    },
    {
      "id": "PV-SC-001",
      "settingName": "DLPEncryptionPolicy",
      "displayName": "Purview DLP - Encrypt Content with Sensitivity Labels",
      "settingPath": "Purview.DLP.Policy.Actions.EncryptContent",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically applies encryption to content containing CUI using Microsoft Purview Data Loss Prevention policies and sensitivity labels. Uses AES-256 encryption with rights management to protect documents and emails. Encryption is applied based on content classification and can restrict access, copying, printing, and forwarding.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal (compliance.microsoft.com)\n2. Go to Information protection > Labels\n3. Create sensitivity label with encryption:\n   - Name: 'Confidential - CUI'\n   - Enable encryption\n   - Set permissions: Authenticated users or specific users/groups\n   - Configure usage rights (view, edit, copy, print restrictions)\n\n4. Create auto-labeling policy:\n   - Go to Information protection > Auto-labeling\n   - Choose label created above\n   - Configure conditions to detect CUI:\n     - Use sensitive information types (SSN, credit card, etc.)\n     - Use trainable classifiers\n     - Use keywords related to CUI\n   - Select locations: Exchange, SharePoint, OneDrive, Devices\n   - Set policy to 'Turn on policy' (not simulation)\n\n5. Create DLP policy with encryption action:\n   - Go to Data loss prevention > Policies\n   - Create policy, select CUI-related templates\n   - Add condition: Content contains > Sensitivity labels > [CUI label]\n   - Add action: 'Restrict access or encrypt the content'\n   - Configure notifications and incident reports\n   - Save and enable policy\n\n6. Educate users on sensitivity labels",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/encryption",
      "controlMappings": [
        {
          "controlId": "03.13.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "DLP with encryption implements automated cryptographic protection based on content classification. It ensures CUI is encrypted both at rest and in transit across Microsoft 365 services. Sensitivity labels apply AES-256 encryption with Azure Rights Management, providing persistent protection that follows the document regardless of location.",
          "nistRequirement": "Implement cryptography to protect the confidentiality of CUI in documents, emails, and collaborative platforms"
        }
      ]
    },
    {
      "id": "PV-SC-002",
      "settingName": "OMEEnabled",
      "displayName": "Office 365 Message Encryption (OME)",
      "settingPath": "Purview.MessageEncryption.Enabled",
      "policyType": "Purview",
      "policySubType": "MessageEncryption",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Office 365 Message Encryption for email containing CUI sent to external recipients. OME uses Azure Rights Management (Azure RMS) to apply AES-256 encryption and access controls to email messages. External recipients can view encrypted messages through a secure web portal even if they don't have Microsoft 365.",
      "implementationGuide": "1. Verify Azure Rights Management is activated:\n   Connect-AipService\n   Enable-AipService\n\n2. Navigate to Microsoft Purview compliance portal\n3. Go to Data loss prevention > Policies\n4. Create mail flow rule (can also be done in Exchange admin center):\n   - Name: 'Encrypt CUI emails to external recipients'\n   - Apply rule when: Recipient is located > Outside the organization\n   - AND: Message contains sensitive information > [CUI-related types]\n   - OR: Subject or body matches patterns > [CUI keywords]\n   - Do the following: Modify message security > Apply Office 365 Message Encryption\n   - Set encryption template: 'Encrypt' or 'Do Not Forward'\n\n5. Optional - Configure OME branding:\n   - Set-OMEConfiguration -Identity default\n   - Configure custom branding, logos, disclaimer text\n\n6. Test encryption:\n   - Send test email to external recipient\n   - Verify encryption is applied\n   - Confirm external recipient can access via portal\n\n7. Monitor encrypted messages in Exchange message trace",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/ome",
      "controlMappings": [
        {
          "controlId": "03.13.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "OME implements cryptographic protection for CUI sent via email to external parties. It ensures confidentiality through AES-256 encryption and provides access controls even for recipients outside the organization. This is critical for protecting CUI when shared with contractors, partners, or other external entities who need access to controlled information.",
          "nistRequirement": "Implement cryptography to protect the confidentiality of CUI when transmitted to external parties"
        }
      ]
    },
    {
      "id": "PV-SC-003",
      "settingName": "AES256EncryptionDefault",
      "displayName": "Microsoft Purview - AES-256 CBC Default Encryption",
      "settingPath": "Purview.InformationProtection.DefaultEncryption",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "AES256-CBC",
      "validationOperator": "==",
      "description": "Ensures Microsoft Purview Information Protection uses AES-256 with Cipher Block Chaining (CBC) mode as the default encryption algorithm. As of October 2023, AES256-CBC is the default for all new Office documents and emails. This provides FIPS 140-2 validated cryptographic protection for all labeled content.",
      "implementationGuide": "1. For Microsoft 365 Apps version 16.0.16227 or later:\n   - AES256-CBC is default, no configuration needed\n   - Verify by checking encrypted document properties\n\n2. For earlier versions (2013-2021), configure via Group Policy:\n   - Download Office Administrative Templates\n   - Configure: User Configuration > Policies > Administrative Templates\n   - Microsoft Office 2016 > Security Settings\n   - Enable 'Set encryption mode for Office Open XML files'\n   - Select 'AES 256, 256-bit'\n\n3. For Cloud Policy (Microsoft 365 Apps):\n   - Navigate to Microsoft 365 Apps admin center\n   - Create cloud policy\n   - Add setting: 'Encryption mode for Office Open XML'\n   - Set to 'AES256-CBC'\n\n4. Verify encryption:\n   - Create test document with sensitivity label\n   - Check document encryption properties\n   - Confirm AES-256 is used\n\n5. For MIP SDK applications:\n   - Update to MIP SDK 1.13 or later\n   - AES256-CBC is automatic in later versions\n\nNote: Backwards compatibility maintained for documents encrypted with older algorithms",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/technical-reference-details-about-encryption",
      "controlMappings": [
        {
          "controlId": "03.13.11",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "AES-256 CBC mode provides FIPS 140-2 validated strong encryption for all Microsoft 365 documents and emails protected by sensitivity labels. This is the foundational cryptographic protection for CUI at rest across all Office applications. The 256-bit key length provides protection against brute force attacks and meets federal cryptographic standards.",
          "nistRequirement": "Implement FIPS-validated cryptography using AES-256 or equivalent to protect the confidentiality of CUI"
        }
      ]
    }
  ],
  "implementationNotes": "BitLocker encryption (IN-SC-004, IN-SC-005) provides foundational protection for CUI at rest on Windows devices and is required by Microsoft Security Baseline and CIS Level 1.\n\nTLS 1.2+ (AZ-SC-007) is mandatory for protecting CUI in transit and is already enforced by Microsoft 365 for most connections. Organizations should verify client configurations support TLS 1.2.\n\nPurview DLP with encryption (PV-SC-001) and Office 365 Message Encryption (PV-SC-002) implement automated protection based on content classification and are recommended for organizations handling significant volumes of CUI.\n\nAES-256 CBC (PV-SC-003) is automatic in current Microsoft 365 Apps versions. Organizations with older Office versions should update or configure via Group Policy.\n\nAll encryption mechanisms are FIPS 140-2 validated and meet federal cryptographic standards. Organizations subject to CMMC or DFARS should implement all six settings for comprehensive cryptographic protection.\n\nRelated controls: 03.13.08 (Transmission Confidentiality), 03.13.10 (Key Management)",
  "references": [
    "Microsoft Security Baseline for Microsoft 365",
    "CIS Microsoft 365 Foundations Benchmark v3.0.0",
    "NIST SP 800-171 Rev 3 Control SC-13",
    "NIST SP 800-52 - TLS Implementation Guidance",
    "FIPS 140-2 - Cryptographic Module Validation",
    "FIPS 197 - AES Specification"
  ]
}
