{
  "controlId": "03.07.06",
  "controlTitle": "Maintenance Personnel",
  "family": "MA",
  "familyName": "Maintenance",
  "totalSettings": 6,
  "settings": [
    {
      "id": "AZ-MA-012",
      "settingName": "PrivilegedIdentityManagement",
      "displayName": "Azure AD Privileged Identity Management (PIM) for Maintenance Roles",
      "settingPath": "privilegedIdentityManagement.roleSettings.eligibleAssignments",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "assignmentType": "eligible",
        "permanentAssignments": 0
      },
      "validationOperator": "==",
      "description": "Implements just-in-time privileged access management for maintenance personnel. Administrators are assigned eligible (not permanent) roles and must explicitly activate them when maintenance is required, with time-limited access and justification requirements.",
      "implementationGuide": "1. Ensure Azure AD Premium P2 licensing for all privileged users\n2. Sign in to Azure portal (portal.azure.com)\n3. Navigate to Microsoft Entra Privileged Identity Management\n4. Go to Azure AD roles > Roles\n5. For each privileged role used for maintenance:\n   - Global Administrator\n   - Privileged Role Administrator  \n   - Security Administrator\n   - Exchange Administrator\n   - SharePoint Administrator\n   - Intune Administrator\n6. Remove permanent active assignments\n7. Add eligible assignments with:\n   - Maximum activation duration: 4-8 hours\n   - Require justification on activation\n   - Require approval for activation (for Global Admin)\n   - Require MFA on activation\n8. Configure access reviews (monthly)\n9. Train administrators on activation process",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure",
      "controlMappings": [
        {
          "controlId": "03.07.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Implements the authorization process for maintenance personnel by requiring explicit activation with justification, ensuring only authorized individuals have elevated privileges when performing maintenance.",
          "nistRequirement": "Establish a process for maintenance personnel authorization"
        }
      ]
    },
    {
      "id": "AZ-MA-013",
      "settingName": "RequireApprovalGlobalAdmin",
      "displayName": "Require Approval for Global Administrator Activation",
      "settingPath": "privilegedIdentityManagement.roleSettings.globalAdministrator.activationRequirements",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "approvalRequired": true,
        "approvers": "minimumTwo"
      },
      "validationOperator": "==",
      "description": "Enforces approval workflow for Global Administrator role activation, preventing unauthorized elevation to the highest privilege level. Two-person rule ensures that critical maintenance activities require oversight and approval from trusted administrators.",
      "implementationGuide": "1. In Azure portal, go to PIM > Azure AD roles > Settings\n2. Select 'Global Administrator' role\n3. Click Edit > Activation tab\n4. Configure activation requirements:\n   - Require approval to activate: Yes\n   - Select approvers: Add at least 2 security administrators\n   - Require justification: Yes\n   - Require ticket information: Yes (optional)\n   - Require Azure MFA: Yes\n5. Under Assignment tab:\n   - Require approval to assign: Yes\n   - Require justification: Yes\n6. Update settings\n7. Document approval process for emergency scenarios\n8. CIS Benchmark v4.0 recommendation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-approval-workflow",
      "controlMappings": [
        {
          "controlId": "03.07.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Establishes formal authorization process requiring approval from authorized personnel before maintenance activities can be performed with highest privileges, preventing unauthorized access.",
          "nistRequirement": "Establish a process for maintenance personnel authorization"
        }
      ]
    },
    {
      "id": "AZ-MA-014",
      "settingName": "AccessReviewsPrivilegedRoles",
      "displayName": "Monthly Access Reviews for Privileged Roles",
      "settingPath": "identityGovernance.accessReviews.privilegedRoles",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "frequency": "monthly",
        "reviewersType": "manager",
        "autoApplyDecisions": false
      },
      "validationOperator": "==",
      "description": "Implements periodic review of privileged role assignments to ensure maintenance personnel still require elevated access. Managers review and attest to the continued need for each user's privileged access, automatically removing access for users who leave or change roles.",
      "implementationGuide": "1. Requires Azure AD Premium P2 licensing\n2. Sign in to Azure portal\n3. Navigate to Identity Governance > Access reviews\n4. Create access review:\n   - Review name: 'Monthly Privileged Role Review for Maintenance'\n   - Frequency: Monthly\n   - Duration: 7 days\n5. Scope: Select all privileged directory roles:\n   - Global Administrator\n   - Privileged Role Administrator\n   - Security Administrator\n   - All other administrative roles\n6. Reviewers: Group owners or managers\n7. Settings:\n   - Require justification: Yes\n   - Remove access if reviewers don't respond: No (for safety)\n   - Send notifications to reviewers\n8. Enable and monitor completion rates\n9. CIS Benchmark recommendation: Monthly (changed from weekly in v4.0)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/access-reviews-overview",
      "controlMappings": [
        {
          "controlId": "03.07.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Maintains current list of authorized maintenance personnel through periodic reviews, ensuring that access authorizations remain valid and removing access when personnel no longer require maintenance privileges.",
          "nistRequirement": "Maintain a list of authorized maintenance organizations or personnel"
        }
      ]
    },
    {
      "id": "AZ-MA-015",
      "settingName": "CloudOnlyPrivilegedAccounts",
      "displayName": "Require Cloud-Only Privileged Accounts",
      "settingPath": "users.privilegedAccounts.onPremisesSyncEnabled",
      "policyType": "AzureAD",
      "policySubType": "UserManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Ensures privileged maintenance accounts are cloud-only (not synchronized from on-premises Active Directory). Prevents on-premises compromise from affecting cloud administrative access and provides better audit trails and conditional access enforcement.",
      "implementationGuide": "1. Audit current privileged accounts:\n   - Sign in to Azure portal\n   - Navigate to Microsoft Entra ID > Roles and administrators\n   - For each privileged role, view assignments\n   - Identify accounts with onPremisesSyncEnabled = true\n2. Create cloud-only replacement accounts:\n   - Naming convention: admin-[username]-cloud@domain.com\n   - No Azure AD Connect synchronization\n   - Assign required licenses (Azure AD Premium P2)\n3. Transfer privileged role assignments to cloud-only accounts\n4. Configure PIM for cloud-only accounts\n5. Remove on-premises accounts from privileged roles\n6. Update documentation and runbooks\n7. Microsoft Security Baseline requirement",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/how-to-connect-sync-feature-prevent-accidental-deletes",
      "controlMappings": [
        {
          "controlId": "03.07.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Enhances security of authorized maintenance personnel by ensuring their privileged accounts cannot be compromised through on-premises attacks, supporting the authorization verification requirement.",
          "nistRequirement": "Verify that non-escorted personnel who perform maintenance on the system possess the required access authorizations"
        }
      ]
    },
    {
      "id": "AZ-MA-016",
      "settingName": "LimitPrivilegedRoleCount",
      "displayName": "Limit Number of Global Administrators",
      "settingPath": "directoryRoles.globalAdministrator.memberCount",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Restricts the number of Global Administrators to maximum 5 users (minimum 2 for redundancy). Reduces attack surface by limiting the number of accounts with complete system control for maintenance activities.",
      "implementationGuide": "1. Review current Global Administrator assignments:\n   - Sign in to Azure portal\n   - Microsoft Entra ID > Roles and administrators\n   - Select 'Global Administrator' role\n   - Document all current members\n2. Identify minimum required Global Admins:\n   - Recommendation: 2-5 accounts\n   - Include 2 emergency access (break-glass) accounts\n   - Keep 2-3 active administrator accounts\n3. Remove unnecessary assignments:\n   - Evaluate if users need Global Admin or less privileged role\n   - Use specific roles: Exchange Admin, Security Admin, etc.\n4. Implement PIM for remaining Global Admins (eligible only)\n5. Configure alerting for new Global Admin assignments\n6. Document justification for each Global Admin\n7. Review quarterly in access reviews\n8. Microsoft Security Baseline and CIS Benchmark requirement",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-planning",
      "controlMappings": [
        {
          "controlId": "03.07.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Implements least privilege by restricting privileged maintenance personnel to minimum necessary, reducing risk of unauthorized access and ensuring only specifically authorized individuals can perform critical system maintenance.",
          "nistRequirement": "Establish a process for maintenance personnel authorization; Maintain a list of authorized maintenance organizations or personnel"
        }
      ]
    },
    {
      "id": "AZ-MA-017",
      "settingName": "PrivilegedRoleActivationAlerts",
      "displayName": "Alert on Privileged Role Activation",
      "settingPath": "privilegedIdentityManagement.alerts.roleActivation",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "object",
      "expectedValue": {
        "alertsEnabled": true,
        "recipients": "securityTeam"
      },
      "validationOperator": "==",
      "description": "Generates real-time alerts when privileged roles are activated for maintenance activities. Security team receives immediate notification with activation details including who, what role, when, and justification provided.",
      "implementationGuide": "1. Sign in to Azure portal\n2. Navigate to Microsoft Entra Privileged Identity Management\n3. Go to Azure AD roles > Alerts > Settings\n4. Configure these alerts:\n   - 'Roles are being activated too frequently'\n   - 'Administrators aren't using their privileged roles'\n   - 'Potential stale accounts in a privileged role'\n5. For each alert:\n   - Enable: Yes\n   - Severity: High\n   - Recipients: Add security team distribution list\n6. Configure email settings:\n   - Notification recipients: Security Operations Center\n   - Include activation link in email: Yes\n7. Test alerts with activation\n8. Integrate with Microsoft Sentinel for advanced correlation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts",
      "controlMappings": [
        {
          "controlId": "03.07.06",
          "confidence": "High",
          "isRequired": true,
          "mappingRationale": "Enables real-time monitoring of privileged maintenance activities by alerting security personnel when authorized maintenance personnel activate their elevated privileges for system maintenance tasks.",
          "nistRequirement": "Designate organizational personnel with required access authorizations and technical competence to supervise the maintenance activities"
        }
      ]
    }
  ]
}
