{
  "version": "1.0.0",
  "generated": "2025-11-17T21:20:27.649Z",
  "totalSettings": 636,
  "description": "Master catalog of all unique M365 settings for NIST 800-171 Rev 3 compliance",
  "sourceStructure": "Nested folders: POLICY SETTINGS/03.XX.XX/03.XX.XX/",
  "settings": [
    {
      "settingName": "state",
      "displayName": "Conditional Access Policy State",
      "settingPath": "state",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "enabled",
      "validationOperator": "==",
      "description": "Controls whether Conditional Access policies are active and enforcing account management controls. Enabled policies enforce access authorization requirements for user accounts.",
      "implementationGuide": "1. Sign in to Azure AD portal (https://portal.azure.com)\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create or edit Conditional Access policy\n4. Set 'Enable policy' to 'On'\n5. Configure policy conditions (users, apps, locations, etc.)\n6. Save the policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview"
    },
    {
      "settingName": "grantControls.builtInControls",
      "displayName": "Conditional Access Grant Controls",
      "settingPath": "grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"mfa\",\"compliantDevice\",\"domainJoinedDevice\"]",
      "validationOperator": "contains",
      "description": "Specifies the access controls that must be satisfied before granting access. Controls like MFA and device compliance enforce authentication requirements for account access.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create or edit policy\n4. Under 'Grant', select required controls:\n   - Require multifactor authentication\n   - Require device to be marked as compliant\n   - Require Hybrid Azure AD joined device\n5. Set 'Require one of the selected controls' or 'Require all the selected controls'\n6. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/conditionalaccesspolicy"
    },
    {
      "settingName": "conditions.users.includeUsers",
      "displayName": "Conditional Access - Users Included",
      "settingPath": "conditions.users.includeUsers",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"All\"]",
      "validationOperator": "contains",
      "description": "Defines which users or user groups are subject to the Conditional Access policy. Setting to 'All' ensures all user accounts are managed under access control policies.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create or edit policy\n4. Under Assignments > Users, select:\n   - Include: All users\n   - Exclude: Emergency access accounts (break-glass accounts)\n5. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/conditionalaccesspolicy"
    },
    {
      "settingName": "conditions.users.excludeUsers",
      "displayName": "Conditional Access - Users Excluded",
      "settingPath": "conditions.users.excludeUsers",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "==",
      "description": "Defines user accounts excluded from Conditional Access policy. Should be limited to emergency access (break-glass) accounts only.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Edit policy\n4. Under Assignments > Users > Exclude\n5. Select only emergency access accounts\n6. Document excluded accounts and rationale\n7. Regularly review exclusions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/conditionalaccesspolicy"
    },
    {
      "settingName": "conditions.users.includeGroups",
      "displayName": "Conditional Access - Groups Included",
      "settingPath": "conditions.users.includeGroups",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "null",
      "validationOperator": "!=",
      "description": "Specifies Azure AD groups whose members are subject to the policy. Used for role-based access control and group membership management.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create or edit policy\n4. Under Assignments > Users > Include > Select groups\n5. Choose security groups representing specific roles or access levels\n6. Configure appropriate grant controls for each group\n7. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/conditionalaccesspolicy"
    },
    {
      "settingName": "conditions.users.includeRoles",
      "displayName": "Conditional Access - Roles Included",
      "settingPath": "conditions.users.includeRoles",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "null",
      "validationOperator": "!=",
      "description": "Specifies Azure AD directory roles subject to the policy. Critical for enforcing stricter controls on privileged accounts.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create policy targeting admin roles\n4. Under Assignments > Users > Include > Select directory roles\n5. Choose admin roles (Global Administrator, Security Administrator, etc.)\n6. Require stronger controls (MFA, compliant device)\n7. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/conditionalaccesspolicy"
    },
    {
      "settingName": "guestUserRoleId",
      "displayName": "Guest User Access Restrictions",
      "settingPath": "guestUserRoleId",
      "policyType": "AzureAD",
      "policySubType": "AuthorizationPolicy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "2af84b1e-32c8-42b7-82bc-daa82404023b",
      "validationOperator": "==",
      "description": "Controls the level of access guest users have in the directory. The most restrictive setting (2af84b1e-32c8-42b7-82bc-daa82404023b) limits guests to only their own profile information.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > External Identities > External collaboration settings\n3. Under 'Guest user access', select:\n   'Guest user access is restricted to properties and memberships of their own directory objects (most restrictive)'\n4. Save changes\n5. Or use Microsoft Graph API:\n   PATCH https://graph.microsoft.com/v1.0/policies/authorizationPolicy/authorizationPolicy\n   {\"guestUserRoleId\": \"2af84b1e-32c8-42b7-82bc-daa82404023b\"}",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/enterprise-users/users-restrict-guest-permissions"
    },
    {
      "settingName": "allowInvitesFrom",
      "displayName": "Guest Invite Restrictions",
      "settingPath": "allowInvitesFrom",
      "policyType": "AzureAD",
      "policySubType": "AuthorizationPolicy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "adminsAndGuestInviters",
      "validationOperator": "==",
      "description": "Controls who can invite guest users to the organization. Setting to 'adminsAndGuestInviters' restricts guest invitations to administrators only.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > External Identities > External collaboration settings\n3. Under 'Guest invite settings', select:\n   'Only users assigned to specific admin roles can invite guest users'\n4. Save changes\n5. Valid values:\n   - 'none' (no one can invite)\n   - 'adminsAndGuestInviters' (only admins and Guest Inviter role)\n   - 'adminsGuestInvitersAndAllMembers' (admins, Guest Inviters, and all members)\n   - 'everyone' (all users including guests)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/external-id/external-collaboration-settings-configure"
    },
    {
      "settingName": "accountEnabled",
      "displayName": "User Account Enabled Status",
      "settingPath": "accountEnabled",
      "policyType": "AzureAD",
      "policySubType": "UserAccount",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Controls whether a user account is enabled or disabled. Disabled accounts cannot authenticate to Azure AD or access resources.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Users\n3. Select user account\n4. Under Profile, view/edit 'Account enabled' setting\n5. To disable: Uncheck 'Account enabled' and save\n6. Via PowerShell:\n   Update-MgUser -UserId <userId> -AccountEnabled $false\n7. Via Graph API:\n   PATCH https://graph.microsoft.com/v1.0/users/{id}\n   {\"accountEnabled\": false}",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/user"
    },
    {
      "settingName": "signInActivity.lastSignInDateTime",
      "displayName": "Last Sign-in Date/Time",
      "settingPath": "signInActivity.lastSignInDateTime",
      "policyType": "AzureAD",
      "policySubType": "UserAccount",
      "platform": "All",
      "dataType": "datetime",
      "expectedValue": "null",
      "validationOperator": "<=",
      "description": "Timestamp of user's last successful sign-in. Used to identify inactive accounts that should be disabled per organization-defined inactivity period.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Users > Sign-in logs\n3. Review lastSignInDateTime for each user\n4. Create automated process to:\n   - Query lastSignInDateTime via Graph API\n   - Compare against organization-defined inactivity period (e.g., 90 days)\n   - Disable accounts exceeding inactivity threshold\n5. Via Graph API:\n   GET https://graph.microsoft.com/v1.0/users?$select=displayName,signInActivity\n6. Implement Access Reviews or Lifecycle Workflows to automate",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/signinactivity"
    },
    {
      "settingName": "sessionControls.signInFrequency.value",
      "displayName": "Conditional Access - Sign-in Frequency Value",
      "settingPath": "sessionControls.signInFrequency.value",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 8,
      "validationOperator": "<=",
      "description": "Defines how often users must reauthenticate. Enforces periodic access validation and session termination based on organization-defined time periods.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create or edit policy\n4. Under Access controls > Session\n5. Check 'Sign-in frequency'\n6. Set frequency value (e.g., 8 hours)\n7. Select time period (Hours or Days)\n8. Save policy\n9. Note: This requires Azure AD Premium P1",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime"
    },
    {
      "settingName": "sessionControls.signInFrequency.type",
      "displayName": "Conditional Access - Sign-in Frequency Type",
      "settingPath": "sessionControls.signInFrequency.type",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "hours",
      "validationOperator": "in",
      "description": "Specifies whether sign-in frequency is measured in hours or days. Typically set to 'hours' for tighter session control.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create or edit policy\n4. Under Access controls > Session > Sign-in frequency\n5. Select type: 'Hours' or 'Days'\n6. Valid values: 'hours', 'days'\n7. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime"
    },
    {
      "settingName": "sessionControls.signInFrequency.isEnabled",
      "displayName": "Conditional Access - Sign-in Frequency Enabled",
      "settingPath": "sessionControls.signInFrequency.isEnabled",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Controls whether sign-in frequency requirements are enforced. Must be enabled to enforce session timeout requirements.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create or edit policy\n4. Under Access controls > Session\n5. Enable 'Sign-in frequency' checkbox\n6. Configure frequency value and type\n7. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime"
    },
    {
      "settingName": "passwordRequired",
      "displayName": "Intune - Password Required (Windows)",
      "settingPath": "passwordRequired",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to enter a password before accessing Windows devices. Enforces authentication requirement for device access.",
      "implementationGuide": "1. Sign in to Intune admin center (https://endpoint.microsoft.com)\n2. Navigate to Devices > Compliance policies > Policies\n3. Create policy > Platform: Windows 10 and later\n4. Under System Security settings\n5. Set 'Require a password to unlock mobile devices' to 'Require'\n6. Assign to device groups\n7. Note: Applies to local accounts on Windows devices",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "minPasswordLength",
      "displayName": "Intune - Minimum Password Length (Windows)",
      "settingPath": "minPasswordLength",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 8,
      "validationOperator": ">=",
      "description": "Specifies the minimum number of characters required for device passwords. Recommended minimum is 8-14 characters for compliance with security standards.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Compliance policies > Policies\n3. Create or edit Windows 10+ compliance policy\n4. Under System Security > Minimum password length\n5. Set value to 8 or greater (14 recommended for NIST)\n6. Assign to device groups\n7. Note: Applies only to local accounts on Windows",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "passwordComplexity",
      "displayName": "Intune - Password Complexity (Windows)",
      "settingPath": "passwordComplexity",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 3,
      "validationOperator": ">=",
      "description": "Defines password complexity requirements. Values: 0=None, 1=Digits, 2=Digits+lowercase, 3=Digits+lowercase+uppercase, 4=Digits+lowercase+uppercase+special.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Compliance policies > Policies\n3. Create or edit Windows 10+ compliance policy\n4. Under System Security > Password complexity\n5. Set to 3 or 4 (recommended: 4 for full complexity)\n6. Complexity values:\n   0 = No complexity\n   1 = Digits required\n   2 = Digits and lowercase letters\n   3 = Digits, lowercase, and uppercase\n   4 = Digits, lowercase, uppercase, and special characters\n7. Assign to device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "passwordExpiration",
      "displayName": "Intune - Password Expiration (Windows)",
      "settingPath": "passwordExpiration",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 90,
      "validationOperator": "<=",
      "description": "Number of days before password expires. Enforces regular password changes to reduce risk of compromised credentials.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Compliance policies > Policies\n3. Create or edit Windows 10+ compliance policy\n4. Under System Security > Password expiration (days)\n5. Set value (recommended: 60-90 days)\n6. Assign to device groups\n7. Note: Modern guidance suggests longer expiration or no expiration with MFA",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "passwordHistoryCount",
      "displayName": "Intune - Password History Count (Windows)",
      "settingPath": "passwordHistoryCount",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 24,
      "validationOperator": ">=",
      "description": "Number of previous passwords that cannot be reused. Prevents password cycling and enhances security.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Compliance policies > Policies\n3. Create or edit Windows 10+ compliance policy\n4. Under System Security > Number of previous passwords to prevent reuse\n5. Set value (recommended: 12-24)\n6. Assign to device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "storageRequireEncryption",
      "displayName": "Intune - Require Data Storage Encryption (Windows)",
      "settingPath": "storageRequireEncryption",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires encryption of data storage on Windows devices. Typically enforced via BitLocker on Windows.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Compliance policies > Policies\n3. Create or edit Windows 10+ compliance policy\n4. Under System Security > Encryption of data storage on device\n5. Set to 'Require'\n6. Assign to device groups\n7. Note: Devices must have BitLocker enabled to be compliant\n8. Consider also enabling 'Require BitLocker' for more robust check",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "maxInactivityBeforeLock",
      "displayName": "Intune - Max Inactivity Before Lock (Windows)",
      "settingPath": "maxInactivityBeforeLock",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 15,
      "validationOperator": "<=",
      "description": "Maximum minutes of inactivity before device screen locks. Implements device lock requirement for unattended systems.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Configuration profiles > Create profile\n3. Platform: Windows 10 and later\n4. Profile type: Device restrictions\n5. Under Settings > Locked screen experience\n6. Set 'Maximum minutes of inactivity until screen locks' to 15 or less\n7. Assign to device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-windows-10"
    },
    {
      "settingName": "authorizationPolicy.allowedToSignUpEmailBasedSubscriptions",
      "displayName": "Allow Email-Based Subscriptions",
      "settingPath": "allowedToSignUpEmailBasedSubscriptions",
      "policyType": "AzureAD",
      "policySubType": "AuthorizationPolicy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Controls whether users can sign up for email-based subscriptions. Should be disabled to prevent unauthorized account creation.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Properties\n3. Click 'Manage Security defaults'\n4. Set appropriate restrictions\n5. Or use Graph API:\n   PATCH https://graph.microsoft.com/v1.0/policies/authorizationPolicy/authorizationPolicy\n   {\"allowedToSignUpEmailBasedSubscriptions\": false}",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy"
    },
    {
      "settingName": "authorizationPolicy.allowedToUseSSPR",
      "displayName": "Allow Self-Service Password Reset",
      "settingPath": "allowedToUseSSPR",
      "policyType": "AzureAD",
      "policySubType": "AuthorizationPolicy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Controls whether users can use self-service password reset. Should be enabled to support password management requirements.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Password reset\n3. Under Properties, configure:\n   - Self service password reset enabled: Selected/All\n4. Configure authentication methods (require 2 methods)\n5. Registration: Require users to register at sign-in\n6. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/authentication/concept-sspr-howitworks"
    },
    {
      "settingName": "authorizationPolicy.blockMsolPowerShell",
      "displayName": "Block MSOL PowerShell",
      "settingPath": "blockMsolPowerShell",
      "policyType": "AzureAD",
      "policySubType": "AuthorizationPolicy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Blocks the legacy MSOL PowerShell module from accessing Azure AD. Enhances security by restricting to modern authentication methods.",
      "implementationGuide": "1. Microsoft is deprecating MSOL PowerShell (deprecated as of March 2024)\n2. This setting blocks legacy authentication via MSOL module\n3. Configured via Graph API:\n   PATCH https://graph.microsoft.com/v1.0/policies/authorizationPolicy/authorizationPolicy\n   {\"blockMsolPowerShell\": true}\n4. Ensure users migrate to Microsoft Graph PowerShell",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/authorizationpolicy"
    },
    {
      "settingName": "conditions.locations.includeLocations",
      "displayName": "Conditional Access - Locations Included",
      "settingPath": "conditions.locations.includeLocations",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"All\"]",
      "validationOperator": "contains",
      "description": "Defines which locations (IP ranges) the policy applies to. Can be used to enforce location-based access restrictions for account management.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. First, configure Named Locations:\n   - Security > Named locations > New location\n   - Define trusted IP ranges (office locations)\n4. Create or edit Conditional Access policy\n5. Under Conditions > Locations\n6. Include: All locations or specific named locations\n7. Exclude: Trusted locations (optional)\n8. Configure appropriate grant controls\n9. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/location-condition"
    },
    {
      "settingName": "conditions.clientAppTypes",
      "displayName": "Conditional Access - Client App Types",
      "settingPath": "conditions.clientAppTypes",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"all\"]",
      "validationOperator": "contains",
      "description": "Specifies which client application types the policy applies to (browser, mobile apps, desktop clients, etc.). Setting to 'all' ensures comprehensive coverage.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create or edit policy\n4. Under Conditions > Client apps\n5. Select app types to include:\n   - Browser\n   - Mobile apps and desktop clients\n   - Exchange ActiveSync clients\n   - Other clients\n6. Or select 'all' for comprehensive coverage\n7. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-conditions"
    },
    {
      "settingName": "accessReviews.inactiveDuration",
      "displayName": "Access Reviews - Inactive User Duration",
      "settingPath": "scope.inactiveDuration",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "duration",
      "expectedValue": "P90D",
      "validationOperator": "<=",
      "description": "Defines the inactivity period (in days) after which user accounts are flagged for review. ISO 8601 duration format (e.g., P90D = 90 days).",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure AD > Identity Governance > Access Reviews\n3. Create new access review\n4. Select 'Users' or 'Groups'\n5. Under 'Users scope', check 'Inactive users (on tenant level)'\n6. Specify 'Days inactive' (recommended: 30-90 days)\n7. Configure reviewers and settings\n8. Set actions for denied access (disable accounts)\n9. Schedule and activate review",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/create-access-review"
    },
    {
      "settingName": "accessReviews.autoApplyDecisionsEnabled",
      "displayName": "Access Reviews - Auto Apply Decisions",
      "settingPath": "settings.autoApplyDecisionsEnabled",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically applies reviewer decisions when access review completes. Can automatically disable/remove accounts flagged for removal.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure AD > Identity Governance > Access Reviews\n3. Create or edit access review\n4. Under Settings tab\n5. Enable 'Auto apply results to resource'\n6. This automatically removes access for denied users\n7. Can be configured to disable accounts or remove from groups\n8. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/create-access-review"
    },
    {
      "settingName": "lifecycleWorkflows.isEnabled",
      "displayName": "Lifecycle Workflow - Enabled Status",
      "settingPath": "isEnabled",
      "policyType": "AzureAD",
      "policySubType": "LifecycleWorkflows",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Controls whether a lifecycle workflow is active. Workflows automate joiner/mover/leaver processes including account creation, modification, and termination.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure AD > Identity Governance > Lifecycle Workflows\n3. Create or edit workflow\n4. Set 'Enable workflow' to Yes\n5. Configure execution conditions (joiner/mover/leaver)\n6. Define tasks (add to groups, send welcome email, disable account, etc.)\n7. Requires Azure AD Premium P2 or Entra ID Governance license\n8. Save and activate",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/identitygovernance-lifecycleworkflows-overview"
    },
    {
      "settingName": "lifecycleWorkflows.tasks.disableUserAccount",
      "displayName": "Lifecycle Workflow - Disable User Account Task",
      "settingPath": "tasks.taskDefinitionId",
      "policyType": "AzureAD",
      "policySubType": "LifecycleWorkflows",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "1dfdfcc7-52fa-4c2e-bf3a-e3919cc12950",
      "validationOperator": "==",
      "description": "Built-in task that disables user accounts. taskDefinitionId: 1dfdfcc7-52fa-4c2e-bf3a-e3919cc12950. Used in leaver workflows to automatically disable accounts.",
      "implementationGuide": "1. Sign in to Azure AD portal\n2. Navigate to Azure AD > Identity Governance > Lifecycle Workflows\n3. Create 'Leaver' workflow\n4. Add task: 'Disable user account'\n5. Set execution sequence (typically first task)\n6. Configure trigger: employeeLeaveDateTime\n7. Define scope: department, location, etc.\n8. Workflow runs on-demand or scheduled\n9. Automatically disables accounts on termination",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/lifecycle-workflow-tasks"
    },
    {
      "settingName": "lifecycleWorkflows.executionConditions.trigger.timeBasedAttribute",
      "displayName": "Lifecycle Workflow - Trigger Attribute",
      "settingPath": "executionConditions.trigger.timeBasedAttribute",
      "policyType": "AzureAD",
      "policySubType": "LifecycleWorkflows",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "employeeLeaveDateTime",
      "validationOperator": "==",
      "description": "Specifies the user attribute used to trigger workflow execution. Values: employeeHireDate, employeeLeaveDateTime, createdDateTime. For leaver workflows, use employeeLeaveDateTime.",
      "implementationGuide": "1. In Lifecycle Workflow configuration\n2. Under 'Trigger details'\n3. Select trigger type: Time-based attribute\n4. Choose attribute:\n   - employeeHireDate (for joiners)\n   - employeeLeaveDateTime (for leavers)\n   - createdDateTime (alternative for joiners)\n5. Set offset in days (-180 to +180)\n6. Workflow executes based on attribute value\n7. Requires attribute to be populated via HR system or manually",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/identitygovernance-lifecycleworkflows-overview"
    },
    {
      "settingName": "passwordRequired",
      "displayName": "Intune - Password Required (iOS)",
      "settingPath": "passwordRequired",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "iOS",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to enter a passcode before accessing iOS/iPadOS devices. iOS devices with passcode are automatically encrypted.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Compliance policies > Create policy\n3. Platform: iOS/iPadOS\n4. Under System Security\n5. Set 'Require a password to unlock mobile devices' to 'Require'\n6. Assign to user groups\n7. Note: Setting passcode on iOS automatically enables device encryption",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-ios"
    },
    {
      "settingName": "simplePasswords",
      "displayName": "Intune - Block Simple Passwords (iOS)",
      "settingPath": "simplePasswords",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "iOS",
      "dataType": "string",
      "expectedValue": "block",
      "validationOperator": "==",
      "description": "Blocks users from creating simple passwords like 1234 or 1111 on iOS devices. Enforces password complexity.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Compliance policies\n3. Create or edit iOS/iPadOS compliance policy\n4. Under System Security > Simple passwords\n5. Set to 'Block'\n6. This prevents sequential or repeating characters\n7. Assign to user groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-ios"
    },
    {
      "settingName": "minPasswordLength",
      "displayName": "Intune - Minimum Password Length (iOS)",
      "settingPath": "minPasswordLength",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "iOS",
      "dataType": "integer",
      "expectedValue": 6,
      "validationOperator": ">=",
      "description": "Specifies minimum number of characters required for iOS device passcode. Recommended: 6-8 minimum.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Compliance policies\n3. Create or edit iOS/iPadOS compliance policy\n4. Under System Security > Minimum password length\n5. Set value (4-16 characters, recommended: 6-8)\n6. Assign to user groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-ios"
    },
    {
      "settingName": "passwordRequired",
      "displayName": "Intune - Password Required (Android)",
      "settingPath": "passwordRequired",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Android",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to enter a password before accessing Android devices. Essential for device-level security.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Compliance policies > Create policy\n3. Platform: Android Enterprise\n4. Profile type: Fully managed, dedicated, corporate-owned work profile\n5. Under System Security\n6. Set 'Require a password to unlock mobile devices' to 'Require'\n7. Assign to user groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-android"
    },
    {
      "settingName": "minPasswordLength",
      "displayName": "Intune - Minimum Password Length (Android)",
      "settingPath": "minPasswordLength",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Android",
      "dataType": "integer",
      "expectedValue": 6,
      "validationOperator": ">=",
      "description": "Specifies minimum number of characters required for Android device password. Recommended: 6-8 minimum.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Devices > Compliance policies\n3. Create or edit Android Enterprise compliance policy\n4. Under System Security > Minimum password length\n5. Set value (4-16 characters, recommended: 6-8)\n6. Assign to user groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-android"
    },
    {
      "settingName": "state",
      "displayName": "Conditional Access Policy State",
      "settingPath": "properties.state",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "enabled",
      "validationOperator": "==",
      "description": "Enforces that Conditional Access policies are in enabled state to actively enforce access controls",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Entra ID > Protection > Conditional Access\n3. Select the policy\n4. Set 'Enable policy' to 'On'\n5. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview"
    },
    {
      "settingName": "builtInControls",
      "displayName": "Conditional Access - Require MFA",
      "settingPath": "properties.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"mfa\"]",
      "validationOperator": "contains",
      "description": "Enforces multi-factor authentication as an access control before granting access to CUI and system resources",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Grant\n4. Check 'Require multifactor authentication'\n5. Set 'For multiple controls' to appropriate setting\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant"
    },
    {
      "settingName": "builtInControls",
      "displayName": "Conditional Access - Require Hybrid Azure AD Joined Device",
      "settingPath": "properties.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[\"domainJoinedDevice\"]",
      "validationOperator": "contains",
      "description": "Enforces that devices must be hybrid Azure AD joined to access resources, ensuring device identity verification",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Grant\n4. Check 'Require Hybrid Azure AD joined device'\n5. Configure Azure AD Connect for hybrid join\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant"
    },
    {
      "settingName": "builtInControls",
      "displayName": "Conditional Access - Require Approved Client App",
      "settingPath": "properties.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "iOS,Android",
      "dataType": "array",
      "expectedValue": "[\"approvedApplication\"]",
      "validationOperator": "contains",
      "description": "Enforces use of approved client applications for mobile access, controlling which apps can access CUI",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Grant\n4. Check 'Require approved client app'\n5. Configure approved apps in Intune\n6. Save and enable policy\n\nNote: This control is being deprecated in March 2026, migrate to 'Require app protection policy'",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant"
    },
    {
      "settingName": "operator",
      "displayName": "Conditional Access - Grant Control Operator",
      "settingPath": "properties.grantControls.operator",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "AND",
      "validationOperator": "==",
      "description": "Defines whether all selected grant controls must be satisfied (AND) or at least one (OR) to enforce access",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Grant\n4. Select 'Require all the selected controls' (for AND) or 'Require one of the selected controls' (for OR)\n5. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-grant"
    },
    {
      "settingName": "sessionControls.applicationEnforcedRestrictions.isEnabled",
      "displayName": "Conditional Access - Application Enforced Restrictions",
      "settingPath": "properties.sessionControls.applicationEnforcedRestrictions.isEnabled",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables application-enforced restrictions for SharePoint Online and Exchange Online to limit access based on device state",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Session\n4. Check 'Use app enforced restrictions'\n5. Configure for SharePoint Online and Exchange Online\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session"
    },
    {
      "settingName": "sessionControls.cloudAppSecurity.isEnabled",
      "displayName": "Conditional Access - Defender for Cloud Apps Control",
      "settingPath": "properties.sessionControls.cloudAppSecurity.isEnabled",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Defender for Cloud Apps to enforce access policies and monitor sessions accessing CUI",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Session\n4. Check 'Use Conditional Access App Control'\n5. Select enforcement mode (Monitor only or Block downloads)\n6. Configure policies in Microsoft Defender for Cloud Apps\n7. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session"
    },
    {
      "settingName": "sessionControls.signInFrequency.isEnabled",
      "displayName": "Conditional Access - Sign-in Frequency",
      "settingPath": "properties.sessionControls.signInFrequency.isEnabled",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces how often users must re-authenticate when accessing CUI, ensuring continuous authorization validation",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Access controls' > Session\n4. Check 'Sign-in frequency'\n5. Set frequency value (e.g., 1 hour, 1 day)\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session"
    },
    {
      "settingName": "roleDefinitionId",
      "displayName": "Azure AD Role Assignment - Role Definition",
      "settingPath": "properties.roleDefinitionId",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "<valid-role-guid>",
      "validationOperator": "matches",
      "description": "Defines which Azure AD role is assigned to principals, enforcing role-based access control for administration",
      "implementationGuide": "1. Navigate to Entra ID > Roles and administrators\n2. Select appropriate role\n3. Click 'Add assignments'\n4. Select users/groups/service principals\n5. Define scope (directory, administrative unit, or application)\n6. Add assignment",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/manage-roles-portal"
    },
    {
      "settingName": "principalId",
      "displayName": "Azure AD Role Assignment - Principal ID",
      "settingPath": "properties.principalId",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "<valid-principal-guid>",
      "validationOperator": "matches",
      "description": "Identifies the user, group, or service principal that is granted role-based access",
      "implementationGuide": "1. Navigate to Entra ID > Roles and administrators\n2. Select role\n3. Review 'Assignments' tab\n4. Verify principal IDs match authorized users/groups/service principals\n5. Remove unauthorized assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/manage-roles-portal"
    },
    {
      "settingName": "directoryScopeId",
      "displayName": "Azure AD Role Assignment - Directory Scope",
      "settingPath": "properties.directoryScopeId",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "/",
      "validationOperator": "matches",
      "description": "Defines the scope of the role assignment (tenant-wide '/', administrative unit '/administrativeUnits/{id}', or application '/{id}')",
      "implementationGuide": "1. Navigate to Entra ID > Roles and administrators\n2. Select role\n3. When adding assignment, choose scope:\n   - Tenant: Leave at root '/'\n   - Administrative Unit: Select specific AU\n   - Application: Select specific app registration\n4. Complete assignment",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/custom-overview"
    },
    {
      "settingName": "assignmentType",
      "displayName": "Azure AD Role Assignment - Assignment Type",
      "settingPath": "properties.assignmentType",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Assigned",
      "validationOperator": "in",
      "description": "Indicates if assignment is direct (Assigned), inherited (Inherited), or eligible for activation (Eligible via PIM)",
      "implementationGuide": "1. Navigate to Entra ID > Roles and administrators\n2. Select role\n3. Review 'Assignments' tab\n4. Check 'Assignment type' column\n5. For PIM-eligible: Navigate to Privileged Identity Management > Azure AD roles\n6. Configure eligible assignments with activation requirements",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure"
    },
    {
      "settingName": "isMemberManagementRestricted",
      "displayName": "Administrative Unit - Restricted Management",
      "settingPath": "properties.isMemberManagementRestricted",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnit",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Restricted Management Administrative Unit (RMAU) to prevent unauthorized modification of privileged objects",
      "implementationGuide": "1. Navigate to Entra ID > Administrative units\n2. Select or create administrative unit\n3. Under 'Properties'\n4. Enable 'Restricted management administrative unit'\n5. Save changes\n6. Only Global Admins or scoped AU admins can manage members",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-restricted-management"
    },
    {
      "settingName": "members",
      "displayName": "Administrative Unit - Member Assignments",
      "settingPath": "members",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnit",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Defines users and groups that are members of the administrative unit, limiting scope of administrative access",
      "implementationGuide": "1. Navigate to Entra ID > Administrative units\n2. Select administrative unit\n3. Under 'Users' or 'Groups'\n4. Add members that should be managed by scoped administrators\n5. These members can only be administered by AU-scoped role assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-members-add"
    },
    {
      "settingName": "scopedRoleMembers",
      "displayName": "Administrative Unit - Scoped Role Assignments",
      "settingPath": "scopedRoleMembers",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnit",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Defines which administrators have role permissions limited to this administrative unit's scope",
      "implementationGuide": "1. Navigate to Entra ID > Administrative units\n2. Select administrative unit\n3. Under 'Roles and administrators'\n4. Assign roles to specific users/groups\n5. These assignments only grant permissions over AU members\n6. Review and validate scoped assignments regularly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-assign-roles"
    },
    {
      "settingName": "assignments",
      "displayName": "Intune App Protection Policy - User/Group Assignment",
      "settingPath": "assignments",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Defines which users or groups receive the app protection policy, enforcing application-level access controls",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Apps > App protection policies\n3. Select policy (iOS or Android)\n4. Under 'Assignments'\n5. Add user groups that should receive the policy\n6. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy"
    },
    {
      "settingName": "dataProtection.blockDataIngestionIntoOrganizationDocuments",
      "displayName": "Intune App Protection - Block Data Ingestion",
      "settingPath": "apps[].mobileAppPolicyConfiguration.dataProtection.blockDataIngestionIntoOrganizationDocuments",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Prevents copying data from personal apps into organization-managed apps, enforcing data access boundaries",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Apps > App protection policies\n3. Select policy\n4. Under 'Data protection'\n5. Configure 'Receive data from other apps' to 'None' or 'Policy managed apps'\n6. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios"
    },
    {
      "settingName": "accessRequirements.pinRequired",
      "displayName": "Intune App Protection - Require PIN",
      "settingPath": "apps[].mobileAppPolicyConfiguration.accessRequirements.pinRequired",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to enter a PIN before accessing organization apps, enforcing application-level authentication",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Apps > App protection policies\n3. Select policy\n4. Under 'Access requirements'\n5. Set 'PIN for access' to 'Required'\n6. Configure PIN type and complexity\n7. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios"
    },
    {
      "settingName": "conditionalLaunch.maxPinAttempts",
      "displayName": "Intune App Protection - Maximum PIN Attempts",
      "settingPath": "apps[].mobileAppPolicyConfiguration.conditionalLaunch.maxPinAttempts",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Limits failed PIN attempts before blocking or wiping app data, preventing unauthorized access",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Apps > App protection policies\n3. Select policy\n4. Under 'Conditional launch'\n5. Add condition: 'Max PIN attempts'\n6. Set value (e.g., 5)\n7. Set action (Block access or Wipe data)\n8. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios"
    },
    {
      "settingName": "conditionalLaunch.offlineGracePeriod",
      "displayName": "Intune App Protection - Offline Grace Period",
      "settingPath": "apps[].mobileAppPolicyConfiguration.conditionalLaunch.offlineGracePeriod",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "integer",
      "expectedValue": 720,
      "validationOperator": "<=",
      "description": "Defines how long (in minutes) an app can run offline before re-authentication is required",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Apps > App protection policies\n3. Select policy\n4. Under 'Conditional launch'\n5. Add condition: 'Offline grace period'\n6. Set value (e.g., 720 minutes = 12 hours)\n7. Set action (Block access or Wipe data)\n8. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios"
    },
    {
      "settingName": "roles",
      "displayName": "SharePoint Site Permissions - Application Role",
      "settingPath": "permissions[].roles",
      "policyType": "SharePoint",
      "policySubType": "SitePermissions",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"read\",\"write\",\"owner\"]",
      "validationOperator": "in",
      "description": "Defines application-level permissions granted to Azure AD apps for SharePoint sites containing CUI (read, write, owner/fullcontrol)",
      "implementationGuide": "1. Use Microsoft Graph API or PowerShell\n2. POST to /sites/{siteId}/permissions\n3. Specify application ID and desired role\n4. Requires Sites.FullControl.All permission to grant\n5. Example roles: 'read', 'write', 'owner'\n6. Validate assignment with GET /sites/{siteId}/permissions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/permissions-selected-overview"
    },
    {
      "settingName": "grantedToIdentities",
      "displayName": "SharePoint Site Permissions - Granted Applications",
      "settingPath": "permissions[].grantedToIdentities[].application.id",
      "policyType": "SharePoint",
      "policySubType": "SitePermissions",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Lists application IDs that have been granted permissions to specific SharePoint sites, enforcing application access control",
      "implementationGuide": "1. Use Microsoft Graph API\n2. GET /sites/{siteId}/permissions\n3. Review grantedToIdentities array\n4. Verify only authorized applications have access\n5. Remove unauthorized apps with DELETE /sites/{siteId}/permissions/{permissionId}",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/permissions-selected-overview"
    },
    {
      "settingName": "Sites.Selected",
      "displayName": "SharePoint - Sites.Selected Permission Scope",
      "settingPath": "requiredResourceAccess[].resourceAccess[].type",
      "policyType": "AzureAD",
      "policySubType": "ApplicationPermissions",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Role",
      "validationOperator": "==",
      "description": "Grants application permission to access only specific SharePoint sites rather than all sites, enforcing least-privilege access",
      "implementationGuide": "1. Navigate to Entra ID > App registrations\n2. Select application\n3. Under 'API permissions'\n4. Add permission > Microsoft Graph > Application permissions\n5. Select 'Sites.Selected'\n6. Grant admin consent\n7. Use Graph API to grant site-specific access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/permissions-selected-overview"
    },
    {
      "settingName": "appRoleAssignments",
      "displayName": "Azure AD Application - App Role Assignments",
      "settingPath": "appRoleAssignments",
      "policyType": "AzureAD",
      "policySubType": "ApplicationPermissions",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Lists app role assignments granted to service principals for accessing Microsoft Graph and other APIs",
      "implementationGuide": "1. Use Microsoft Graph API or PowerShell\n2. GET /servicePrincipals/{id}/appRoleAssignments\n3. Review assigned app roles\n4. Validate only required permissions are granted\n5. Remove excessive permissions\n6. Monitor for privilege escalation risks (e.g., RoleManagement.ReadWrite.Directory)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/serviceprincipal-list-approleassignments"
    },
    {
      "settingName": "resourceAppId",
      "displayName": "Azure AD Application - Resource Application ID",
      "settingPath": "appRoleAssignments[].resourceAppId",
      "policyType": "AzureAD",
      "policySubType": "ApplicationPermissions",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "00000003-0000-0000-c000-000000000000",
      "validationOperator": "==",
      "description": "Identifies the resource application (e.g., Microsoft Graph) that the app has permissions to access",
      "implementationGuide": "1. Use Microsoft Graph API\n2. GET /servicePrincipals/{id}/appRoleAssignments\n3. Check resourceAppId field\n4. Common values:\n   - Microsoft Graph: 00000003-0000-0000-c000-000000000000\n   - SharePoint: 00000003-0000-0ff1-ce00-000000000000\n5. Validate assignments are for approved resources only",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/approleassignment"
    },
    {
      "settingName": "appRoleId",
      "displayName": "Azure AD Application - Specific App Role ID",
      "settingPath": "appRoleAssignments[].appRoleId",
      "policyType": "AzureAD",
      "policySubType": "ApplicationPermissions",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "<valid-role-guid>",
      "validationOperator": "matches",
      "description": "Identifies the specific permission/app role granted (e.g., User.Read.All, Sites.Read.All)",
      "implementationGuide": "1. Use Microsoft Graph API\n2. GET /servicePrincipals/{id}/appRoleAssignments\n3. Review appRoleId values\n4. Cross-reference with resource application's appRoles\n5. Identify high-risk permissions:\n   - RoleManagement.ReadWrite.Directory\n   - AppRoleAssignment.ReadWrite.All\n   - Application.ReadWrite.All\n6. Remove or justify high-risk assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/approleassignment"
    },
    {
      "settingName": "complianceState",
      "displayName": "Intune Device Compliance - Compliance State",
      "settingPath": "managedDevices[].complianceState",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "compliant",
      "validationOperator": "==",
      "description": "Indicates whether a device meets compliance requirements and can access CUI",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Devices > Monitor > Device compliance\n3. Review compliance state for each device\n4. Investigate non-compliant devices\n5. Remediate or block access based on policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started"
    },
    {
      "settingName": "compliancePolicyAssignments",
      "displayName": "Intune Compliance Policy - Group Assignments",
      "settingPath": "deviceCompliancePolicies[].assignments",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": "contains",
      "description": "Defines which user/device groups receive compliance policies that enforce access requirements",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Select Devices > Compliance policies\n3. Select policy (Windows, iOS, Android, macOS)\n4. Under 'Assignments'\n5. Add groups that should receive the policy\n6. Configure inclusion and exclusion groups\n7. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started"
    },
    {
      "settingName": "justInTimeAccess",
      "displayName": "Privileged Identity Management - Just-in-Time Access",
      "settingPath": "roleManagementPolicies[].rules[].ruleType",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "ExpirationRule",
      "validationOperator": "==",
      "description": "Enforces time-limited activation of privileged roles, ensuring access is granted only when needed",
      "implementationGuide": "1. Navigate to Entra ID > Privileged Identity Management\n2. Select Azure AD roles or Azure resources\n3. Select role to configure\n4. Under 'Settings'\n5. Configure activation duration (max 8 hours recommended)\n6. Require justification on activation\n7. Require approval if needed\n8. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure"
    },
    {
      "settingName": "approvalRequired",
      "displayName": "Privileged Identity Management - Approval Required",
      "settingPath": "roleManagementPolicies[].rules[].setting.isApprovalRequired",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires approval before privileged role activation, enforcing multi-person authorization",
      "implementationGuide": "1. Navigate to Entra ID > Privileged Identity Management\n2. Select Azure AD roles\n3. Select role to configure\n4. Under 'Settings' > 'Activation'\n5. Check 'Require approval to activate'\n6. Add approvers (minimum 2 recommended)\n7. Configure approval timeout\n8. Save changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-resource-roles-approval-workflow"
    },
    {
      "settingName": "conditions.applications.includeApplications",
      "displayName": "Conditional Access - Cloud App Targeting",
      "settingPath": "properties.conditions.applications.includeApplications",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"All\",\"Office365\"]",
      "validationOperator": "in",
      "description": "Specifies which cloud applications the access enforcement policy applies to, controlling access to CUI-containing apps",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Assignments' > Cloud apps or actions\n4. Select 'Include' > Choose 'All cloud apps' or 'Select apps'\n5. If specific apps, search and select (e.g., Office 365, SharePoint, Exchange)\n6. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-cloud-apps"
    },
    {
      "settingName": "conditions.users.includeUsers",
      "displayName": "Conditional Access - User/Group Targeting",
      "settingPath": "properties.conditions.users.includeUsers",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"All\"]",
      "validationOperator": "in",
      "description": "Specifies which users or groups the access enforcement policy applies to",
      "implementationGuide": "1. Navigate to Entra ID > Protection > Conditional Access > Policies\n2. Create new policy or select existing\n3. Under 'Assignments' > Users and groups\n4. Select 'Include' > Choose 'All users' or 'Select users and groups'\n5. If specific, select groups/roles\n6. Configure exclusions if needed (emergency access accounts)\n7. Save and enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-users-groups"
    },
    {
      "settingName": "state",
      "displayName": "DLP Policy State",
      "settingPath": "policy.state",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Enabled",
      "validationOperator": "==",
      "description": "Enables the DLP policy to actively enforce information flow restrictions and prevent CUI exfiltration",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Go to Data loss prevention > Policies\n3. Select the CUI protection policy or create new policy\n4. Ensure 'Turn it on right away' is selected (Enabled state)\n5. Save the policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-create-deploy-policy"
    },
    {
      "settingName": "locations",
      "displayName": "DLP Policy Locations",
      "settingPath": "policy.locations",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"Exchange\",\"SharePoint\",\"OneDrive\",\"Teams\",\"Devices\"]",
      "validationOperator": "contains",
      "description": "Specifies which Microsoft 365 workloads the DLP policy monitors to control CUI information flow across all communication channels",
      "implementationGuide": "1. In Microsoft Purview portal, navigate to Data loss prevention > Policies\n2. Create or edit DLP policy\n3. On 'Choose locations' page, enable:\n   - Exchange email\n   - SharePoint sites\n   - OneDrive accounts\n   - Teams chat and channel messages\n   - Devices (Windows/Mac endpoints)\n4. Select 'All' for each location or specify included/excluded groups\n5. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-policy-reference"
    },
    {
      "settingName": "contentContainsSensitiveInformation",
      "displayName": "DLP Sensitive Information Detection",
      "settingPath": "rule.conditions.contentContainsSensitiveInformation",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"Custom.CUI\",\"U.S._Social_Security_Number\",\"Credit_Card_Number\",\"Custom.ITAR\"]",
      "validationOperator": "contains",
      "description": "Defines sensitive information types that DLP detects to identify CUI content and trigger information flow controls",
      "implementationGuide": "1. Navigate to Purview portal > Data loss prevention > Policies\n2. Edit DLP policy rules\n3. Under 'Conditions', select 'Content contains'\n4. Add sensitive information types:\n   - Built-in types (SSN, Credit Card, etc.)\n   - Custom sensitive info types for CUI classification\n   - ITAR/Export controlled data types\n5. Configure confidence level (High/Medium/Low)\n6. Set instance count threshold\n7. Save rule configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-policy-reference"
    },
    {
      "settingName": "contentContainsSensitivityLabel",
      "displayName": "DLP Sensitivity Label Detection",
      "settingPath": "rule.conditions.contentContainsSensitivityLabel",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"CUI\",\"Confidential\",\"Highly Confidential\"]",
      "validationOperator": "contains",
      "description": "Detects sensitivity labels applied to content to enforce label-based information flow restrictions for classified CUI",
      "implementationGuide": "1. In Purview portal, go to Data loss prevention > Policies\n2. Edit DLP policy rules\n3. Under 'Conditions', select 'Content contains sensitivity labels'\n4. Choose sensitivity labels that classify CUI:\n   - CUI label\n   - Confidential label\n   - Highly Confidential label\n5. Configure rule to trigger on any or all selected labels\n6. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-policy-reference"
    },
    {
      "settingName": "blockAccess",
      "displayName": "DLP Block Action for External Sharing",
      "settingPath": "rule.actions.blockAccess",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Blocks sharing of CUI content to external recipients, preventing unauthorized information flow outside the organization",
      "implementationGuide": "1. Navigate to Purview > Data loss prevention > Policies\n2. Edit DLP rule actions\n3. Under 'Actions', select 'Restrict access or encrypt the content'\n4. Choose 'Block users from accessing shared SharePoint, OneDrive, and Teams content'\n5. Select 'Block only people from outside your organization'\n6. For Exchange, select 'Block the message'\n7. For Devices, select 'Block'\n8. Save action configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-policy-reference"
    },
    {
      "settingName": "notifyUser",
      "displayName": "DLP User Notification",
      "settingPath": "rule.actions.notifyUser",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Notifies users when they attempt unauthorized CUI information flow, providing policy tips and awareness",
      "implementationGuide": "1. In Purview portal, navigate to Data loss prevention > Policies\n2. Edit DLP rule\n3. Under 'User notifications', toggle 'On'\n4. Select notification options:\n   - Notify users in Office 365 service with a policy tip\n   - Send email notification to user who sent, shared, or modified content\n5. Customize policy tip text to explain CUI restrictions\n6. Save notification settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-policy-reference"
    },
    {
      "settingName": "restrictedCloudAppDomains",
      "displayName": "DLP Restricted Cloud Service Domains",
      "settingPath": "endpointSettings.restrictedCloudAppDomains",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[\"gmail.com\",\"dropbox.com\",\"box.com\",\"icloud.com\"]",
      "validationOperator": "contains",
      "description": "Blocks file uploads containing CUI to specified unmanaged cloud services from managed endpoints",
      "implementationGuide": "1. Navigate to Purview > Data loss prevention > Settings > Endpoint DLP settings\n2. Go to 'Browser and domain restrictions to sensitive data'\n3. Configure 'Service domains' list mode:\n   - Set to 'Block' to create blocklist\n4. Add cloud service domains to block:\n   - gmail.com\n   - dropbox.com\n   - box.com\n   - icloud.com\n   - Other unapproved cloud storage\n5. Save endpoint DLP settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-configure-endpoint-settings"
    },
    {
      "settingName": "advancedClassification",
      "displayName": "DLP Advanced Classification Scanning",
      "settingPath": "endpointSettings.advancedClassification",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables cloud-based classification service to scan and detect CUI in files on endpoints for information flow enforcement",
      "implementationGuide": "1. Navigate to Purview portal > Data loss prevention > Settings\n2. Select 'Endpoint DLP settings'\n3. Locate 'Advanced classification scanning and protection' section\n4. Toggle the setting to 'On'\n5. This enables cloud-based scanning for:\n   - Trainable classifiers\n   - Named entities\n   - Enhanced sensitive information detection\n6. Save endpoint settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-configure-endpoint-settings"
    },
    {
      "settingName": "policyMode",
      "displayName": "DLP Policy Mode (Enforcement vs Test)",
      "settingPath": "policy.mode",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Enforce",
      "validationOperator": "==",
      "description": "Sets DLP policy to enforcement mode to actively block unauthorized CUI information flow (vs test-only mode)",
      "implementationGuide": "1. In Purview portal, navigate to Data loss prevention > Policies\n2. Select or create DLP policy\n3. In policy settings, choose policy mode:\n   - 'Turn it on right away' = Enforce mode (REQUIRED)\n   - 'Test it out first' = Test mode (not compliant)\n   - 'Keep it off' = Disabled (not compliant)\n4. Select 'Turn it on right away' for production enforcement\n5. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-create-deploy-policy"
    },
    {
      "settingName": "encryptContent",
      "displayName": "DLP Encrypt Content Action",
      "settingPath": "rule.actions.encryptContent",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically encrypts CUI content when shared externally to enforce information protection during transit",
      "implementationGuide": "1. Navigate to Purview > Data loss prevention > Policies\n2. Edit DLP rule actions\n3. Under 'Actions', select 'Restrict access or encrypt the content in Microsoft 365 locations'\n4. Choose 'Encrypt email messages' for Exchange\n5. Select encryption template (Office 365 Message Encryption)\n6. For files, enable 'Apply sensitivity label' that includes encryption\n7. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-exchange-conditions-and-actions"
    },
    {
      "settingName": "isMandatory",
      "displayName": "Mandatory Sensitivity Labeling",
      "settingPath": "labelPolicy.settings.isMandatory",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to apply sensitivity labels to CUI content, ensuring all information is classified before flow decisions",
      "implementationGuide": "1. Navigate to Microsoft Purview portal > Information protection > Labels > Label policies\n2. Select or create label publishing policy\n3. On 'Policy settings' page, enable 'Require users to apply a label to their email and documents'\n4. This forces labeling before save/send operations\n5. Publish policy to users\n6. Allow 24 hours for replication",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/create-sensitivity-labels"
    },
    {
      "settingName": "isDowngradeJustificationRequired",
      "displayName": "Downgrade Justification Required",
      "settingPath": "labelPolicy.settings.isDowngradeJustificationRequired",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires justification when downgrading CUI sensitivity label, preventing unauthorized label changes that bypass flow controls",
      "implementationGuide": "1. In Purview portal, navigate to Information protection > Label policies\n2. Edit label publishing policy\n3. On 'Policy settings', enable 'Require users to provide justification to remove a label or lower classification label'\n4. This creates audit trail for label downgrades\n5. Users must provide business justification to downgrade CUI labels\n6. Save and publish policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/create-sensitivity-labels"
    },
    {
      "settingName": "encryptionSettings",
      "displayName": "Sensitivity Label Encryption for CUI",
      "settingPath": "label.encryptionSettings.enabled",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Applies encryption to CUI-labeled content to restrict access and prevent unauthorized information flow",
      "implementationGuide": "1. Navigate to Purview > Information protection > Labels\n2. Select CUI/Confidential sensitivity label\n3. On 'Encryption' page, select 'Configure encryption settings'\n4. Choose 'Apply encryption'\n5. Configure encryption options:\n   - Assign permissions now or let users assign\n   - Set access expiration\n   - Allow offline access with restrictions\n6. Define who can access encrypted content\n7. Save label configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/encryption-sensitivity-labels"
    },
    {
      "settingName": "externalSharingSettings",
      "displayName": "Block External Sharing for CUI Labels",
      "settingPath": "label.siteAndGroupSettings.privacy",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Private",
      "validationOperator": "==",
      "description": "Restricts external sharing of Teams/Groups/Sites labeled with CUI sensitivity labels",
      "implementationGuide": "1. In Purview portal, go to Information protection > Labels\n2. Select CUI sensitivity label\n3. On 'Define protection settings for groups and sites', enable scope\n4. Configure 'Privacy and external user access settings':\n   - Privacy: Select 'Private'\n   - External user access: Uncheck 'Let Microsoft 365 group owners add people outside your organization to the group'\n5. Configure 'External sharing and Conditional Access':\n   - External sharing: Select appropriate restriction level\n6. Save label configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/sensitivity-labels-teams-groups-sites"
    },
    {
      "settingName": "defaultSharingLinkType",
      "displayName": "Sensitivity Label Default Sharing Link Type",
      "settingPath": "label.defaultSharingLinkType",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Direct",
      "validationOperator": "==",
      "description": "Sets default sharing link type for CUI-labeled content to 'Specific people' to prevent anonymous sharing",
      "implementationGuide": "1. Navigate to Purview > Information protection > Labels\n2. Select CUI sensitivity label\n3. Use PowerShell to configure default link type (not available in UI):\n   Set-Label -Identity \"CUI\" -AdvancedSettings @{DefaultSharingScope=\"SpecificPeople\"}\n4. This ensures CUI content shares default to specific people, not 'Anyone' links\n5. Users must explicitly choose broader sharing",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/sensitivity-labels-default-sharing-link"
    },
    {
      "settingName": "autoLabelingPolicy",
      "displayName": "Auto-Labeling for CUI Content",
      "settingPath": "autoLabelingPolicy.enabled",
      "policyType": "Purview",
      "policySubType": "SensitivityLabel",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically applies CUI sensitivity labels to content matching CUI criteria, ensuring consistent flow enforcement",
      "implementationGuide": "1. Navigate to Purview > Information protection > Auto-labeling\n2. Create new auto-labeling policy\n3. Name policy (e.g., 'Auto-label CUI content')\n4. Choose locations (Exchange, SharePoint, OneDrive)\n5. Define rules matching CUI sensitive info types\n6. Select CUI sensitivity label to auto-apply\n7. Choose 'Apply label automatically' mode\n8. Save and publish policy\n9. Allow up to 7 days for initial labeling",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/apply-sensitivity-label-automatically"
    },
    {
      "settingName": "sharingCapability",
      "displayName": "SharePoint/OneDrive Organization Sharing Capability",
      "settingPath": "tenant.sharingCapability",
      "policyType": "SharePoint",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "ExternalUserSharingOnly",
      "validationOperator": "in",
      "description": "Restricts external sharing to authenticated guests only, preventing anonymous CUI sharing via 'Anyone' links",
      "implementationGuide": "1. Navigate to SharePoint admin center (https://admin.microsoft.com/sharepoint)\n2. Go to Policies > Sharing\n3. Under 'External sharing', configure SharePoint slider:\n   - For highest security: 'Only people in your organization'\n   - For controlled external sharing: 'New and existing guests' (ExternalUserSharingOnly)\n   - Avoid: 'Anyone' (allows anonymous links)\n4. Set OneDrive to same or more restrictive level\n5. Save settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off"
    },
    {
      "settingName": "defaultSharingLinkType",
      "displayName": "Default Sharing Link Type",
      "settingPath": "tenant.defaultSharingLinkType",
      "policyType": "SharePoint",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Direct",
      "validationOperator": "==",
      "description": "Sets default sharing link to 'Specific people' instead of 'Anyone' to prevent accidental CUI over-sharing",
      "implementationGuide": "1. In SharePoint admin center, navigate to Policies > Sharing\n2. Scroll to 'File and folder links' section\n3. Under 'Choose the type of link that's selected by default', select:\n   - 'Specific people' (recommended for CUI)\n   - Alternative: 'Only people in your organization'\n4. Under 'Choose the permission that's selected by default', select 'View'\n5. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/change-default-sharing-link"
    },
    {
      "settingName": "requireAnonymousLinksExpireInDays",
      "displayName": "Anonymous Link Expiration",
      "settingPath": "tenant.requireAnonymousLinksExpireInDays",
      "policyType": "SharePoint",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 30,
      "validationOperator": "<=",
      "description": "Enforces expiration on anonymous sharing links to limit duration of CUI exposure if anonymous sharing is permitted",
      "implementationGuide": "1. Navigate to SharePoint admin center > Policies > Sharing\n2. Under 'Advanced settings for Anyone links', enable 'These links must expire within this many days'\n3. Set value to 30 days or less (recommended: 14-30 days)\n4. Note: This only applies if 'Anyone' sharing is enabled\n5. For CUI environments, consider disabling 'Anyone' sharing entirely\n6. Save settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off"
    },
    {
      "settingName": "guestAccessExpirationDays",
      "displayName": "Guest Access Expiration Days",
      "settingPath": "tenant.externalUserExpirationRequired",
      "policyType": "SharePoint",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 90,
      "validationOperator": "<=",
      "description": "Requires periodic re-authorization of external guest access to CUI content in SharePoint/OneDrive",
      "implementationGuide": "1. In SharePoint admin center, go to Policies > Sharing\n2. Under 'Advanced settings for Anyone links', scroll to 'Guest access to a site or OneDrive will expire automatically after this many days'\n3. Enable the setting\n4. Set value (recommended: 60-90 days)\n5. Guests must be re-invited after expiration\n6. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off"
    },
    {
      "settingName": "defaultLinkPermission",
      "displayName": "Default Link Permission Level",
      "settingPath": "tenant.defaultLinkPermission",
      "policyType": "SharePoint",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "View",
      "validationOperator": "==",
      "description": "Sets default sharing permission to 'View' instead of 'Edit' to prevent unauthorized CUI modification",
      "implementationGuide": "1. Navigate to SharePoint admin center > Policies > Sharing\n2. Under 'File and folder links' section\n3. Find 'Choose the permission that's selected by default for sharing links'\n4. Select 'View' (recommended for CUI protection)\n5. This prevents accidental 'Edit' permissions on CUI shares\n6. Users must explicitly grant 'Edit' if needed\n7. Save settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/change-default-sharing-link"
    },
    {
      "settingName": "transportRuleState",
      "displayName": "Mail Flow Rule State for External CUI Blocking",
      "settingPath": "transportRule.state",
      "policyType": "Exchange",
      "policySubType": "TransportRule",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Enabled",
      "validationOperator": "==",
      "description": "Enables mail flow rule to block or encrypt CUI emails to external recipients",
      "implementationGuide": "1. Navigate to Exchange admin center (https://admin.exchange.microsoft.com)\n2. Go to Mail flow > Rules\n3. Create new rule or enable existing CUI protection rule\n4. Configure rule:\n   - Name: 'Block CUI to External Recipients'\n   - Apply if: Recipient is outside organization AND (message contains sensitive info OR has CUI label)\n   - Do the following: Block the message / Reject with explanation\n5. Set rule state to 'Enabled'\n6. Save rule\nNote: Mail flow rules managed via PowerShell (New-TransportRule), not Graph API",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/manage-mail-flow-rules"
    },
    {
      "settingName": "encryptAction",
      "displayName": "Mail Flow Rule Encryption Action",
      "settingPath": "transportRule.actions.applyOME",
      "policyType": "Exchange",
      "policySubType": "TransportRule",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Applies Office 365 Message Encryption to CUI emails sent to approved external recipients",
      "implementationGuide": "1. In Exchange admin center, go to Mail flow > Rules\n2. Create rule for CUI encryption:\n   - Name: 'Encrypt CUI to External Recipients'\n   - Apply if: Recipient is outside organization AND message has CUI label\n   - Do the following: Modify message security > Apply Office 365 Message Encryption\n3. Select encryption template (e.g., 'Encrypt')\n4. Enable rule\n5. Save configuration\nNote: Requires Azure Information Protection / Office 365 Message Encryption",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/use-rules-to-encrypt-email"
    },
    {
      "settingName": "fromScope",
      "displayName": "Mail Flow Rule Sender Scope Condition",
      "settingPath": "transportRule.conditions.fromScope",
      "policyType": "Exchange",
      "policySubType": "TransportRule",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "InOrganization",
      "validationOperator": "==",
      "description": "Applies CUI flow rule only to internal senders to prevent external spoofing bypass",
      "implementationGuide": "1. In Exchange admin center, navigate to Mail flow > Rules\n2. Edit CUI protection mail flow rule\n3. Under conditions, select 'The sender is located...'\n4. Choose 'Inside the organization'\n5. This ensures rule applies to genuine internal users, not external spoofers\n6. Combine with other conditions (CUI labels, sensitive info)\n7. Save rule configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions"
    },
    {
      "settingName": "allowTeamsConsumer",
      "displayName": "Block Teams Communication with Personal Accounts",
      "settingPath": "teamsClientConfiguration.allowTeamsConsumer",
      "policyType": "Teams",
      "policySubType": "ExternalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Blocks Teams users from communicating with personal Microsoft accounts to prevent CUI data leakage",
      "implementationGuide": "1. Navigate to Teams admin center (https://admin.teams.microsoft.com)\n2. Go to Users > External access\n3. Under 'Teams accounts not managed by an organization', toggle OFF:\n   - 'People in my organization can communicate with Teams users whose accounts aren't managed by an organization'\n4. This blocks chat/calls with personal Teams accounts\n5. Save configuration\nNote: Configured via Teams admin center or PowerShell (Set-CsExternalAccessPolicy)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoftteams/manage-external-access"
    },
    {
      "settingName": "allowGuestAccess",
      "displayName": "Teams Guest Access Control",
      "settingPath": "guestAccessConfiguration.allowGuestAccess",
      "policyType": "Teams",
      "policySubType": "GuestAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Controls whether external guests can be added to Teams, preventing CUI exposure to unauthorized external users",
      "implementationGuide": "1. Navigate to Teams admin center > Users > Guest access\n2. Set 'Allow guest access in Teams' toggle:\n   - OFF: Completely blocks guest access (highest security for CUI)\n   - ON: Allows controlled guest access with restrictions\n3. If enabling guest access for CUI environment:\n   - Messaging: Limit guest capabilities\n   - Calling: Disable make/receive calls\n   - Meeting: Restrict screen sharing\n4. Save settings\n5. Use Azure AD guest access policies for additional controls",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoftteams/guest-access"
    },
    {
      "settingName": "allowGuestEditChannelPosts",
      "displayName": "Block Guest Channel Post Editing",
      "settingPath": "guestAccessConfiguration.allowGuestEditChannelPosts",
      "policyType": "Teams",
      "policySubType": "GuestAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Prevents guests from editing channel posts containing CUI to maintain information integrity",
      "implementationGuide": "1. In Teams admin center, navigate to Users > Guest access\n2. Under 'Messaging', find 'Edit sent messages'\n3. Toggle to 'Off' to prevent guests from editing channel posts\n4. This prevents modification of CUI messages by external guests\n5. Save guest access configuration\nNote: Only applicable if guest access is enabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoftteams/guest-access"
    },
    {
      "settingName": "sendOrgDataToOtherApps",
      "displayName": "Intune MAM - Block Org Data to Unmanaged Apps",
      "settingPath": "appProtectionPolicy.dataProtection.allowedOutboundDataTransferDestinations",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS,Android",
      "dataType": "string",
      "expectedValue": "ManagedApps",
      "validationOperator": "==",
      "description": "Blocks CUI from being sent from managed apps (Outlook, OneDrive) to unmanaged personal apps on mobile devices",
      "implementationGuide": "1. Navigate to Intune admin center (https://intune.microsoft.com)\n2. Go to Apps > App protection policies\n3. Create or edit iOS/Android policy\n4. Under 'Data protection', configure 'Send org data to other apps':\n   - Select 'Policy managed apps' (blocks transfer to unmanaged apps)\n   - Alternative: 'None' (most restrictive, blocks all transfers)\n5. Apply policy to users/groups\n6. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios"
    },
    {
      "settingName": "receiveDataFromOtherApps",
      "displayName": "Intune MAM - Receive Data from Other Apps",
      "settingPath": "appProtectionPolicy.dataProtection.allowedInboundDataTransferSources",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS,Android",
      "dataType": "string",
      "expectedValue": "AllApps",
      "validationOperator": "==",
      "description": "Controls whether managed apps can receive data from unmanaged apps (typically allowed for usability)",
      "implementationGuide": "1. In Intune admin center, navigate to Apps > App protection policies\n2. Edit iOS/Android policy\n3. Under 'Data protection', configure 'Receive data from other apps':\n   - 'All apps': Allows receiving from any app (typical setting)\n   - 'Policy managed apps': Only from other managed apps\n   - 'None': Blocks all incoming data\n4. For CUI environments, consider 'Policy managed apps' for maximum protection\n5. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios"
    },
    {
      "settingName": "restrictCutCopyPaste",
      "displayName": "Intune MAM - Restrict Cut/Copy/Paste",
      "settingPath": "appProtectionPolicy.dataProtection.allowedOutboundClipboardSharingLevel",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS,Android",
      "dataType": "string",
      "expectedValue": "ManagedAppsWithPasteIn",
      "validationOperator": "==",
      "description": "Restricts clipboard sharing of CUI between managed and unmanaged apps on mobile devices",
      "implementationGuide": "1. Navigate to Intune > Apps > App protection policies\n2. Edit iOS/Android policy\n3. Under 'Data protection', configure 'Restrict cut, copy, and paste between other apps':\n   - 'Blocked': Completely blocks clipboard (most restrictive)\n   - 'Policy managed apps': Only clipboard between managed apps\n   - 'Policy managed apps with paste in': Allows paste FROM unmanaged (recommended)\n   - 'Any app': No restrictions (not recommended for CUI)\n4. Save policy configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios"
    },
    {
      "settingName": "saveAsBlocked",
      "displayName": "Intune MAM - Block Save As to Unmanaged Locations",
      "settingPath": "appProtectionPolicy.dataProtection.allowUserToSaveCopy",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS,Android",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Blocks saving CUI documents to unmanaged cloud storage or local device storage from managed apps",
      "implementationGuide": "1. In Intune admin center, go to Apps > App protection policies\n2. Edit policy under 'Data protection' settings\n3. Configure 'Allow user to save copies to selected services':\n   - Toggle OFF to block all 'Save As'\n   - Or select only approved services (OneDrive, SharePoint)\n4. This prevents CUI from being saved to:\n   - Local device storage\n   - Personal cloud storage (iCloud, Google Drive)\n   - Unmanaged file locations\n5. Save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios"
    },
    {
      "settingName": "printBlocked",
      "displayName": "Intune MAM - Block Print of Org Data",
      "settingPath": "appProtectionPolicy.dataProtection.printBlocked",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS,Android",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Blocks printing of CUI content from managed mobile apps to prevent physical information leakage",
      "implementationGuide": "1. Navigate to Intune > Apps > App protection policies\n2. Edit iOS/Android policy\n3. Under 'Data protection', locate 'Printing org data' setting\n4. Set to 'Block' to prevent printing CUI from managed apps\n5. This prevents:\n   - Printing to local printers\n   - Printing to cloud print services\n   - Print-to-PDF operations\n6. Apply policy to users\n7. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy-settings-ios"
    },
    {
      "settingName": "roleDefinitionId",
      "displayName": "Security Reader Role Assignment (Audit Functions)",
      "settingPath": "roleManagement.directory.roleAssignments.roleDefinitionId",
      "policyType": "AzureAD",
      "policySubType": "RoleAssignment",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "5d6b6bb7-de71-4623-b4af-96380a352509",
      "validationOperator": "==",
      "description": "Security Reader role provides read-only access to security information and audit logs across Microsoft 365 services, separating audit review from administrative functions. Users with this role can view security data but cannot make changes.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Go to Identity > Roles & admins > Roles & admins\n3. Search for 'Security Reader' role\n4. Click the role and select 'Add assignments'\n5. Select users who should have audit/review responsibilities (separate from those with Security Administrator role)\n6. Complete assignment\n\nNote: Ensure users assigned Security Reader are NOT also assigned Security Administrator to maintain separation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference#security-reader"
    },
    {
      "settingName": "maximumPrivilegedRoleAssignments",
      "displayName": "Maximum Subscription Owners Limit",
      "settingPath": "subscription.roleAssignments.ownerCount",
      "policyType": "AzureAD",
      "policySubType": "BestPractice",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 3,
      "validationOperator": "<=",
      "description": "Limit the number of subscription owners to a maximum of 3 to reduce the potential for breach by a compromised owner and enforce separation of administrative duties.",
      "implementationGuide": "1. Sign in to Azure Portal\n2. Navigate to Subscriptions\n3. Select your subscription\n4. Click Access control (IAM)\n5. Review 'Owner' role assignments on Role assignments tab\n6. If more than 3 owners exist, remove unnecessary owner assignments\n7. Use more restrictive roles (Contributor, Reader, or custom roles) for other users\n\nMonitoring: Enable Microsoft Defender for Cloud to monitor this recommendation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/role-based-access-control/best-practices#limit-privileged-administrator-role-assignments"
    },
    {
      "settingName": "isEnabled",
      "displayName": "Enable Privileged Identity Management (PIM)",
      "settingPath": "identityGovernance.privilegedIdentityManagement.isEnabled",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "PIM enables just-in-time privileged access, requiring users to activate roles when needed rather than having permanent privileged access. This supports separation of duties by ensuring privileged access is time-limited and auditable.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Go to Identity Governance > Privileged Identity Management\n3. If not already enabled, click 'Consent to PIM' and provide admin consent\n4. Navigate to Microsoft Entra roles\n5. Configure role settings for privileged roles\n6. Convert permanent role assignments to eligible assignments\n\nRequirements: Azure AD Premium P2 or Microsoft Entra ID Governance licenses",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-getting-started"
    },
    {
      "settingName": "requireMfaOnActivation",
      "displayName": "Require MFA for Role Activation",
      "settingPath": "policies.roleManagementPolicies.rules[?(@.ruleType=='RoleManagementPolicyEnablementRule')].enabledRules",
      "policyType": "AzureAD",
      "policySubType": "PIMRoleSettings",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"MultiFactorAuthentication\"]",
      "validationOperator": "contains",
      "description": "Require multi-factor authentication when users activate eligible privileged roles. This adds an additional layer of verification before granting privileged access.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Go to Identity Governance > Privileged Identity Management > Microsoft Entra roles\n3. Click 'Roles' and select a privileged role (e.g., Global Administrator, Security Administrator)\n4. Click 'Role settings' > 'Edit'\n5. Under 'Activation', check 'Require multi-factor authentication on activation'\n6. Click 'Update'\n7. Repeat for all privileged roles\n\nAPI Method: Update unifiedRoleManagementPolicy rules",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "maximumActivationDuration",
      "displayName": "Maximum Role Activation Duration",
      "settingPath": "policies.roleManagementPolicies.rules[?(@.ruleType=='RoleManagementPolicyExpirationRule')].maximumDuration",
      "policyType": "AzureAD",
      "policySubType": "PIMRoleSettings",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "PT8H",
      "validationOperator": "<=",
      "description": "Set maximum duration for role activation to 8 hours or less. This ensures privileged access is time-limited and users must reactivate roles for extended work.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Go to Identity Governance > Privileged Identity Management > Microsoft Entra roles\n3. Click 'Roles' and select a privileged role\n4. Click 'Role settings' > 'Edit'\n5. Under 'Activation', set 'Activation maximum duration (hours)' to 8 or less\n6. Click 'Update'\n7. Repeat for all privileged roles\n\nFormat: ISO 8601 duration (PT8H = 8 hours)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "requireApprovalToActivate",
      "displayName": "Require Approval for Role Activation",
      "settingPath": "policies.roleManagementPolicies.rules[?(@.ruleType=='RoleManagementPolicyApprovalRule')].setting.isApprovalRequired",
      "policyType": "AzureAD",
      "policySubType": "PIMRoleSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require approval from designated approvers before users can activate highly privileged roles. This enforces separation by ensuring privileged access requires oversight.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Go to Identity Governance > Privileged Identity Management > Microsoft Entra roles\n3. Click 'Roles' and select a high-privilege role (e.g., Global Administrator)\n4. Click 'Role settings' > 'Edit'\n5. Under 'Activation', check 'Require approval to activate'\n6. Add approvers (should be separate individuals from potential activators)\n7. Click 'Update'\n\nBest Practice: Require approval for Global Administrator, Privileged Role Administrator, and Security Administrator roles",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "displayName",
      "displayName": "Administrative Units for Scoped Administration",
      "settingPath": "directory.administrativeUnits.displayName",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnit",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "configured",
      "validationOperator": "exists",
      "description": "Administrative Units (AUs) provide containers for users, groups, and devices that enable scoped administration. Admins assigned to an AU can only manage resources within that unit, enforcing separation between different organizational divisions.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Go to Identity > Roles & admins > Administrative units\n3. Click '+ Add' to create a new administrative unit\n4. Provide a name and description (e.g., 'Finance Department', 'Engineering Team')\n5. Add members (users, groups, or devices) to the AU\n6. Assign scoped administrative roles to specific users for this AU only\n7. Verify that AU admins cannot see or manage resources outside their assigned unit\n\nRequirement: Azure AD Premium P1 or P2 licenses for AU administrators",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/administrative-units"
    },
    {
      "settingName": "scopedRoleAssignments",
      "displayName": "Scoped Role Assignments to Administrative Units",
      "settingPath": "directory.administrativeUnits.scopedRoleMembers",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnit",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "configured",
      "validationOperator": "exists",
      "description": "Assign administrative roles scoped to specific Administrative Units. Scoped admins can only perform their assigned role functions within the AU, not tenant-wide.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Go to Identity > Roles & admins > Administrative units\n3. Select an administrative unit\n4. Click 'Roles and administrators'\n5. Select a role (e.g., User Administrator, Groups Administrator)\n6. Click '+ Add assignments'\n7. Select the user or group to assign the scoped role\n8. Complete assignment\n\nSupported Roles: User Administrator, Groups Administrator, Helpdesk Administrator, License Administrator, Password Administrator, and others",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-assign-roles"
    },
    {
      "settingName": "maxCustomRoleAssignmentsAtNonTenantScope",
      "displayName": "Maximum Custom Role Assignments at Non-Tenant Scope",
      "settingPath": "organization.limits.maxCustomRoleAssignmentsPerPrincipalAtNonTenantScope",
      "policyType": "AzureAD",
      "policySubType": "ServiceLimit",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 100,
      "validationOperator": "<=",
      "description": "Azure AD enforces a limit of 100 custom role assignments per principal at non-tenant scopes (e.g., administrative units, resource groups). This limit supports separation of duties by preventing excessive privilege accumulation.",
      "implementationGuide": "This is an enforced service limit, not a configurable setting.\n\nMonitoring:\n1. Sign in to Microsoft Entra admin center\n2. Go to Identity > Roles & admins > Roles & admins\n3. For each custom role, review assignments\n4. Use Azure Resource Graph to query role assignments per principal\n5. Ensure no single principal approaches the 100 assignment limit\n\nRemediation: If approaching limit, consolidate roles or use group-based assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/users/directory-service-limits-restrictions"
    },
    {
      "settingName": "maxBuiltInRoleAssignmentsAtNonTenantScope",
      "displayName": "Maximum Built-in Role Assignments at Non-Tenant Scope",
      "settingPath": "organization.limits.maxBuiltInRoleAssignmentsPerPrincipalAtNonTenantScope",
      "policyType": "AzureAD",
      "policySubType": "ServiceLimit",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 100,
      "validationOperator": "<=",
      "description": "Azure AD enforces a limit of 100 built-in role assignments per principal at non-tenant scopes (administrative units, Azure AD objects). This prevents privilege accumulation and supports separation of duties.",
      "implementationGuide": "This is an enforced service limit, not a configurable setting.\n\nMonitoring:\n1. Sign in to Microsoft Entra admin center\n2. Go to Identity > Roles & admins\n3. Review role assignments per user\n4. Use Microsoft Graph to query assignments per principal\n5. Alert if any principal has >50 role assignments (50% of limit)\n\nBest Practice: Use group-based role assignments and custom roles with precise permissions instead of multiple built-in roles",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/users/directory-service-limits-restrictions"
    },
    {
      "settingName": "isCustomRoleEnabled",
      "displayName": "Custom Role Creation for Precise Duty Separation",
      "settingPath": "roleManagement.directory.roleDefinitions",
      "policyType": "AzureAD",
      "policySubType": "CustomRole",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Create custom roles with specific permissions tailored to job functions. Custom roles enable precise separation of duties by granting only necessary permissions instead of broad built-in roles.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Go to Identity > Roles & admins > Roles & admins\n3. Click '+ New custom role'\n4. Provide a name and description (e.g., 'Access Control Auditor', 'Security Policy Manager')\n5. Select specific permissions aligned to job duties\n6. Avoid combining access control administration with audit permissions\n7. Click 'Create'\n8. Assign custom role to appropriate users or groups\n\nExample: Create separate custom roles for:\n- Security policy configuration (no audit access)\n- Security audit and review (no configuration access)\n- User access provisioning (no security policy access)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/custom-create"
    },
    {
      "settingName": "roleDefinitionName",
      "displayName": "Intune RBAC - Separate Device Management Roles",
      "settingPath": "deviceManagement.roleDefinitions.displayName",
      "policyType": "Intune",
      "policySubType": "RoleDefinition",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "configured",
      "validationOperator": "exists",
      "description": "Intune provides built-in and custom roles for device management. Use separate roles for different management functions (e.g., policy creation vs. device troubleshooting) to enforce separation of duties.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (endpoint.microsoft.com)\n2. Go to Tenant administration > Roles > All roles\n3. Review built-in roles:\n   - Intune Administrator: Full device management\n   - Help Desk Operator: Read-only + device actions (no policy changes)\n   - Read Only Operator: View-only access\n   - Policy and Profile Manager: Manage policies/profiles only\n4. Create custom roles for specific functions if needed\n5. Assign roles to appropriate personnel based on job duties\n6. Use scopes to limit role assignments to specific device groups\n\nSeparation Example:\n- Assign Help Desk Operator for support staff (troubleshooting only)\n- Assign Policy Manager for security team (policy configuration only)\n- Assign Read Only Operator for auditors (reporting only)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/fundamentals/role-based-access-control"
    },
    {
      "settingName": "scopeAssignments",
      "displayName": "Intune Role Scope Tags",
      "settingPath": "deviceManagement.roleAssignments.scopeTags",
      "policyType": "Intune",
      "policySubType": "RoleAssignment",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "configured",
      "validationOperator": "exists",
      "description": "Scope tags in Intune limit the devices, apps, and policies that admins can see and manage. Use scope tags to enforce separation by organizational unit, geography, or function.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Go to Tenant administration > Roles > Scope tags\n3. Click '+ Create' to create scope tags (e.g., 'Finance', 'Engineering', 'HR')\n4. Apply scope tags to devices, apps, and policies\n5. When assigning roles, specify which scope tags the role assignment includes\n6. Verify that admins can only see/manage resources with their assigned scope tags\n\nExample:\n- Finance Admin: Scope tag 'Finance' - can only manage Finance department devices\n- Engineering Admin: Scope tag 'Engineering' - can only manage Engineering devices\n- Both admins cannot see or manage each other's resources",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/fundamentals/scope-tags"
    },
    {
      "settingName": "roleGroupMembership",
      "displayName": "Microsoft Purview Compliance Role Groups",
      "settingPath": "purview.roleGroups.members",
      "policyType": "Purview",
      "policySubType": "ComplianceRoleGroup",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "configured",
      "validationOperator": "exists",
      "description": "Microsoft Purview uses role groups to assign permissions for compliance functions. Separate role groups exist for different compliance activities (DLP management, eDiscovery, audit review, etc.) to enforce separation of duties.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal (compliance.microsoft.com)\n2. Go to Permissions > Microsoft Purview solutions > Roles\n3. Review built-in role groups:\n   - Compliance Administrator: Manage compliance settings\n   - Compliance Data Administrator: Manage compliance data\n   - eDiscovery Manager: Conduct eDiscovery searches\n   - Organization Management: Full compliance admin\n   - Security Administrator: Manage security features\n   - Security Reader: View security information\n4. Click a role group and add members based on their duties\n5. Ensure personnel are assigned only to role groups aligned with their responsibilities\n6. Avoid assigning users to both administrative and audit-only roles\n\nSeparation Example:\n- Assign DLP Policy Manager role for policy creation\n- Assign Compliance Data Administrator for data review\n- Assign Security Reader for audit and reporting\n- Do not assign the same user to multiple conflicting roles",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/microsoft-365-compliance-center-permissions"
    },
    {
      "settingName": "roleGroupMembership",
      "displayName": "Exchange Online RBAC Role Groups",
      "settingPath": "exchangeOnline.roleGroups.members",
      "policyType": "Exchange",
      "policySubType": "RoleGroup",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "configured",
      "validationOperator": "exists",
      "description": "Exchange Online uses RBAC to separate administrative duties. Built-in role groups provide specific permissions for different Exchange management functions.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell:\n   Connect-ExchangeOnline\n2. Review role groups:\n   Get-RoleGroup | Select Name, Description\n3. Key role groups for separation:\n   - Organization Management: Full Exchange admin\n   - Recipient Management: Manage mailboxes, groups (no org-wide settings)\n   - View-Only Organization Management: Read-only audit access\n   - Help Desk: Limited support functions\n   - Security Administrator: Security features only\n   - Compliance Management: Compliance and audit functions\n4. Add members to appropriate role groups:\n   Add-RoleGroupMember -Identity \"Role Group Name\" -Member user@domain.com\n5. Verify separation between admin and audit functions\n\nBest Practice: Assign View-Only Organization Management for auditors separate from Organization Management for administrators",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/exchange/permissions-exo/permissions-exo"
    },
    {
      "settingName": "globalAdministratorRoleLimit",
      "displayName": "Global Administrator Role Assignment Limit",
      "settingPath": "roleManagement.directory.roleAssignments",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Limit the number of users assigned to the Global Administrator role to 5 or fewer to restrict privileged account proliferation",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Roles and administrators\n2. Select 'Global Administrator' role\n3. Review assignments and remove unnecessary accounts\n4. Maintain 5 Global Administrator accounts\n5. Document all Global Administrator accounts and business justification",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/best-practices"
    },
    {
      "settingName": "emergencyAccessAccounts",
      "displayName": "Emergency Access (Break-Glass) Accounts",
      "settingPath": "users",
      "policyType": "AzureAD",
      "policySubType": "UserManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 2,
      "validationOperator": "==",
      "description": "Maintain exactly 2 cloud-only emergency access accounts permanently assigned Global Administrator role for emergency scenarios",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Users\n2. Create 2 cloud-only accounts (e.g., breakglass1@, breakglass2@)\n3. Assign Global Administrator role permanently\n4. Exclude from Conditional Access policies\n5. Use complex passwords stored in secure physical vault\n6. Configure alerts for any usage\n7. Test quarterly to verify functionality",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-emergency-access"
    },
    {
      "settingName": "dedicatedAdminAccountsRequired",
      "displayName": "Separate Dedicated Admin Accounts",
      "settingPath": "organizationalPolicy",
      "policyType": "AzureAD",
      "policySubType": "GovernancePolicy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require administrators to use dedicated cloud-only admin accounts separate from their standard user accounts for all administrative tasks",
      "implementationGuide": "1. Create dedicated admin account for each admin user (e.g., john.admin@)\n2. Ensure admin accounts are cloud-only (not synced from on-premises)\n3. Do NOT assign service licenses (Exchange, Teams) to admin accounts\n4. Configure separate Conditional Access policies for admin accounts\n5. Enforce through governance policy and periodic reviews\n6. Example naming convention: firstname.admin@domain.com or firstname-admin@domain.com",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/enterprise/protect-your-global-administrator-accounts"
    },
    {
      "settingName": "adminAccountNoServiceLicenses",
      "displayName": "No Service Licenses on Admin Accounts",
      "settingPath": "users.assignedLicenses",
      "policyType": "AzureAD",
      "policySubType": "LicenseManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Prevent admin accounts from having service-based licenses (Exchange Online, Teams, SharePoint) to eliminate mailbox and collaboration capabilities on privileged accounts",
      "implementationGuide": "1. Navigate to Microsoft 365 admin center > Active users\n2. Select admin account\n3. Review assigned licenses\n4. Remove service licenses (Exchange Online Plan, Microsoft Teams, SharePoint Online)\n5. Retain only admin licenses if needed (Azure AD Premium P2)\n6. Configure Conditional Access to block Exchange/Teams access for admin accounts",
      "microsoftDocUrl": "https://blog.admindroid.com/how-to-safeguard-microsoft-365-admin-accounts/"
    },
    {
      "settingName": "pimEnabledForAllPrivilegedRoles",
      "displayName": "PIM Enabled for All Privileged Roles",
      "settingPath": "privilegedIdentityManagement.settings.roleSettings",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable Privileged Identity Management (PIM) for all privileged Azure AD roles to provide just-in-time privileged access and eliminate standing admin permissions",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Privileged Identity Management\n2. Select Azure AD roles\n3. For each privileged role (Global Admin, Privileged Role Admin, Security Admin, etc.):\n   - Remove permanent active assignments\n   - Add eligible assignments instead\n4. Configure role settings for activation requirements\n5. Requires Azure AD Premium P2 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure"
    },
    {
      "settingName": "pimActivationRequiresMFA",
      "displayName": "PIM Activation Requires MFA",
      "settingPath": "privilegedIdentityManagement.roleSettings.activationRules.mfaRequired",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require multi-factor authentication when activating any privileged role through PIM to ensure secure access to privileged accounts",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Privileged Identity Management > Azure AD roles\n2. Select Settings\n3. For each privileged role, select Edit\n4. Under Activation, enable 'Require Microsoft Entra ID multifactor authentication on activation'\n5. Save role settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "pimActivationRequiresJustification",
      "displayName": "PIM Activation Requires Business Justification",
      "settingPath": "privilegedIdentityManagement.roleSettings.activationRules.justificationRequired",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require business justification when activating privileged roles to document the purpose of privileged access and support auditing",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Privileged Identity Management > Azure AD roles\n2. Select Settings\n3. For each role, select Edit\n4. Under Activation, enable 'Require justification on activation'\n5. Save role settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "pimMaxActivationDuration",
      "displayName": "PIM Maximum Activation Duration",
      "settingPath": "privilegedIdentityManagement.roleSettings.activationRules.maximumActivationDuration",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 8,
      "validationOperator": "<=",
      "description": "Limit the maximum duration for privileged role activation to 8 hours or less to minimize exposure window of privileged access",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Privileged Identity Management > Azure AD roles\n2. Select Settings\n3. For each role, select Edit\n4. Under Activation, set 'Maximum activation duration (hours)' to 8 or less\n5. Consider shorter durations (4-6 hours) for highly privileged roles\n6. Save role settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "pimApprovalRequiredHighPrivilegedRoles",
      "displayName": "PIM Approval Required for Highly Privileged Roles",
      "settingPath": "privilegedIdentityManagement.roleSettings.activationRules.approvalRequired",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require approval to activate highly privileged roles (Global Administrator, Privileged Role Administrator) to provide additional oversight for most sensitive privileged accounts",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Privileged Identity Management > Azure AD roles\n2. Select Settings\n3. For Global Administrator and Privileged Role Administrator roles, select Edit\n4. Under Activation, enable 'Require approval to activate'\n5. Select approvers (senior IT management, security team)\n6. Configure approval notification settings\n7. Save role settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-resource-roles-approval-workflow"
    },
    {
      "settingName": "pimEligibleAssignmentsPreferred",
      "displayName": "Prefer Eligible Over Permanent Role Assignments",
      "settingPath": "privilegedIdentityManagement.roleAssignments.assignmentType",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Eligible",
      "validationOperator": "==",
      "description": "Prefer eligible role assignments over permanent active assignments to eliminate standing privileged access (zero standing privileges)",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Privileged Identity Management > Azure AD roles\n2. Select Assignments\n3. Review all active (permanent) assignments\n4. For each permanent assignment (except emergency access accounts):\n   - Remove active assignment\n   - Add eligible assignment\n5. Monitor PIM audit logs for activation patterns\n6. Exception: Break-glass accounts maintain permanent Global Admin",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-add-role-to-user"
    },
    {
      "settingName": "conditionalAccessAdminAccountsMFA",
      "displayName": "Conditional Access - Require MFA for Admin Accounts",
      "settingPath": "conditionalAccess.policies",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"conditions\":{\"users\":{\"include\":{\"groups\":[\"All_Admin_Accounts\"]}},\"applications\":{\"include\":[\"All\"]}},\"grantControls\":{\"operator\":\"AND\",\"builtInControls\":[\"mfa\"]}}",
      "validationOperator": "contains",
      "description": "Require multi-factor authentication for all administrative accounts when accessing any cloud application",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Conditional Access\n2. Create new policy 'CA-Admins-Require-MFA'\n3. Under Users: Include group containing all admin accounts\n4. Under Users: Exclude emergency access accounts\n5. Under Cloud apps: Select 'All cloud apps'\n6. Under Grant: Select 'Require multifactor authentication'\n7. Enable policy\n8. Test with non-critical admin account before full deployment",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-admin-mfa"
    },
    {
      "settingName": "auditLogPrivilegedAccountActivities",
      "displayName": "Audit Logging Enabled for Privileged Account Activities",
      "settingPath": "compliance.auditLog.unifiedAuditLogIngestionEnabled",
      "policyType": "Purview",
      "policySubType": "AuditLogging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable unified audit logging to capture all privileged account activities including PIM activations, role assignments, and administrative actions",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal\n2. Go to Audit > Search\n3. If not enabled, select 'Start recording user and admin activity'\n4. Verify with PowerShell: Get-AdminAuditLogConfig | FL UnifiedAuditLogIngestionEnabled\n5. Should return True\n6. Audit logs retained for 180 days (default) or 365 days (E5 license)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-enable-disable"
    },
    {
      "settingName": "auditLogRetentionPrivilegedAccounts",
      "displayName": "Extended Audit Log Retention for Privileged Accounts",
      "settingPath": "compliance.auditLog.retentionPolicies",
      "policyType": "Purview",
      "policySubType": "AuditRetention",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 365,
      "validationOperator": ">=",
      "description": "Retain audit logs for privileged account activities for minimum 1 year (365 days) to support investigations and compliance",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal\n2. Go to Audit > Audit retention policies\n3. Create new retention policy\n4. Priority: Set high priority\n5. Record type: Select relevant admin activities (AzureActiveDirectoryAccountLogon, ExchangeAdmin, etc.)\n6. Users: Specify admin accounts group or individual admin UPNs\n7. Duration: Set to 365 days or 10 years (E5 Compliance add-on)\n8. Requires Microsoft 365 E5 or E5 Compliance add-on",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies"
    },
    {
      "settingName": "pimActivityAlerts",
      "displayName": "PIM Activity Alerts and Notifications",
      "settingPath": "privilegedIdentityManagement.alerts",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable PIM alerts and notifications to monitor privileged role activations, assignments, and suspicious activity",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Privileged Identity Management\n2. Select Alerts\n3. Enable the following alerts:\n   - Roles are being assigned outside of PIM\n   - Roles are being activated too frequently\n   - Administrators aren't using their privileged roles\n   - Too many global administrators\n4. Configure notification recipients (security team, IT management)\n5. Set severity levels and response procedures",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts"
    },
    {
      "settingName": "priorityAccountProtectionAdmins",
      "displayName": "Priority Account Protection for Admin Accounts",
      "settingPath": "security.defender.priorityAccounts",
      "policyType": "Defender",
      "policySubType": "ThreatProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Designate admin accounts as priority accounts in Microsoft Defender for Office 365 for enhanced threat protection and monitoring",
      "implementationGuide": "1. Navigate to Microsoft 365 Defender portal > Settings > Email & collaboration\n2. Select Priority accounts\n3. Add all admin accounts as priority accounts\n4. Tag as 'Executive' or 'Security' based on role\n5. Enhanced monitoring includes:\n   - Priority account tag in alerts\n   - Dedicated insights in threat analytics\n   - Enhanced detection for compromised accounts\n6. Requires Microsoft Defender for Office 365 Plan 2",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/priority-accounts-security-recommendations"
    },
    {
      "settingName": "adminAccountInventoryMaintained",
      "displayName": "Privileged Account Inventory and Documentation",
      "settingPath": "governance.privilegedAccountInventory",
      "policyType": "AzureAD",
      "policySubType": "Governance",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Maintain comprehensive inventory of all privileged accounts including assignment justifications, review dates, and responsible parties",
      "implementationGuide": "1. Create privileged account inventory spreadsheet or database\n2. Document for each privileged account:\n   - User name and UPN\n   - Assigned privileged roles\n   - Business justification for access\n   - Approval date and approver\n   - Last review date\n   - Next review date (quarterly recommended)\n   - Emergency access designation (if applicable)\n3. Review inventory quarterly\n4. Update documentation when roles change\n5. Store securely with restricted access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-planning"
    },
    {
      "settingName": "privilegedAccountAccessReviews",
      "displayName": "Quarterly Access Reviews for Privileged Accounts",
      "settingPath": "identityGovernance.accessReviews",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"recurrence\":{\"pattern\":{\"type\":\"absoluteMonthly\",\"interval\":3}},\"scope\":{\"principalScopes\":[{\"query\":\"/v1.0/directoryRoles/filter(displayName eq 'Global Administrator' or displayName eq 'Privileged Role Administrator' or displayName eq 'Security Administrator')\",\"queryType\":\"MicrosoftGraph\"}]},\"settings\":{\"autoApplyDecisionsEnabled\":true,\"defaultDecisionEnabled\":true,\"defaultDecision\":\"Deny\"}}",
      "validationOperator": "contains",
      "description": "Conduct quarterly access reviews of all privileged role assignments to validate continued need and remove unnecessary privileged access",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity Governance > Access reviews\n2. Create new access review\n3. Review name: 'Quarterly Privileged Role Review'\n4. Scope: Select privileged roles (Global Admin, Privileged Role Admin, Security Admin, etc.)\n5. Reviewers: Role-assignable group of senior IT management\n6. Recurrence: Quarterly (every 3 months)\n7. Duration: 3 days\n8. Settings:\n   - Auto-apply results: Yes\n   - If reviewers don't respond: Remove access\n   - Enable recommendations: Yes\n9. Requires Azure AD Premium P2 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/create-access-review"
    },
    {
      "settingName": "noOnPremisesSyncForAdminAccounts",
      "displayName": "Admin Accounts Are Cloud-Only (Not Synced from On-Premises)",
      "settingPath": "users.onPremisesSyncEnabled",
      "policyType": "AzureAD",
      "policySubType": "UserManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Ensure admin accounts are cloud-only and NOT synchronized from on-premises Active Directory to prevent lateral movement from on-prem compromise",
      "implementationGuide": "1. Identify all admin accounts in Azure AD\n2. Check onPremisesSyncEnabled property for each admin account\n3. For any synced admin accounts:\n   - Create new cloud-only admin account\n   - Remove directory roles from synced account\n   - Exclude synced account from Azure AD Connect sync (OU filtering)\n   - Assign roles to new cloud-only account\n4. Document exception handling for hybrid environments\n5. Maintain separate on-premises admin accounts for on-prem tasks",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/best-practices"
    },
    {
      "settingName": "adminAccountNamingConvention",
      "displayName": "Admin Account Naming Convention",
      "settingPath": "governance.namingPolicy",
      "policyType": "AzureAD",
      "policySubType": "Governance",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "firstname.admin@domain.com or firstname-admin@domain.com",
      "validationOperator": "matches",
      "description": "Enforce consistent naming convention for admin accounts to clearly identify privileged accounts (e.g., firstname.admin@ or firstname-admin@)",
      "implementationGuide": "1. Define admin account naming standard:\n   - Pattern: firstname.admin@domain.com OR\n   - Pattern: firstname-admin@domain.com\n   - Examples: john.admin@contoso.com, jane-admin@contoso.com\n2. Document naming convention in governance policy\n3. Apply naming convention for all new admin accounts\n4. Rename existing admin accounts during next access review\n5. Use naming convention to create dynamic groups for admin accounts\n6. Helps with:\n   - Quick identification of admin accounts\n   - Conditional Access policy targeting\n   - Audit log analysis",
      "microsoftDocUrl": "https://blog.admindroid.com/how-to-secure-admin-accounts-in-hybrid-environment/"
    },
    {
      "settingName": "conditionalAccessAdminSessionTimeout",
      "displayName": "Conditional Access - Shorter Session Timeout for Admin Accounts",
      "settingPath": "conditionalAccess.policies.sessionControls.signInFrequency",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"value\":4,\"type\":\"hours\",\"isEnabled\":true}",
      "validationOperator": "contains",
      "description": "Require admin accounts to re-authenticate every 4 hours to limit exposure window of active privileged sessions",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Conditional Access\n2. Create new policy 'CA-Admins-Session-Timeout'\n3. Under Users: Include group containing all admin accounts\n4. Under Cloud apps: Select 'All cloud apps'\n5. Under Session: Enable 'Sign-in frequency'\n6. Set frequency to 4 hours (or less)\n7. Enable policy\n8. Test with admin account to verify re-authentication prompt",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime"
    },
    {
      "settingName": "privilegedAccountMonitoringDashboard",
      "displayName": "Privileged Account Activity Monitoring Dashboard",
      "settingPath": "monitoring.insightsAndReporting",
      "policyType": "AzureAD",
      "policySubType": "Monitoring",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Implement monitoring dashboard to track privileged account sign-ins, role activations, and administrative activities",
      "implementationGuide": "1. Options for monitoring dashboards:\n   Option A - Azure Monitor Workbooks:\n   - Navigate to Microsoft Entra admin center > Monitoring > Workbooks\n   - Use built-in 'Sign-ins' workbook filtered for admin accounts\n   - Use 'PIM Activity' workbook for role activations\n   \n   Option B - Microsoft Sentinel:\n   - Deploy Sentinel connector for Azure AD\n   - Import PIM solution from content hub\n   - Configure workbook 'Privileged Identity Management'\n   - Create custom KQL queries for admin activity\n   \n   Option C - Third-party SIEM:\n   - Configure Azure AD logs export to SIEM\n   - Create dashboards for admin sign-ins, role changes, PIM activations\n\n2. Monitor metrics:\n   - Admin account sign-in frequency and locations\n   - Failed admin sign-in attempts\n   - PIM role activations by user and role\n   - Changes to privileged role assignments\n   - Admin account creation/deletion",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts"
    },
    {
      "settingName": "adminAccountFailedSignInAlerts",
      "displayName": "Alerts for Failed Admin Account Sign-In Attempts",
      "settingPath": "monitoring.alerts.failedSignIns",
      "policyType": "AzureAD",
      "policySubType": "Monitoring",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"threshold\":3,\"timeWindow\":\"15 minutes\",\"severity\":\"High\"}",
      "validationOperator": "contains",
      "description": "Generate high-severity alerts when admin accounts experience multiple failed sign-in attempts indicating potential compromise attempts",
      "implementationGuide": "1. Option A - Azure Monitor Alert Rules:\n   - Navigate to Azure portal > Monitor > Alerts\n   - Create new alert rule\n   - Scope: Azure AD Sign-in logs\n   - Condition: Failed sign-ins for admin accounts\n   - Threshold: 3 failures within 15 minutes\n   - Action group: Email/SMS to security team\n   \n   Option B - Microsoft Sentinel:\n   - Use built-in analytics rule 'Failed logon attempts'\n   - Configure to filter for admin accounts\n   - Set severity to High\n   - Configure incident creation\n   \n   Option C - Defender for Cloud Apps:\n   - Create activity policy\n   - Activity type: Failed log on\n   - User: Admin accounts group\n   - Alert: Security team\n\n2. Alert recipients: Security Operations team, IT management\n3. Response procedures: Account lockout investigation, credential reset if compromised",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/howto-manage-inactive-user-accounts"
    },
    {
      "settingName": "pimAuditReportGeneration",
      "displayName": "Monthly PIM Audit Report Generation",
      "settingPath": "privilegedIdentityManagement.reporting",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Generate and review monthly PIM audit reports showing all privileged role activations, assignments, and changes",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Privileged Identity Management\n2. Select Audit history\n3. Export last 30 days of PIM activity:\n   - Role activations (who, when, duration, justification)\n   - Role assignments (additions, removals, changes)\n   - Role setting changes\n   - Approvals and denials\n4. Review report for:\n   - Unusual activation patterns\n   - Activations without proper justification\n   - Long-duration activations\n   - Activations at unusual times/locations\n   - Dormant eligible assignments\n5. Present findings to IT leadership monthly\n6. Document corrective actions taken\n7. Automate report generation using PowerShell or Graph API",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-use-audit-log"
    },
    {
      "settingName": "identityProtectionRiskPoliciesAdmins",
      "displayName": "Identity Protection Risk Policies for Admin Accounts",
      "settingPath": "identityProtection.riskPolicies",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"userRiskPolicy\":{\"enabled\":true,\"userRiskLevels\":[\"high\"],\"accessControlAction\":\"blockAccess\"},\"signInRiskPolicy\":{\"enabled\":true,\"signInRiskLevels\":[\"medium\",\"high\"],\"accessControlAction\":\"requireMFA\"}}",
      "validationOperator": "contains",
      "description": "Enable Azure AD Identity Protection risk policies to automatically block or require additional authentication for risky admin account sign-ins",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity Protection\n2. Configure User risk policy:\n   - Users: Include admin accounts group\n   - User risk level: High\n   - Access: Block access\n   - Requires password change after admin review\n3. Configure Sign-in risk policy:\n   - Users: Include admin accounts group  \n   - Sign-in risk level: Medium and high\n   - Access: Require multi-factor authentication\n4. Enable policies\n5. Monitor risky sign-ins dashboard\n6. Requires Azure AD Premium P2 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-policies"
    },
    {
      "settingName": "UserAccountControl_BehaviorOfTheElevationPromptForAdministrators",
      "displayName": "UAC: Behavior of the elevation prompt for administrators in Admin Approval Mode",
      "settingPath": "./Device/Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_BehaviorOfTheElevationPromptForAdministrators",
      "policyType": "Intune",
      "policySubType": "Settings Catalog - Local Policies Security Options",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 2,
      "validationOperator": "==",
      "description": "Controls UAC elevation prompt behavior for administrators. Value 2 = Prompt for consent on the secure desktop. Prevents silent elevation and ensures admin must explicitly approve privileged operations.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://endpoint.microsoft.com)\n2. Navigate to Devices > Windows > Configuration profiles\n3. Click Create profile\n4. Platform: Windows 10 and later, Profile type: Settings catalog\n5. Click Add settings\n6. Search for 'Local Policies Security Options'\n7. Expand Local Policies Security Options\n8. Select 'User Account Control Behavior Of The Elevation Prompt For Administrators'\n9. Set value to 'Prompt for consent on the secure desktop' (value: 2)\n10. Assign to device groups\n11. Monitor deployment status",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/user-account-control/settings-and-configuration"
    },
    {
      "settingName": "UserAccountControl_BehaviorOfTheElevationPromptForStandardUsers",
      "displayName": "UAC: Behavior of the elevation prompt for standard users",
      "settingPath": "./Device/Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_BehaviorOfTheElevationPromptForStandardUsers",
      "policyType": "Intune",
      "policySubType": "Settings Catalog - Local Policies Security Options",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 0,
      "validationOperator": "==",
      "description": "Controls UAC elevation prompt behavior for standard users. Value 0 = Automatically deny elevation requests. Prevents non-privileged users from executing privileged functions.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Windows > Configuration profiles\n3. Create profile: Settings catalog\n4. Add settings > Local Policies Security Options\n5. Select 'User Account Control Behavior Of The Elevation Prompt For Standard Users'\n6. Set to 'Automatically deny elevation requests' (value: 0)\n7. Alternative: Value 1 = 'Prompt for credentials on the secure desktop' (requires admin credentials)\n8. Assign to All Devices group\n9. Monitor compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/user-account-control/settings-and-configuration"
    },
    {
      "settingName": "UserAccountControl_UseAdminApprovalMode",
      "displayName": "UAC: Admin Approval Mode for the Built-in Administrator account",
      "settingPath": "./Device/Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_UseAdminApprovalMode",
      "policyType": "Intune",
      "policySubType": "Settings Catalog - Local Policies Security Options",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 1,
      "validationOperator": "==",
      "description": "Enables Admin Approval Mode for built-in Administrator account. Value 1 = Enabled. Forces even the built-in admin to request elevation for privileged operations.",
      "implementationGuide": "1. Intune admin center > Devices > Configuration profiles\n2. Create Settings catalog profile\n3. Add settings: Local Policies Security Options\n4. Select 'User Account Control Use Admin Approval Mode'\n5. Toggle to Enabled (value: 1)\n6. Assign to devices with local admin accounts\n7. Note: Built-in admin must meet password complexity requirements",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/user-account-control/settings-and-configuration"
    },
    {
      "settingName": "UserAccountControl_SwitchToTheSecureDesktopWhenPromptingForElevation",
      "displayName": "UAC: Switch to the secure desktop when prompting for elevation",
      "settingPath": "./Device/Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_SwitchToTheSecureDesktopWhenPromptingForElevation",
      "policyType": "Intune",
      "policySubType": "Settings Catalog - Local Policies Security Options",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 1,
      "validationOperator": "==",
      "description": "Switches to secure desktop for elevation prompts. Value 1 = Enabled. Prevents UI spoofing attacks against UAC prompts.",
      "implementationGuide": "1. Intune admin center > Devices > Configuration profiles\n2. Settings catalog profile > Add settings\n3. Local Policies Security Options\n4. Select 'User Account Control Switch To The Secure Desktop When Prompting For Elevation'\n5. Toggle to Enabled (value: 1)\n6. Assign to All Devices\n7. Verify: UAC prompts should dim entire screen",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/user-account-control/settings-and-configuration"
    },
    {
      "settingName": "UserAccountControl_DetectApplicationInstallationsAndPromptForElevation",
      "displayName": "UAC: Detect application installations and prompt for elevation",
      "settingPath": "./Device/Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_DetectApplicationInstallationsAndPromptForElevation",
      "policyType": "Intune",
      "policySubType": "Settings Catalog - Local Policies Security Options",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 1,
      "validationOperator": "==",
      "description": "Detects installer packages requiring elevation. Value 1 = Enabled. Prompts for admin credentials when installation packages need elevated privileges.",
      "implementationGuide": "1. Intune admin center > Settings catalog\n2. Add Local Policies Security Options settings\n3. Select 'User Account Control Detect Application Installations And Prompt For Elevation'\n4. Toggle to Enabled (value: 1)\n5. Note: Can be Disabled if using delegated installation tech like Intune\n6. For standard deployment: Keep Enabled\n7. Assign to device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/user-account-control/settings-and-configuration"
    },
    {
      "settingName": "UserAccountControl_OnlyElevateExecutableFilesThatAreSignedAndValidated",
      "displayName": "UAC: Only elevate executables that are signed and validated",
      "settingPath": "./Device/Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_OnlyElevateExecutableFilesThatAreSignedAndValidated",
      "policyType": "Intune",
      "policySubType": "Settings Catalog - Local Policies Security Options",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 1,
      "validationOperator": "==",
      "description": "Enforces PKI certificate path validation before elevation. Value 1 = Enabled. Only signed executables can be elevated, preventing malicious code elevation.",
      "implementationGuide": "1. Intune admin center > Settings catalog\n2. Add Local Policies Security Options\n3. Select 'User Account Control Only Elevate Executable Files That Are Signed And Validated'\n4. Toggle to Enabled (value: 1)\n5. Ensure trusted publisher certificates deployed\n6. Test with internal unsigned tools before wide deployment\n7. May require code signing infrastructure\n8. Assign to high-security devices first",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/user-account-control/settings-and-configuration"
    },
    {
      "settingName": "UserAccountControl_VirtualizeFileAndRegistryWriteFailuresToPerUserLocations",
      "displayName": "UAC: Virtualize file and registry write failures to per-user locations",
      "settingPath": "./Device/Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/UserAccountControl_VirtualizeFileAndRegistryWriteFailuresToPerUserLocations",
      "policyType": "Intune",
      "policySubType": "Settings Catalog - Local Policies Security Options",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 1,
      "validationOperator": "==",
      "description": "Redirects write failures to protected locations into user-specific locations. Value 1 = Enabled. Prevents legacy apps from failing while still protecting system files.",
      "implementationGuide": "1. Intune admin center > Settings catalog\n2. Add Local Policies Security Options\n3. Select 'User Account Control Virtualize File And Registry Write Failures To Per User Locations'\n4. Toggle to Enabled (value: 1)\n5. Recommended: Keep enabled for legacy app compatibility\n6. Assign to All Devices",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/user-account-control/settings-and-configuration"
    },
    {
      "settingName": "EnableScriptBlockLogging",
      "displayName": "PowerShell: Turn on PowerShell Script Block Logging",
      "settingPath": "Computer Configuration\\Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on PowerShell Script Block Logging",
      "policyType": "Intune",
      "policySubType": "Administrative Templates",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables PowerShell script block logging. Logs all PowerShell code blocks as they execute, including deobfuscated code. Critical for logging privileged script execution.",
      "implementationGuide": "1. Intune admin center > Devices > Configuration profiles\n2. Create profile: Administrative Templates\n3. Navigate to: Computer Configuration > Windows Components > Windows PowerShell\n4. Enable 'Turn on PowerShell Script Block Logging'\n5. Optional: Enable 'Log script block invocation start/stop events' for detailed tracking\n6. Assign to All Devices\n7. Verify: Check Event Log Microsoft-Windows-PowerShell/Operational (Event ID 4104)\n8. Configure log retention/forwarding to SIEM",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows"
    },
    {
      "settingName": "EnableTranscripting",
      "displayName": "PowerShell: Turn on PowerShell Transcription",
      "settingPath": "Computer Configuration\\Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on PowerShell Transcription",
      "policyType": "Intune",
      "policySubType": "Administrative Templates",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables PowerShell transcription logging. Records PowerShell commands and output to text files. Complements script block logging.",
      "implementationGuide": "1. Intune admin center > Configuration profiles > Administrative Templates\n2. Navigate to: Computer Configuration > Windows Components > Windows PowerShell\n3. Enable 'Turn on PowerShell Transcription'\n4. Configure Output Directory (e.g., \\\\server\\share\\PSTranscripts)\n5. Enable 'Include invocation headers' for timestamps\n6. Assign to All Devices or Admin workstations\n7. Ensure output directory has proper ACLs (users can write, admins can read)\n8. Configure log rotation/archival\n9. Consider storage requirements",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows"
    },
    {
      "settingName": "EnableModuleLogging",
      "displayName": "PowerShell: Turn on Module Logging",
      "settingPath": "Computer Configuration\\Administrative Templates\\Windows Components\\Windows PowerShell\\Turn on Module Logging",
      "policyType": "Intune",
      "policySubType": "Administrative Templates",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables PowerShell module logging. Logs pipeline execution events for specified modules. Use * to log all modules.",
      "implementationGuide": "1. Intune admin center > Administrative Templates profile\n2. Navigate to: Computer Configuration > Windows Components > Windows PowerShell\n3. Enable 'Turn on Module Logging'\n4. Click Show for Module Names\n5. Enter * to log all modules OR specific modules (e.g., ActiveDirectory, Microsoft.PowerShell.Security)\n6. Assign to device groups\n7. Check Event Log: Microsoft-Windows-PowerShell/Operational\n8. Note: Can generate high volume if logging all modules",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows"
    },
    {
      "settingName": "ApplicationControlCodeIntegrityPolicy",
      "displayName": "App Control for Business: Code Integrity Policy",
      "settingPath": "Endpoint Security > App Control for Business > Base Policy XML",
      "policyType": "Intune",
      "policySubType": "Endpoint Security - App Control for Business",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "<PolicyXML>Base policy allowing Microsoft-signed + Managed Installer</PolicyXML>",
      "validationOperator": "exists",
      "description": "Deploys Windows Defender Application Control (WDAC) policy. Prevents execution of unapproved code. Enforces allow-list of applications that can execute.",
      "implementationGuide": "1. Create WDAC policy XML using PowerShell:\n   New-CIPolicy -FilePath BasePolicy.xml -Level Publisher -UserPEs\n2. Add Managed Installer rule to trust Intune:\n   Add-CIPolicyRule -FilePath BasePolicy.xml -ManagedInstaller\n3. Enable Intelligent Security Graph:\n   Set-RuleOption -FilePath BasePolicy.xml -Option 14 -Enabled\n4. Convert to binary: ConvertFrom-CIPolicy -XmlFilePath BasePolicy.xml -BinaryFilePath BasePolicy.bin\n5. Intune admin center > Endpoint security > App Control for Business\n6. Create policy > Upload BasePolicy.bin\n7. Start in Audit mode initially\n8. Assign to pilot group\n9. Monitor CodeIntegrity/Operational logs for 30 days\n10. Create supplemental policies for approved unsigned apps\n11. Switch to Enforcement mode\n12. Expand to all devices",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/endpoint-security-app-control-policy"
    },
    {
      "settingName": "ManagedInstallerEnabled",
      "displayName": "App Control: Enable Managed Installer (Intune)",
      "settingPath": "Endpoint Security > App Control for Business > Managed Installer",
      "policyType": "Intune",
      "policySubType": "Endpoint Security - App Control for Business",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Configures Intune Management Extension as managed installer. Auto-trusts applications deployed via Intune, reducing WDAC exceptions needed.",
      "implementationGuide": "1. Intune admin center > Endpoint security\n2. Navigate to App Control for Business\n3. Select Managed Installer tab\n4. Click Add\n5. Confirm addition of Intune Management Extension as managed installer\n6. Wait for policy sync (can take minutes)\n7. Verify: All Intune-deployed apps will be automatically trusted\n8. Note: Does NOT retroactively trust already-installed apps\n9. Recommend: Enable before deploying WDAC enforcement",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/endpoint-security-app-control-policy"
    },
    {
      "settingName": "EPMElevationSettingsPolicy",
      "displayName": "Endpoint Privilege Management: Elevation Settings Policy",
      "settingPath": "Endpoint Security > Endpoint Privilege Management > Elevation Settings",
      "policyType": "Intune",
      "policySubType": "Endpoint Security - EPM Elevation Settings",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"defaultElevationBehavior\":\"DenyAllRequests\",\"sendElevationDataForReporting\":true,\"reportingScope\":\"DiagnosticDataAndAllEndpointElevations\"}",
      "validationOperator": "==",
      "description": "Enables EPM on devices and sets default elevation behavior. Controls whether unmanaged files can be elevated and what data is reported to Intune.",
      "implementationGuide": "1. Intune admin center > Endpoint security > Endpoint Privilege Management\n2. Select Policies tab > Create Policy\n3. Platform: Windows, Profile: Windows elevation settings policy\n4. Configure settings:\n   - Default elevation response: Start with 'Require user confirmation', move to 'Deny all requests' after rules created\n   - Validation type: Business justification + Windows authentication (recommended)\n   - Send elevation data for reporting: Yes\n   - Reporting scope: 'Diagnostic data and all endpoint elevations' (initially for visibility)\n5. Assign to Windows devices or users\n6. Monitor EPM reports for 2-4 weeks before creating elevation rules\n7. After rules deployed, change default to 'Deny all requests'",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/epm-elevation-settings"
    },
    {
      "settingName": "EPMElevationRulesPolicy",
      "displayName": "Endpoint Privilege Management: Elevation Rules Policy",
      "settingPath": "Endpoint Security > Endpoint Privilege Management > Elevation Rules",
      "policyType": "Intune",
      "policySubType": "Endpoint Security - EPM Elevation Rules",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "Array of rule objects defining which files can be elevated and under what conditions",
      "validationOperator": "exists",
      "description": "Defines specific executables, MSI packages, or PowerShell scripts that can be elevated. Each rule specifies detection criteria (publisher, hash, path) and elevation type (automatic, user-confirmed, support-approved).",
      "implementationGuide": "1. Analyze EPM unmanaged elevation reports to identify common elevation needs\n2. Intune admin center > Endpoint security > EPM > Policies > Create Policy\n3. Platform: Windows, Profile: Windows elevation rules policy\n4. Add rules for each approved application:\n   - File name (e.g., setup.exe, install.msi, configure.ps1)\n   - Detection method: Publisher certificate (recommended) OR file hash OR file path\n   - Elevation type:\n     * Automatic: Well-known apps from trusted publishers\n     * User confirmed: Requires business justification\n     * Support approved: IT must approve each request\n   - Optional: Specify required file arguments\n   - Child process behavior: Require elevation (default) or Allow without elevation\n5. Assign to user/device groups\n6. Monitor elevation reports\n7. Refine rules based on usage patterns",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/epm-elevation-rules"
    },
    {
      "settingName": "UnifiedAuditLogIngestionEnabled",
      "displayName": "Microsoft 365: Enable Unified Audit Logging",
      "settingPath": "Exchange Online PowerShell: Set-AdminAuditLogConfig -UnifiedAuditLogIngestionEnabled",
      "policyType": "Purview",
      "policySubType": "Audit Configuration",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables unified audit logging across Microsoft 365 services. Logs all admin and user activities including privileged operations in Exchange, SharePoint, Teams, Azure AD, etc. Required for NIST compliance.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell:\n   Connect-ExchangeOnline\n2. Verify current status:\n   Get-AdminAuditLogConfig | FL UnifiedAuditLogIngestionEnabled\n3. If False, enable:\n   Set-AdminAuditLogConfig -UnifiedAuditLogIngestionEnabled $true\n4. Wait 24 hours for full activation\n5. Verify in Purview portal:\n   - Navigate to https://compliance.microsoft.com\n   - Go to Audit\n   - Should see \"Start recording user and admin activity\" or audit log search available\n6. Configure alert policies for suspicious admin activities\n7. Set up audit retention policies (E5 required for >180 days)\n8. Consider exporting to Log Analytics for long-term retention",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-enable-disable"
    },
    {
      "settingName": "AuditLogRetentionPolicy",
      "displayName": "Microsoft 365: Audit Log Retention Policy",
      "settingPath": "Security & Compliance PowerShell: New-UnifiedAuditRetentionPolicy",
      "policyType": "Purview",
      "policySubType": "Audit Retention Policy",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"retentionDuration\":\"OneYear\",\"recordTypes\":\"AzureActiveDirectory,ExchangeAdmin,SharePointAdmin\",\"priority\":1}",
      "validationOperator": "exists",
      "description": "Creates custom audit log retention policy. Default is 180 days; E5 allows up to 1 year (or 10 years with add-on). Required to meet compliance retention requirements.",
      "implementationGuide": "1. Connect to Security & Compliance PowerShell:\n   Connect-IPPSSession\n2. Verify licensing: Requires Microsoft 365 E5 or Purview Audit (Premium)\n3. Create retention policy:\n   New-UnifiedAuditRetentionPolicy -Name \"Admin Activities 1 Year\" -Description \"Retain admin audit logs for 1 year\" -RecordTypes AzureActiveDirectory,ExchangeAdmin,SharePointAdmin,SecurityComplianceCenter -RetentionDuration OneYear -Priority 1\n4. For 10-year retention (requires add-on):\n   -RetentionDuration TenYears\n5. Verify policy:\n   Get-UnifiedAuditRetentionPolicy\n6. Max 50 policies per organization\n7. Priority 1 = highest (lower number = higher priority)\n8. Consider separate policies for different admin types",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies"
    },
    {
      "settingName": "PIMRoleEligibleAssignment",
      "displayName": "Azure AD PIM: Eligible Role Assignment",
      "settingPath": "Azure AD > PIM > Microsoft Entra roles > Assign eligibility",
      "policyType": "AzureAD",
      "policySubType": "Privileged Identity Management",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"assignmentType\":\"Eligible\",\"requireMFAOnActivation\":true,\"requireJustification\":true,\"maxActivationDuration\":8}",
      "validationOperator": "==",
      "description": "Configures eligible (just-in-time) role assignments in PIM. Users must activate roles when needed, automatically logging all activations. Preferred over permanent active assignments.",
      "implementationGuide": "1. Azure Portal > Microsoft Entra ID > Identity Governance > Privileged Identity Management\n2. Select Microsoft Entra roles\n3. Select Roles > Choose privileged role (e.g., Global Administrator)\n4. Click Assignments > Add assignments\n5. Select members (users/groups)\n6. Assignment type: Eligible (NOT Active)\n7. Assignment starts: Now, Assignment ends: Permanent or time-bound\n8. Click Next\n9. Configure Role settings (if not already configured):\n   - Activation maximum duration: 8 hours (recommended)\n   - Require MFA on activation: Yes\n   - Require justification on activation: Yes\n   - Require approval: Yes (for high-privilege roles like Global Admin)\n10. Assign\n11. User activation process: PIM > My roles > Activate > Provide justification > MFA > Approved\n12. All activations logged in Azure AD audit logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-add-role-to-user"
    },
    {
      "settingName": "PIMAuditLog",
      "displayName": "Azure AD PIM: Audit Log Monitoring",
      "settingPath": "Azure AD > PIM > Microsoft Entra roles > Resource audit",
      "policyType": "AzureAD",
      "policySubType": "Privileged Identity Management Audit",
      "platform": "All",
      "dataType": "log",
      "expectedValue": "Audit logs enabled and exported to Log Analytics",
      "validationOperator": "exists",
      "description": "PIM automatically logs all role activations, assignments, and approvals to Azure AD audit logs. Logs should be exported to Log Analytics for retention beyond 30 days.",
      "implementationGuide": "1. PIM audit logs automatically enabled (no configuration needed)\n2. View audit logs:\n   - Azure Portal > PIM > Microsoft Entra roles > Resource audit\n   - OR Azure AD > Audit logs > Filter Service: \"PIM\"\n3. Audit data available for 30 days by default\n4. For longer retention, export to Log Analytics:\n   - Azure AD > Diagnostic settings\n   - Add diagnostic setting\n   - Select AuditLogs\n   - Send to Log Analytics workspace\n   - Choose retention period\n5. Query PIM activities in Log Analytics:\n   AuditLogs\n   | where ServicePrincipalName == \"PIM\"\n   | where OperationName contains \"Activate\" or OperationName contains \"Assign\"\n6. Create alerts for suspicious PIM activities\n7. Export for SIEM integration if needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-use-audit-log"
    },
    {
      "settingName": "PrivilegedAccessManagementEnabled",
      "displayName": "Microsoft 365 PAM: Enable Privileged Access Management",
      "settingPath": "Microsoft 365 Admin Center > Settings > Org Settings > Security & Privacy > Privileged access",
      "policyType": "Purview",
      "policySubType": "Privileged Access Management",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Privileged Access Management for Exchange Online and M365. Requires approval for executing privileged tasks like mailbox moves, role assignments, etc.",
      "implementationGuide": "1. Prerequisites:\n   - Microsoft 365 E5 or Office 365 E5 subscription\n   - Create mail-enabled security group for approvers\n2. Microsoft 365 Admin Center (https://admin.microsoft.com)\n3. Settings > Org Settings > Security & Privacy\n4. Find Privileged access section > Edit\n5. Toggle 'Require approvals for privileged tasks' to ON\n6. Select Default approver group (must be mail-enabled security group)\n7. Save\n8. Alternatively via PowerShell:\n   Connect-ExchangeOnline\n   Enable-ElevatedAccessControl -AdminAccount admin@domain.com -DelegatedApprovers approvers@domain.com\n9. Create approval policies for specific tasks:\n   New-ElevatedAccessApprovalPolicy -Task 'Exchange\\New-MoveRequest' -ApprovalType Manual -ApproverGroup 'approvers@domain.com'\n10. Test: Request privilege access to execute approved task",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/privileged-access-management-configuration"
    },
    {
      "settingName": "PAMApprovalPolicy",
      "displayName": "Microsoft 365 PAM: Approval Policy for High-Risk Tasks",
      "settingPath": "Exchange Online PowerShell: New-ElevatedAccessApprovalPolicy",
      "policyType": "Purview",
      "policySubType": "PAM Approval Policy",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"task\":\"Exchange\\\\New-MoveRequest\",\"approvalType\":\"Manual\",\"approverGroup\":\"mailbox-admins@contoso.com\"}",
      "validationOperator": "exists",
      "description": "Creates approval policy for specific privileged Exchange/M365 tasks. Requires manual approval before admin can execute the task. Max 30 policies per organization.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell:\n   Connect-ExchangeOnline\n2. Create approval policy:\n   New-ElevatedAccessApprovalPolicy -Task 'Exchange\\<CmdletName>' -ApprovalType Manual -ApproverGroup 'approvers@domain.com'\n3. Examples of high-risk tasks to protect:\n   - New-MoveRequest (mailbox moves)\n   - Remove-Mailbox (mailbox deletion)\n   - Add-RoleGroupMember (role assignments)\n   - Set-Mailbox (permission changes)\n   - New-InboxRule (inbox rules for execs)\n   - Search-Mailbox (mailbox searches)\n4. View policies:\n   Get-ElevatedAccessApprovalPolicy\n5. Users request access:\n   New-ElevatedAccessRequest -Task 'Exchange\\New-MoveRequest' -Reason 'Migrate CEO mailbox' -DurationHours 4\n6. Approvers receive email, can approve via:\n   - Microsoft 365 Admin Center\n   - PowerShell: Approve-ElevatedAccessRequest -RequestId <id>\n7. All requests/approvals logged in unified audit log",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/privileged-access-management-configuration"
    },
    {
      "settingName": "ConditionalAccessAdminMFA",
      "displayName": "Azure AD Conditional Access: Require MFA for Admin Roles",
      "settingPath": "Azure AD > Security > Conditional Access > New policy",
      "policyType": "AzureAD",
      "policySubType": "Conditional Access",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"users\":\"Directory roles - All admin roles\",\"grantControls\":\"Require multifactor authentication\"}",
      "validationOperator": "==",
      "description": "Requires MFA for all administrative role sign-ins. Enhances security for privileged function execution by ensuring strong authentication. Recommended for NIST compliance.",
      "implementationGuide": "1. Azure Portal > Microsoft Entra ID > Security > Conditional Access\n2. Create new policy > Name: 'Require MFA for Admin Roles'\n3. Assignments:\n   - Users: Select 'Directory roles'\n   - Select all admin roles (Global Admin, Security Admin, etc.)\n   - Exclude: Emergency access accounts (break-glass)\n4. Target resources: All cloud apps\n5. Conditions (optional but recommended):\n   - Sign-in risk: Medium and high\n   - Device platforms: All\n6. Grant: Require multifactor authentication\n7. Session: Sign-in frequency: 4 hours (vs 90 days for users)\n8. Enable policy: Report-only (test) > On (enforce)\n9. Verify: Admin sign-ins should require MFA\n10. Monitor: Sign-in logs for policy enforcement\n11. All MFA prompts logged in Azure AD sign-in logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-admin-mfa"
    },
    {
      "settingName": "AuditPrivilegeUse",
      "displayName": "Windows Audit: Audit Sensitive Privilege Use",
      "settingPath": "Advanced Audit Policy Configuration\\System Audit Policies\\Privilege Use",
      "policyType": "Intune",
      "policySubType": "Settings Catalog - Windows Audit Policy",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Success and Failure",
      "validationOperator": "==",
      "description": "Audits use of sensitive privileges. Logs Event ID 4673 (Sensitive privilege use) and 4674 (Operation attempted on privileged object). Critical for logging privileged operations.",
      "implementationGuide": "1. Intune admin center > Settings catalog profile\n2. Add settings > Search 'Audit Policy'\n3. Navigate to: System Audit Policies - Local Group Policy Object > Privilege Use\n4. Enable 'Audit Sensitive Privilege Use'\n5. Set to: Success and Failure\n6. Assign to All Devices\n7. Verify on device:\n   auditpol /get /subcategory:\"Sensitive Privilege Use\"\n   Should show: Success and Failure\n8. Check Event Viewer: Security log\n   - Event ID 4672: Special privileges assigned to new logon\n   - Event ID 4673: Sensitive privilege use\n   - Event ID 4674: Operation attempted on privileged object\n9. Forward to SIEM or Log Analytics\n10. Create alerts for suspicious privilege use patterns",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-sensitive-privilege-use"
    },
    {
      "settingName": "lockoutThreshold",
      "displayName": "Smart Lockout - Account Lockout Threshold",
      "settingPath": "authenticationMethodConfiguration.passwordProtection.lockoutThreshold",
      "policyType": "AzureAD",
      "policySubType": "PasswordProtection",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Number of failed sign-in attempts allowed before account lockout occurs in Azure AD",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Authentication methods > Password protection\n3. Set 'Lockout threshold' to 5 or fewer failed attempts\n4. Click Save\nNote: Requires Azure AD Premium P1 or higher for customization. Default is 10 for Azure Public, 3 for Azure US Government.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/howto-password-smart-lockout"
    },
    {
      "settingName": "lockoutDurationInSeconds",
      "displayName": "Smart Lockout - Account Lockout Duration",
      "settingPath": "authenticationMethodConfiguration.passwordProtection.lockoutDurationInSeconds",
      "policyType": "AzureAD",
      "policySubType": "PasswordProtection",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 60,
      "validationOperator": ">=",
      "description": "Duration in seconds for account lockout after threshold is exceeded. Lockout duration increases with repeated lockouts.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Authentication methods > Password protection\n3. Set 'Lockout duration in seconds' to 60-18000 (1 minute to 5 hours)\n4. Click Save\nDefault is 60 seconds (1 minute). Duration increases automatically after subsequent failed attempts.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/howto-password-smart-lockout"
    },
    {
      "settingName": "accountLockoutThreshold",
      "displayName": "Windows - Account Lockout Threshold (Local)",
      "settingPath": "settings.accountPolicies.accountLockout.threshold",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Number of failed logon attempts before local Windows account locks. Applies to local authentication on Windows devices.",
      "implementationGuide": "METHOD 1 - PowerShell Script:\n1. Navigate to Intune > Devices > Scripts and remediations > Platform scripts\n2. Add new script with:\n   Net Accounts /lockoutthreshold:5\n3. Assign to Windows device groups\n\nMETHOD 2 - Custom OMA-URI (Windows 11 24H2/Server 2025+):\n1. Create Settings Catalog policy\n2. Add Custom OMA-URI:\n   Name: DeviceLockAccountLockoutPolicy\n   OMA-URI: ./Device/Vendor/MSFT/Policy/Config/DeviceLock/AccountLockoutPolicy\n   Data type: String\n   Value: {\"LockoutThreshold\":5,\"LockoutDuration\":15,\"ResetCounter\":15}\n3. Assign to device groups\n\nVerification: Run 'Net Accounts' command on device",
      "microsoftDocUrl": "https://www.anoopcnair.com/best-way-to-set-lockout-policy-using-intune/"
    },
    {
      "settingName": "accountLockoutDuration",
      "displayName": "Windows - Account Lockout Duration (Local)",
      "settingPath": "settings.accountPolicies.accountLockout.duration",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 15,
      "validationOperator": ">=",
      "description": "Duration in minutes for local Windows account lockout. Range: 1-99,999 minutes.",
      "implementationGuide": "METHOD 1 - PowerShell Script:\n1. Navigate to Intune > Devices > Scripts and remediations > Platform scripts\n2. Add new script with:\n   Net Accounts /lockoutduration:15\n3. Assign to Windows device groups\n\nMETHOD 2 - Custom OMA-URI (Windows 11 24H2/Server 2025+):\nIncluded in AccountLockoutPolicy OMA-URI (see IN-WIN-LOCKOUT-001)",
      "microsoftDocUrl": "https://www.anoopcnair.com/windows-11-account-lockout-policy-intune-setup/"
    },
    {
      "settingName": "accountLockoutResetCounter",
      "displayName": "Windows - Reset Account Lockout Counter After",
      "settingPath": "settings.accountPolicies.accountLockout.resetCounter",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 15,
      "validationOperator": ">=",
      "description": "Minutes before failed logon counter resets to zero. Must be less than or equal to lockout duration. Range: 1-99,999 minutes.",
      "implementationGuide": "METHOD 1 - PowerShell Script:\n1. Navigate to Intune > Devices > Scripts and remediations > Platform scripts\n2. Add new script with:\n   Net Accounts /lockoutwindow:15\n3. Assign to Windows device groups\n\nMETHOD 2 - Custom OMA-URI (Windows 11 24H2/Server 2025+):\nIncluded in AccountLockoutPolicy OMA-URI (see IN-WIN-LOCKOUT-001)",
      "microsoftDocUrl": "https://www.anoopcnair.com/windows-11-account-lockout-policy-intune-setup/"
    },
    {
      "settingName": "allowAdministratorLockout",
      "displayName": "Windows - Allow Administrator Account Lockout",
      "settingPath": "deviceLock.allowAdministratorLockout",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Allows lockout policy to apply to built-in Administrator account (Windows 11 23H2+)",
      "implementationGuide": "1. Navigate to Intune > Devices > Configuration profiles\n2. Create Settings Catalog policy\n3. Search for 'Device Lock'\n4. Add setting: Allow administrator account lockout\n5. Configure Custom OMA-URI:\n   Name: Allow administrator account lockout\n   OMA-URI: ./Device/Vendor/MSFT/Policy/Config/DeviceLock/AllowAdministratorLockout\n   Data type: Integer\n   Value: 1\n6. Assign to Windows device groups",
      "microsoftDocUrl": "https://www.onevinn.com/blog/windows-11-local-account-lockout-policy"
    },
    {
      "settingName": "maxDevicePasswordFailedAttempts",
      "displayName": "Windows - Maximum Sign-In Failures Before Wiping Device",
      "settingPath": "deviceLock.maxDevicePasswordFailedAttempts",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 10,
      "validationOperator": "<=",
      "description": "Number of authentication failures before device enters BitLocker recovery (functional wipe). 0 disables wipe functionality.",
      "implementationGuide": "1. Navigate to Intune > Endpoint security > Security baselines\n2. Select 'Security Baseline for Windows 10 and later'\n3. Create profile > Device Lock section\n4. Configure 'Number of sign-in failures before wiping device' to 10 or fewer\n5. Assign to Windows device groups\n\nNote: Device reboots into BitLocker recovery wizard, effectively locking device until recovery key provided.",
      "microsoftDocUrl": "https://inthecloud247.com/automatically-wipe-a-windows-10-device-after-a-number-of-authentication-failures/"
    },
    {
      "settingName": "maxInactivityTimeDeviceLockWithPasscode",
      "displayName": "iOS/iPadOS - Number of Sign-In Failures Before Wiping Device",
      "settingPath": "restrictedApps.maxInactivityTimeDeviceLockWithPasscode",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "iOS",
      "dataType": "integer",
      "expectedValue": 10,
      "validationOperator": "<=",
      "description": "Number of failed sign-in attempts before iOS/iPadOS device is wiped. Range: 2-11. Recommended: 4-10.",
      "implementationGuide": "1. Navigate to Intune > Devices > Configuration profiles > Create profile\n2. Platform: iOS/iPadOS\n3. Profile type: Device restrictions\n4. Password section\n5. Configure 'Number of sign-in failures before wiping device' to 4-10\n6. Assign to iOS/iPadOS device groups\n\nNote: Not recommended to set to 2-3 (too sensitive). iOS has built-in delays for failed attempts.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-restrictions-ios"
    },
    {
      "settingName": "passwordFailureCountBeforeWipe",
      "displayName": "Android - Password Failure Count Before Device Wipe",
      "settingPath": "androidDeviceOwner.passwordFailureCountBeforeWipe",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Android",
      "dataType": "integer",
      "expectedValue": 10,
      "validationOperator": "<=",
      "description": "Number of wrong password attempts before device is wiped. Range: 4-11. Personal work profile: removes work profile. Corporate devices: wipes device.",
      "implementationGuide": "1. Navigate to Intune > Devices > Configuration profiles > Create profile\n2. Platform: Android Enterprise\n3. Profile type: Device restrictions\n4. Password section\n5. Configure 'Number of passwords required before user can reuse password' to 4-11\n6. Assign to Android device groups\n\nNote: Behavior differs by enrollment type:\n- Personal work profile: Work profile removed, personal data intact\n- Corporate devices: Full device wipe",
      "microsoftDocUrl": "https://www.anoopcnair.com/enforce-screen-lock-for-android-devices-intune/"
    },
    {
      "settingName": "signInRiskPolicy",
      "displayName": "Sign-In Risk Policy - Require MFA on Medium/High Risk",
      "settingPath": "identityProtection.riskPolicies.signInRisk",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"riskLevel\":[\"medium\",\"high\"],\"controls\":[\"mfa\"]}",
      "validationOperator": "==",
      "description": "Requires MFA when sign-in risk is medium or high. Risk detection includes unfamiliar sign-in properties, malicious IP addresses, atypical travel, etc.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Conditional Access\n3. Create new policy: 'Sign-In Risk - Require MFA'\n4. Under Conditions > Sign-in risk: Select Medium and High\n5. Under Access controls > Grant: Require multifactor authentication\n6. Enable policy\n7. Exclude emergency access accounts\n\nRequires: Azure AD Premium P2",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/authentication/tutorial-risk-based-sspr-mfa"
    },
    {
      "settingName": "userRiskPolicy",
      "displayName": "User Risk Policy - Require Password Change on High Risk",
      "settingPath": "identityProtection.riskPolicies.userRisk",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"riskLevel\":[\"high\"],\"controls\":[\"passwordChange\",\"mfa\"]}",
      "validationOperator": "==",
      "description": "Requires secure password reset when user risk is high. Detects leaked credentials, impossible travel, and compromised accounts.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Conditional Access\n3. Create new policy: 'User Risk - Require Password Change'\n4. Under Conditions > User risk: Select High\n5. Under Access controls > Grant: Require password change\n6. Require MFA before password change\n7. Enable policy\n8. Exclude emergency access accounts\n\nRequires: Azure AD Premium P2",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/authentication/tutorial-risk-based-sspr-mfa"
    },
    {
      "settingName": "riskySignInsReport",
      "displayName": "Risky Sign-Ins Monitoring Report",
      "settingPath": "identityProtection.reports.riskySignIns",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Monitors and reports sign-in attempts with detected risk. Includes failed attempts from malicious IPs, unfamiliar locations, and brute force attacks.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Identity Protection > Risky sign-ins\n3. Review sign-ins flagged as risky\n4. Configure alerts: Protection > Identity Protection > Notify\n5. Set up weekly digest emails\n6. Configure alerts for high-risk users\n\nAccess via Microsoft Graph:\nGET https://graph.microsoft.com/v1.0/identityProtection/riskySignIns\n\nRequires: Azure AD Premium P2 for full features",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-remediate-unblock"
    },
    {
      "settingName": "signInLogsEnabled",
      "displayName": "Azure AD Sign-In Logs - Enabled",
      "settingPath": "monitoring.signInLogs.enabled",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables logging of all sign-in attempts including failed authentications. Captures IP address, location, device, application, and failure reason.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Monitoring & health > Sign-in logs\n3. Verify sign-in logs are capturing data\n4. For extended retention: Navigate to Monitoring & health > Diagnostic settings\n5. Add diagnostic setting\n6. Select 'SignInLogs'\n7. Configure destination: Log Analytics workspace, Storage account, or Event Hub\n8. Save\n\nDefault retention: 30 days (Azure AD Premium), 7 days (Free)\nExtended retention requires Azure Monitor",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/concept-sign-ins"
    },
    {
      "settingName": "signInLogsRetention",
      "displayName": "Azure AD Sign-In Logs - Extended Retention",
      "settingPath": "monitoring.signInLogs.retentionDays",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 365,
      "validationOperator": ">=",
      "description": "Extends sign-in log retention beyond default 30 days for compliance and investigation. Requires Azure Monitor.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Monitoring & health > Diagnostic settings\n3. Add diagnostic setting\n4. Select 'SignInLogs'\n5. Configure destination: Log Analytics workspace with 365+ day retention\n   OR Storage account for archive\n6. Set retention period in destination:\n   - Log Analytics: Set retention to 365+ days\n   - Storage: Configure archive policy\n7. Save\n\nRequires: Azure subscription, Log Analytics workspace or Storage account",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs"
    },
    {
      "settingName": "conditionalAccessBlockLegacyAuth",
      "displayName": "Conditional Access - Block Legacy Authentication",
      "settingPath": "conditionalAccess.policies.blockLegacyAuth",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"clientApps\":[\"exchangeActiveSync\",\"other\"],\"grantControls\":\"block\"}",
      "validationOperator": "==",
      "description": "Blocks legacy authentication protocols that don't support modern security like MFA, preventing brute force attacks via legacy protocols.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Conditional Access\n3. Create new policy: 'Block Legacy Authentication'\n4. Users: All users (exclude emergency accounts)\n5. Cloud apps: All cloud apps\n6. Conditions > Client apps:\n   - Exchange ActiveSync clients\n   - Other clients (legacy protocols)\n7. Access controls: Block\n8. Enable policy\n\nNote: Test in report-only mode first. Requires Azure AD Premium P1",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/block-legacy-authentication"
    },
    {
      "settingName": "conditionalAccessBlockUnknownPlatforms",
      "displayName": "Conditional Access - Block Unknown Device Platforms",
      "settingPath": "conditionalAccess.policies.blockUnknownPlatforms",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"platforms\":[\"unknown\"],\"grantControls\":\"block\"}",
      "validationOperator": "==",
      "description": "Blocks authentication attempts from unknown or unmanaged device platforms, reducing attack surface for brute force attempts.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Conditional Access\n3. Create new policy: 'Block Unknown Platforms'\n4. Users: All users (exclude emergency accounts)\n5. Cloud apps: All cloud apps\n6. Conditions > Device platforms: Select 'Unknown'\n7. Access controls: Block\n8. Enable policy\n\nNote: Test thoroughly as this may impact legitimate users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-conditions#device-platforms"
    },
    {
      "settingName": "idProtectionAlerts",
      "displayName": "Identity Protection - High Risk User Alerts",
      "settingPath": "identityProtection.notifications.usersAtRisk",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"riskLevel\":\"high\",\"recipients\":[\"security-team@organization.com\"]}",
      "validationOperator": "==",
      "description": "Sends email alerts to administrators when users are flagged as high risk due to suspicious sign-in patterns including failed attempts.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Identity Protection > Notify\n3. Configure 'Users at risk detected alerts':\n   - Enable alerts\n   - Risk level: High\n   - Recipients: Add security team email addresses\n4. Save\n\nAlert triggers include:\n- Multiple failed sign-ins from malicious IPs\n- Leaked credentials\n- Impossible travel\n- Unfamiliar sign-in properties",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-configure-notifications"
    },
    {
      "settingName": "idProtectionWeeklyDigest",
      "displayName": "Identity Protection - Weekly Digest Email",
      "settingPath": "identityProtection.notifications.weeklyDigest",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"recipients\":[\"security-team@organization.com\"]}",
      "validationOperator": "==",
      "description": "Sends weekly summary of risky users and sign-ins including failed authentication patterns.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Identity Protection > Notify\n3. Configure 'Weekly digest':\n   - Enable weekly digest\n   - Recipients: Add security team email addresses\n4. Save\n\nDigest includes:\n- New risky users detected\n- Risky sign-ins summary\n- Users with resolved risks\n- Overall security posture",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-configure-notifications"
    },
    {
      "settingName": "failedSignInAlert",
      "displayName": "Azure Monitor - Failed Sign-In Alert Rule",
      "settingPath": "azureMonitor.alerts.failedSignIns",
      "policyType": "AzureAD",
      "policySubType": "AzureMonitor",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"threshold\":5,\"timeWindow\":\"5 minutes\",\"severity\":\"High\"}",
      "validationOperator": "==",
      "description": "Creates alert when user has 5+ failed sign-in attempts within 5-minute window, indicating potential brute force attack.",
      "implementationGuide": "1. Sign in to Azure portal\n2. Navigate to Monitor > Alerts > Alert rules\n3. Create alert rule\n4. Scope: Select Log Analytics workspace with Azure AD logs\n5. Condition: Custom log search\n   Query: SigninLogs | where ResultType != 0 | summarize FailedAttempts = count() by UserPrincipalName | where FailedAttempts >= 5\n6. Actions: Create action group to notify security team\n7. Alert rule details:\n   - Name: 'Multiple Failed Sign-Ins Detected'\n   - Severity: High\n   - Evaluation frequency: 5 minutes\n8. Create alert rule\n\nRequires: Log Analytics workspace, Azure Monitor Logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-log-alert-rule"
    },
    {
      "settingName": "defenderIdentityAlerts",
      "displayName": "Defender for Identity - Brute Force Attack Alerts",
      "settingPath": "defenderForIdentity.alerts.bruteForce",
      "policyType": "Defender",
      "policySubType": "DefenderForIdentity",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Detects and alerts on brute force authentication attacks including password spray and failed logon attempts.",
      "implementationGuide": "1. Defender for Identity must be deployed\n2. Sign in to Microsoft 365 Defender portal (https://security.microsoft.com)\n3. Navigate to Settings > Identities\n4. Verify sensors are deployed and healthy\n5. Navigate to Incidents & alerts > Alert policies\n6. Verify 'Brute force attack' alert is enabled\n7. Configure notification recipients\n\nDefender for Identity automatically detects:\n- Suspected brute force attacks (Kerberos, NTLM)\n- Password spray attacks\n- Unusual failed authentication patterns\n\nRequires: Microsoft Defender for Identity license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-for-identity/alerts-overview"
    },
    {
      "settingName": "signInActivityQuery",
      "displayName": "Microsoft Graph - Sign-In Activity Query",
      "settingPath": "graph.signIns",
      "policyType": "AzureAD",
      "policySubType": "MicrosoftGraph",
      "platform": "All",
      "dataType": "api",
      "expectedValue": "accessible",
      "validationOperator": "==",
      "description": "Microsoft Graph API endpoint for programmatically querying sign-in logs including failed attempts.",
      "implementationGuide": "API Endpoint: GET https://graph.microsoft.com/v1.0/auditLogs/signIns\n\nRequired Permissions:\n- AuditLog.Read.All (Application)\n- Directory.Read.All (Application)\n\nQuery for failed sign-ins:\nGET https://graph.microsoft.com/v1.0/auditLogs/signIns?$filter=status/errorCode ne 0\n\nQuery for specific user:\nGET https://graph.microsoft.com/v1.0/auditLogs/signIns?$filter=userPrincipalName eq 'user@domain.com' and status/errorCode ne 0\n\nQuery for time range:\nGET https://graph.microsoft.com/v1.0/auditLogs/signIns?$filter=createdDateTime ge 2024-11-01 and status/errorCode ne 0\n\nResponse includes:\n- UserPrincipalName\n- Status (error code)\n- IPAddress\n- Location\n- DeviceDetail\n- ConditionalAccessStatus",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/signin-list"
    },
    {
      "settingName": "searchUnifiedAuditLog",
      "displayName": "PowerShell - Search Unified Audit Log for Failed Sign-Ins",
      "settingPath": "powershell.exchangeOnline.searchUnifiedAuditLog",
      "policyType": "Purview",
      "policySubType": "PowerShell",
      "platform": "All",
      "dataType": "cmdlet",
      "expectedValue": "available",
      "validationOperator": "==",
      "description": "PowerShell cmdlet to search unified audit log for failed authentication attempts.",
      "implementationGuide": "Prerequisites:\n1. Connect to Exchange Online PowerShell:\n   Connect-ExchangeOnline\n\nSearch for failed sign-ins:\nSearch-UnifiedAuditLog -StartDate (Get-Date).AddDays(-7) -EndDate (Get-Date) -Operations UserLoginFailed -ResultSize 5000\n\nSearch for specific user:\nSearch-UnifiedAuditLog -StartDate (Get-Date).AddDays(-7) -EndDate (Get-Date) -UserIds user@domain.com -Operations UserLoginFailed\n\nExport results:\nSearch-UnifiedAuditLog -StartDate (Get-Date).AddDays(-30) -EndDate (Get-Date) -Operations UserLoginFailed -ResultSize 5000 | Export-Csv -Path 'C:\\FailedSignIns.csv' -NoTypeInformation\n\nNote: Maximum 5000 results per query. Use pagination for larger datasets.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/powershell/module/exchange/search-unifiedauditlog"
    },
    {
      "settingName": "getAzureADAuditSignInLogs",
      "displayName": "PowerShell - Get Azure AD Sign-In Logs",
      "settingPath": "powershell.azureAD.getAzureADAuditSignInLogs",
      "policyType": "AzureAD",
      "policySubType": "PowerShell",
      "platform": "All",
      "dataType": "cmdlet",
      "expectedValue": "available",
      "validationOperator": "==",
      "description": "PowerShell cmdlet to retrieve Azure AD sign-in audit logs including failed attempts.",
      "implementationGuide": "Prerequisites:\n1. Install Microsoft Graph PowerShell SDK:\n   Install-Module Microsoft.Graph -Scope CurrentUser\n2. Connect to Microsoft Graph:\n   Connect-MgGraph -Scopes 'AuditLog.Read.All', 'Directory.Read.All'\n\nGet failed sign-ins (last 7 days):\nGet-MgAuditLogSignIn -Filter \"status/errorCode ne 0 and createdDateTime ge $(Get-Date).AddDays(-7).ToString('yyyy-MM-ddTHH:mm:ssZ')\" -Top 100\n\nGet failed sign-ins for specific user:\nGet-MgAuditLogSignIn -Filter \"userPrincipalName eq 'user@domain.com' and status/errorCode ne 0\" -Top 100\n\nExport to CSV:\nGet-MgAuditLogSignIn -Filter \"status/errorCode ne 0\" -Top 1000 | Select-Object UserPrincipalName, CreatedDateTime, IPAddress, Status, Location | Export-Csv -Path 'FailedSignIns.csv' -NoTypeInformation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/powershell/module/microsoft.graph.reports/get-mgauditlogsignin"
    },
    {
      "settingName": "sentinelFailedSignInWorkbook",
      "displayName": "Microsoft Sentinel - Failed Sign-In Analysis Workbook",
      "settingPath": "sentinel.workbooks.failedSignIns",
      "policyType": "AzureAD",
      "policySubType": "Sentinel",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Sentinel workbook for visualizing and analyzing failed sign-in patterns, brute force attempts, and account lockouts.",
      "implementationGuide": "Prerequisites:\n1. Microsoft Sentinel workspace deployed\n2. Azure AD logs connected to Sentinel:\n   - Navigate to Sentinel > Data connectors\n   - Connect 'Azure Active Directory' connector\n   - Enable sign-in logs\n\nCreate workbook:\n1. Navigate to Microsoft Sentinel > Workbooks\n2. Add workbook\n3. Use template: 'Sign-in failure analysis'\n   OR create custom workbook with KQL queries:\n\nFailed sign-ins by user:\nSigninLogs\n| where ResultType != 0\n| summarize FailedAttempts = count() by UserPrincipalName\n| order by FailedAttempts desc\n\nFailed sign-ins by error code:\nSigninLogs\n| where ResultType != 0\n| summarize Count = count() by ResultType, ResultDescription\n| order by Count desc\n\nBrute force detection:\nSigninLogs\n| where ResultType != 0\n| summarize FailedAttempts = count() by UserPrincipalName, IPAddress, bin(TimeGenerated, 5m)\n| where FailedAttempts >= 5",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/sentinel/monitor-audit-sign-in-logs"
    },
    {
      "settingName": "deviceCompliancePasswordPolicy",
      "displayName": "Device Compliance - Password Policy with Lockout",
      "settingPath": "compliance.deviceCompliance.passwordPolicy",
      "policyType": "Intune",
      "policySubType": "CompliancePolicy",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"requirePassword\":true,\"minimumPasswordLength\":8,\"passwordComplexity\":\"required\",\"enforceAccountLockout\":true}",
      "validationOperator": "==",
      "description": "Device compliance policy requiring password with account lockout enforcement. Devices not meeting requirements are marked non-compliant.",
      "implementationGuide": "1. Navigate to Intune > Devices > Compliance policies\n2. Create policy for each platform (Windows, iOS, Android)\n3. Configure Password section:\n   - Require a password: Yes\n   - Minimum password length: 8+\n   - Password complexity: Required\n4. Combine with Conditional Access to block non-compliant devices\n5. Assign to device groups\n\nNote: Enforces that devices have lockout policies configured, but doesn't set specific threshold values (use device configuration for that).",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/device-compliance-get-started"
    },
    {
      "settingName": "entraSignInFailureWorkbook",
      "displayName": "Entra Workbook - Sign-In Failure Analysis",
      "settingPath": "entra.workbooks.signInFailureAnalysis",
      "policyType": "AzureAD",
      "policySubType": "EntraWorkbook",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Built-in Entra workbook for analyzing sign-in failures, identifying patterns, and diagnosing authentication issues.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Monitoring & health > Workbooks\n3. Select 'Sign-in failure analysis' template\n4. View available analytics:\n   - Failed sign-ins by user\n   - Failed sign-ins by error code\n   - Failed sign-ins by application\n   - Failed sign-ins by location\n   - Temporal analysis of failures\n5. Customize time range and filters\n6. Save workbook for recurring use\n\nCustom KQL queries available for:\n- Identifying brute force patterns\n- Analyzing locked accounts\n- Tracking repeat offenders\n- Geographic anomaly detection",
      "microsoftDocUrl": "https://blog.admindroid.com/audit-sign-in-failures-in-microsoft-365-with-workbook/"
    },
    {
      "settingName": "InteractiveLogonMessageText",
      "displayName": "Windows Interactive Logon - Message Text",
      "settingPath": "LocalPoliciesSecurityOptions.InteractiveLogon_MessageTextForUsersAttemptingToLogOn",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration_SettingsCatalog",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "String containing legal notice text (max 4096 characters recommended)",
      "validationOperator": "!=",
      "description": "Specifies text message displayed to users when they log on to Windows. Used for legal warnings, security notices, or acceptable use policy notifications before granting system access.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://endpoint.microsoft.com)\n2. Navigate to Devices > Windows > Configuration profiles\n3. Click Create profile > Platform: Windows 10 and later, Profile type: Settings catalog\n4. Name: 'Windows Interactive Logon Message'\n5. Click Add settings > Browse: Local Policies Security Options\n6. Select 'Interactive Logon Message Text For Users Attempting To Log On'\n7. Enter your legal notice text (recommend <2000 characters for compatibility)\n8. Assign to device groups\n9. Note: Will break Autopilot pre-provisioning if enabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/security-policy-settings/interactive-logon-message-text-for-users-attempting-to-log-on"
    },
    {
      "settingName": "InteractiveLogonMessageTitle",
      "displayName": "Windows Interactive Logon - Message Title",
      "settingPath": "LocalPoliciesSecurityOptions.InteractiveLogon_MessageTitleForUsersAttemptingToLogOn",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration_SettingsCatalog",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "String containing title for logon message dialog (e.g., 'SECURITY NOTICE', 'Important Legal Notice')",
      "validationOperator": "!=",
      "description": "Specifies title that appears in the window title bar containing the Interactive logon message text. Typically used to emphasize the legal or security nature of the notice.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://endpoint.microsoft.com)\n2. Navigate to Devices > Windows > Configuration profiles\n3. Use same profile created for message text (or create new)\n4. Click Add settings > Browse: Local Policies Security Options\n5. Select 'Interactive Logon Message Title For Users Attempting To Log On'\n6. Enter title text (e.g., 'SECURITY WARNING', 'Authorized Use Only')\n7. Configure together with message text setting\n8. User must click OK to acknowledge before login proceeds",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/security-policy-settings/interactive-logon-message-title-for-users-attempting-to-log-on"
    },
    {
      "settingName": "SignInPageText",
      "displayName": "Azure AD Sign-In Page Text",
      "settingPath": "organizationalBranding.signInPageText",
      "policyType": "AzureAD",
      "policySubType": "CompanyBranding",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Text containing security notice, acceptable use policy, or legal disclaimer (max 256 characters)",
      "validationOperator": "!=",
      "description": "Text that appears at the bottom of the Azure AD sign-in page. Can be used to communicate security notices, legal statements, or help desk contact information before cloud authentication.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center (https://entra.microsoft.com)\n2. Navigate to Microsoft Entra ID > Company branding\n3. Click Edit (or Create if no branding exists)\n4. Go to Sign-in form section\n5. In 'Sign-in page text' field, enter your notice (max 256 characters)\n6. Text appears below sign-in form on Azure AD login pages\n7. Applies to all Microsoft 365 authentication flows\n8. Requires Azure AD Premium P1 or P2 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/fundamentals/how-to-customize-branding"
    },
    {
      "settingName": "FooterPrivacyAndCookies",
      "displayName": "Azure AD Sign-In Page - Privacy & Cookies Link",
      "settingPath": "organizationalBranding.privacyAndCookiesUrl",
      "policyType": "AzureAD",
      "policySubType": "CompanyBranding",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "URL to organization's privacy policy (optional custom display text)",
      "validationOperator": "!=",
      "description": "Custom privacy and cookies link displayed in footer of Azure AD sign-in page. Can replace Microsoft's default link with organization-specific privacy policy.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center (https://entra.microsoft.com)\n2. Navigate to Microsoft Entra ID > Company branding\n3. Click Edit > Layout section > Enable 'Show footer'\n4. Under Footer section, configure 'Privacy & Cookies' settings:\n   - Display text: Custom text for link\n   - URL: Organization's privacy policy URL\n5. Appears in footer of sign-in page\n6. Note: Different from Conditional Access Terms of Use",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/fundamentals/how-to-customize-branding"
    },
    {
      "settingName": "FooterTermsOfUse",
      "displayName": "Azure AD Sign-In Page - Terms of Use Link",
      "settingPath": "organizationalBranding.termsOfUseUrl",
      "policyType": "AzureAD",
      "policySubType": "CompanyBranding",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "URL to organization's terms of use (optional custom display text)",
      "validationOperator": "!=",
      "description": "Custom terms of use link displayed in footer of Azure AD sign-in page. Note: This is NOT the same as Conditional Access Terms of Use (which requires acceptance).",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center (https://entra.microsoft.com)\n2. Navigate to Microsoft Entra ID > Company branding\n3. Click Edit > Layout section > Enable 'Show footer'\n4. Under Footer section, configure 'Terms of Use' settings:\n   - Display text: Custom text for link\n   - URL: Organization's terms of use URL\n5. Link appears in footer but does not require acceptance\n6. For enforced acceptance, use Conditional Access Terms of Use instead",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/fundamentals/how-to-customize-branding"
    },
    {
      "settingName": "ConditionalAccessTermsOfUse",
      "displayName": "Conditional Access - Terms of Use Policy",
      "settingPath": "agreement.file",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess_TermsOfUse",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "PDF document containing legal notices, acceptable use policy, security warnings (file uploaded to Azure AD)",
      "validationOperator": "exists",
      "description": "PDF document with organization's terms of use, legal notices, and security policies. Users must accept before accessing applications protected by Conditional Access policy.",
      "implementationGuide": "1. Create PDF document with legal/security notices (recommended: 24pt font for mobile compatibility)\n2. Sign in to Microsoft Entra admin center (https://entra.microsoft.com)\n3. Navigate to Protection > Conditional Access > Terms of use\n4. Click New terms\n5. Configure:\n   - Name: Internal name (e.g., 'CUI Security Notice')\n   - Display name: User-visible name\n   - Upload PDF document\n   - Require users to expand: Enable (forces review)\n   - Select language\n6. Enforcement method: Select 'Custom policy' to create Conditional Access policy\n7. Requires Azure AD Premium P1 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/terms-of-use"
    },
    {
      "settingName": "TermsOfUseDisplayName",
      "displayName": "Conditional Access - Terms of Use Display Name",
      "settingPath": "agreement.displayName",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess_TermsOfUse",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "User-facing name for terms of use (e.g., 'Security and Acceptable Use Policy', 'CUI Handling Agreement')",
      "validationOperator": "!=",
      "description": "Display name shown to users when presented with terms of use dialog. Should clearly indicate nature of agreement (security, legal, acceptable use).",
      "implementationGuide": "1. In Conditional Access > Terms of use > New terms\n2. Set 'Display name' field\n3. This name appears to users in acceptance dialog\n4. Supports multiple languages (add language-specific versions)\n5. Keep concise but descriptive (e.g., 'System Security Notice', 'Authorized Use Policy')",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/terms-of-use"
    },
    {
      "settingName": "TermsOfUseRequireExpand",
      "displayName": "Conditional Access - Require Users to Expand Terms",
      "settingPath": "agreement.requireReviewBeforeAccept",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess_TermsOfUse",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Forces users to expand and view full terms of use PDF before accepting. Prevents 'click-through' acceptance without reading.",
      "implementationGuide": "1. When creating Terms of Use policy\n2. Enable 'Require users to expand the terms of use'\n3. Users must click to expand PDF before Accept button becomes available\n4. Ensures users actually view security notices before acceptance\n5. Recommended setting: Enabled for all security/legal notices",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/terms-of-use"
    },
    {
      "settingName": "TermsOfUseConsentOnEveryDevice",
      "displayName": "Conditional Access - Require Consent on Every Device",
      "settingPath": "agreement.userReacceptRequiredFrequency",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess_TermsOfUse",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to accept terms of use on each device they use to access applications. Device must be registered with Azure AD.",
      "implementationGuide": "1. When creating Terms of Use policy\n2. Enable 'Require users to consent on every device'\n3. Users must accept on each device (work PC, mobile, home PC)\n4. Note: Device must be registered/joined to Azure AD for tracking\n5. Use for: High-security environments, BYOD scenarios\n6. Consideration: May impact user experience with frequent prompts",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/terms-of-use"
    },
    {
      "settingName": "iOSLockScreenFootnote",
      "displayName": "iOS/iPadOS Lock Screen Footnote",
      "settingPath": "SystemConfiguration.LockScreenMessage.LockScreenFootnote",
      "policyType": "Intune",
      "policySubType": "DeviceFeatures_SettingsCatalog",
      "platform": "iOS",
      "dataType": "string",
      "expectedValue": "Security notice or legal disclaimer text (e.g., 'Property of [Org]. Authorized Use Only. Violators Will Be Prosecuted.')",
      "validationOperator": "!=",
      "description": "Text displayed on iOS/iPadOS device lock screen. Can include security warnings, ownership information, or legal notices visible before device unlock.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://endpoint.microsoft.com)\n2. Navigate to Devices > iOS/iPadOS > Configuration profiles\n3. Create profile > Platform: iOS/iPadOS, Profile type: Settings catalog\n4. Name: 'iOS Lock Screen Message'\n5. Add settings > Browse: System Configuration > Lock Screen Message\n6. Select 'Lock Screen Footnote'\n7. Enter message text (keep concise for readability)\n8. Assign to iOS device groups\n9. Note: Only works on Supervised devices (Apple Business Manager/School Manager enrolled)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/ios-device-features-settings"
    },
    {
      "settingName": "iOSAssetTagInformation",
      "displayName": "iOS/iPadOS Asset Tag Information",
      "settingPath": "SystemConfiguration.LockScreenMessage.AssetTagInformation",
      "policyType": "Intune",
      "policySubType": "DeviceFeatures_SettingsCatalog",
      "platform": "iOS",
      "dataType": "string",
      "expectedValue": "Organization name, ownership statement, or 'If found return to' message",
      "validationOperator": "!=",
      "description": "Asset tag information displayed on iOS/iPadOS lock screen and login window. Typically used for device ownership identification and return instructions.",
      "implementationGuide": "1. In same Settings Catalog profile as Lock Screen Footnote\n2. Add settings > System Configuration > Lock Screen Message\n3. Select 'Asset Tag Information'\n4. Enter text (e.g., 'Property of ABC Corp', 'If lost, call 555-1234')\n5. Appears with lock screen message\n6. Use together with footnote for comprehensive notice\n7. Only for Supervised iOS/iPadOS devices",
      "microsoftDocUrl": "https://support.apple.com/guide/deployment/lock-screen-message-payload-settings-dep3fbb42e89/web"
    },
    {
      "settingName": "AndroidLockScreenMessage",
      "displayName": "Android Lock Screen Message",
      "settingPath": "DeviceRestrictions.System.LockScreenMessage",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Android",
      "dataType": "string",
      "expectedValue": "Security notice text for lock screen (max 4096 characters, supports device tokens)",
      "validationOperator": "!=",
      "description": "Custom message displayed on Android device lock screen. Can include security warnings, legal notices, and device-specific information using tokens ({{deviceName}}, {{serialNumber}}, etc.).",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://endpoint.microsoft.com)\n2. Navigate to Devices > Android > Configuration profiles\n3. Create profile > Platform: Android Enterprise, Profile: Device restrictions\n4. Select enrollment type (Personally-owned work profile or Corporate-owned work profile)\n5. Under Settings > System, configure 'Lock screen message':\n   - All, except when specified: Default message for all languages\n   - Select locale: Language-specific messages\n6. Can use device tokens: {{deviceName}}, {{serialNumber}}, {{WiFiMacAddress}}, {{IMEI}}, {{phoneNumber}}\n7. Message auto-translates to device's default language\n8. Assign to Android device groups",
      "microsoftDocUrl": "https://www.anoopcnair.com/configure-custom-message-for-android-intune/"
    },
    {
      "settingName": "AndroidSupportMessageShort",
      "displayName": "Android Short Support Message",
      "settingPath": "DeviceRestrictions.System.ShortSupportMessage",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Android",
      "dataType": "string",
      "expectedValue": "Brief message shown when user tries to change managed setting (max 4096 characters)",
      "validationOperator": "!=",
      "description": "Short message displayed when Android users attempt to modify settings managed by organization. Can include security policy reminders or IT contact information.",
      "implementationGuide": "1. In Android Device Restrictions profile\n2. Under System settings, configure 'Short support message'\n3. Enter brief message (e.g., 'This setting is managed by IT. Contact helpdesk@org.com for changes.')\n4. Appears when user tries to change managed settings\n5. Click 'Learn more' shows long support message\n6. Available for: Corporate-owned Android Enterprise devices\n7. Message not translated automatically - create locale-specific versions if needed",
      "microsoftDocUrl": "https://petervanderwoude.nl/post/quick-tip-adding-custom-support-information-to-corporate-owned-android-enterprise-devices/"
    },
    {
      "settingName": "CompanyPortalPrivacyMessage",
      "displayName": "Company Portal Privacy Message (iOS/iPadOS)",
      "settingPath": "tenantAdmin.customization.privacyMessage_ios",
      "policyType": "Intune",
      "policySubType": "TenantAdministration_Customization",
      "platform": "iOS",
      "dataType": "string",
      "expectedValue": "Custom privacy message explaining what organization can/cannot see on managed devices",
      "validationOperator": "!=",
      "description": "Privacy message displayed in Company Portal app on iOS/iPadOS devices. Informs users what organization can see/control vs. what remains private on their devices.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://endpoint.microsoft.com)\n2. Navigate to Tenant administration > Customization\n3. Edit default policy or create custom policy\n4. Under Configuration > Privacy section:\n   - Configure 'Privacy message in Company Portal for iOS/iPadOS'\n5. Click 'Customize message' to use rich text editor\n6. Include: What IT can see (apps, compliance status), What IT cannot see (personal data, browsing history)\n7. Message appears in Company Portal app > Settings > Privacy\n8. Supports up to 25 custom branding policies for different user groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/company-portal-app"
    },
    {
      "settingName": "MaxInactivityTimeDeviceLock",
      "displayName": "Maximum Inactivity Time Device Lock (Windows)",
      "settingPath": "Device.Vendor.MSFT.Policy.Config.DeviceLock.MaxInactivityTimeDeviceLock",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 15,
      "validationOperator": "<=",
      "description": "Specifies maximum time (minutes) of inactivity before device automatically locks. Users can select shorter timeouts. Enforces automatic device lock after inactivity.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Devices > Windows > Configuration profiles > Create\n3. Platform: Windows 10+, Profile: Settings catalog\n4. Add settings > Device Lock > Max Inactivity Time Device Lock\n5. Set Device Password Enabled: true, Max time: 15 min\n6. Assign to device groups\n7. Deploy (requires device restart)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-devicelock#maxinactivitytimedevicelock"
    },
    {
      "settingName": "InteractiveLogon_MachineInactivityLimit",
      "displayName": "Machine Inactivity Limit (Windows Alternative)",
      "settingPath": "Device.Vendor.MSFT.Policy.Config.LocalPoliciesSecurityOptions.InteractiveLogon_MachineInactivityLimit",
      "policyType": "Intune",
      "policySubType": "EndpointSecurityBaseline",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 900,
      "validationOperator": "<=",
      "description": "Alternative Windows setting - max time (seconds) before screen saver activates and locks session. 900 sec = 15 min. Works with screen saver settings.",
      "implementationGuide": "1. Intune admin center\n2. Endpoint security > Attack surface reduction\n3. Platform: Windows 10+, Profile: Security Baseline\n4. Configuration > Local Policies Security Options\n5. Interactive Logon: Machine inactivity limit = 900 seconds\n6. Assign and deploy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-localpoliciessecurityoptions#interactivelogon_machineinactivitylimit"
    },
    {
      "settingName": "ScreenSaverTimeout",
      "displayName": "Screen Saver Timeout (Windows)",
      "settingPath": "User.Vendor.MSFT.Policy.Config.ADMX_ControlPanelDisplay.CPL_Personalization_ScreenSaverTimeOut",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 900,
      "validationOperator": "<=",
      "description": "Idle time (seconds) before screen saver activates. 1-86400 sec range. USER-level policy. Works with machine inactivity limit.",
      "implementationGuide": "1. Devices > Windows > Configuration > Create\n2. Platform: Windows 10+, Profile: Settings catalog\n3. Add settings > Administrative Templates > Control Panel > Personalization\n4. Screen saver timeout (User): Enabled, 900 seconds\n5. Assign to user/device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-admx-controlpaneldisplay"
    },
    {
      "settingName": "ScreenSaverIsSecure",
      "displayName": "Password Protect Screen Saver (Windows)",
      "settingPath": "User.Vendor.MSFT.Policy.Config.ADMX_ControlPanelDisplay.CPL_Personalization_EnableScreenSaver_PasswordProtect",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces password when dismissing screen saver. REQUIRED if using screen saver-based locking. Ensures re-authentication per NIST 03.01.10(b).",
      "implementationGuide": "1. Devices > Windows > Configuration > Settings catalog\n2. Add settings > Administrative Templates > Control Panel > Personalization\n3. Password protect the screen saver (User): Enabled\n4. Must combine with screen saver timeout\n5. Assign and deploy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-admx-controlpaneldisplay"
    },
    {
      "settingName": "LockScreenImageUrl",
      "displayName": "Lock Screen Image URL (Windows Enterprise)",
      "settingPath": "Device.Vendor.MSFT.Policy.Config.Personalization.LockScreenImageUrl",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "https://contoso.sharepoint.com/lockscreen.jpg",
      "validationOperator": "!=null",
      "description": "URL to JPG/PNG for Windows lock screen wallpaper. Locked, users cannot change. Conceals sensitive info per NIST 03.01.10(c). Enterprise/Education ONLY.",
      "implementationGuide": "1. Upload image to SharePoint/Azure Blob/OneDrive\n2. Get public URL\n3. Devices > Windows > Configuration > Device restrictions\n4. Personalization > Locked screen picture URL: [image URL]\n5. Assign to Enterprise/Education devices only\n6. Users cannot change lock screen when set",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/client-management/mdm/personalization-csp"
    },
    {
      "settingName": "PreventChangingLockScreen",
      "displayName": "Prevent Users from Changing Lock Screen (Windows)",
      "settingPath": "Device.Vendor.MSFT.Policy.Config.ADMX_ControlPanel.PreventChangingLockScreen",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Prevents users from changing lock screen background. Enforces NIST 03.01.10(c) by maintaining organizational control over lock screen content.",
      "implementationGuide": "1. Devices > Windows > Configuration > Settings catalog\n2. Add settings > Administrative Templates > Control Panel > Personalization\n3. Prevent changing lock screen and logon image: Enabled\n4. Combine with LockScreenImageUrl policy\n5. Settings grayed out for users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-admx-controlpanel"
    },
    {
      "settingName": "WindowsHelloForBusiness_UseBiometrics",
      "displayName": "Windows Hello - Allow Biometric Authentication",
      "settingPath": "windows10EndpointProtectionConfiguration.windowsHelloForBusinessSettings.useBiometrics",
      "policyType": "Intune",
      "policySubType": "AccountProtection",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Allows Windows Hello biometric authentication (face/fingerprint) as PIN alternative. Users must configure PIN as fallback. Enhances NIST 03.01.10(b) strong authentication.",
      "implementationGuide": "1. Endpoint security > Account protection > Create Policy\n2. Platform: Windows 10+, Profile: Account protection\n3. Use Windows Hello for Business: Enable\n4. Use biometrics: Enable\n5. Use enhanced anti-spoofing: Enable\n6. Minimum PIN length: 6\n7. Assign to device/user groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/identity-protection-windows-settings"
    },
    {
      "settingName": "WindowsHelloForBusiness_PINMinimumLength",
      "displayName": "Windows Hello - Minimum PIN Length",
      "settingPath": "windows10EndpointProtectionConfiguration.windowsHelloForBusinessSettings.pinMinimumLength",
      "policyType": "Intune",
      "policySubType": "AccountProtection",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 6,
      "validationOperator": ">=",
      "description": "Minimum Windows Hello PIN length. Range: 4-127. Recommended: 6+. Ensures strong authentication for device unlock per NIST 03.01.10(b).",
      "implementationGuide": "1. Endpoint security > Account protection policy\n2. Platform: Windows 10+, Profile: Account protection\n3. Minimum PIN length: 6\n4. Optional: Configure lowercase/uppercase/special char requirements\n5. PIN expiration (days) if needed\n6. Assign and deploy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/identity-protection-windows-settings"
    },
    {
      "settingName": "MaxInactivityTimeDeviceLock_iOS",
      "displayName": "Maximum Minutes of Inactivity Until Screen Locks (iOS)",
      "settingPath": "iosGeneralDeviceConfiguration.maxInactivityTimeDeviceLock",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "iOS",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Max idle time (minutes) before iOS screen locks. Options: 1-15 min. Recommended: 5 min for NIST compliance. Prevents unauthorized access to unattended devices.",
      "implementationGuide": "1. Devices > iOS/iPadOS > Configuration > Create\n2. Platform: iOS/iPadOS, Profile: Device restrictions\n3. Password section > Maximum minutes of inactivity until screen locks: 5 minutes\n4. Assign to user/device groups\n5. Users can select any value up to maximum\n6. Verify: Settings > Display & Brightness > Auto-Lock",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-ios#password"
    },
    {
      "settingName": "MaxGracePeriod_iOS",
      "displayName": "Maximum Grace Period for Password After Screen Lock (iOS)",
      "settingPath": "iosGeneralDeviceConfiguration.maxGracePeriod",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "iOS",
      "dataType": "integer",
      "expectedValue": 0,
      "validationOperator": "==",
      "description": "Time (minutes) before password required after screen lock. 0 = Immediately. CRITICAL: Enforces NIST 03.01.10(b) - no grace period for unlock.",
      "implementationGuide": "1. Devices > iOS/iPadOS > Configuration > Device restrictions\n2. Password section > Maximum minutes after screen lock before password required: Immediately (0)\n3. Assign to groups\n4. Verify: Settings > Touch ID & Passcode > Require Passcode: Immediately\n5. Users cannot change this when managed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-ios#password"
    },
    {
      "settingName": "LockScreenMessage_iOS",
      "displayName": "Lock Screen Footnote Message (iOS Supervised)",
      "settingPath": "iosGeneralDeviceConfiguration.lockScreenFootnote",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "iOS",
      "dataType": "string",
      "expectedValue": "Property of [Organization]. Return if found.",
      "validationOperator": "!=null",
      "description": "Custom message on iOS lock screen. Satisfies NIST 03.01.10(c) for publicly viewable info. Requires supervised devices (ABM/ASM + ADE).",
      "implementationGuide": "1. Prerequisites: Supervised devices via Apple Business Manager\n2. Devices > iOS/iPadOS > Configuration > Settings catalog\n3. Add settings > System Configuration > Lock Screen Message > Lock Screen Footnote\n4. Enter message (max ~100 chars recommended)\n5. Assign to supervised device groups only\n6. Appears at bottom of lock screen",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-ios"
    },
    {
      "settingName": "MaxInactivityTimeDeviceLock_Android",
      "displayName": "Maximum Minutes of Inactivity Until Screen Locks (Android)",
      "settingPath": "androidDeviceOwnerGeneralDeviceConfiguration.passwordMinutesOfInactivityBeforeScreenTimeout",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Android",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Time (minutes) before Android screen locks. Applies to Android Enterprise fully managed/corporate-owned work profile. Recommended: 5 min for NIST.",
      "implementationGuide": "1. Devices > Android > Configuration > Create\n2. Platform: Android Enterprise, Profile: Device restrictions (Fully managed/corporate-owned work profile)\n3. Password section > Maximum minutes of inactivity until screen locks: 5\n4. Assign to Android Enterprise device groups\n5. Verify: Settings > Display > Screen timeout\n6. Users cannot exceed maximum",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-android-for-work#password"
    },
    {
      "settingName": "LockScreenMessage_Android",
      "displayName": "Lock Screen Message (Android Enterprise)",
      "settingPath": "androidDeviceOwnerGeneralDeviceConfiguration.lockScreenMessage",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Android",
      "dataType": "string",
      "expectedValue": "Property of [Organization]. Authorized use only.",
      "validationOperator": "!=null",
      "description": "Custom text on Android lock screen. Supports device tokens {{deviceName}}, {{serialNumber}}. Max 4096 chars, recommend <200. Satisfies NIST 03.01.10(c).",
      "implementationGuide": "1. Devices > Android > Configuration > Device restrictions\n2. Device password section > Lock screen message\n3. Enter message (use device tokens if desired)\n4. Auto-translates to device language\n5. Assign to Android Enterprise corporate devices\n6. Message appears before unlock",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-android-for-work"
    },
    {
      "settingName": "SignInFrequency",
      "displayName": "Sign-in Frequency (Session Control)",
      "settingPath": "sessionControls.signInFrequency",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"isEnabled\":true,\"type\":\"hours\",\"value\":8}",
      "validationOperator": "==",
      "description": "Automatically terminates user sessions by forcing re-authentication after a defined period of time, regardless of activity. Enforces periodic session termination to limit exposure window for compromised credentials.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Entra admin center > Identity > Protection > Conditional Access\n2. Create or edit Conditional Access policy\n3. Under 'Session' controls, enable 'Sign-in frequency'\n4. Select 'Periodic reauthentication' and set time period (1-24 hours, or specific days)\n5. Choose 'Hours' and enter value (8 hours recommended for standard users, 1-4 hours for privileged access)\n6. Assign to target users/groups\n7. Set policy to 'Report-only' for testing, then enable\n8. IMPORTANT: For mobile devices, authentication after timeout may take 30 seconds on average",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime"
    },
    {
      "settingName": "PersistentBrowserSession",
      "displayName": "Persistent Browser Session Control",
      "settingPath": "sessionControls.persistentBrowser",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"isEnabled\":true,\"mode\":\"never\"}",
      "validationOperator": "==",
      "description": "Controls whether browser sessions persist after closing and reopening browser windows. Setting to 'Never' ensures sessions are terminated when browser is closed, preventing unauthorized continued access from unattended devices.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Entra admin center > Identity > Protection > Conditional Access\n2. Create or edit Conditional Access policy\n3. Select 'All Cloud Apps' (REQUIRED - persistent browser works only with all apps)\n4. Under 'Session' controls, enable 'Persistent browser session'\n5. Set to 'Never' to disable persistent sessions (force new authentication after browser close)\n6. Alternative: Set to 'Always' only for managed, compliant devices\n7. This overrides the 'Stay signed in?' prompt shown to users\n8. Combine with Sign-in frequency for comprehensive session management",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session"
    },
    {
      "settingName": "InteractiveLogonMachineInactivityLimit",
      "displayName": "Interactive Logon: Machine Inactivity Limit",
      "settingPath": "LocalPoliciesSecurityOptions.InteractiveLogon_MachineInactivityLimit",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 900,
      "validationOperator": "<=",
      "description": "Automatically locks Windows session after specified seconds of inactivity. This is DIFFERENT from device lock - it can trigger actual logoff when combined with screensaver settings. Value in seconds (900 = 15 minutes). NOTE: This was also documented in 03.01.10 but serves dual purpose for both device lock and session termination.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > Settings Catalog\n2. Add setting: Search for 'Interactive Logon Machine Inactivity Limit'\n3. Path: Local Policies Security Options > Interactive Logon > Machine Inactivity Limit\n4. Set value in SECONDS (900 seconds = 15 minutes, 600 = 10 minutes)\n5. WARNING: This can conflict with MaxInactivityTimeDeviceLock - test thoroughly\n6. CRITICAL BUG: Some documentation shows this as boolean, but it's actually integer seconds\n7. Assign to device groups\n8. Verify registry: HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\InactivityTimeoutSecs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/interactive-logon-machine-inactivity-limit"
    },
    {
      "settingName": "RDPIdleSessionLimit",
      "displayName": "RDP: Set Time Limit for Active But Idle Sessions",
      "settingPath": "RemoteDesktopServices.RemoteDesktopSessionHost.SessionTimeLimit.IdleSessionLimit",
      "policyType": "Intune",
      "policySubType": "AdministrativeTemplate",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 900000,
      "validationOperator": "<=",
      "description": "Automatically disconnects Remote Desktop sessions after specified time of user inactivity (last input time). This is CRITICAL for privileged access and remote workers. Value in milliseconds (900000ms = 15 minutes). Disconnected session remains active until terminated by 'disconnected session' timeout.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > Settings Catalog\n2. Add setting: Search for 'Set time limit for active but idle Remote Desktop Services sessions'\n3. Path: Administrative Templates > Windows Components > Remote Desktop Services > Remote Desktop Session Host > Session Time Limits\n4. Set value in MILLISECONDS (900000ms = 15 min, 1800000ms = 30 min, 3600000ms = 1 hour)\n5. Choose action: 'Disconnect' (recommended) or 'End session'\n6. Best practice: 15 minutes for high-security, 30 minutes for standard users\n7. Works for both RDS hosts and regular Windows with RDP enabled\n8. Verify with: Get-WmiObject -Class Win32_TerminalServiceSetting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-365/enterprise/frontline-cloud-pc-session-time-limits"
    },
    {
      "settingName": "RDPDisconnectedSessionLimit",
      "displayName": "RDP: Set Time Limit for Disconnected Sessions",
      "settingPath": "RemoteDesktopServices.RemoteDesktopSessionHost.SessionTimeLimit.DisconnectedSessionLimit",
      "policyType": "Intune",
      "policySubType": "AdministrativeTemplate",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 60000,
      "validationOperator": "<=",
      "description": "Automatically terminates (logs off) Remote Desktop sessions that remain in 'Disconnected' state for specified time. This ensures background processes are ended and resources freed. Value in milliseconds (60000ms = 1 minute). CRITICAL: This actually ENDS the session, not just disconnects it.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > Settings Catalog\n2. Add setting: Search for 'Set time limit for disconnected sessions'\n3. Path: Administrative Templates > Windows Components > Remote Desktop Services > Remote Desktop Session Host > Session Time Limits\n4. Set value in MILLISECONDS (60000ms = 1 min, 300000ms = 5 min, 900000ms = 15 min)\n5. Recommended values: 1-5 minutes for high-security, 15-30 minutes for standard users\n6. IMPORTANT: This TERMINATES the session (full logoff), closing all processes\n7. Works in combination with idle session limit: Idle timeout disconnects, this terminates\n8. Test impact on long-running processes before deployment",
      "microsoftDocUrl": "https://woshub.com/remote-desktop-session-time-limit/"
    },
    {
      "settingName": "RDPActiveSessionLimit",
      "displayName": "RDP: Set Time Limit for Active Sessions",
      "settingPath": "RemoteDesktopServices.RemoteDesktopSessionHost.SessionTimeLimit.ActiveSessionLimit",
      "policyType": "Intune",
      "policySubType": "AdministrativeTemplate",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 0,
      "validationOperator": "==",
      "description": "Sets maximum duration for active Remote Desktop sessions before automatic termination. Value in milliseconds. Setting to 0 (recommended) means no time limit - rely on idle session timeout instead. USE WITH CAUTION: Non-zero values will disconnect ACTIVE users even while working.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > Settings Catalog\n2. Add setting: Search for 'Set time limit for active Remote Desktop Services sessions'\n3. Path: Administrative Templates > Windows Components > Remote Desktop Services > Remote Desktop Session Host > Session Time Limits\n4. RECOMMENDED: Set to 0 (disabled) - rely on idle timeout instead\n5. Alternative: Set maximum session duration (e.g., 28800000ms = 8 hours)\n6. WARNING: This disconnects users even if actively working - frustrating for users\n7. Only use for extreme high-security scenarios (e.g., privileged access workstations)\n8. If enabled, notify users in advance and provide session warnings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-365/enterprise/frontline-cloud-pc-session-time-limits"
    },
    {
      "settingName": "RDPEndSessionWhenTimeLimitsReached",
      "displayName": "RDP: End Session When Time Limits Are Reached",
      "settingPath": "RemoteDesktopServices.RemoteDesktopSessionHost.SessionTimeLimit.EndSessionWhenTimeLimitsReached",
      "policyType": "Intune",
      "policySubType": "AdministrativeTemplate",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Determines whether Remote Desktop sessions are terminated (logged off) or merely disconnected when time limits are reached. Setting to TRUE ensures complete session termination with process cleanup. Setting to FALSE only disconnects, leaving processes running.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > Settings Catalog\n2. Add setting: Search for 'End session when time limits are reached'\n3. Path: Administrative Templates > Windows Components > Remote Desktop Services > Remote Desktop Session Host > Session Time Limits\n4. Set to 'Enabled' to force complete logoff (recommended for security)\n5. When enabled: RDP sessions are ENDED (full logoff, all processes terminated)\n6. When disabled: RDP sessions are DISCONNECTED (can reconnect, processes continue)\n7. Recommended: Enable for security - ensures clean session termination\n8. Consider user impact: Enabled = data loss if unsaved work, but better security",
      "microsoftDocUrl": "https://woshub.com/remote-desktop-session-time-limit/"
    },
    {
      "settingName": "IdleSessionTimeout",
      "displayName": "Microsoft 365 Idle Session Timeout (Global)",
      "settingPath": "admin.microsoft.com.settings.IdleSessionTimeout",
      "policyType": "Microsoft365",
      "policySubType": "TenantWideSettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 60,
      "validationOperator": "<=",
      "description": "Automatically signs out users from Microsoft 365 web apps (Outlook Web App, SharePoint Online, OneDrive, Office web apps, Microsoft 365 Admin Center) after specified minutes of inactivity across ALL tabs. This is a tenant-wide setting that overrides individual app timeouts.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft 365 admin center (admin.microsoft.com)\n2. Go to Settings > Org Settings > Security & privacy tab\n3. Select 'Idle session timeout'\n4. Enable 'Turn on to set the period of inactivity for users to be signed off of Microsoft 365 web apps'\n5. Select timeout value: Choose preset (1-24 hours) or Custom (12-1440 minutes)\n6. Recommended: 1 hour (60 minutes) for standard users, 15-30 minutes for high-security\n7. Click Save - takes a few minutes to activate\n8. IMPORTANT: Overrides existing OWA and SharePoint timeout policies\n9. Users must be inactive across ALL M365 web app tabs to trigger timeout\n10. Does NOT affect: Desktop apps, mobile apps, managed devices with SSO",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/idle-session-timeout-web-apps"
    },
    {
      "settingName": "IdleSessionTimeoutUnmanagedDevices",
      "displayName": "Microsoft 365 Idle Session Timeout - Unmanaged Devices Only",
      "settingPath": "ConditionalAccess.SessionControls.UseAppEnforcedRestrictions",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Applies idle session timeout ONLY to unmanaged devices using Conditional Access 'Use app enforced restrictions' control. Allows different timeout values for managed vs. unmanaged devices. Managed devices can have longer timeouts, unmanaged devices get stricter controls.",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Entra admin center > Identity > Protection > Conditional Access\n2. Create new policy targeting unmanaged devices\n3. Under Conditions > Filter for devices: Device.isCompliant equals False\n4. Select Cloud apps: Office 365 (selects all M365 apps)\n5. Under Session controls: Select 'Use app enforced restrictions'\n6. This enables idle timeout from M365 Admin Center OR app-specific settings\n7. Configure timeout in: M365 Admin Center (global) OR SharePoint/Exchange PowerShell (app-specific)\n8. For SharePoint: Use Set-SPOBrowserIdleSignOut cmdlet\n9. For Exchange/OWA: Managed via M365 Admin Center global setting\n10. Result: Managed devices exempt from timeout, unmanaged devices subject to timeout",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/idle-session-timeout-web-apps#turn-on-idle-session-timeout-on-unmanaged-devices"
    },
    {
      "settingName": "SPOBrowserIdleSignOut",
      "displayName": "SharePoint Online Idle Session Sign-Out",
      "settingPath": "SharePoint.IdleSessionSignOut",
      "policyType": "Purview",
      "policySubType": "SharePointOnlineSettings",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"Enabled\":true,\"WarnAfter\":\"00:45:00\",\"SignOutAfter\":\"01:00:00\"}",
      "validationOperator": "==",
      "description": "SharePoint and OneDrive-specific idle session timeout. Warns users after specified inactivity, then automatically signs out if no response. WARNING: Microsoft 365 Admin Center global timeout overrides this setting. Only use if NOT using global M365 timeout OR if targeting unmanaged devices only.",
      "implementationGuide": "Step-by-step (PowerShell required):\n1. Install SharePoint Online Management Shell: Install-Module -Name Microsoft.Online.SharePoint.PowerShell\n2. Connect: Connect-SPOService -Url https://tenant-admin.sharepoint.com\n3. Configure timeout:\n   Set-SPOBrowserIdleSignOut -Enabled $true -WarnAfter (New-TimeSpan -Minutes 45) -SignOutAfter (New-TimeSpan -Minutes 60)\n4. Verify: Get-SPOBrowserIdleSignOut\n5. Values:\n   - WarnAfter: Time before warning (e.g., 45 minutes)\n   - SignOutAfter: Time before sign-out (e.g., 60 minutes)\n   - WarnAfter and SignOutAfter CANNOT be the same value\n6. Takes ~15 minutes to apply across organization\n7. Activity = requests sent to SharePoint (mouse clicks), NOT mouse movement or scrolling\n8. IMPORTANT: M365 Admin Center idle timeout OVERRIDES this if configured",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/sign-out-inactive-users"
    },
    {
      "settingName": "ActivityBasedAuthenticationTimeout",
      "displayName": "Exchange Online Activity-Based Authentication Timeout",
      "settingPath": "Organization.ActivityBasedAuthenticationTimeout",
      "policyType": "Microsoft365",
      "policySubType": "ExchangeOnlineSettings",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"ActivityBasedAuthenticationTimeoutEnabled\":true,\"ActivityBasedAuthenticationTimeoutInterval\":\"01:00:00\",\"ActivityBasedAuthenticationTimeoutWithSingleSignOnEnabled\":true}",
      "validationOperator": "==",
      "description": "Outlook Web App (OWA) session timeout based on user activity. Default is 6 hours. NOTE: Microsoft is RETIRING this feature in 2024 in favor of M365 Admin Center global idle timeout. Range: 5 minutes to 8 hours. WARNING: M365 Admin Center global timeout overrides this.",
      "implementationGuide": "Step-by-step (PowerShell required):\n1. Connect to Exchange Online: Connect-ExchangeOnline -UserPrincipalName admin@tenant.com\n2. Check current setting: Get-OrganizationConfig | Select-Object ActivityBasedAuthenticationTimeout*\n3. Configure timeout:\n   Set-OrganizationConfig -ActivityBasedAuthenticationTimeoutEnabled $true -ActivityBasedAuthenticationTimeoutInterval 01:00:00 -ActivityBasedAuthenticationTimeoutWithSingleSignOnEnabled $true\n4. Value format: HH:MM:SS (e.g., 01:00:00 = 1 hour, 00:15:00 = 15 minutes)\n5. Range: Minimum 00:05:00 (5 min), Maximum 08:00:00 (8 hours)\n6. Takes 12+ hours to take effect - be patient!\n7. IMPORTANT: Microsoft started retiring this in January 2024\n8. Use M365 Admin Center global idle timeout instead for new deployments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/idle-session-timeout-web-apps"
    },
    {
      "settingName": "AppProtectionPolicyOfflineGracePeriod",
      "displayName": "App Protection Policy - Offline Grace Period (Minutes)",
      "settingPath": "IntuneMAMPolicy.ConditionalLaunch.OfflineGracePeriod",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "iOS",
      "dataType": "integer",
      "expectedValue": 720,
      "validationOperator": "<=",
      "description": "Maximum minutes apps can run offline before requiring online authentication check. If exceeded, blocks access or wipes app data. Acts as session timeout for mobile apps - forces re-authentication after extended offline period. Recommended: 720 minutes (12 hours).",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Apps > App protection policies\n2. Create or edit iOS/iPadOS App Protection Policy\n3. Under 'Conditional launch' section > App conditions\n4. Find 'Offline grace period' setting (pre-configured by default)\n5. Set value: 720 minutes (12 hours) - default, OR customize (60-10080 minutes = 1 hour to 7 days)\n6. Choose action when exceeded:\n   - 'Block access' (recommended): User must connect to network and re-authenticate\n   - 'Wipe data': Removes corporate data from app\n7. Best practice: 12 hours for standard users, 4-8 hours for high-security\n8. Applies to: Outlook, OneDrive, Office apps, Teams, other MAM-enabled apps\n9. User experience: After threshold, user sees message requiring network connection",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/apps/app-protection-policy-settings-ios#conditional-launch"
    },
    {
      "settingName": "AppProtectionPolicyOfflineGracePeriodAndroid",
      "displayName": "App Protection Policy - Offline Grace Period (Minutes) - Android",
      "settingPath": "IntuneMAMPolicy.ConditionalLaunch.OfflineGracePeriod",
      "policyType": "Intune",
      "policySubType": "AppProtectionPolicy",
      "platform": "Android",
      "dataType": "integer",
      "expectedValue": 720,
      "validationOperator": "<=",
      "description": "Maximum minutes apps can run offline before requiring online authentication check on Android devices. If exceeded, blocks access or wipes app data. Acts as session timeout for mobile apps - forces re-authentication after extended offline period. Recommended: 720 minutes (12 hours).",
      "implementationGuide": "Step-by-step:\n1. Navigate to Microsoft Intune admin center > Apps > App protection policies\n2. Create or edit Android App Protection Policy\n3. Under 'Conditional launch' section > App conditions\n4. Find 'Offline grace period' setting (pre-configured by default)\n5. Set value: 720 minutes (12 hours) - default, OR customize (60-10080 minutes = 1 hour to 7 days)\n6. Choose action when exceeded:\n   - 'Block access' (recommended): User must connect to network and re-authenticate\n   - 'Wipe data': Removes corporate data from app\n7. Best practice: 12 hours for standard users, 4-8 hours for high-security\n8. Applies to: Outlook, OneDrive, Office apps, Teams, other MAM-enabled apps\n9. User experience: After threshold, user sees message requiring network connection\n10. Android-specific: Requires Intune Company Portal app installed on device",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/apps/app-protection-policy-settings-android#conditional-launch"
    },
    {
      "settingName": "displayName",
      "displayName": "Named Location Display Name",
      "settingPath": "displayName",
      "policyType": "AzureAD",
      "policySubType": "NamedLocations",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "<organization-defined-name>",
      "validationOperator": "matches",
      "description": "Human-readable name for the named location used to define authorized access points for remote access",
      "implementationGuide": "Step-by-step:\n1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Named locations\n3. Click 'New location'\n4. Enter descriptive name (e.g., 'Corporate VPN IP Ranges', 'Authorized Remote Offices', or 'Trusted Cloud Gateways')\n5. Choose location type: IP ranges location or Countries/Regions location\n6. Configure location details based on type selected\n7. Save the named location",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network"
    },
    {
      "settingName": "isTrusted",
      "displayName": "Mark as Trusted Location",
      "settingPath": "isTrusted",
      "policyType": "AzureAD",
      "policySubType": "NamedLocations",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Designates whether the named location represents a trusted network location (e.g., corporate network, authorized VPN endpoints, managed remote access points)",
      "implementationGuide": "Step-by-step:\n1. When creating or editing an IP ranges named location\n2. Enable the 'Mark as trusted location' checkbox\n3. Only mark locations as trusted if they represent organization-controlled network infrastructure\n4. Trusted locations are used by Azure AD Identity Protection to reduce false positives\n5. Can be used in Conditional Access policies to reduce MFA prompts from corporate networks\n6. Review and validate trusted location designations quarterly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network"
    },
    {
      "settingName": "ipRanges",
      "displayName": "IP Address Ranges",
      "settingPath": "ipRanges",
      "policyType": "AzureAD",
      "policySubType": "NamedLocations",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"<cidr-notation-ip-ranges>\"]",
      "validationOperator": "contains",
      "description": "List of IPv4/IPv6 address ranges in CIDR notation that define authorized remote access points (e.g., VPN gateway IPs, office network ranges)",
      "implementationGuide": "Step-by-step:\n1. Gather all authorized remote access IP ranges (VPN gateways, cloud proxies, office locations)\n2. Convert IP ranges to CIDR notation (e.g., 203.0.113.0/24)\n3. In Named location configuration, select 'IP ranges location'\n4. Add each IP range using the + button\n5. Ensure CIDR masks are /8 or greater (smaller subnets)\n6. Maximum 2000 IP ranges per named location\n7. Document the purpose of each IP range for audit purposes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network"
    },
    {
      "settingName": "countriesAndRegions",
      "displayName": "Countries and Regions",
      "settingPath": "countriesAndRegions",
      "policyType": "AzureAD",
      "policySubType": "NamedLocations",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"<country-codes>\"]",
      "validationOperator": "in",
      "description": "List of countries/regions from which remote access is authorized, supporting geographic-based access restrictions",
      "implementationGuide": "Step-by-step:\n1. Determine which countries/regions have authorized remote workers or offices\n2. In Named locations, select 'Countries location'\n3. Choose location determination method: IP address or GPS coordinates\n4. Select authorized countries from the list\n5. Optionally include 'unknown countries/regions' for IP addresses that can't be mapped\n6. GPS coordinate method requires Microsoft Authenticator app on user devices\n7. Document business justification for each authorized country",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network"
    },
    {
      "settingName": "conditions.locations.excludeLocations",
      "displayName": "Conditional Access - Exclude Locations",
      "settingPath": "conditions.locations.excludeLocations",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"<named-location-ids>\"]",
      "validationOperator": "in",
      "description": "Specifies which named locations are excluded from Conditional Access policy enforcement, allowing differentiated requirements based on access location",
      "implementationGuide": "Step-by-step:\n1. In Conditional Access policy location conditions\n2. Under Exclude, select 'Selected locations'\n3. Choose named locations to exclude from policy enforcement\n4. Common use: Exclude trusted office locations from MFA requirements\n5. Exclude locations override include statements\n6. Use carefully to avoid security gaps\n7. Document exclusion rationale for compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network"
    },
    {
      "settingName": "onPremisesPublishing.externalUrl",
      "displayName": "Application Proxy External URL",
      "settingPath": "onPremisesPublishing.externalUrl",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "https://<appname>-<tenant>.msappproxy.net",
      "validationOperator": "matches",
      "description": "External URL through which remote users access on-premises applications, serving as a managed access control point",
      "implementationGuide": "Step-by-step:\n1. Sign in to Microsoft Entra admin center\n2. Navigate to Enterprise applications > Application proxy\n3. Select 'Configure an app'\n4. Enter Internal URL of on-premises application\n5. Azure AD assigns external URL automatically (format: https://<appname>-<tenant>.msappproxy.net)\n6. Optionally configure custom domain after initial setup\n7. This external URL becomes the authorized access point for remote users\n8. Internal application remains protected behind firewall",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-add-on-premises-application"
    },
    {
      "settingName": "onPremisesPublishing.internalUrl",
      "displayName": "Application Proxy Internal URL",
      "settingPath": "onPremisesPublishing.internalUrl",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "http://internal-server.contoso.com",
      "validationOperator": "matches",
      "description": "Internal URL of the on-premises application that Application Proxy connectors will access on behalf of remote users",
      "implementationGuide": "Step-by-step:\n1. Identify the internal URL/FQDN of the application (e.g., http://sharepoint.internal.local)\n2. In Application Proxy configuration, enter this URL in 'Internal URL' field\n3. Internal URL must be accessible from connector servers\n4. Can use HTTP or HTTPS\n5. Ensure DNS resolution works from connector servers\n6. Test connectivity from connector to internal URL before completing setup",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-add-on-premises-application"
    },
    {
      "settingName": "onPremisesPublishing.isOnPremPublishingEnabled",
      "displayName": "Application Proxy Publishing Enabled",
      "settingPath": "onPremisesPublishing.isOnPremPublishingEnabled",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Indicates whether the application is published for remote access through Application Proxy, establishing it as an authorized remote access method",
      "implementationGuide": "Step-by-step:\n1. Complete Application Proxy configuration with external and internal URLs\n2. Assign at least one connector group\n3. Configure pre-authentication (Azure AD recommended)\n4. Save the application\n5. Publishing is automatically enabled when configuration is complete\n6. Verify publishing status in application properties\n7. Test remote access through external URL",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-add-on-premises-application"
    },
    {
      "settingName": "onPremisesPublishing.externalAuthenticationType",
      "displayName": "Application Proxy Pre-Authentication",
      "settingPath": "onPremisesPublishing.externalAuthenticationType",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "aadPreAuthentication",
      "validationOperator": "==",
      "description": "Requires Azure AD authentication before allowing remote access through Application Proxy, enforcing authorization requirements",
      "implementationGuide": "Step-by-step:\n1. In Application Proxy configuration, locate 'Pre Authentication' setting\n2. Select 'Azure Active Directory' (recommended for security)\n3. Alternative 'Passthrough' should only be used for public content\n4. With Azure AD pre-authentication:\n   - Users must authenticate to Azure AD first\n   - Conditional Access policies apply\n   - MFA can be enforced\n   - Only authenticated users reach backend application\n5. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-security"
    },
    {
      "settingName": "onPremisesPublishing.applicationServerTimeout",
      "displayName": "Application Proxy Backend Timeout",
      "settingPath": "onPremisesPublishing.applicationServerTimeout",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Long",
      "validationOperator": "in",
      "description": "Configures timeout settings for connections between Application Proxy connector and backend applications",
      "implementationGuide": "Step-by-step:\n1. In Application Proxy advanced settings\n2. Locate 'Backend application timeout' setting\n3. Options: Default (85 seconds) or Long (180 seconds)\n4. Choose based on application requirements\n5. Long timeout recommended for:\n   - Applications with slow authentication\n   - Large file uploads/downloads\n   - Report generation\n6. Monitor connector logs for timeout issues",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-add-on-premises-application"
    },
    {
      "settingName": "onPremisesPublishing.connectorGroupId",
      "displayName": "Application Proxy Connector Group",
      "settingPath": "onPremisesPublishing.connectorGroupId",
      "policyType": "AzureAD",
      "policySubType": "ApplicationProxy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "<connector-group-guid>",
      "validationOperator": "matches",
      "description": "Assigns the application to a specific connector group, defining which physical connectors serve as managed access points",
      "implementationGuide": "Step-by-step:\n1. Navigate to Application proxy > Connector groups\n2. Create logical connector groups (e.g., by location, network segment, security zone)\n3. Assign installed connectors to appropriate groups\n4. In application configuration, select connector group\n5. Connector group determines which physical servers handle traffic\n6. Use multiple connectors per group for high availability\n7. Place connectors close to backend applications to reduce latency",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy-connector-groups"
    },
    {
      "settingName": "roleSettings.activationDuration",
      "displayName": "PIM Maximum Activation Duration",
      "settingPath": "roleSettings.activationDuration",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "PT8H",
      "validationOperator": "<=",
      "description": "Maximum duration for which privileged remote access roles can be activated via PIM",
      "implementationGuide": "Step-by-step:\\n1. Sign in to Microsoft Entra admin center\\n2. Navigate to Identity Governance > Privileged Identity Management > Azure AD roles\\n3. Select Roles > Select role (e.g., Global Administrator)\\n4. Click 'Settings' > 'Edit'\\n5. Set 'Activation maximum duration (hours)'\\n6. Recommended: 4-8 hours maximum\\n7. Save settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "roleSettings.approvalRequired",
      "displayName": "PIM Approval Requirement",
      "settingPath": "roleSettings.approvalRequired",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires approval before activating privileged roles for remote administrative access",
      "implementationGuide": "Step-by-step:\\n1. In PIM role settings\\n2. Enable 'Require approval to activate'\\n3. Add specific approvers\\n4. Save configuration",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "servers",
      "displayName": "VPN Server Configuration",
      "settingPath": "servers",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-VPN",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[\"vpn.contoso.com\"]",
      "validationOperator": "contains",
      "description": "Defines VPN gateway servers for managed remote access",
      "implementationGuide": "Step-by-step:\\n1. In Intune VPN profile\\n2. Add VPN servers\\n3. Configure authentication\\n4. Deploy to users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/vpn-settings-windows-10"
    },
    {
      "settingName": "connectionType",
      "displayName": "VPN Connection Type",
      "settingPath": "connectionType",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-VPN",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "ikEv2",
      "validationOperator": "in",
      "description": "Specifies VPN protocol type for secure remote connections",
      "implementationGuide": "Step-by-step:\\n1. Select IKEv2 connection type\\n2. Configure certificates\\n3. Deploy profile",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/vpn-settings-windows-10"
    },
    {
      "settingName": "fDenyTSConnections",
      "displayName": "Allow Remote Desktop Connections",
      "settingPath": "fDenyTSConnections",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-AdministrativeTemplates",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 0,
      "validationOperator": "==",
      "description": "Authorizes RDP as approved remote access method",
      "implementationGuide": "Step-by-step:\\n1. Create Administrative Templates profile\\n2. Enable RDP connections\\n3. Configure firewall\\n4. Deploy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/administrative-templates-windows"
    },
    {
      "settingName": "UserAuthentication",
      "displayName": "Require Network Level Authentication",
      "settingPath": "UserAuthentication",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-AdministrativeTemplates",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 1,
      "validationOperator": "==",
      "description": "Requires NLA for RDP connections",
      "implementationGuide": "Step-by-step:\\n1. Enable NLA requirement\\n2. Deploy to devices\\n3. Test connections",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-server/remote/remote-desktop-services/clients/remote-desktop-allow-access"
    },
    {
      "settingName": "wiFiSecurityType",
      "displayName": "Require WPA2-Enterprise Wi-Fi Security",
      "settingPath": "wiFiConfiguration.securityType",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-WiFi",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "wpa2Enterprise",
      "validationOperator": "==",
      "description": "Enforces WPA2-Enterprise security protocol for all organizational Wi-Fi networks, requiring 802.1X authentication with RADIUS server. This prevents use of insecure WPA-PSK or open networks.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Configuration profiles > Create profile\n3. Select platform (Windows/iOS/Android) and profile type 'Wi-Fi'\n4. Configure:\n   - Wi-Fi type: Enterprise\n   - Security type: WPA2-Enterprise\n   - EAP type: EAP-TLS (recommended) or PEAP-MSCHAPv2\n5. Configure certificate profiles for authentication\n6. Assign to device groups\n7. Verify deployment status in Intune reporting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/wi-fi-settings-configure"
    },
    {
      "settingName": "eapType",
      "displayName": "Require EAP-TLS Authentication for Enterprise Wi-Fi",
      "settingPath": "wiFiConfiguration.eapConfiguration.eapType",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-WiFi",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "EAP-TLS",
      "validationOperator": "==",
      "description": "Requires EAP-TLS (Extensible Authentication Protocol - Transport Layer Security) as the authentication method for enterprise Wi-Fi. EAP-TLS is the most secure EAP method, using certificate-based mutual authentication and eliminating password vulnerabilities.",
      "implementationGuide": "1. Ensure PKI infrastructure is configured for certificate distribution\n2. In Intune admin center, navigate to Devices > Configuration profiles\n3. Create or edit Enterprise Wi-Fi profile\n4. Under Authentication method, select 'EAP-TLS'\n5. Configure:\n   - Root certificate for server validation\n   - Client certificate (SCEP or PKCS)\n   - Identity privacy (outer identity) if needed\n6. Deploy certificate profiles before Wi-Fi profile\n7. Test authentication with enrolled devices\n8. Monitor connection success in Intune reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/wi-fi-settings-windows"
    },
    {
      "settingName": "fipsCompliant",
      "displayName": "Require FIPS 140-2 Compliant Wi-Fi Profiles",
      "settingPath": "wiFiConfiguration.fipsCompliant",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration-WiFi",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Forces Wi-Fi profiles to comply with Federal Information Processing Standard (FIPS) 140-2 for cryptographic modules. This ensures wireless encryption uses validated cryptographic algorithms approved for federal use, providing highest-level encryption assurance.",
      "implementationGuide": "1. In Intune admin center, open Windows Wi-Fi configuration profile\n2. Navigate to Wi-Fi settings configuration\n3. Locate 'Force Wi-Fi profile to be compliant with FIPS' setting\n4. Set to 'Yes' (Enabled)\n5. Ensure certificate profiles also use FIPS-compliant algorithms\n6. Deploy to Windows devices\n7. Test connectivity and verify FIPS mode is active\n8. Note: FIPS compliance may not be available on all hardware",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/wi-fi-settings-windows"
    },
    {
      "settingName": "grantControls.builtInControls",
      "displayName": "Require Compliant Device for Wi-Fi Network Access",
      "settingPath": "conditionalAccessPolicy.conditions.locations.includeLocations / grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"compliantDevice\"]",
      "validationOperator": "contains",
      "description": "Requires devices to be marked as compliant by Intune before accessing resources from organizational networks. This enforces that wireless-connected devices meet all security requirements including encryption, OS version, and configuration standards.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Policies\n3. Create new policy or edit existing policy\n4. Under Assignments:\n   - Users: Select All users (exclude break-glass accounts)\n   - Target resources: All cloud apps\n   - Conditions: Configure network locations if needed\n5. Under Access controls > Grant:\n   - Select 'Grant access'\n   - Check 'Require device to be marked as compliant'\n6. Enable policy\n7. Test with compliant and non-compliant devices\n8. Monitor sign-in logs for policy enforcement",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-all-users-device-compliance"
    },
    {
      "settingName": "jailbroken",
      "displayName": "Block Jailbroken/Rooted Devices from Network",
      "settingPath": "deviceCompliancePolicy.deviceHealthAttestation.jailbroken",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "iOS,Android",
      "dataType": "string",
      "expectedValue": "Block",
      "validationOperator": "==",
      "description": "Marks jailbroken (iOS) or rooted (Android) devices as non-compliant, preventing them from connecting to the organizational network. Jailbroken/rooted devices bypass built-in security controls and cannot be trusted for wireless access to systems with CUI.",
      "implementationGuide": "1. In Intune admin center, navigate to Devices > Compliance policies\n2. Create or edit iOS/iPadOS or Android compliance policy\n3. Under Device Health section:\n   - iOS: Set 'Jailbroken devices' to 'Block'\n   - Android: Set 'Rooted devices' to 'Block'\n4. Configure additional compliance requirements as needed\n5. Under Actions for noncompliance:\n   - Immediately mark device as noncompliant\n   - Send push notification to user\n   - Block access after grace period (optional)\n6. Assign policy to user groups\n7. Test with test device to verify detection\n8. Monitor compliance status in Intune reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-ios"
    },
    {
      "settingName": "wiFiDisabledBeforeDeployment",
      "displayName": "Disable Wi-Fi on Devices Before Deployment",
      "settingPath": "deviceConfiguration.wireless.wiFiBlocked",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Windows,iOS,Android",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Disables Wi-Fi networking capabilities on devices during initial provisioning until authorized Wi-Fi profiles are deployed. This prevents devices from connecting to unauthorized or untrusted wireless networks before organizational controls are in place.",
      "implementationGuide": "1. Create device configuration profile for device restrictions\n2. In Intune admin center, go to Devices > Configuration profiles\n3. Create profile:\n   - Platform: Windows 10 and later / iOS/iPadOS / Android Enterprise\n   - Profile type: Device restrictions\n4. Under Wireless settings:\n   - Windows: Enable 'Block WiFi'\n   - iOS: Enable 'Block modifying Wi-Fi settings'\n   - Android: Configure via device restrictions\n5. Assign to 'All Devices' or staging device group\n6. After provisioning complete, deploy authorized Wi-Fi profiles\n7. Create second policy to allow Wi-Fi once profiles are deployed\n8. Use dynamic groups to transition devices between policies",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-configure"
    },
    {
      "settingName": "requireDeviceEncryption",
      "displayName": "Require Full Device Encryption on Mobile Devices",
      "settingPath": "deviceCompliancePolicy.systemSecurity.requireEncryption",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Mandates full-device encryption on all mobile devices (iOS, Android, Windows) before allowing access to organizational resources. iOS devices are automatically encrypted when a passcode is set; Android Enterprise enforces encryption by default. This protects CUI confidentiality if devices are lost or stolen.",
      "implementationGuide": "1. In Intune admin center, navigate to Devices > Compliance policies\n2. Create platform-specific compliance policies:\n   - iOS/iPadOS: Under 'System Security', set 'Require' for password (encryption automatic)\n   - Android Enterprise: Encryption enforced by default, verify setting\n   - Windows: Set 'Require' for 'Encryption of data storage on device'\n3. Configure Actions for noncompliance:\n   - Immediately mark as noncompliant\n   - Send notification to user\n   - Block access after 1 day grace period\n4. Assign policies to 'All users' or mobile device groups\n5. For Windows, consider deploying BitLocker configuration profile\n6. Monitor compliance status and remediation\n7. Document exceptions for devices that cannot support encryption",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started"
    },
    {
      "settingName": "minimumOSVersion",
      "displayName": "Enforce Minimum OS Version for Mobile Devices",
      "settingPath": "deviceCompliancePolicy.deviceProperties.osMinimumVersion",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "N-1",
      "validationOperator": ">=",
      "description": "Requires mobile devices to run at minimum the N-1 (current minus one) major OS version to ensure security patches and encryption capabilities are current. Prevents outdated devices with known vulnerabilities from accessing systems with CUI.",
      "implementationGuide": "1. Determine current OS versions: iOS 18/17, Android 14/13, Windows 11/10\n2. In Intune compliance policies, configure:\n   - iOS: Set 'Minimum OS version' to iOS 17.0 (if iOS 18 is current)\n   - Android: Set 'Minimum OS version' to Android 13.0 (if Android 14 is current)\n   - Windows: Set 'Minimum OS version' to 10.0.19045 (22H2) or Windows 11\n3. Under Actions for noncompliance:\n   - Grace period: 7 days for user remediation\n   - Send notification with upgrade instructions\n   - Block access after grace period\n4. Assign to mobile device groups\n5. Review and update quarterly as new OS versions release\n6. Monitor devices blocked for OS version\n7. Plan device refresh cycle for unsupported hardware",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-ios"
    },
    {
      "settingName": "passwordRequired",
      "displayName": "Require Strong Passcode on Mobile Devices",
      "settingPath": "deviceCompliancePolicy.systemSecurity.passwordRequired",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"required\":true,\"minLength\":8,\"passwordType\":\"alphanumeric\",\"maxInactivity\":15}",
      "validationOperator": "==",
      "description": "Enforces strong passcode requirements on mobile devices including minimum length, complexity (alphanumeric), and automatic lock timeout. Passcodes activate device encryption and prevent unauthorized physical access to devices containing CUI.",
      "implementationGuide": "1. Create or edit device compliance policy for each platform\n2. Under System Security > Password section, configure:\n   - iOS/Android/Windows: Set 'Require a password' to 'Require'\n   - 'Required password type': Alphanumeric\n   - 'Minimum password length': 8 characters\n   - 'Simple passwords': Block\n   - 'Maximum minutes of inactivity before password required': 15 minutes\n   - 'Password expiration (days)': 365 (or per policy)\n   - 'Number of previous passwords to prevent reuse': 5\n3. Configure device lock settings in device configuration profile:\n   - iOS: Device lock after 15 minutes\n   - Android: Screen timeout 15 minutes\n   - Windows: Lock screen timeout 15 minutes\n4. Test policy enforcement on test devices\n5. Deploy to production mobile device groups\n6. Monitor compliance and password change events",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-ios"
    },
    {
      "settingName": "grantControls.builtInControls",
      "displayName": "Require Compliant or Hybrid Joined Device for Mobile Access",
      "settingPath": "conditionalAccessPolicy.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"compliantDevice\",\"domainJoinedDevice\"]",
      "validationOperator": "contains",
      "description": "Requires mobile devices to be Intune-compliant or hybrid Azure AD joined before accessing organizational resources. This enforces centralized authorization of mobile device connections and ensures only managed, secure devices can access systems with CUI.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Conditional Access > Policies\n3. Create new policy: 'Require Compliant Mobile Devices'\n4. Assignments:\n   - Users: All users (exclude break-glass and service accounts)\n   - Target resources: All cloud apps\n   - Conditions > Device platforms: Select 'iOS', 'Android', 'Windows Phone'\n5. Access controls > Grant:\n   - Select 'Grant access'\n   - Require one of the selected controls:\n     * 'Require device to be marked as compliant'\n     * 'Require Hybrid Azure AD joined device'\n6. Session: Not configured (or as needed)\n7. Enable policy in 'Report-only' mode initially\n8. Test with mobile devices on all platforms\n9. Review sign-in logs for 7-14 days\n10. Switch to 'On' when validated\n11. Monitor ongoing sign-in reports for blocks",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-compliant-device-admin"
    },
    {
      "settingName": "appProtectionPolicy",
      "displayName": "Require App Protection Policies for CUI Access",
      "settingPath": "appProtectionPolicy.settings.dataProtection",
      "policyType": "Intune",
      "policySubType": "AppProtection",
      "platform": "iOS,Android",
      "dataType": "object",
      "expectedValue": "{\"dataTransferRestrictions\":\"managedAppsOnly\",\"encryptAppData\":true,\"minimumRequiredOsVersion\":\"N-1\"}",
      "validationOperator": "==",
      "description": "Implements container-based encryption and data protection through Intune App Protection Policies (MAM). Encrypts organizational data within managed apps independent of device encryption, implements copy/paste restrictions, and prevents data leakage to unmanaged apps. Critical for BYOD scenarios.",
      "implementationGuide": "1. In Intune admin center, navigate to Apps > App protection policies\n2. Create policy for iOS/iPadOS:\n   - Select apps: Outlook, Teams, OneDrive, Edge (Microsoft 365 apps)\n   - Data protection settings:\n     * Encrypt org data: Require\n     * Send org data to other apps: Policy managed apps\n     * Receive data from other apps: Policy managed apps\n     * Save copies of org data: Block\n     * Restrict cut, copy, paste: Policy managed apps\n   - Access requirements:\n     * PIN for access: Require\n     * Work or school account credentials: Require\n     * Biometrics: Allow (optional)\n   - Conditional launch:\n     * Min OS version: iOS 17.0\n     * Max PIN attempts: 5\n     * Offline grace period: 720 minutes\n     * Jailbroken/rooted devices: Block access\n3. Create similar policy for Android\n4. Assign to user groups\n5. Test with enrolled and unenrolled devices\n6. Monitor app protection status in Intune\n7. Review app protection reports weekly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy"
    },
    {
      "settingName": "enrollmentRestrictions",
      "displayName": "Block Personally Owned Device Enrollment",
      "settingPath": "deviceEnrollmentConfiguration.platformRestrictions.personalDeviceEnrollment",
      "policyType": "Intune",
      "policySubType": "EnrollmentRestrictions",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Block",
      "validationOperator": "==",
      "description": "Restricts mobile device enrollment to only corporate-owned devices, preventing personal BYOD devices from enrolling in Intune MDM. This ensures only authorized, organizationally-controlled devices can connect to systems with CUI. Organizations with BYOD programs should use App Protection Policies instead of full MDM enrollment.",
      "implementationGuide": "1. In Intune admin center, navigate to Devices > Enrollment\n2. Select 'Enrollment device platform restrictions'\n3. Create or edit restriction policy\n4. For each platform (iOS, Android, Windows, macOS):\n   - Set 'Personally owned devices' to 'Block'\n   - Or set 'Platform' to 'Block' entirely for BYOD\n5. Configure allowed enrollment types:\n   - Corporate-owned only: User enrollment, Device enrollment\n   - Block: Personal device enrollment\n6. For corporate devices, use one of:\n   - Apple Business Manager / Device Enrollment Program\n   - Android Enterprise fully managed\n   - Windows Autopilot\n7. Assign restriction policy with priority 1 (highest)\n8. Test enrollment with corporate vs personal devices\n9. Document approved device procurement process\n10. Review enrolled devices monthly for compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/enrollment/enrollment-restrictions-set"
    },
    {
      "settingName": "requireHybridAzureADJoinedDevice",
      "displayName": "Require Hybrid Azure AD Joined Device",
      "settingPath": "grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[\"domainJoinedDevice\"]",
      "validationOperator": "contains",
      "description": "Restricts access to organizational resources to devices that are hybrid Azure AD joined or Azure AD joined, preventing unmanaged external devices from accessing CUI.",
      "implementationGuide": "1. Navigate to Azure AD > Security > Conditional Access\n2. Create new policy named 'Require Domain Joined Devices'\n3. Under Assignments > Users: Select 'All users' (exclude break-glass accounts)\n4. Under Cloud apps: Select 'Office 365' or 'All cloud apps'\n5. Under Conditions > Device platforms: Select 'Windows'\n6. Under Grant: Select 'Require Hybrid Azure AD joined device' or 'Require device to be marked as compliant'\n7. Set policy to Report-Only, validate for 7-14 days\n8. Enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-compliant-device"
    },
    {
      "settingName": "blockUnsupportedDevicePlatforms",
      "displayName": "Block Unknown or Unsupported Device Platforms",
      "settingPath": "conditions.platforms.excludePlatforms",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"all\"]",
      "validationOperator": "==",
      "description": "Blocks access from unknown or unsupported device platforms that are not explicitly allowed by the organization, preventing unauthorized external devices from accessing CUI.",
      "implementationGuide": "1. Navigate to Azure AD > Security > Conditional Access\n2. Create new policy named 'Block Unsupported Device Platforms'\n3. Under Assignments > Users: Select 'All users'\n4. Under Cloud apps: Select 'All cloud apps'\n5. Under Conditions > Device platforms: Configure > Include: 'Any device' > Exclude: Select only approved platforms (Windows, iOS, Android, macOS)\n6. Under Access controls > Grant: Select 'Block access'\n7. Enable report-only mode, test thoroughly\n8. Enable policy after validation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-conditions#device-platforms"
    },
    {
      "settingName": "requireApprovedClientAppOrAppProtection",
      "displayName": "Require Approved Client App or App Protection Policy",
      "settingPath": "grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "iOS, Android",
      "dataType": "array",
      "expectedValue": "[\"approvedApplication\",\"compliantApplication\"]",
      "validationOperator": "contains",
      "description": "Requires mobile devices to use approved applications with app protection policies enforced, ensuring that CUI accessed from external mobile devices is protected through MAM policies.",
      "implementationGuide": "1. Navigate to Azure AD > Security > Conditional Access\n2. Create policy named 'Require Approved Apps for Mobile'\n3. Under Assignments > Users: Select 'All users'\n4. Under Cloud apps: Select 'Office 365'\n5. Under Conditions > Device platforms: Select 'iOS' and 'Android'\n6. Under Conditions > Client apps: Select 'Mobile apps and desktop clients'\n7. Under Grant: Select 'Require approved client app' OR 'Require app protection policy'\n8. Create corresponding Intune App Protection policies for iOS/Android\n9. Test in Report-Only mode\n10. Enable policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/conditional-access-intune-common-ways-use"
    },
    {
      "settingName": "RemovableDiskDenyWriteAccess",
      "displayName": "Block Removable Storage Devices",
      "settingPath": "Storage.RemovableDiskDenyWriteAccess",
      "policyType": "Intune",
      "policySubType": "AttackSurfaceReduction",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enabled",
      "validationOperator": "==",
      "description": "Prevents write access to removable storage devices (USB drives, external hard drives) on Windows devices, directly enforcing the prohibition of organizationally controlled portable storage on external systems.",
      "implementationGuide": "1. Sign in to Microsoft Intune Admin Center\n2. Navigate to Endpoint security > Attack surface reduction\n3. Click Create Policy\n4. Platform: Windows 10 and later\n5. Profile: Device Control\n6. Name: 'Block Removable Storage Write Access'\n7. Configuration settings: Scroll to 'Removable Disk Deny Write Access'\n8. Select 'Enabled' from dropdown\n9. Assign to All Devices or specific groups\n10. Review and Create\n11. Monitor compliance through Intune reporting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-asr-policy"
    },
    {
      "settingName": "DeviceControlRemovableMediaPolicy",
      "displayName": "Defender Device Control for Removable Media",
      "settingPath": "Defender.DeviceControl.RemovableMediaAccess",
      "policyType": "Defender",
      "policySubType": "DeviceControl",
      "platform": "Windows, macOS",
      "dataType": "string",
      "expectedValue": "Block",
      "validationOperator": "==",
      "description": "Advanced device control policy in Microsoft Defender for Endpoint that blocks or restricts removable media access with granular controls, supporting exceptions for approved devices.",
      "implementationGuide": "1. Sign in to Microsoft Intune Admin Center\n2. Ensure devices are onboarded to Microsoft Defender for Endpoint\n3. Navigate to Endpoint security > Attack surface reduction\n4. Create Policy > Platform: Windows 10 and later > Profile: Device control\n5. Create reusable setting for 'Any Removable Media'\n6. Name: Primary ID: 'RemovableMediaDevices'\n7. Create Device Control Rule Entry\n8. Name: 'Block All Removable Media'\n9. Entry: Type: 'Deny', Options: Read/Write/Execute\n10. Set Included ID to 'Any Removable Media' reusable setting\n11. Optional: Create allowed list for specific approved USB devices by serial number\n12. Assign to device groups\n13. Test and monitor events in Defender portal",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/device-control-deploy-manage-intune"
    },
    {
      "settingName": "BlockExternalSharingBySensitivityLabel",
      "displayName": "DLP Policy - Block External Sharing of Sensitive Content",
      "settingPath": "DlpPolicy.Rules.Conditions.ContentContainsSensitivityLabel",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"action\":\"BlockAccess\",\"condition\":\"ContentShared.External\"}",
      "validationOperator": "==",
      "description": "Prevents external sharing of documents and emails containing sensitive information or CUI by detecting sensitivity labels and blocking access to external recipients, ensuring CUI does not become publicly accessible.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal\n2. Navigate to Data loss prevention > Policies\n3. Create policy > Custom > Custom policy\n4. Name: 'Block External Sharing of CUI'\n5. Locations: SharePoint sites, OneDrive accounts, Teams chat and channel messages, Exchange email\n6. Create rule: 'Block Sensitive External Sharing'\n7. Conditions: Content contains > Sensitivity labels > Select 'Internal', 'Confidential', 'Restricted' (or equivalent CUI labels)\n8. AND Content is shared from Microsoft 365 > with people outside my organization\n9. Actions: Restrict access or encrypt the content > Block people from sharing and restrict access to shared content\n10. User notifications: Enable with policy tips\n11. Test mode: Run in simulation first\n12. Turn on policy after validation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-create-deploy-policy"
    },
    {
      "settingName": "SharePointExternalSharingRestriction",
      "displayName": "SharePoint External Sharing - Restricted to Authenticated Users",
      "settingPath": "SharingCapability",
      "policyType": "Purview",
      "policySubType": "SharePointAdminCenter",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "ExistingExternalUserSharingOnly",
      "validationOperator": "==",
      "description": "Restricts SharePoint and OneDrive external sharing to only authenticated users who are already in the directory, preventing anonymous public links that could expose CUI.",
      "implementationGuide": "1. Sign in to SharePoint Admin Center as Global Admin or SharePoint Admin\n2. Navigate to Policies > Sharing\n3. Under 'External sharing' section\n4. For SharePoint: Move slider to 'Existing guests' (most restrictive that allows external sharing)\n5. OR set to 'Only people in your organization' to block all external sharing\n6. For OneDrive: Set same or more restrictive level\n7. Expand 'More external sharing settings'\n8. Uncheck 'Allow guests to share items they don't own'\n9. Uncheck 'Anyone links' (anonymous sharing)\n10. Set default link type to 'Only people in your organization'\n11. Save changes\n12. Communicate changes to users\n13. Monitor sharing activity through audit logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off"
    },
    {
      "settingName": "SensitivityLabelsPublished",
      "displayName": "Sensitivity Labels with External Sharing Controls",
      "settingPath": "InformationProtection.SensitivityLabels",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Implements sensitivity labels that classify CUI and automatically apply protection settings including external sharing restrictions, encryption, and content markings to prevent public exposure.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal\n2. Navigate to Information protection > Labels\n3. Create label for CUI: 'CUI - Controlled Unclassified Information'\n4. Enable label for: Files & emails, Groups & sites\n5. Items tab > Encryption: Set 'Apply or remove encryption'\n6. Configure encryption: Restrict access > Assign permissions > Only organization members\n7. Content marking: Add header/footer 'CUI - Internal Use Only'\n8. Files and emails tab > External sharing: 'Block external sharing'\n9. Auto-labeling: Create auto-labeling policy to detect CUI patterns\n10. Create label policy to publish labels to all users\n11. Label policy settings: Require users to apply a label to email and documents\n12. Train users on label usage and CUI identification\n13. Monitor label usage through Information protection analytics",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/create-sensitivity-labels"
    },
    {
      "settingName": "DlpPolicyForPublicWebsites",
      "displayName": "DLP Policy - Detect CUI in Public Communications",
      "settingPath": "DlpPolicy.Rules.Conditions.ContentContainsSensitiveInformation",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"action\":\"BlockAccessOrEncrypt\",\"detectCUI\":true}",
      "validationOperator": "==",
      "description": "Scans content for patterns indicating CUI (SSN, financial data, ITAR information, etc.) and blocks or restricts external sharing to prevent CUI from being posted to public websites or shared externally.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal\n2. Navigate to Data loss prevention > Policies > Create policy\n3. Template: Custom or select 'U.S. Personally Identifiable Information (PII) Data'\n4. Name: 'Detect and Block CUI in External Communications'\n5. Locations: Exchange email, SharePoint sites, OneDrive accounts, Teams chat, Devices\n6. Create advanced DLP rule: 'Block CUI External Sharing'\n7. Conditions: Content contains\n8. Add sensitive info types: Social Security numbers, Credit card numbers, Financial data, HIPAA data, Export-controlled information\n9. AND Content is shared > with people outside my organization\n10. Actions: Restrict access > Block everyone\n11. User notifications: Notify users with policy tips and email\n12. Incident reports: Send to admins when rule match occurs\n13. Test mode first, then enable\n14. Review and adjust based on false positives",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-create-deploy-policy"
    },
    {
      "settingName": "TeamsExternalAccessRestriction",
      "displayName": "Microsoft Teams - Restrict External Access and Guest Sharing",
      "settingPath": "TeamsClientConfiguration.AllowPublicUsers",
      "policyType": "AzureAD",
      "policySubType": "TeamsAdmin",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Controls external access and guest user capabilities in Microsoft Teams to prevent CUI from being shared in public or external team channels, meetings, or chats.",
      "implementationGuide": "1. Sign in to Microsoft Teams Admin Center\n2. Navigate to Users > External access\n3. Review 'Users can communicate with Skype for Business and Teams users' setting\n4. Set to allow only specific external domains (whitelist) or block all\n5. Navigate to Users > Guest access\n6. Review guest permissions and set restrictive settings:\n7. Make private calls: Off\n8. Allow IP video: Off (or On based on business need)\n9. Edit messages: Off\n10. Delete messages: Off\n11. Navigate to Meetings > Meeting policies\n12. Create policy for handling sensitive information\n13. Set 'Anonymous users can join a meeting' to Off\n14. Set 'Automatically admit people' to 'People in my organization only'\n15. In Org-wide settings > External access: Restrict to specific approved domains only\n16. Deploy information barriers if needed for additional segregation\n17. Train users on proper Teams usage for CUI discussions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoftteams/manage-external-access"
    },
    {
      "settingName": "GlobalAdministratorRoleAssignmentCount",
      "displayName": "Global Administrator Role Assignment Limit",
      "settingPath": "roleAssignments.filter(roleDefinitionId eq 'Global Administrator').count",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Limit the number of Global Administrator role assignments to a maximum of 5 users to reduce attack surface and implement least privilege",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Roles and administrators\n2. Select 'Global Administrator' role\n3. Review all assignments under 'Assignments' tab\n4. Remove unnecessary assignments by selecting user and clicking 'Remove assignment'\n5. Ensure 2-5 Global Administrators remain (Microsoft recommendation: minimum 2, maximum 5)\n6. Document remaining Global Admins and justification for their access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/best-practices"
    },
    {
      "settingName": "BuiltInRoleUsagePolicy",
      "displayName": "Use Least Privileged Built-in Roles",
      "settingPath": "roleAssignments.roleDefinitionId",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Use least privileged role appropriate for task (e.g., User Administrator instead of Global Administrator for user management tasks)",
      "validationOperator": "policy",
      "description": "Assign users the least privileged built-in role necessary to perform their job functions instead of Global Administrator",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Roles and administrators\n2. Review all role assignments by clicking 'All roles' and examining assignment counts\n3. For each user with overly broad permissions:\n   a. Identify specific tasks they need to perform\n   b. Reference Microsoft's least privileged roles guide for task-appropriate role\n   c. Remove broad role (e.g., Global Administrator)\n   d. Assign appropriate least privileged role (e.g., User Administrator, Security Administrator)\n4. Use Microsoft's delegate-by-task documentation for role selection\n5. Document role assignment decisions and periodic review schedule",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/delegate-by-task"
    },
    {
      "settingName": "CustomRoleDefinitionForPreciseDuties",
      "displayName": "Custom Role Definitions for Precise Duties",
      "settingPath": "roleDefinitions.isBuiltIn",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "custom_role_exists",
      "description": "Create custom roles when built-in roles are too broad to achieve precise least privilege access for specific job functions",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Roles and administrators > All roles\n2. Click 'New custom role'\n3. Provide role name, description, and baseline permissions\n4. On 'Permissions' tab, select only specific permissions required\n5. Use JSON to define granular permission sets if needed\n6. Review and create custom role\n7. Assign custom role with appropriate scope (tenant, administrative unit, or resource)\n8. Requires Azure AD Premium P1 or P2 license\n9. Document custom role purpose, permissions, and approved assignees",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/custom-create"
    },
    {
      "settingName": "RoleAssignableGroupsForManagement",
      "displayName": "Role-Assignable Groups for Simplified Management",
      "settingPath": "groups.isAssignableToRole",
      "policyType": "AzureAD",
      "policySubType": "GroupManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Use role-assignable groups to simplify role management and ensure consistent least privilege across group members",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Groups > All groups\n2. Click 'New group'\n3. Set 'Group type' to 'Security'\n4. Enable 'Azure AD roles can be assigned to the group'\n5. Add appropriate members who need same role\n6. Navigate to Roles and administrators\n7. Select appropriate role and assign the group\n8. Use with PIM for just-in-time access (recommended)\n9. Requires Azure AD Premium P1 license minimum\n10. Document group membership criteria and approval process",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/groups-concept"
    },
    {
      "settingName": "PrivilegedRoleAssignmentLimit",
      "displayName": "Privileged Role Assignment Limit",
      "settingPath": "roleAssignments.filter(roleDefinition.isPrivileged eq true).count",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 10,
      "validationOperator": "<=",
      "description": "Limit the number of privileged role assignments (roles with privileged permissions like credential management) to fewer than 10 to minimize security risk",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Roles and administrators\n2. Identify roles marked as 'PRIVILEGED' (e.g., Application Administrator, Cloud Application Administrator)\n3. For each privileged role, review assignment count\n4. If total assignments across privileged roles exceed 10:\n   a. Review business justification for each assignment\n   b. Remove unnecessary privileged access\n   c. Consider using PIM for eligible assignments instead of permanent\n   d. Use custom roles with limited permissions where possible\n5. Monitor via Azure AD reporting for excessive privileged assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/best-practices#limit-the-number-of-privileged-role-assignments"
    },
    {
      "settingName": "EmergencyAccessAccountConfiguration",
      "displayName": "Emergency Access Accounts (Break Glass)",
      "settingPath": "users.filter(displayName contains 'emergency' or displayName contains 'breakglass').count",
      "policyType": "AzureAD",
      "policySubType": "AccountManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 2,
      "validationOperator": ">=",
      "description": "Configure at least 2 cloud-only emergency access accounts with Global Administrator role to prevent lockout while maintaining least privilege for normal operations",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Users > All users\n2. Create 2 cloud-only accounts (not synced from on-premises)\n3. Use strong, unique passwords stored in secure physical location (e.g., safe)\n4. Assign Global Administrator role to both accounts\n5. Exclude from all Conditional Access policies\n6. Exclude from MFA requirements (or use hardware token)\n7. Configure monitoring and alerting for usage\n8. Document storage location of credentials\n9. Test access quarterly\n10. Review usage logs monthly for unauthorized access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-emergency-access"
    },
    {
      "settingName": "RoleAssignmentScopeRestriction",
      "displayName": "Role Assignment Scope Restriction",
      "settingPath": "roleAssignments.directoryScopeId",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Administrative Unit or resource scope (not '/' for tenant-wide)",
      "validationOperator": "!=",
      "description": "Limit role assignment scope to specific Administrative Units or resources instead of tenant-wide to implement least privilege at the scope level",
      "implementationGuide": "1. Create Administrative Units for organizational/geographic boundaries:\n   a. Navigate to Identity > Administrative units > Add\n   b. Define AU by department, location, or function\n2. Assign users or devices to Administrative Units\n3. When assigning roles:\n   a. Select role in Roles and administrators\n   b. Click 'Add assignments'\n   c. Under 'Assignment type', choose 'Scoped to administrative unit'\n   d. Select specific Administrative Unit\n4. Review existing tenant-wide role assignments\n5. Migrate to scoped assignments where possible\n6. Requires Azure AD Premium P1 or P2 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/administrative-units"
    },
    {
      "settingName": "ServicePrincipalRoleAssignmentLimit",
      "displayName": "Service Principal Role Assignment Limit (100 per principal)",
      "settingPath": "servicePrincipals.appRoleAssignments.count + roleAssignments.count",
      "policyType": "AzureAD",
      "policySubType": "ServiceLimits",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 100,
      "validationOperator": "<=",
      "description": "Azure AD enforces a maximum of 100 role assignments per service principal at non-tenant scope to prevent privilege accumulation",
      "implementationGuide": "1. This is a built-in Azure AD service limit that cannot be configured\n2. Monitor service principal role assignments:\n   a. Use Microsoft Graph API: GET /servicePrincipals/{id}/appRoleAssignments\n   b. Count total assignments per service principal\n3. If approaching limit:\n   a. Review necessity of each role assignment\n   b. Consolidate permissions into fewer, more appropriate roles\n   c. Use resource-specific permissions instead of broad directory roles\n4. Alert when service principal has >80 role assignments\n5. Document and justify service principals with high assignment counts",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/users/directory-service-limits-restrictions"
    },
    {
      "settingName": "PimEnabledForPrivilegedRoles",
      "displayName": "PIM Enabled for Privileged Roles",
      "settingPath": "privilegedAccess.azureResources/roleSettings.isDefault",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Enable Privileged Identity Management for all privileged Azure AD roles to provide just-in-time access and reduce standing privileges",
      "implementationGuide": "1. Requires Azure AD Premium P2 license for all users with PIM roles\n2. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n3. Select 'Azure AD roles'\n4. Click 'Roles' and identify privileged roles (Global Admin, Privileged Role Admin, Security Admin, etc.)\n5. For each privileged role:\n   a. Click role name\n   b. Click 'Settings'\n   c. Click 'Edit'\n   d. Configure activation requirements:\n      - Enable 'Require multifactor authentication on activation'\n      - Enable 'Require justification on activation'\n      - Set 'Activation maximum duration' to 8 hours or less\n      - Enable 'Require approval to activate' for highly privileged roles\n   e. Save settings\n6. Migrate permanent assignments to eligible assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure"
    },
    {
      "settingName": "PimActivationMfaRequired",
      "displayName": "PIM Activation Requires MFA",
      "settingPath": "privilegedAccess.azureResources/roleSettings.userMemberSettings.mfaRule",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require multifactor authentication when activating privileged roles in PIM to verify identity before granting elevated access",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n2. Select 'Azure AD roles' > 'Roles'\n3. For each privileged role:\n   a. Click role name\n   b. Click 'Settings' > 'Edit'\n   c. Under 'Activation' tab\n   d. Check 'Require multifactor authentication on activation'\n   e. Click 'Update'\n4. Verify users have MFA methods registered\n5. Test role activation to confirm MFA prompt appears\n6. Apply to all privileged roles without exception",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "PimActivationJustificationRequired",
      "displayName": "PIM Activation Requires Justification",
      "settingPath": "privilegedAccess.azureResources/roleSettings.userMemberSettings.justificationRule",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require business justification when activating privileged roles to create audit trail and ensure appropriate use of elevated permissions",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n2. Select 'Azure AD roles' > 'Roles'\n3. For each role:\n   a. Click role name\n   b. Click 'Settings' > 'Edit'\n   c. Under 'Activation' tab\n   d. Check 'Require justification on activation'\n   e. Click 'Update'\n4. Educate users on providing meaningful justifications\n5. Review justifications in PIM audit logs\n6. Implement monitoring for generic or suspicious justifications",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "PimMaximumActivationDuration",
      "displayName": "PIM Maximum Activation Duration",
      "settingPath": "privilegedAccess.azureResources/roleSettings.userMemberSettings.maximumGrantPeriod",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 8,
      "validationOperator": "<=",
      "description": "Set maximum role activation duration to 8 hours or less to limit the time window of elevated privileges",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n2. Select 'Azure AD roles' > 'Roles'\n3. For each privileged role:\n   a. Click role name\n   b. Click 'Settings' > 'Edit'\n   c. Under 'Activation' tab\n   d. Set 'Activation maximum duration (hours)' to 8 or less\n   e. Consider shorter durations (4-6 hours) for highest privileged roles\n   f. Click 'Update'\n4. Inform users they can re-activate if additional time needed\n5. Monitor activation patterns to optimize duration settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "PimApprovalRequiredForHighPrivilegedRoles",
      "displayName": "PIM Approval Required for Highly Privileged Roles",
      "settingPath": "privilegedAccess.azureResources/roleSettings.userMemberSettings.approvalRule",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require approval workflow for activating highly privileged roles (Global Administrator, Privileged Role Administrator) to add human oversight",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n2. Select 'Azure AD roles' > 'Roles'\n3. For highly privileged roles (Global Administrator, Privileged Role Administrator):\n   a. Click role name\n   b. Click 'Settings' > 'Edit'\n   c. Under 'Activation' tab\n   d. Check 'Require approval to activate'\n   e. Click 'Select approver(s)'\n   f. Add appropriate approvers (avoid single point of failure)\n   g. Click 'Update'\n4. Configure notification settings for approval requests\n5. Document approval SLA (recommended: <2 hours)\n6. Implement backup approvers for 24/7 coverage",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "PimEligibleAssignmentsOverPermanent",
      "displayName": "PIM Eligible Assignments Over Permanent",
      "settingPath": "roleAssignments.assignmentState",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Eligible",
      "validationOperator": "==",
      "description": "Use eligible PIM assignments instead of permanent role assignments for privileged roles to eliminate standing access",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity > Privileged Identity Management\n2. Select 'Azure AD roles' > 'Roles'\n3. For each privileged role with permanent assignments:\n   a. Click role name\n   b. View 'Assignments' tab\n   c. Identify users with 'Permanent' assignment type\n   d. For each permanent assignment:\n      - Click '...' menu > 'Update assignment'\n      - Change assignment type to 'Eligible'\n      - Set appropriate start/end dates\n      - Click 'Update'\n4. Exception: Keep 2 emergency access accounts as permanent Global Administrators\n5. Monitor for new permanent assignments via alerts\n6. Quarterly review to ensure no unauthorized permanent assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-add-role-to-user"
    },
    {
      "settingName": "PrivilegedRoleAccessReviewEnabled",
      "displayName": "Access Reviews Enabled for Privileged Roles",
      "settingPath": "identityGovernance.accessReviews.definitions.instanceEnumerationScope.principalScoped",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable recurring access reviews for all privileged Azure AD roles to periodically validate continued need for elevated permissions",
      "implementationGuide": "1. Requires Azure AD Premium P2 license for all reviewers\n2. Navigate to Microsoft Entra admin center > Identity Governance > Privileged Identity Management\n3. Select 'Azure AD roles' > 'Access reviews'\n4. Click 'New access review'\n5. Configure review:\n   a. Name: 'Privileged Role Access Review - [Role Name]'\n   b. Start date: Immediate or scheduled\n   c. Frequency: Weekly, Monthly, or Quarterly (recommend monthly minimum)\n   d. Duration: 3-7 days\n   e. End: Never (recurring)\n6. Select roles to review (Global Admin, Security Admin, etc.)\n7. Assignment type: All active and eligible assignments\n8. Reviewers: Manager or specific security personnel\n9. Enable 'Auto apply results to resource'\n10. Set 'If reviewers don't respond' to 'Remove access'\n11. Create separate review for each critical privileged role",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review"
    },
    {
      "settingName": "AccessReviewFrequencyForHighPrivilegedRoles",
      "displayName": "Access Review Frequency for High Privileged Roles",
      "settingPath": "identityGovernance.accessReviews.definitions.settings.recurrence.pattern.type",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "weekly",
      "validationOperator": "in",
      "description": "Configure access reviews for highly privileged roles (Global Admin, Privileged Role Admin) to run at least weekly or monthly",
      "implementationGuide": "1. Navigate to Identity Governance > Privileged Identity Management > Azure AD roles > Access reviews\n2. For existing reviews of highly privileged roles:\n   a. Select review > 'Settings'\n   b. Set 'Frequency' to 'Weekly' or 'Monthly'\n3. For new reviews:\n   a. Click 'New access review'\n   b. Select Global Administrator, Privileged Role Administrator roles\n   c. Set Frequency to 'Weekly' (for highest risk) or 'Monthly' (acceptable)\n   d. Duration: 3-7 days maximum\n4. CIS Benchmark recommends weekly for: Global Admin, Exchange Admin, SharePoint Admin, Teams Admin, Security Admin\n5. Configure notifications to reviewers\n6. Enable 'Show recommendations' based on sign-in activity",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review"
    },
    {
      "settingName": "AccessReviewAutoApplyResults",
      "displayName": "Access Review Auto-Apply Results",
      "settingPath": "identityGovernance.accessReviews.definitions.settings.autoApplyDecisionsEnabled",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable automatic application of access review results to immediately remove access when reviewers deny or don't respond",
      "implementationGuide": "1. Navigate to Identity Governance > Access reviews\n2. When creating or editing access review:\n   a. Expand 'Advanced settings'\n   b. Enable 'Auto apply results to resource'\n   c. Set 'If reviewers don't respond' to 'Remove access' or 'Take recommendations'\n3. For existing reviews:\n   a. Select review > 'Settings'\n   b. Enable 'Auto apply results to resource'\n   c. Update 'Default decision' setting\n4. Test with non-critical role first\n5. Configure notifications to affected users before removal\n6. Document exception process for restoring accidentally removed access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review"
    },
    {
      "settingName": "AccessReviewDurationLimit",
      "displayName": "Access Review Duration Limit",
      "settingPath": "identityGovernance.accessReviews.definitions.settings.recurrence.pattern.daysOfMonth",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 3,
      "validationOperator": "<=",
      "description": "Set access review duration to 3 days or less to ensure timely completion and prevent stale privileged access",
      "implementationGuide": "1. Navigate to Identity Governance > Access reviews\n2. When creating access review:\n   a. Set 'Duration (in days)' to 3 or less\n   b. Shorter duration increases urgency\n3. For existing reviews:\n   a. Edit review settings\n   b. Reduce duration to 3 days maximum\n4. Configure reminder notifications:\n   a. Send reminder 1 day before end\n   b. Escalate to backup reviewer if no response\n5. Monitor review completion rates\n6. Adjust duration if completion rates drop below 90%",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review"
    },
    {
      "settingName": "AccessReviewRecommendationsEnabled",
      "displayName": "Access Review Recommendations Enabled",
      "settingPath": "identityGovernance.accessReviews.definitions.settings.recommendationsEnabled",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable system recommendations in access reviews based on user sign-in activity and access patterns to assist reviewers",
      "implementationGuide": "1. Navigate to Identity Governance > Access reviews\n2. When creating or editing access review:\n   a. Enable 'Show recommendations'\n   b. Recommendations based on:\n      - Last sign-in activity\n      - Role usage patterns\n      - Access history\n3. System recommends 'Deny' for:\n   - Users who haven't signed in for 30+ days\n   - Inactive role assignments\n4. Educate reviewers to:\n   a. Consider recommendations but verify business need\n   b. Document reason if overriding recommendation\n5. Review recommendation accuracy quarterly\n6. Adjust recommendation thresholds if needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review"
    },
    {
      "settingName": "AccessReviewJustificationRequired",
      "displayName": "Access Review Justification Required",
      "settingPath": "identityGovernance.accessReviews.definitions.settings.justificationRequiredOnApproval",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require reviewers to provide business justification when approving continued privileged access",
      "implementationGuide": "1. Navigate to Identity Governance > Access reviews\n2. When creating or editing access review:\n   a. Enable 'Require reason on approval'\n   b. Optionally enable 'Require reason on denial'\n3. Educate reviewers on providing meaningful justifications:\n   a. Specific job function requiring privilege\n   b. Recent tasks performed with elevated access\n   c. Expected duration of continued need\n4. Review justifications for quality\n5. Flag generic justifications (e.g., 'needs access') for follow-up\n6. Store justifications for audit trail and compliance reporting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review"
    },
    {
      "settingName": "AutopilotStandardUserProvisioning",
      "displayName": "Windows Autopilot Standard User Provisioning",
      "settingPath": "deviceEnrollmentConfigurations.windowsAutopilot.settings.enableWhiteGlove",
      "policyType": "Intune",
      "policySubType": "WindowsAutopilot",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Standard",
      "validationOperator": "==",
      "description": "Configure Windows Autopilot to provision user accounts as Standard users instead of Local Administrators during device setup",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Windows > Windows enrollment\n2. Select 'Deployment Profiles'\n3. Edit existing profile or create new:\n   a. Click 'Create profile' > 'Windows PC'\n   b. Provide name and description\n4. On 'Out-of-box experience (OOBE)' page:\n   a. Set 'Apply device name template' (optional)\n   b. Set 'User account type' to 'Standard'\n   c. Configure other OOBE settings as needed\n5. Assign profile to appropriate device groups\n6. Applies to new device enrollments only\n7. Existing devices require manual local admin removal\n8. Document exceptions requiring local admin (if any)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/autopilot/windows-autopilot"
    },
    {
      "settingName": "IntuneAccountProtectionLocalAdminRestriction",
      "displayName": "Intune Account Protection - Local Admin Restriction",
      "settingPath": "deviceConfigurations.endpointSecurityAccountProtection.localUsersAndGroups.configure",
      "policyType": "Intune",
      "policySubType": "EndpointSecurityAccountProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"groupName\":\"Administrators\",\"action\":\"remove_update\",\"members\":[\"Azure AD joined device local administrator role group\"]}",
      "validationOperator": "contains",
      "description": "Use Intune Account Protection policy to manage local Administrators group membership, removing unnecessary users and adding only authorized administrators",
      "implementationGuide": "1. Navigate to Intune admin center > Endpoint security > Account protection\n2. Click 'Create Policy'\n3. Platform: Windows 10 and later\n4. Profile: Local user group membership\n5. Click 'Create'\n6. On 'Configuration settings':\n   a. Click 'Add group'\n   b. Local Group: Administrators (S-1-5-32-544)\n   c. Action: Select 'Remove and Update' or 'Add Update'\n   d. Members: Add Azure AD security group or specific users\n7. To remove user who joined device:\n   a. Action: 'Remove'\n   b. Members: Add placeholder or specific user SID\n8. Assign to device groups\n9. Monitor compliance status\n10. Requires Windows 10 20H2 or later",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-account-protection-policy"
    },
    {
      "settingName": "AdministratorProtectionUACEnabled",
      "displayName": "Administrator Protection (UAC Enhancement)",
      "settingPath": "deviceConfigurations.settingsCatalog.localPoliciesSecurityOptions.userAccountControlTypeOfAdminApprovalMode",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Admin Approval Mode with Administrator protection",
      "validationOperator": "==",
      "description": "Enable Administrator Protection to require users with admin privileges to consent before elevated operations, implementing just-in-time privilege elevation",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration profiles\n2. Click 'Create profile'\n3. Platform: Windows 10 and later\n4. Profile type: Settings catalog\n5. Click 'Add settings'\n6. Search for 'User Account Control'\n7. Select 'Local Policies Security Options'\n8. Add these settings:\n   a. 'User Account Control: Configure type of Admin Approval Mode'\n      - Set to 'Admin Approval Mode with Administrator protection'\n   b. 'User Account Control: Behavior of the elevation prompt for administrators running with Administrator protection'\n      - Set to 'Prompt for credentials' or 'Prompt for consent'\n9. Assign to user or device groups with admin rights\n10. Requires Windows 11 24H2 build 26100.7019 or later\n11. Integrates with Windows Hello for authentication",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/administrator-protection/"
    },
    {
      "settingName": "EndpointPrivilegeManagementPolicies",
      "displayName": "Endpoint Privilege Management (EPM) Policies",
      "settingPath": "deviceManagement.elevationRequests.elevationRules",
      "policyType": "Intune",
      "policySubType": "EndpointPrivilegeManagement",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "{\"ruleType\":\"fileHash\",\"action\":\"allow\",\"requireJustification\":true}",
      "validationOperator": "exists",
      "description": "Deploy Endpoint Privilege Management policies to allow standard users to run specific applications with elevated privileges without granting full admin rights",
      "implementationGuide": "1. Requires Microsoft Intune Suite license\n2. Navigate to Intune admin center > Endpoint security > Endpoint Privilege Management\n3. Click 'Create policy'\n4. Select 'Windows elevation rules'\n5. Configure elevation rules:\n   a. Rule name and description\n   b. File type: Certificate, File hash, or File name\n   c. For critical applications:\n      - Add file details (hash, path, or certificate)\n      - Select 'Elevation type': Automatic or User-confirmed\n      - Enable 'Require business justification'\n6. Create separate rules for different applications\n7. Assign to user groups (standard users who need occasional elevation)\n8. Monitor elevation requests and justifications\n9. Review and update rules quarterly\n10. Currently in Public Preview",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/epm-overview"
    },
    {
      "settingName": "WindowsLAPSConfiguration",
      "displayName": "Windows LAPS (Local Administrator Password Solution)",
      "settingPath": "deviceConfigurations.settingsCatalog.laps",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"backupDirectory\":\"1\",\"passwordComplexity\":\"4\",\"passwordLength\":14,\"postAuthenticationActions\":\"3\"}",
      "validationOperator": "configured",
      "description": "Configure Windows LAPS to automatically manage and rotate local administrator passwords, reducing shared credential risk",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration profiles\n2. Create Settings Catalog profile\n3. Add settings from 'LAPS' category:\n   a. 'Backup Directory' = 'Backup the password to Azure AD only' (1)\n   b. 'Password Complexity' = 'Large letters + small letters + numbers + special characters' (4)\n   c. 'Password Length' = 14 or greater\n   d. 'Password Age Days' = 30 (or organization-defined)\n   e. 'Post Authentication Actions' = 'Reset the password and logoff the managed account' (3)\n4. Assign to Azure AD joined Windows devices\n5. Verify Azure AD Premium P1 or P2 license\n6. Grant access to LAPS passwords:\n   a. Azure AD role with appropriate permissions\n   b. Or use RBAC with custom role\n7. Monitor password retrieval via audit logs\n8. Supported on Azure AD joined devices only",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-server/identity/laps/laps-scenarios-azure-active-directory"
    },
    {
      "settingName": "IntuneRBACCustomRoles",
      "displayName": "Intune RBAC Custom Roles for Scoped Administration",
      "settingPath": "roleManagement.roleDefinitions",
      "policyType": "Intune",
      "policySubType": "RoleBasedAccessControl",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"isBuiltIn\":false,\"permissions\":[\"specific_permissions_only\"]}",
      "validationOperator": "exists",
      "description": "Create custom Intune RBAC roles with minimum required permissions for device management tasks instead of using broad built-in roles",
      "implementationGuide": "1. Navigate to Intune admin center > Tenant administration > Roles\n2. Click 'Create' to create custom role\n3. Provide role name and description\n4. On 'Permissions' tab:\n   a. Select only required permission categories\n   b. Within each category, grant specific permissions needed\n   c. Avoid granting all permissions in a category\n5. Common least privilege roles:\n   a. Help Desk Operator: Device read + remote actions only\n   b. Policy Manager: Policy create/edit, no device wipe\n   c. Read-Only Operator: Read permissions only\n6. On 'Scope tags' tab:\n   a. Add scope tags to limit device visibility\n7. Assign custom role to security groups\n8. Review and update permissions quarterly\n9. Document role purpose and approved assignees",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/fundamentals/create-custom-role"
    },
    {
      "settingName": "ApplicationPermissionsLeastPrivilege",
      "displayName": "Application Permissions - Least Privilege Principle",
      "settingPath": "servicePrincipals.appRoles",
      "policyType": "AzureAD",
      "policySubType": "ApplicationManagement",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "Minimum required permissions only (no *.All permissions unless absolutely necessary)",
      "validationOperator": "policy",
      "description": "Grant applications only the minimum Microsoft Graph API and Azure AD permissions required for their functionality",
      "implementationGuide": "1. For each application registration:\n   a. Navigate to Azure AD > App registrations > [Application]\n   b. Select 'API permissions'\n   c. Review existing permissions\n2. Apply least privilege:\n   a. Prefer delegated permissions over application permissions when user context exists\n   b. Request specific resource permissions (e.g., User.Read.All) instead of broad permissions (e.g., Directory.ReadWrite.All)\n   c. Avoid *.ReadWrite.All permissions unless required\n   d. Use resource-specific permissions when available\n3. Remove unnecessary permissions:\n   a. Select permission > 'Remove permission'\n4. Document permission justification\n5. Implement approval workflow for high-privilege permissions\n6. Quarterly permission review and cleanup\n7. Use Microsoft Graph permissions reference for least privilege guidance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/permissions-overview"
    },
    {
      "settingName": "AdminConsentRequiredForHighPrivilegePermissions",
      "displayName": "Admin Consent Required for High Privilege Permissions",
      "settingPath": "servicePrincipals.appRoleAssignments.appRoleId",
      "policyType": "AzureAD",
      "policySubType": "ApplicationManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Require administrator consent for applications requesting high-privilege permissions (e.g., Application.ReadWrite.All, RoleManagement.ReadWrite.Directory)",
      "implementationGuide": "1. This is default behavior in Azure AD - admin consent required for application permissions\n2. Configure user consent settings:\n   a. Navigate to Azure AD > Enterprise applications > Consent and permissions\n   b. Under 'User consent settings':\n      - Select 'Do not allow user consent' for high-risk permissions\n      - Or 'Allow user consent for apps from verified publishers, for selected permissions'\n3. Review and approve consent requests:\n   a. Navigate to Enterprise applications > Admin consent requests\n   b. Review business justification\n   c. Verify least privilege principle\n   d. Approve or deny with documentation\n4. Monitor high-privilege permission grants via audit logs\n5. Implement approval workflow for permissions allowing credential management or role assignment\n6. Quarterly review of all granted application permissions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/configure-admin-consent-workflow"
    },
    {
      "settingName": "ServicePrincipalPermissionReview",
      "displayName": "Service Principal Permission Periodic Review",
      "settingPath": "servicePrincipals.appRoleAssignments",
      "policyType": "AzureAD",
      "policySubType": "ApplicationManagement",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "Reviewed quarterly",
      "validationOperator": "periodic_review",
      "description": "Periodically review application and service principal permissions to identify and remove unnecessary or excessive permissions",
      "implementationGuide": "1. Create quarterly review process:\n   a. Export all service principals: GET /servicePrincipals via Graph API\n   b. For each service principal, retrieve permissions:\n      - GET /servicePrincipals/{id}/appRoleAssignments\n      - GET /servicePrincipals/{id}/oauth2PermissionGrants\n2. Review each permission grant:\n   a. Validate business need with application owner\n   b. Verify permission is minimum required\n   c. Check for unused applications (no sign-in activity)\n   d. Identify overly broad permissions (*.All)\n3. Remove unnecessary permissions:\n   a. DELETE /servicePrincipals/{id}/appRoleAssignments/{assignmentId}\n   b. DELETE /oauth2PermissionGrants/{grantId}\n4. Document review findings and actions taken\n5. Create alert for new high-privilege permission grants\n6. Implement approval for permission changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/serviceprincipal-list-approleassignments"
    },
    {
      "settingName": "DelegatedPermissionsOverApplicationPermissions",
      "displayName": "Prefer Delegated Permissions Over Application Permissions",
      "settingPath": "servicePrincipals.oauth2PermissionGrants.scope",
      "policyType": "AzureAD",
      "policySubType": "ApplicationManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Delegated permissions used when user context available",
      "validationOperator": "policy",
      "description": "Use delegated permissions instead of application permissions when user context is available, limiting access to user's own permissions intersection",
      "implementationGuide": "1. For applications requiring user context:\n   a. Navigate to App registrations > [Application] > API permissions\n   b. Request delegated permissions (Type: Delegated) instead of application permissions (Type: Application)\n   c. Understand permission intersection: Effective access = MIN(delegated permission, user's permissions)\n2. Examples:\n   a. User with User role + User.ReadWrite.All delegated = Can only modify own profile\n   b. User with User Admin role + User.ReadWrite.All delegated = Can modify all users\n3. Reserve application permissions for:\n   a. Background services without user sign-in\n   b. Daemon/service applications\n   c. Automation requiring access beyond user permissions\n4. Document why application permissions required\n5. Review application permission usage quarterly\n6. Migrate to delegated permissions where feasible",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/permissions-overview#delegated-permissions"
    },
    {
      "settingName": "AdministrativeUnitForScopedAdministration",
      "displayName": "Administrative Units for Scoped Administration",
      "settingPath": "administrativeUnits",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnits",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"membershipType\":\"Dynamic\",\"membershipRule\":\"Defined based on user/device attributes\"}",
      "validationOperator": "exists",
      "description": "Create Administrative Units to scope role assignments to specific organizational boundaries, implementing least privilege at the scope level",
      "implementationGuide": "1. Requires Azure AD Premium P1 or P2 license\n2. Navigate to Azure AD > Administrative units\n3. Click 'New administrative unit'\n4. Configure AU:\n   a. Name: Organizational unit name (e.g., 'Marketing Department', 'US Region')\n   b. Description: Purpose and scope\n   c. Membership type:\n      - Dynamic: Auto-populate based on attributes\n      - Assigned: Manually add users/devices/groups\n5. For dynamic membership:\n   a. Define membership rules (e.g., department equals Marketing)\n6. Add role assignments scoped to AU:\n   a. Select AU > 'Roles and administrators'\n   b. Add role assignment\n   c. Select role (e.g., User Administrator)\n   d. Select user/group to assign\n7. Common AU scenarios:\n   a. Geographic regions\n   b. Departments/business units\n   c. Device types or locations\n8. Document AU structure and role assignment strategy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/administrative-units"
    },
    {
      "settingName": "RestrictedManagementAdministrativeUnits",
      "displayName": "Restricted Management Administrative Units",
      "settingPath": "administrativeUnits.isMemberManagementRestricted",
      "policyType": "AzureAD",
      "policySubType": "AdministrativeUnits",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enable restricted management on Administrative Units to prevent modifications by administrators outside the AU scope",
      "implementationGuide": "1. Navigate to Azure AD > Administrative units\n2. Select existing AU or create new\n3. Under AU settings:\n   a. Enable 'Restrict management'\n   b. This prevents Global Administrators from modifying AU members unless they have scoped role on the AU\n4. Use for sensitive organizational units:\n   a. Executive leadership\n   b. Security/compliance team\n   c. Finance department\n5. Assign AU-scoped administrators:\n   a. Only users with role assignment scoped to this AU can manage members\n6. Verify Global Admins cannot bypass restriction (except specific scoped assignments)\n7. Document restricted AUs and justification\n8. Requires Azure AD Premium P1 or P2 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-restricted-management"
    },
    {
      "settingName": "UnifiedAuditLogIngestionEnabled",
      "displayName": "Microsoft 365 Unified Audit Log",
      "settingPath": "UnifiedAuditLogIngestionEnabled",
      "policyType": "Purview",
      "policySubType": "AuditConfiguration",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables the unified audit log to record user and admin activities across Microsoft 365 services including Exchange, SharePoint, OneDrive, Teams, Azure AD, and more. This is the foundational setting that enables event logging for all M365 services.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell\n2. Run command: Set-AdminAuditLogConfig -UnifiedAuditLogIngestionEnabled $true\n3. Verify with: Get-AdminAuditLogConfig | FL UnifiedAuditLogIngestionEnabled\n4. Note: Changes take up to 60 minutes to take effect\n5. Confirm logging is active in Microsoft Purview Compliance portal > Audit > New Search",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-enable-disable"
    },
    {
      "settingName": "AuditLogs",
      "displayName": "Azure AD Audit Logs Diagnostic Settings",
      "settingPath": "properties.logs[?(@.category=='AuditLogs')].enabled",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Azure AD audit logs to capture directory changes, user/group modifications, role assignments, application changes, and other Azure AD activities. Critical for tracking identity and access management events.",
      "implementationGuide": "1. Navigate to Azure Portal > Azure Active Directory > Monitoring > Diagnostic settings\n2. Click '+ Add diagnostic setting'\n3. Enter name (e.g., 'AzureAD-Audit-Logs')\n4. Check 'AuditLogs' category\n5. Select destination: Send to Log Analytics workspace (recommended for retention) or Archive to storage account\n6. Click Save\n7. Verify logs appear within 15 minutes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/howto-integrate-activity-logs-with-log-analytics"
    },
    {
      "settingName": "SignInLogs",
      "displayName": "Azure AD Sign-In Logs Diagnostic Settings",
      "settingPath": "properties.logs[?(@.category=='SignInLogs')].enabled",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Azure AD sign-in logs to capture all authentication attempts including successful and failed logins, authentication methods used, conditional access policy results, and location/device information. Essential for detecting unauthorized access attempts.",
      "implementationGuide": "1. Navigate to Azure Portal > Azure Active Directory > Monitoring > Diagnostic settings\n2. Click '+ Add diagnostic setting'\n3. Enter name (e.g., 'AzureAD-SignIn-Logs')\n4. Check 'SignInLogs' category\n5. Select destination: Send to Log Analytics workspace (recommended) or Archive to storage account\n6. Configure retention period (minimum 180 days recommended)\n7. Click Save\n8. Verify logs appear within 15 minutes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-sign-ins"
    },
    {
      "settingName": "AuditDisabled",
      "displayName": "Exchange Online Mailbox Auditing (Organization-wide)",
      "settingPath": "AuditDisabled",
      "policyType": "Purview",
      "policySubType": "MailboxAudit",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Ensures mailbox auditing is enabled organization-wide to log mailbox activities including message access, modifications, deletions, and permissions changes. CIS Benchmark Level 1 requirement.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell\n2. Check current status: Get-OrganizationConfig | FL AuditDisabled\n3. Enable auditing: Set-OrganizationConfig -AuditDisabled $false\n4. Verify mailbox auditing for users: Get-Mailbox -ResultSize Unlimited | Select UserPrincipalName, AuditEnabled\n5. Enable for specific mailbox if needed: Set-Mailbox -Identity user@domain.com -AuditEnabled $true\n6. View audit events: Search-UnifiedAuditLog -StartDate (Get-Date).AddDays(-7) -EndDate (Get-Date) -RecordType ExchangeItem",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/mailbox-auditing"
    },
    {
      "settingName": "DeviceComplianceMonitoring",
      "displayName": "Intune Device Compliance Audit Logging",
      "settingPath": "microsoft.intune/deviceComplianceMonitoring",
      "policyType": "Intune",
      "policySubType": "CompliancePolicy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables logging of device compliance state changes, policy assignments, and device enrollment activities in Intune. Logs are automatically sent to the unified audit log.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://intune.microsoft.com)\n2. Navigate to Devices > Monitor > Audit logs\n3. Verify audit logging is enabled (enabled by default)\n4. Configure Azure AD diagnostic settings to export Intune logs:\n   - Azure Portal > Monitor > Diagnostic settings\n   - Select subscription > Add diagnostic setting\n   - Check 'Intune' service\n5. Review logs: Intune admin center > Tenant administration > Audit logs\n6. Search unified audit log for Intune events: Search-UnifiedAuditLog -RecordType AzureActiveDirectory -Operations 'Update device'",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/fundamentals/monitor-audit-logs"
    },
    {
      "settingName": "DefenderAuditLogging",
      "displayName": "Microsoft Defender for Office 365 Audit Logging",
      "settingPath": "microsoft.defender/auditLogging",
      "policyType": "Defender",
      "policySubType": "ThreatProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables audit logging for Microsoft Defender for Office 365 security events including threat detections, quarantine actions, policy hits, and security investigations. Automatically logs to unified audit log.",
      "implementationGuide": "1. Defender for Office 365 automatically logs to unified audit log when enabled\n2. Verify unified audit log is enabled (prerequisite)\n3. Access Defender logs: Microsoft Defender portal > Audit\n4. Search for Defender events: Search-UnifiedAuditLog -RecordType ThreatIntelligence\n5. Common Defender operations:\n   - 'AlertTriggered' - Security alert generated\n   - 'ThreatIntelligenceDetection' - Threat detected\n   - 'QuarantineAction' - Message quarantined\n6. Configure alert policies for Defender events in Microsoft Purview\n7. Export to SIEM: Use Office 365 Management Activity API",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-office-365/audit-log-search-defender-portal"
    },
    {
      "settingName": "MailboxAuditLogContent",
      "displayName": "Exchange Mailbox Audit Log Content",
      "settingPath": "AuditOwner,AuditDelegate,AuditAdmin",
      "policyType": "Purview",
      "policySubType": "MailboxAudit",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "ApproveMessagesWithDLExpansion,Create,FolderBind,HardDelete,MailboxLogin,MessageBind,Move,MoveToDeletedItems,SendAs,SendOnBehalf,SoftDelete,Update,UpdateCalendarDelegation,UpdateFolderPermissions,UpdateInboxRules",
      "validationOperator": "contains",
      "description": "Configures mailbox audit logging to capture detailed content for owner, delegate, and admin actions including what action occurred, timestamp, user identity, affected items, source IP, and outcome. Logs automatically include all NIST-required fields.",
      "implementationGuide": "1. Verify mailbox auditing is enabled: Get-OrganizationConfig | FL AuditDisabled\n2. Check default logged actions: Get-Mailbox -ResultSize Unlimited | Select UserPrincipalName,AuditOwner,AuditDelegate,AuditAdmin | FL\n3. Mailbox audit records automatically capture:\n   - What: Operation (e.g., 'HardDelete', 'SendAs', 'MailboxLogin')\n   - When: CreationTime (UTC timestamp)\n   - Where: ClientIPAddress, ClientInfoString\n   - Source: LogonUserDisplayName, LogonUserSid\n   - Outcome: ResultStatus (Succeeded/Failed)\n   - Identity: MailboxOwnerUPN, MailboxResolvedOwnerName\n4. View sample record: Search-UnifiedAuditLog -StartDate (Get-Date).AddDays(-1) -EndDate (Get-Date) -RecordType ExchangeItem -ResultSize 1 | FL\n5. Verify content fields present in AuditData property",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/mailbox-auditing"
    },
    {
      "settingName": "UnifiedAuditLogRecordContent",
      "displayName": "Microsoft 365 Unified Audit Log Record Schema",
      "settingPath": "UnifiedAuditLogRecordType",
      "policyType": "Purview",
      "policySubType": "AuditConfiguration",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "StandardSchema",
      "validationOperator": "==",
      "description": "The unified audit log uses a standardized schema across all M365 services that automatically includes required NIST content fields: CreationTime, Operation, OrganizationId, RecordType, UserType, UserId, ClientIP, ObjectId, and service-specific data.",
      "implementationGuide": "1. Verify unified audit log is enabled (prerequisite)\n2. Unified audit records automatically contain standard fields:\n   - What: Operation (activity name)\n   - When: CreationTime (UTC ISO 8601)\n   - Where: ClientIP, Workload (service)\n   - Source: UserId, UserKey, UserType\n   - Outcome: ResultStatus (when applicable)\n   - Identity: UserId, UserKey, ObjectId (target)\n3. View schema: Search-UnifiedAuditLog -StartDate (Get-Date).AddDays(-1) -EndDate (Get-Date) -ResultSize 1 | Select -ExpandProperty AuditData\n4. Standard fields always present: CreationTime, Id, Operation, OrganizationId, RecordType, UserKey, UserType, Version, Workload\n5. Additional fields vary by RecordType (service)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-schema"
    },
    {
      "settingName": "AuditLogRetentionPolicy",
      "displayName": "Microsoft 365 Audit Log Retention Policy",
      "settingPath": "RetentionDuration",
      "policyType": "Purview",
      "policySubType": "AuditRetention",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 365,
      "validationOperator": ">=",
      "description": "Configures audit log retention period to retain records for minimum 1 year (365 days). Default is 180 days for Audit Standard; E5 licenses support up to 10 years. Retention policies determine how long audit records are retained and searchable.",
      "implementationGuide": "1. Verify licensing (E5 or Audit add-on required for 1 year retention)\n2. Navigate to Microsoft Purview compliance portal > Audit > Retention policies\n3. Click '+ Create' to create new retention policy\n4. Configure policy settings:\n   - Name: 'NIST-Required-1Year-Retention'\n   - Record types: Select AzureActiveDirectory, Exchange, SharePoint, OneDrive\n   - Duration: 1 year (365 days minimum)\n   - Priority: 1 (highest)\n5. Review and create policy\n6. Verify with PowerShell: Get-UnifiedAuditLogRetentionPolicy | FL\n7. Note: Default retention for E5 users is 1 year for Exchange, SharePoint, Azure AD; 180 days for other services\n8. For extended retention beyond 1 year, use Azure Log Analytics workspace with custom retention",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies"
    },
    {
      "settingName": "LogAnalyticsRetention",
      "displayName": "Azure AD Log Analytics Workspace Retention",
      "settingPath": "properties.retentionInDays",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 365,
      "validationOperator": ">=",
      "description": "Configures Log Analytics workspace retention for Azure AD audit and sign-in logs to retain data beyond the default 30-day portal retention. Recommended minimum 365 days for compliance. Supports retention up to 2 years (730 days) without additional cost tiers.",
      "implementationGuide": "1. Prerequisites: Azure subscription, Log Analytics workspace created\n2. Configure diagnostic settings to send to Log Analytics (if not done):\n   - Azure Portal > Azure AD > Diagnostic settings\n   - Enable AuditLogs and SignInLogs\n   - Select destination: Log Analytics workspace\n3. Configure retention in Log Analytics:\n   - Azure Portal > Log Analytics workspaces > Select workspace\n   - Settings > Usage and estimated costs > Data Retention\n   - Move slider to desired retention (365 days minimum)\n   - Click OK to save\n4. Verify retention: Workspace > General > Properties > Data Retention\n5. Alternative: Archive to Azure Storage Account for indefinite retention at lower cost\n6. Query retention settings: workspace | project RetentionInDays",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/azure-monitor/logs/data-retention-archive"
    },
    {
      "settingName": "MailboxAuditLogAgeLimit",
      "displayName": "Mailbox Audit Log Age Limit",
      "settingPath": "AuditLogAgeLimit",
      "policyType": "Purview",
      "policySubType": "MailboxAudit",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 180,
      "validationOperator": ">=",
      "description": "Configures retention period for mailbox audit logs. Default is 90 days; can be configured up to 180 days for mailbox-level retention. For longer retention, logs must be exported to unified audit log or external storage. CIS Benchmark recommends enabling with adequate retention.",
      "implementationGuide": "1. Check current mailbox audit retention:\n   Get-Mailbox -ResultSize Unlimited | Select UserPrincipalName,AuditLogAgeLimit\n2. Default retention varies by license:\n   - E3: 90 days\n   - E5: 180 days (via unified audit log)\n3. Mailbox audit records automatically flow to unified audit log\n4. For long-term retention beyond 180 days:\n   - Use unified audit log retention policies (up to 1 year default for E5)\n   - Configure Azure Log Analytics for extended retention\n   - Export to external SIEM or archive system\n5. Verify retention in unified audit log:\n   Search-UnifiedAuditLog -RecordType ExchangeItem -StartDate (Get-Date).AddDays(-180)\n6. Note: AuditLogAgeLimit is a mailbox-level setting; unified audit log provides central retention",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/mailbox-auditing"
    },
    {
      "settingName": "StorageAccountArchiving",
      "displayName": "Azure Storage Account Archive for Audit Logs",
      "settingPath": "properties.storageAccountId",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "configured",
      "validationOperator": "!=",
      "description": "Configures Azure Storage Account as archival destination for Azure AD audit and sign-in logs to support long-term retention (up to 10+ years) at low cost with immutable storage options. Ideal for regulatory compliance requiring multi-year retention.",
      "implementationGuide": "1. Create Azure Storage Account:\n   - Azure Portal > Storage accounts > + Create\n   - Select subscription, resource group, unique name\n   - Performance: Standard, Replication: LRS or GRS\n   - Enable hierarchical namespace for better organization\n2. Configure diagnostic settings for archival:\n   - Azure AD > Diagnostic settings > Add diagnostic setting\n   - Name: 'AzureAD-Archive-Long-Term'\n   - Select: AuditLogs, SignInLogs\n   - Destination: Archive to storage account\n   - Select storage account created above\n   - Retention: 0 (indefinite) or specific days\n3. Enable immutable storage (optional but recommended):\n   - Storage account > Data protection > Immutability policy\n   - Configure time-based retention policy\n4. Verify archival: Storage account > Containers > insights-logs-audit/signin\n5. Cost optimization: Configure lifecycle management to move old logs to Cool or Archive tier",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/quickstart-azure-monitor-route-logs-to-storage-account"
    },
    {
      "settingName": "AuditLogFailureAlertPolicy",
      "displayName": "Alert Policy for Audit Logging Failures",
      "settingPath": "AlertPolicyEnabled",
      "policyType": "Purview",
      "policySubType": "AlertPolicy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Creates and enables alert policy to notify administrators when audit logging process failures occur, including when audit log ingestion is disabled, audit capacity issues arise, or audit log service disruptions occur. CIS Benchmark recommendation for audit monitoring.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal > Policies > Alert policies\n2. Click '+ New alert policy'\n3. Configure policy:\n   - Name: 'Audit Logging Failure Alert'\n   - Description: 'Alert when audit logging is disabled or fails'\n   - Severity: High\n   - Category: Threat management\n   - Activity: 'Disabled audit log search' or 'Set-AdminAuditLogConfig'\n   - Trigger: Every time an activity matches the rule\n4. Configure notifications:\n   - Email: Add security team/admin email addresses\n   - Daily notification limit: 20 (adjust as needed)\n5. Turn on policy immediately\n6. Create additional alert for audit log operations:\n   New-ActivityAlert -Name \"Audit Config Changes\" -Operation \"Set-AdminAuditLogConfig\" -NotifyUser \"admin@domain.com\" -EmailCulture en-US\n7. Test alert: Temporarily disable and re-enable audit log (in test environment)\n8. Verify alert received within 30 minutes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/alert-policies"
    },
    {
      "settingName": "DiagnosticSettingsHealthMonitoring",
      "displayName": "Azure AD Diagnostic Settings Health Monitoring",
      "settingPath": "properties.logs[].enabled",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Monitors health of Azure AD diagnostic settings to detect when log streaming to Log Analytics or Storage Account fails. When diagnostic settings are disabled or experience ingestion failures, Azure generates service health notifications and metrics alerts can be configured.",
      "implementationGuide": "1. Verify diagnostic settings are configured and active:\n   - Azure Portal > Azure AD > Diagnostic settings\n   - Verify status shows 'Enabled' for AuditLogs and SignInLogs\n2. Configure Azure Monitor alert for diagnostic setting failures:\n   - Azure Portal > Monitor > Alerts > + New alert rule\n   - Scope: Select Log Analytics workspace receiving Azure AD logs\n   - Condition: Custom log search\n   - Query: Heartbeat | where TimeGenerated > ago(1h) | summarize count() by Computer\n   - Alert logic: Less than 1 result (indicates no logs received)\n   - Evaluation frequency: 15 minutes\n3. Configure action group:\n   - Name: 'Azure-AD-Log-Failure-Notification'\n   - Add email/SMS notifications to security team\n4. Alternative - Service Health alerts:\n   - Azure Portal > Service Health > Health alerts\n   - Create alert rule for Azure Active Directory service\n   - Enable notifications for Service issues and Security advisories\n5. Test alert: Temporarily disable diagnostic setting (test environment only)\n6. Verify workspace ingestion: Log Analytics > Logs > Run query: AuditLogs | summarize count() by TimeGenerated",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-create-new-alert-rule"
    },
    {
      "settingName": "AuditLogCapacityMonitoring",
      "displayName": "Audit Log Storage Capacity Monitoring",
      "settingPath": "AuditLogStorageQuota",
      "policyType": "Purview",
      "policySubType": "AuditConfiguration",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Monitored",
      "validationOperator": "==",
      "description": "Monitors unified audit log storage capacity to detect when approaching limits and prevent audit record loss. While M365 unified audit log storage is effectively unlimited, monitoring ensures log Analytics workspace or storage account destinations don't reach capacity limits.",
      "implementationGuide": "1. Monitor unified audit log health:\n   - Microsoft Purview compliance portal > Audit\n   - Check for any warning banners about audit capacity\n   - Microsoft automatically manages unified audit log storage\n2. Monitor Log Analytics workspace capacity (if used):\n   - Azure Portal > Log Analytics workspace > Usage and estimated costs\n   - Review daily ingestion volume and trends\n   - Set up alert for daily cap approach (if cap is set)\n   - Configure alert: Workspace > Monitoring > Alerts > + New alert rule\n   - Condition: 'Data collection volume approaching daily cap'\n3. Monitor Storage Account capacity (if archiving):\n   - Storage account > Monitoring > Metrics\n   - Monitor 'Used capacity' metric\n   - Create alert when reaching 80% of subscription quota\n4. Create custom alert for audit record generation rate:\n   - Use PowerShell to query record count trends\n   - Alert if sudden drop indicates logging failure\n5. Document response procedures:\n   - Who receives alerts\n   - Escalation procedures\n   - Actions to take (increase capacity, archive old logs, etc.)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-search"
    },
    {
      "settingName": "AlertNotificationConfiguration",
      "displayName": "Audit Alert Notification Recipients",
      "settingPath": "AlertPolicy.NotifyUser",
      "policyType": "Purview",
      "policySubType": "AlertPolicy",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"configured\"]",
      "validationOperator": "contains",
      "description": "Configures email notification recipients for audit logging failure alerts to ensure organizational personnel are notified promptly. Recipients should include security operations team, compliance officers, and system administrators with authority to respond to audit failures.",
      "implementationGuide": "1. Define organizational roles/personnel for audit alerts:\n   - Security Operations Center (SOC) team email\n   - Compliance Officer(s)\n   - IT System Administrators\n   - IT Security Manager\n2. Configure notification recipients in alert policies:\n   - Purview portal > Policies > Alert policies\n   - Edit existing audit alert policies\n   - Update 'Send this alert to' field with email addresses\n   - Add distribution list for broader coverage\n3. Configure alert aggregation settings:\n   - Daily notification limit: Set based on expected alert volume\n   - Email notifications: Enabled\n   - Alert dashboard: Enable for centralized monitoring\n4. Test notification delivery:\n   - Trigger test alert (in test environment)\n   - Verify all recipients receive notification\n   - Confirm notification arrives within defined time period\n5. Document notification procedures:\n   - Response time requirements (e.g., 1 hour for critical alerts)\n   - Escalation matrix\n   - After-hours contact procedures\n6. Review and update recipient list quarterly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/alert-policies"
    },
    {
      "settingName": "ServiceHealthAlertConfiguration",
      "displayName": "Azure Service Health Alerts for Audit Services",
      "settingPath": "ServiceHealthAlertEnabled",
      "policyType": "AzureAD",
      "policySubType": "ServiceHealth",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Configures Azure Service Health alerts to notify administrators of service incidents, planned maintenance, or health advisories affecting Azure AD, Microsoft 365, or audit logging services. Provides early warning of platform-level audit logging disruptions.",
      "implementationGuide": "1. Navigate to Azure Portal > Service Health > Health alerts\n2. Click '+ Create service health alert'\n3. Configure alert rule:\n   - Scope: Select subscription(s)\n   - Condition:\n     * Services: Select 'Azure Active Directory', 'Microsoft 365 suite'\n     * Regions: All regions (global services)\n     * Event types: Service issues, Planned maintenance, Health advisories, Security advisories\n4. Configure actions:\n   - Action group name: 'Service-Health-Audit-Notifications'\n   - Notification type: Email/SMS/Push/Voice\n   - Add recipients: Security team, IT admins, Compliance officers\n5. Configure alert rule details:\n   - Name: 'Azure AD and M365 Service Health Alerts'\n   - Description: 'Alerts for service disruptions affecting audit logging'\n   - Severity: Sev 1 (Critical)\n   - Enable alert rule: Yes\n6. Create alert rule\n7. Test: Azure occasionally runs service health test notifications\n8. Review Service Health dashboard regularly: Azure Portal > Service Health > Service issues",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal"
    },
    {
      "settingName": "UnifiedAuditLogIngestionEnabled",
      "displayName": "Unified Audit Log Enabled",
      "settingPath": "AdminAuditLogConfig.UnifiedAuditLogIngestionEnabled",
      "policyType": "Purview",
      "policySubType": "AuditLogging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables unified audit logging across Microsoft 365 services to capture user and admin activities for review and analysis. This is the foundational setting that enables audit log collection for Exchange Online, SharePoint Online, OneDrive, Azure AD, Teams, and other M365 services.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Select 'Audit' from the left navigation\n3. Click 'Start recording user and admin activity' if not already enabled\n4. Verify status by running PowerShell: Connect-ExchangeOnline; Get-AdminAuditLogConfig | Format-List UnifiedAuditLogIngestionEnabled\n5. Document the enablement date and verify logs are being generated within 24 hours",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-enable-disable"
    },
    {
      "settingName": "AuditLogRetentionPolicy",
      "displayName": "Audit Log Retention Duration",
      "settingPath": "AuditRetentionPolicy.RetentionDuration",
      "policyType": "Purview",
      "policySubType": "AuditRetention",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 365,
      "validationOperator": ">=",
      "description": "Sets the retention period for audit logs to minimum 1 year (365 days) to enable historical analysis and incident investigations. E5 licensed users automatically get 1-year retention; non-E5 users get 180 days by default.",
      "implementationGuide": "1. Ensure users have E5 or Microsoft 365 E5 Compliance licenses for 1-year retention\n2. Navigate to Microsoft Purview compliance portal\n3. Go to Solutions > Audit > Retention policies\n4. Review default retention policy (retains all Exchange, SharePoint, OneDrive, Azure AD logs for 1 year for E5 users)\n5. Create custom retention policies if needed for specific record types or longer retention (up to 10 years with add-on licenses)\n6. Verify retention settings: Get-UnifiedAuditLogRetentionPolicy in PowerShell",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies"
    },
    {
      "settingName": "DiagnosticSettings",
      "displayName": "Azure AD Diagnostic Settings for SIEM Integration",
      "settingPath": "AzureAD.DiagnosticSettings",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"destination\":\"LogAnalytics or EventHub\"}",
      "validationOperator": "==",
      "description": "Configures Azure AD to export audit and sign-in logs to Log Analytics workspace or Event Hub for centralized monitoring, correlation, and analysis in Microsoft Sentinel or third-party SIEM solutions. This enables automated analysis and correlation of audit records across different repositories.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as at least Security Administrator\n2. Navigate to Entra ID > Monitoring & health > Diagnostic settings\n3. Click '+ Add diagnostic setting'\n4. Name the setting (e.g., 'Export to Sentinel')\n5. Select log categories: AuditLogs, SignInLogs, RiskyUsers (at minimum)\n6. Choose destination: 'Send to Log Analytics workspace' or 'Stream to an event hub'\n7. Select the Log Analytics workspace where Microsoft Sentinel is deployed\n8. Click Save\n9. Verify logs are flowing to destination within 15 minutes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs"
    },
    {
      "settingName": "SentinelAnalyticsRules",
      "displayName": "Microsoft Sentinel Analytics Rules for Audit Log Monitoring",
      "settingPath": "Sentinel.AnalyticsRules",
      "policyType": "Defender",
      "policySubType": "SentinelAnalytics",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"AnomalousSignIn\",\"PrivilegedAccountActivity\",\"UnusualAdminActivity\"]",
      "validationOperator": "contains",
      "description": "Implements automated analytics rules in Microsoft Sentinel to continuously monitor and analyze audit logs for suspicious patterns, anomalous behavior, and security incidents. Rules should detect unusual sign-ins, privileged account abuse, unauthorized access attempts, and configuration changes.",
      "implementationGuide": "1. Ensure Microsoft Sentinel is enabled on Log Analytics workspace\n2. Navigate to Microsoft Sentinel > Analytics\n3. Enable recommended built-in rules from templates including:\n   - 'Anomalous sign-in location by user account and authenticating application'\n   - 'Admin promotion after Role Management Application Permission Grant'\n   - 'Multiple admin membership removals from newly created admin'\n   - 'Rare application consent'\n4. Configure rule frequency (recommended: 5 minutes to hourly based on rule type)\n5. Set appropriate severity levels and entity mappings\n6. Configure alert grouping and incident creation\n7. Test rules and adjust thresholds to minimize false positives\n8. Document alerting procedures and assign incident response personnel",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/sentinel/detect-threats-built-in"
    },
    {
      "settingName": "MailboxAuditingEnabled",
      "displayName": "Mailbox Audit Logging Enabled",
      "settingPath": "OrganizationConfig.AuditDisabled",
      "policyType": "Purview",
      "policySubType": "ExchangeAuditing",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Ensures mailbox audit logging is enabled organization-wide to capture mailbox access and actions by owners, delegates, and administrators. When AuditDisabled is False, mailbox auditing is active. This captures critical email-related activities for security review and compliance.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell: Connect-ExchangeOnline\n2. Check organization-wide status: Get-OrganizationConfig | Format-List AuditDisabled\n3. If AuditDisabled is True, enable by running: Set-OrganizationConfig -AuditDisabled $false\n4. Verify mailbox auditing for specific mailbox: Get-Mailbox user@domain.com | Format-List AuditEnabled\n5. Mailbox auditing logs are retained for 180 days by default\n6. Search mailbox audit logs in Purview compliance portal: Audit > Search > Mailbox activities\n7. Document that mailbox auditing is enabled for all mailboxes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-mailboxes"
    },
    {
      "settingName": "LogAnalyticsWorkspace",
      "displayName": "Log Analytics Workspace for Audit Analysis",
      "settingPath": "LogAnalytics.Workspace",
      "policyType": "Defender",
      "policySubType": "LogAnalytics",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"retentionDays\":90}",
      "validationOperator": "==",
      "description": "Deploys Azure Log Analytics workspace as the centralized repository for audit record storage, analysis, and reporting. Log Analytics provides powerful KQL (Kusto Query Language) capabilities for audit record reduction, filtering, and custom report generation without altering original audit data.",
      "implementationGuide": "1. Navigate to Azure Portal > Log Analytics workspaces\n2. Click '+ Create' to create new workspace or use existing\n3. Select subscription, resource group, and region\n4. Name the workspace (e.g., 'M365-Audit-Workspace')\n5. Choose pricing tier (Pay-as-you-go recommended for flexibility)\n6. Set data retention to minimum 90 days (up to 730 days available)\n7. Review and create the workspace\n8. Once created, note the Workspace ID and Primary Key\n9. Configure Microsoft 365 and Azure AD to send audit logs to this workspace via Diagnostic Settings\n10. Enable Microsoft Sentinel on this workspace for advanced analytics",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-workspace-overview"
    },
    {
      "settingName": "SentinelWorkbooks",
      "displayName": "Microsoft Sentinel Workbooks for Audit Reporting",
      "settingPath": "Sentinel.Workbooks",
      "policyType": "Defender",
      "policySubType": "SentinelReporting",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"AzureADSignIns\",\"AuditLogs\",\"SecurityOperations\"]",
      "validationOperator": "contains",
      "description": "Implements pre-built and custom workbooks in Microsoft Sentinel for visualizing and reporting on audit data. Workbooks provide interactive, summarized views of audit records for executive reporting, compliance demonstrations, and operational security monitoring without modifying source data.",
      "implementationGuide": "1. Navigate to Microsoft Sentinel > Workbooks\n2. Select 'Templates' tab to view available workbook templates\n3. Deploy recommended audit-focused workbooks:\n   - 'Azure AD Audit, Activity and Sign-in logs'\n   - 'Azure Activity'\n   - 'Office 365'\n   - 'Identity & Access'\n4. Click on template and select 'Save' to create instance\n5. Customize workbooks by clicking 'Edit' to add organization-specific queries\n6. Create custom workbooks for specific reporting requirements:\n   - Privileged account activity summaries\n   - Failed authentication attempts by time period\n   - Configuration changes summary\n7. Schedule workbook exports using Azure Logic Apps if needed\n8. Share workbooks with appropriate stakeholders",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/sentinel/monitor-your-data"
    },
    {
      "settingName": "AuditLogSearch",
      "displayName": "Microsoft Purview Audit Log Search",
      "settingPath": "Purview.AuditSearch",
      "policyType": "Purview",
      "policySubType": "AuditSearch",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"exportCapability\":true}",
      "validationOperator": "==",
      "description": "Leverages Microsoft Purview unified audit log search functionality to query, filter, and export audit records across Microsoft 365 services. Provides on-demand search and export capabilities for detailed audit record analysis and report generation while preserving original record integrity.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Select 'Audit' from Solutions menu\n3. Click 'Search' tab to access audit log search interface\n4. Configure search parameters:\n   - Date range (up to 90 days for standard search, 10 years for advanced)\n   - Activities (select specific events or use 'Show results for all activities')\n   - Users (specific users or all users)\n   - File/folder/site filters as needed\n5. Run search and review results\n6. Export results to CSV for further analysis or reporting:\n   - Click 'Export' button\n   - Choose 'Download all results' or 'Download loaded results'\n7. Use PowerShell for advanced searches: Search-UnifiedAuditLog cmdlet\n8. Document standard search queries for regular reporting needs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-search"
    },
    {
      "settingName": "KQLQueries",
      "displayName": "KQL Queries for Audit Record Analysis",
      "settingPath": "LogAnalytics.SavedQueries",
      "policyType": "Defender",
      "policySubType": "LogAnalyticsQueries",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"FailedSignIns\",\"AdminChanges\",\"PrivilegedAccess\"]",
      "validationOperator": "contains",
      "description": "Creates and maintains library of standardized KQL queries for common audit analysis scenarios including failed authentication attempts, privileged account activity, configuration changes, and data access patterns. Queries perform audit record reduction by summarizing and filtering large datasets while preserving original audit data.",
      "implementationGuide": "1. Navigate to Azure Portal > Log Analytics workspace > Logs\n2. Create essential audit analysis queries:\n   a) Failed Sign-ins Summary:\n      SigninLogs | where ResultType != 0 | summarize Count=count() by UserPrincipalName, ResultType, bin(TimeGenerated, 1h)\n   b) Admin Role Changes:\n      AuditLogs | where Category == 'RoleManagement' | project TimeGenerated, OperationName, InitiatedBy, TargetResources\n   c) Privileged Account Activity:\n      AuditLogs | where InitiatedBy.user.userPrincipalName in ('admin1@domain.com', 'admin2@domain.com') | summarize Operations=count() by OperationName, bin(TimeGenerated, 1d)\n3. Save queries with descriptive names and categories\n4. Create query packs for team sharing\n5. Document query purpose and expected outputs\n6. Test queries regularly to ensure accuracy\n7. Create scheduled query rules for automated reporting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/azure-monitor/logs/queries"
    },
    {
      "settingName": "WindowsTimeServiceConfiguration",
      "displayName": "Windows Time Service (W32Time) NTP Configuration",
      "settingPath": "Intune.DeviceConfiguration.WindowsTimeService",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"Type\":\"NTP\",\"NtpServer\":\"time.windows.com,0x9\",\"enabled\":true}",
      "validationOperator": "==",
      "description": "Configures Windows Time Service on domain-joined and Azure AD-joined devices to synchronize with reliable external NTP sources using Coordinated Universal Time (UTC). This ensures consistent, accurate time stamps across all systems for audit record correlation and compliance with Kerberos authentication requirements.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://intune.microsoft.com)\n2. Navigate to Devices > Configuration profiles > Create profile\n3. Select Platform: Windows 10 and later\n4. Select Profile type: Templates > Administrative Templates\n5. Create profile named 'Windows Time Service Configuration'\n6. Configure settings under Computer Configuration > System > Windows Time Service:\n   a) 'Global Configuration Settings' = Enabled, AnnounceFlags = 5\n   b) 'Configure Windows NTP Client' = Enabled:\n      - NtpServer: time.windows.com,0x9 (or organization's NTP server)\n      - Type: NTP\n      - CrossSiteSyncFlags: 2\n      - ResolvePeerBackoffMinutes: 15\n      - SpecialPollInterval: 64\n   c) 'Enable Windows NTP Client' = Enabled\n7. Assign to appropriate device groups (All Windows devices)\n8. Monitor compliance and verify time sync: w32tm /query /status",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-server/networking/windows-time-service/windows-time-service-tools-and-settings"
    },
    {
      "settingName": "AzureADTimeSync",
      "displayName": "Azure AD Joined Device Time Synchronization",
      "settingPath": "Intune.DeviceCompliance.TimeSync",
      "policyType": "Intune",
      "policySubType": "CompliancePolicy",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"timeSyncRequired\":true,\"maxTimeOffset\":300}",
      "validationOperator": "<=",
      "description": "Enforces time synchronization compliance for Azure AD joined and hybrid joined devices. Devices must maintain time accuracy within 5 minutes (300 seconds) of UTC time to remain compliant. Azure AD-joined devices automatically sync with Azure time infrastructure which uses UTC.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Compliance policies\n2. Create new compliance policy for each platform (Windows, iOS, Android, macOS)\n3. Configure 'System Security' settings:\n   - Windows: 'Require BitLocker' includes time sync validation\n   - iOS/Android: Time sync is inherent to OS functionality\n   - macOS: Enable 'Require encryption of data storage on device'\n4. Set compliance timeframe for remediation (e.g., 3 days)\n5. Configure actions for noncompliance:\n   - Send email to end user immediately\n   - Mark device noncompliant after 1 day\n   - Retire noncompliant device after 7 days (optional based on org policy)\n6. Assign policy to All Devices or specific groups\n7. Monitor compliance reports: Devices > Monitor > Noncompliant devices\n8. Azure AD automatically handles time sync for cloud-joined devices",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "AzureADSignInLogTimeStamps",
      "displayName": "Azure AD Sign-in Log Time Stamps (UTC)",
      "settingPath": "AzureAD.SignInLogs.TimeGenerated",
      "policyType": "AzureAD",
      "policySubType": "Logging",
      "platform": "All",
      "dataType": "datetime",
      "expectedValue": "UTC",
      "validationOperator": "==",
      "description": "Azure AD automatically records all sign-in events with UTC time stamps in ISO 8601 format. The 'TimeGenerated' and 'CreatedDateTime' fields in Azure AD sign-in logs use UTC time with millisecond granularity, ensuring precise time correlation across global deployments.",
      "implementationGuide": "1. This is a built-in Azure AD capability that requires no configuration\n2. All Azure AD sign-in logs automatically use UTC time stamps\n3. Verify time stamp format by querying logs:\n   - Navigate to Entra admin center > Sign-in logs\n   - View any sign-in event\n   - Confirm 'Date (UTC)' column shows time in UTC format\n4. When exporting logs via API or PowerShell, verify time format:\n   Get-MgAuditLogSignIn -Top 1 | Select-Object CreatedDateTime\n5. When integrating with SIEM, configure time zone handling:\n   - Log Analytics/Sentinel automatically preserves UTC\n   - Third-party SIEMs may need UTC configuration\n6. Document that all Azure AD audit events use UTC time stamps\n7. Train analysts on UTC time interpretation for investigations",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/concept-sign-ins"
    },
    {
      "settingName": "UnifiedAuditLogTimeStamps",
      "displayName": "Microsoft 365 Unified Audit Log Time Stamps (UTC)",
      "settingPath": "UnifiedAuditLog.CreationTime",
      "policyType": "Purview",
      "policySubType": "AuditLogging",
      "platform": "All",
      "dataType": "datetime",
      "expectedValue": "UTC",
      "validationOperator": "==",
      "description": "Microsoft 365 unified audit log automatically timestamps all audit records in UTC format with second-level granularity. The 'CreationTime' field records when the event occurred using UTC, ensuring consistent time references across Exchange Online, SharePoint, Teams, OneDrive, and other M365 services.",
      "implementationGuide": "1. This is a built-in Microsoft 365 capability requiring no configuration\n2. All unified audit log entries automatically use UTC time stamps\n3. Verify time stamp format:\n   - Navigate to Purview compliance portal > Audit > Search\n   - Run any audit log search\n   - Review 'Date' column showing UTC time\n4. When using PowerShell to search audit logs:\n   Search-UnifiedAuditLog -StartDate (Get-Date).AddDays(-1) -EndDate (Get-Date)\n   - StartDate and EndDate are automatically converted to UTC\n   - Results show CreationDate in UTC\n5. When exporting audit logs:\n   - CSV exports include UTC time stamps\n   - API queries return ISO 8601 UTC format\n6. Configure SIEM or analysis tools to interpret UTC correctly\n7. Document UTC usage in audit procedures and investigation guides",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-activities"
    },
    {
      "settingName": "TimeServiceMonitoring",
      "displayName": "Windows Time Service Health Monitoring",
      "settingPath": "Intune.DeviceCompliance.TimeServiceStatus",
      "policyType": "Intune",
      "policySubType": "ComplianceMonitoring",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Running",
      "validationOperator": "==",
      "description": "Monitors the Windows Time Service (W32Time) status on managed Windows devices to ensure continuous time synchronization. Devices with stopped or disabled time services are flagged as noncompliant to prevent audit time stamp inaccuracies.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Scripts\n2. Create PowerShell script for time service validation:\n   $w32time = Get-Service W32Time\n   $timeSource = w32tm /query /source\n   if ($w32time.Status -ne 'Running' -or $timeSource -eq 'Local CMOS Clock') {\n       exit 1  # Non-compliant\n   }\n   exit 0  # Compliant\n3. Configure script settings:\n   - Run script using logged-on credentials: No\n   - Enforce script signature check: No\n   - Run script in 64-bit PowerShell: Yes\n4. Assign to All Windows devices\n5. Schedule to run daily\n6. Create remediation script if needed:\n   net start w32time\n   w32tm /resync /nowait\n7. Monitor compliance: Devices > Monitor > Device compliance\n8. Configure alert policy for noncompliant devices\n9. Review time sync status in device inventory reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension"
    },
    {
      "settingName": "AuditLogRBACRoles",
      "displayName": "Audit Log Access - RBAC Role Assignment",
      "settingPath": "AzureAD.RoleAssignments.AuditLogs",
      "policyType": "AzureAD",
      "policySubType": "RoleBasedAccessControl",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"Reports Reader\",\"Security Reader\",\"Security Administrator\"]",
      "validationOperator": "in",
      "description": "Restricts access to Azure AD audit logs to users with specific privileged roles (Reports Reader, Security Reader, Security Administrator, or Global Administrator). This prevents unauthorized access to sensitive audit information and limits audit log viewing to authorized security personnel only.",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Roles and administrators\n2. Review current role assignments for audit-related roles:\n   - Reports Reader (microsoft.directory/auditLogs/allProperties/read)\n   - Security Reader (can read security info and reports)\n   - Security Administrator (can read security info and manage security settings)\n3. Assign roles using least privilege principle:\n   a) For audit log viewing only: Reports Reader\n   b) For security monitoring: Security Reader\n   c) For security operations: Security Administrator\n4. Remove unnecessary Global Administrator assignments\n5. Document role assignments in access control matrix\n6. Review assignments quarterly:\n   Get-MgDirectoryRoleMember -DirectoryRoleId (Get-MgDirectoryRole -Filter \"DisplayName eq 'Reports Reader'\").Id\n7. Enable PIM (Privileged Identity Management) for just-in-time access to these roles\n8. Configure access reviews for privileged role assignments\n9. Monitor audit log for role assignment changes (Category: RoleManagement)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference"
    },
    {
      "settingName": "AuditLogManagementRestriction",
      "displayName": "Restrict Audit Log Management to Privileged Subset",
      "settingPath": "AzureAD.RoleAssignments.AuditManagement",
      "policyType": "AzureAD",
      "policySubType": "RoleBasedAccessControl",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"Compliance Administrator\",\"Security Administrator\"]",
      "validationOperator": "in",
      "description": "Limits management of audit logging functionality (enabling/disabling audit logging, configuring retention, managing diagnostic settings) to a restricted subset of privileged users. Only Compliance Administrators and Security Administrators should have permissions to modify audit configurations.",
      "implementationGuide": "1. Navigate to Entra admin center > Roles and administrators\n2. Identify roles with audit management permissions:\n   - Compliance Administrator: Can manage audit settings in Purview\n   - Security Administrator: Can configure diagnostic settings\n   - Global Administrator: Has full access (should be limited)\n3. Review current assignments:\n   Get-MgDirectoryRoleMember -DirectoryRoleId (Get-MgDirectoryRole -Filter \"DisplayName eq 'Compliance Administrator'\").Id\n4. Implement least privilege:\n   - Assign Compliance Administrator only to personnel responsible for compliance\n   - Limit Security Administrator to security operations team\n   - Reduce Global Administrator count to minimum (2-3 break-glass accounts)\n5. Create custom roles if needed for more granular control\n6. Enable Privileged Identity Management (PIM):\n   - Configure eligible assignments instead of permanent\n   - Require justification and approval for role activation\n   - Set maximum activation duration (e.g., 8 hours)\n7. Configure alert for audit configuration changes:\n   - Monitor for 'Set-AdminAuditLogConfig' operations\n   - Alert on diagnostic setting modifications\n8. Document all audit management role holders",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure"
    },
    {
      "settingName": "LogAnalyticsWorkspaceRBAC",
      "displayName": "Log Analytics Workspace Access Control",
      "settingPath": "LogAnalytics.Workspace.AccessControl",
      "policyType": "Defender",
      "policySubType": "WorkspaceRBAC",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"accessMode\":\"Resource\",\"minRole\":\"Reader\"}",
      "validationOperator": "==",
      "description": "Implements Azure RBAC on Log Analytics workspace containing audit logs to control who can read, query, or manage audit data. Resource-level permissions ensure users can only access audit logs they're authorized to view, protecting audit information from unauthorized access.",
      "implementationGuide": "1. Navigate to Azure Portal > Log Analytics workspace > Access control (IAM)\n2. Review current role assignments:\n   - Owner: Full control (limit to 2-3 workspace administrators)\n   - Contributor: Can manage all resources except permissions\n   - Log Analytics Reader: Read-only access to logs (assign to SOC analysts)\n   - Log Analytics Contributor: Can manage workspace but not grant access\n3. Configure resource-level permissions:\n   - Settings > Workspace configuration > Access control mode\n   - Select 'Use resource or workspace permissions' (recommended)\n4. Assign roles based on job function:\n   - Security analysts: Log Analytics Reader\n   - Security engineers: Log Analytics Contributor  \n   - Compliance officers: Reader (for reporting only)\n5. Remove unnecessary Owner and Contributor assignments\n6. Configure Azure AD group-based access:\n   - Create 'Security Operations - Audit Readers' Azure AD group\n   - Assign Log Analytics Reader role to group\n   - Manage access via group membership\n7. Enable activity logging for workspace:\n   - Diagnostic settings > Add diagnostic setting\n   - Select 'Audit' log category\n   - Send to separate workspace to prevent tampering\n8. Monitor access: Review 'Activity log' for permission changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/azure-monitor/logs/manage-access"
    },
    {
      "settingName": "AuditRetentionImmutability",
      "displayName": "Immutable Audit Log Retention",
      "settingPath": "Purview.AuditRetention.Immutability",
      "policyType": "Purview",
      "policySubType": "AuditRetention",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Microsoft 365 audit logs are immutable by design - once logged, entries cannot be modified or deleted by users, including Global Administrators. Audit records are retained according to retention policies and automatically deleted only when retention period expires, protecting audit integrity.",
      "implementationGuide": "1. This is a built-in Microsoft 365 capability - audit logs are immutable by default\n2. Verify audit log immutability:\n   - Users cannot modify or delete individual audit log entries\n   - Only retention policies can remove logs after expiration\n   - Even Global Administrators cannot alter audit records\n3. Configure audit retention policies to meet compliance requirements:\n   - Navigate to Purview > Audit > Retention policies\n   - Default: 180 days (Standard), 365 days (E5 users)\n   - Create custom policies for extended retention (up to 10 years)\n4. Export audit logs for long-term archival if needed:\n   - Regular exports to Azure Storage (immutable blob storage)\n   - Enable write-once-read-many (WORM) policy on storage\n5. Configure alert for retention policy changes:\n   - Monitor AuditLogs for 'New-UnifiedAuditLogRetentionPolicy' operations\n   - Alert on 'Set-UnifiedAuditLogRetentionPolicy' modifications\n6. Document retention policies and legal hold requirements\n7. For extended protection, export to Azure Storage with legal hold:\n   - Create dedicated storage account for audit archives\n   - Enable version-level immutability with time-based retention",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies"
    },
    {
      "settingName": "DiagnosticSettingsProtection",
      "displayName": "Protect Diagnostic Settings from Unauthorized Changes",
      "settingPath": "AzureAD.DiagnosticSettings.RoleAssignment",
      "policyType": "AzureAD",
      "policySubType": "RoleBasedAccessControl",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Security Administrator",
      "validationOperator": "==",
      "description": "Restricts modification of Azure AD diagnostic settings (which control audit log export to SIEM/Log Analytics) to Security Administrators only. Prevents attackers or insiders from disabling audit log export to evade detection. Monitors and alerts on any diagnostic setting changes.",
      "implementationGuide": "1. Verify diagnostic settings permissions:\n   - Navigate to Entra admin center > Diagnostic settings\n   - Only users with these roles can modify settings:\n     * Security Administrator\n     * Global Administrator\n2. Review and limit role assignments:\n   - Minimize Global Administrators (2-3 maximum)\n   - Assign Security Administrator only to security operations leads\n   - Use PIM for just-in-time access\n3. Enable audit logging for diagnostic setting changes:\n   - Changes are logged in Azure Activity Log\n   - Category: 'microsoft.aadiam'\n   - Operation: 'Microsoft.Insights/DiagnosticSettings/Write'\n4. Create alert rule for diagnostic setting changes:\n   - Navigate to Azure Monitor > Alerts > Create alert rule\n   - Scope: All resources in subscription\n   - Condition: Activity Log - Administrative\n   - Operation name: 'Create or Update Diagnostic Setting'\n   - Create action group to notify security team\n5. Implement secondary monitoring:\n   - Use Microsoft Sentinel analytic rule\n   - Query: AzureActivity | where OperationNameValue == 'MICROSOFT.INSIGHTS/DIAGNOSTICSETTINGS/WRITE'\n6. Configure Azure Policy to enforce diagnostic settings:\n   - Policy: 'Deploy Diagnostic Settings for Azure AD to Log Analytics workspace'\n   - Assignment: Tenant root or management group level\n7. Document approved diagnostic setting changes in change log",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/howto-configure-diagnostic-settings"
    },
    {
      "settingName": "ConditionalAccessAuditProtection",
      "displayName": "Conditional Access Policy for Audit Tool Access",
      "settingPath": "AzureAD.ConditionalAccess.AuditAccess",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"requireMFA\":true,\"requireCompliantDevice\":true,\"blockLegacyAuth\":true}",
      "validationOperator": "==",
      "description": "Implements Conditional Access policy requiring MFA and compliant devices when accessing audit logs, Purview compliance portal, Azure Monitor, or Sentinel. This adds an additional layer of protection for audit information and prevents unauthorized access even with compromised credentials.",
      "implementationGuide": "1. Navigate to Entra admin center > Protection > Conditional Access\n2. Create new policy: 'Audit Tool Access Protection'\n3. Configure Assignments:\n   Users: Include\n   - Security Administrators group\n   - Compliance Administrators group  \n   - Reports Readers group\n   Exclude: Break-glass accounts\n4. Cloud apps or actions: Select apps\n   - Microsoft Azure Management (Azure Portal/Azure Monitor)\n   - Office 365 (for Purview compliance portal)\n   - Microsoft Admin Portals\n5. Configure Conditions:\n   - Sign-in risk: High, Medium\n   - Device platforms: All\n   - Locations: Any location\n6. Access controls - Grant:\n   - Require multifactor authentication (checked)\n   - Require device to be marked as compliant (checked)\n   - Require all selected controls\n7. Session:\n   - Sign-in frequency: Every time\n   - Persistent browser session: Never persistent\n8. Enable policy and test with test user\n9. Monitor policy effectiveness: Sign-ins > Conditional Access\n10. Document policy in security procedures",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-cloud-apps"
    },
    {
      "settingName": "SecurityBaselineProfile",
      "displayName": "Windows Security Baseline Profile Deployment",
      "settingPath": "policies.securityBaseline.profile",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Deploys Microsoft's recommended Windows security baseline profile containing preconfigured security settings for Windows 10/11 devices. This baseline serves as the foundational security configuration for all managed endpoints.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Security baselines\n2. Select 'Security Baseline for Windows 10 and later'\n3. Click 'Create policy' and name it (e.g., 'Windows Security Baseline - Standard')\n4. Review default settings (BitLocker, authentication, Defender configurations)\n5. Assign to device groups representing all managed Windows endpoints\n6. Set deployment to 'Enabled' and save policy\n7. Monitor deployment status via Endpoint security > Security baselines > Monitor",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/security-baselines"
    },
    {
      "settingName": "DeviceCompliancePolicy",
      "displayName": "Device Compliance Policy - Baseline Configuration",
      "settingPath": "policies.compliance.configurationBaseline",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces that devices meet baseline security configuration requirements including minimum OS version, encryption, and security settings. Devices must maintain compliance with defined baseline to access resources.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Compliance > Policies\n2. Click 'Create policy' > Select 'Windows 10 and later'\n3. Name the policy (e.g., 'Windows Baseline Compliance')\n4. Configure compliance settings:\n   - Device Health: Require BitLocker, Secure Boot\n   - Device Properties: Minimum OS version (e.g., Windows 10 1909)\n   - System Security: Require device encryption, firewall enabled\n5. Set 'Mark devices with no compliance policy as' to 'Not compliant'\n6. Configure Actions for noncompliance (e.g., mark noncompliant immediately)\n7. Assign to device groups and save policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/device-compliance-get-started"
    },
    {
      "settingName": "RequireCompliantDevice",
      "displayName": "Conditional Access - Require Compliant Device",
      "settingPath": "conditionalAccess.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"compliantDevice\"]",
      "validationOperator": "contains",
      "description": "Enforces that only devices meeting baseline configuration requirements (marked as compliant in Intune) can access organizational resources. This ensures baseline adherence before resource access.",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Protection > Conditional Access > Policies\n2. Click 'New policy' and name it (e.g., 'Require Compliant Device - All Users')\n3. Under Assignments > Users: Select 'All users' (exclude emergency accounts)\n4. Under Assignments > Target resources: Select 'All cloud apps'\n5. Under Access controls > Grant: Select 'Require device to be marked as compliant'\n6. Set 'Enable policy' to 'On' (or 'Report-only' for testing)\n7. Click 'Create' to save the policy\n8. Monitor via Entra ID > Sign-in logs and Conditional Access > Insights and reporting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-all-users-device-compliance"
    },
    {
      "settingName": "ConfigurationBaseline.ReviewFrequency",
      "displayName": "Security Baseline Review and Update Schedule",
      "settingPath": "policies.securityBaseline.reviewSchedule",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "30-90 days",
      "validationOperator": "==",
      "description": "Ensures security baselines are reviewed and updated on a defined schedule (recommended quarterly) and when Microsoft releases new baseline versions. Supports systematic baseline maintenance.",
      "implementationGuide": "1. Establish baseline review schedule in change management process (recommend quarterly)\n2. Monitor Microsoft baseline updates via Intune admin center > Endpoint security > Security baselines\n3. When new versions available, review changes via 'Compare versions' option\n4. Create test deployment to pilot group first\n5. After validation, update production baseline profiles\n6. Document review date and version in baseline profile description\n7. Set calendar reminder for next review cycle (90 days)\n8. Monitor compliance via Security baselines > Monitor > Profile status",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/security-baselines-configure"
    },
    {
      "settingName": "BaselineMonitoring",
      "displayName": "Baseline Configuration Compliance Monitoring",
      "settingPath": "reporting.deviceCompliance.baselineStatus",
      "policyType": "Intune",
      "policySubType": "Reporting",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Continuous monitoring of device compliance with baseline configurations through Intune compliance reporting. Identifies deviations from baseline and non-compliant devices requiring remediation.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Monitor > Compliance status\n2. Review 'Compliance policy status' dashboard for baseline compliance metrics\n3. Click 'Device compliance' to view detailed per-device compliance status\n4. For Security Baselines: Go to Endpoint security > Security baselines > [Policy] > Monitor\n5. Review 'Device status' to identify non-compliant devices\n6. Set up automated email reports: Intune admin center > Reports > Export data\n7. Create scheduled exports for weekly baseline compliance reports\n8. Establish process to remediate non-compliant devices within defined SLA (e.g., 7 days)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/reports"
    },
    {
      "settingName": "DefenderBaselineProfile",
      "displayName": "Microsoft Defender for Endpoint Security Baseline",
      "settingPath": "policies.securityBaseline.defenderProfile",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Deploys Microsoft Defender for Endpoint security baseline containing recommended configurations for attack surface reduction rules, exploit protection, network protection, and controlled folder access.",
      "implementationGuide": "1. Navigate to Intune admin center > Endpoint security > Security baselines\n2. Select 'Security Baseline for Microsoft Defender for Endpoint'\n3. Click 'Create profile' and name it (e.g., 'Defender Baseline - Standard')\n4. Review and configure key settings:\n   - Attack surface reduction rules (enable recommended rules)\n   - Network protection (enabled in block mode)\n   - Controlled folder access (enabled)\n   - Exploit protection (enable system-level protections)\n5. Assign to device groups\n6. Set to 'Enabled' and save\n7. Monitor compliance via Endpoint security > Security baselines > Monitor",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/security-baseline-settings-defender"
    },
    {
      "settingName": "SecuritySettings.RestrictiveMode",
      "displayName": "Most Restrictive Configuration Settings Enforcement",
      "settingPath": "policies.deviceConfiguration.restrictiveSettings",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces most restrictive security configuration settings consistent with operational requirements through Intune device configuration profiles, including password policies, encryption, firewall rules, and application controls.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration > Create profile\n2. Select Platform: Windows 10 and later, Profile type: Settings catalog\n3. Name profile (e.g., 'Windows Restrictive Security Settings')\n4. Add key restrictive settings:\n   - Windows Security > Firewall: Enable Windows Defender Firewall (all profiles)\n   - Security > Encryption: Require device encryption\n   - Security > Password: Minimum password length (14 chars)\n   - Security > User Rights: Deny access to this computer from network (Guest)\n   - Windows Components > Remote Desktop: Do not allow passwords to be saved\n5. Document any deviations from most restrictive mode in description\n6. Assign to device groups and deploy\n7. Monitor compliance via Devices > Monitor > Device assignment status",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-profile-create"
    },
    {
      "settingName": "ConfigurationProfile.Documentation",
      "displayName": "Configuration Settings Documentation",
      "settingPath": "policies.deviceConfiguration.documentation",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Documented",
      "validationOperator": "==",
      "description": "Requires all device configuration profiles to include detailed documentation of settings, rationale, and any deviations from most restrictive mode. Documentation maintained in profile description and change control records.",
      "implementationGuide": "1. Establish configuration documentation standard template\n2. For each Intune configuration profile, include in Description field:\n   - Purpose and scope of configuration\n   - List of critical settings configured\n   - Justification for any settings less restrictive than maximum\n   - Approval authority and date\n   - Version number and last review date\n3. Maintain separate Configuration Settings Register (Excel/SharePoint):\n   - Profile name, ID, and description\n   - List of all settings with values\n   - Deviations from most restrictive mode with business justification\n   - Approval records\n4. Review and update documentation quarterly or when profiles change",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-profiles"
    },
    {
      "settingName": "PasswordPolicy.Complexity",
      "displayName": "Windows Hello for Business Password Complexity",
      "settingPath": "policies.deviceConfiguration.passwordComplexity",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"minimumLength\":14,\"requireUppercase\":true,\"requireLowercase\":true,\"requireNumbers\":true,\"requireSpecialCharacters\":true,\"passwordHistory\":24,\"maximumAge\":60}",
      "validationOperator": "==",
      "description": "Enforces restrictive password complexity requirements for Windows Hello for Business PIN and convenience PIN, implementing NIST password guidelines for authentication security.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration > Create profile\n2. Select Platform: Windows 10 and later, Profile type: Settings catalog\n3. Name profile 'Windows Hello Password Policy'\n4. Add settings from 'Windows Hello for Business' category:\n   - Use Windows Hello for Business: Yes\n   - Minimum PIN length: 14\n   - PIN complexity: Require digits, uppercase, lowercase, special characters\n   - PIN expiration (days): 60\n   - Remember PIN history: 24\n   - Allow simple passwords: No\n   - Require TPM: Yes (for hardware-backed credentials)\n5. Add from 'Local Security Options' > Security Options:\n   - Password must meet complexity requirements: Enabled\n6. Assign to user or device groups\n7. Deploy and monitor compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/hello-manage-in-organization"
    },
    {
      "settingName": "BitLocker.EncryptionSettings",
      "displayName": "BitLocker Drive Encryption Configuration",
      "settingPath": "policies.deviceConfiguration.bitLocker",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"systemDriveEncryption\":\"XTS-AES 256-bit\",\"fixedDriveEncryption\":\"XTS-AES 256-bit\",\"removableDriveEncryption\":\"AES-CBC 256-bit\",\"enablePrebootAuthentication\":true,\"requireTPM\":true}",
      "validationOperator": "==",
      "description": "Configures BitLocker with most secure encryption algorithms and settings including XTS-AES 256-bit encryption, TPM requirement, and preboot authentication for comprehensive data protection.",
      "implementationGuide": "1. Navigate to Intune admin center > Endpoint security > Disk encryption\n2. Click 'Create policy' > Platform: Windows 10 and later > Profile: BitLocker\n3. Name policy 'BitLocker Restrictive Encryption'\n4. Configure BitLocker settings:\n   - Operating System Drives:\n     * Require BitLocker: Yes\n     * Encryption method: XTS-AES 256-bit\n     * Require TPM: Yes\n     * Allow BitLocker without compatible TPM: No\n     * Require startup authentication: TPM with startup PIN\n   - Fixed Data Drives:\n     * Require encryption: Yes\n     * Encryption method: XTS-AES 256-bit\n   - Removable Data Drives:\n     * Require encryption: Yes\n     * Encryption method: AES-CBC 256-bit\n5. Assign to device groups\n6. Monitor encryption status via Reports > Device compliance > Encryption report",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/encrypt-devices"
    },
    {
      "settingName": "FirewallRules.RestrictivePolicy",
      "displayName": "Windows Defender Firewall Restrictive Rules",
      "settingPath": "policies.deviceConfiguration.firewallRules",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"domainProfile\":\"enabled\",\"privateProfile\":\"enabled\",\"publicProfile\":\"enabled\",\"defaultInboundAction\":\"block\",\"defaultOutboundAction\":\"allow\",\"logDroppedPackets\":true}",
      "validationOperator": "==",
      "description": "Enforces Windows Defender Firewall in most restrictive mode with block-by-default inbound rules, enabled on all network profiles, and comprehensive logging of dropped packets.",
      "implementationGuide": "1. Navigate to Intune admin center > Endpoint security > Firewall\n2. Click 'Create policy' > Platform: Windows 10 and later > Profile: Microsoft Defender Firewall Rules\n3. Name policy 'Windows Firewall Restrictive Configuration'\n4. Configure firewall settings for each profile (Domain, Private, Public):\n   - Firewall: Enable\n   - Default action for inbound connections: Block\n   - Default action for outbound connections: Allow\n   - Log dropped packets: Yes\n   - Log successful connections: Yes (optional, may impact performance)\n   - Stealth mode: Enabled\n5. Add specific firewall rules only for required services:\n   - Create allow rules for essential services (RDP, file sharing if needed)\n   - Document business justification for each allow rule\n6. Assign to device groups\n7. Test with pilot group before broad deployment\n8. Monitor via Endpoint security > Firewall > Monitor",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "ConfigurationDeviation.ApprovalProcess",
      "displayName": "Configuration Deviation Approval Workflow",
      "settingPath": "policies.changeManagement.deviationApproval",
      "policyType": "Intune",
      "policySubType": "ChangeManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces formal approval process for any configuration settings that deviate from most restrictive mode. Requires documented business justification, risk assessment, and approval from security team before implementation.",
      "implementationGuide": "1. Establish Configuration Deviation Approval Process:\n   - Create deviation request form template (include: setting name, current value, proposed value, business justification, risk assessment)\n   - Define approval authority (e.g., Security team, CISO)\n   - Set approval SLA (e.g., 5 business days)\n2. Integrate with Intune deployment process:\n   - For any configuration profile with less restrictive settings, require deviation approval before deployment\n   - Document approved deviations in profile description field\n   - Maintain Configuration Deviation Register (SharePoint/Database):\n     * Profile ID and name\n     * Setting(s) deviated\n     * Justification and risk assessment\n     * Approver name and date\n     * Review date (annual minimum)\n3. Include deviation review in quarterly configuration baseline reviews\n4. Revoke deviations when no longer needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/deployment-plan-compliance-policies"
    },
    {
      "settingName": "UpdateRings.DeploymentControl",
      "displayName": "Windows Update Rings - Change Control Deployment",
      "settingPath": "policies.windowsUpdate.updateRings",
      "policyType": "Intune",
      "policySubType": "WindowsUpdateRings",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[\"Ring1-Pilot\",\"Ring2-Validation\",\"Ring3-Production\"]",
      "validationOperator": "contains",
      "description": "Implements phased deployment rings for Windows updates with mandatory testing phases before production rollout. Enables controlled, monitored deployment of system configuration changes through updates.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Update rings for Windows 10 and later\n2. Create Ring 1 - Pilot (IT department, 3-5% of devices):\n   - Click 'Create policy', name 'Update Ring 1 - Pilot'\n   - Quality update deferral: 0 days (immediate)\n   - Feature update deferral: 0 days\n   - Assign to pilot device group (IT department)\n3. Create Ring 2 - Validation (early adopters, 20% of devices):\n   - Name 'Update Ring 2 - Validation'\n   - Quality update deferral: 3-7 days\n   - Feature update deferral: 7-14 days\n   - Assign to validation user group\n4. Create Ring 3 - Production (all remaining devices):\n   - Name 'Update Ring 3 - Production'\n   - Quality update deferral: 7-14 days\n   - Feature update deferral: 14-30 days\n   - Assign to all devices group (exclude Ring 1 & 2)\n5. Configure each ring with:\n   - Automatic update behavior: Auto install and restart\n   - Restart grace period: 3 days\n   - Deadline for quality updates: 7 days after deferral\n6. Document ring strategy in organizational change control procedures\n7. Monitor deployment via Reports > Windows updates > Windows update report",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/windows-10-update-rings"
    },
    {
      "settingName": "FeatureUpdates.ApprovalRequired",
      "displayName": "Windows Feature Updates - Manual Approval Control",
      "settingPath": "policies.windowsUpdate.featureUpdates",
      "policyType": "Intune",
      "policySubType": "FeatureUpdates",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"requireApproval\":true,\"targetVersion\":\"specified\",\"automaticUpgrade\":false}",
      "validationOperator": "==",
      "description": "Requires explicit approval for Windows feature updates (major version changes) through Intune Feature Updates policy. Prevents automatic major OS upgrades and ensures change control review process.",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Update rings for Windows 10 and later > Feature updates\n2. Click 'Create profile' for Feature Updates policy\n3. Name 'Windows Feature Update Control - [Target Version]'\n4. Deployment settings:\n   - Select specific Windows version (e.g., Windows 11 23H2)\n   - Do NOT select 'Make update available as soon as possible'\n   - Configure rollout options:\n     * Start date: Specify after change approval\n     * Make available for this many days: 90\n5. Set 'Gradual rollout' if available (requires Windows Autopatch)\n6. In Update Ring policy, set Feature update deferral to 0 days (control via Feature Updates policy)\n7. Document approval process:\n   - Security assessment of new feature set\n   - Compatibility testing requirements\n   - Change advisory board approval\n   - Pilot deployment plan and success criteria\n8. Only create/deploy Feature Updates policy after formal change approval\n9. Assign to device groups following ring deployment model\n10. Monitor via Reports > Windows feature updates > Windows feature updates (Organizational)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/windows-10-feature-updates"
    },
    {
      "settingName": "ConfigurationProfile.VersionControl",
      "displayName": "Configuration Profile Version Control",
      "settingPath": "policies.deviceConfiguration.versionControl",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Versioned",
      "validationOperator": "==",
      "description": "Implements version control for all Intune configuration profiles using naming convention and change tracking. Maintains history of configuration changes with documented approvals and rollback capability.",
      "implementationGuide": "1. Establish Configuration Profile Naming Convention:\n   - Format: '[Platform]-[Category]-[Description]-v[X.Y]'\n   - Example: 'Windows-Security-BitLocker-v1.2'\n   - Increment minor version (X.Y) for minor changes\n   - Increment major version (X.0) for significant changes\n2. For each configuration change:\n   a. Copy existing profile (do not modify in-place)\n   b. Rename with incremented version number\n   c. Update description with:\n      - Version number and date\n      - Change summary\n      - Change request/ticket number\n      - Approver name\n      - Previous version reference\n   d. Make configuration changes to new version\n   e. Test new version with pilot group\n   f. After validation, reassign groups from old to new version\n   g. Keep old version for 90 days (for rollback), then delete\n3. Maintain Configuration Change Log (SharePoint/Database):\n   - Profile name and version\n   - Change date and author\n   - Change description\n   - Approval record\n   - Deployment dates by ring\n4. Use Intune audit logs for tracking: Settings > Audit logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/review-logs-using-azure-monitor"
    },
    {
      "settingName": "ChangeMonitoring.AuditLogs",
      "displayName": "Configuration Change Audit Logging",
      "settingPath": "monitoring.auditLogs.configurationChanges",
      "policyType": "Intune",
      "policySubType": "AuditLogging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables comprehensive audit logging of all configuration changes in Intune including policy creation, modification, deletion, and assignment changes. Provides change tracking and accountability.",
      "implementationGuide": "1. Verify Intune audit logging is enabled (enabled by default):\n   - Navigate to Intune admin center > Tenant administration > Audit logs\n   - Audit logs automatically capture all configuration changes\n2. Configure Azure Monitor integration for long-term retention:\n   - Go to Intune admin center > Reports > Diagnostics settings\n   - Click 'Add diagnostic setting'\n   - Name: 'Intune Audit Logs to Log Analytics'\n   - Select logs: AuditLogs, OperationalLogs\n   - Send to: Log Analytics workspace\n   - Configure retention: 365 days minimum\n3. Review audit logs regularly:\n   - Filter by Category: 'DeviceConfiguration', 'DeviceCompliance', 'MobileApplicationManagement'\n   - Filter by Activity: 'Create', 'Update', 'Delete', 'Assign'\n   - Review 'Initiated by (actor)' for accountability\n4. Set up automated alerts for unauthorized changes:\n   - Create Azure Monitor alert rule for Intune changes by non-admin users\n   - Alert on policy deletions\n   - Alert on changes outside approved maintenance windows\n5. Include audit log review in monthly security review process\n6. Export audit logs for compliance reporting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/review-logs-using-azure-monitor"
    },
    {
      "settingName": "UpdatePause.EmergencyControl",
      "displayName": "Windows Update Pause - Emergency Change Control",
      "settingPath": "policies.windowsUpdate.pauseUpdates",
      "policyType": "Intune",
      "policySubType": "WindowsUpdateRings",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"allowPause\":true,\"maxPauseDays\":35,\"requireApproval\":true}",
      "validationOperator": "==",
      "description": "Enables emergency pause capability for Windows updates when issues are identified during pilot deployment. Provides immediate change control response to problematic updates while maintaining audit trail.",
      "implementationGuide": "1. Configure pause capability in each Update Ring:\n   - Edit existing Update Ring policy\n   - Under 'Update settings':\n     * Quality update deferral period (days): Set as per ring (0, 3-7, 7-14)\n     * Feature update deferral period (days): Set as per ring\n   - Pause feature is available via Intune console (not in policy settings)\n2. Establish Emergency Update Pause Process:\n   - Define triggers for pause (e.g., critical bug reported, widespread device issues)\n   - Require approval from Change Advisory Board or IT Director\n   - Document reason, affected rings, and duration\n3. To pause updates when issues identified:\n   - Navigate to Update rings policy\n   - Select specific ring to pause\n   - Click 'Pause' button\n   - Select pause duration (up to 35 days for quality updates, 35 days for feature updates)\n   - Document pause reason in tenant notes\n4. Monitor paused updates:\n   - Review regularly (weekly minimum during pause)\n   - Evaluate vendor patches/fixes\n   - Test resolution in Ring 1\n   - Resume updates once validated safe\n5. Resume updates:\n   - Click 'Resume' in Update Ring policy\n   - Monitor deployment closely post-resume\n6. Document all pause/resume actions in change log",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/windows-update-pause-resume"
    },
    {
      "settingName": "ConditionalAccess.ConfigurationProtection",
      "displayName": "Conditional Access - Protect Configuration Changes",
      "settingPath": "conditionalAccess.adminProtection",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"requireMFA\":true,\"requireCompliantDevice\":true,\"blockLegacyAuth\":true}",
      "validationOperator": "==",
      "description": "Enforces MFA and compliant device requirements for administrators accessing Intune and making configuration changes. Ensures proper authentication and authorization for configuration control activities.",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Protection > Conditional Access\n2. Click 'New policy' and name 'Intune Admin - Require MFA and Compliant Device'\n3. Assignments:\n   - Users: Include > Directory roles > Select roles:\n     * Intune Administrator\n     * Cloud Device Administrator\n     * Global Administrator\n     * Security Administrator\n   - Exclude: Emergency access accounts\n4. Target resources:\n   - Select apps > Include > Select apps\n   - Search and add:\n     * 'Microsoft Intune'\n     * 'Microsoft Intune Enrollment'\n     * 'Microsoft Endpoint Manager'\n5. Conditions:\n   - Client apps: Configure > Browser and Mobile apps and desktop clients\n6. Grant:\n   - Select 'Grant access'\n   - Check: 'Require multifactor authentication'\n   - Check: 'Require device to be marked as compliant'\n   - For multiple controls: 'Require all the selected controls'\n7. Session: (optional)\n   - Sign-in frequency: 8 hours\n8. Enable policy: On\n9. Save policy\n10. Test with non-production admin account first\n11. Monitor via Entra ID > Sign-in logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-admin-mfa"
    },
    {
      "settingName": "UpdateRings.PilotValidation",
      "displayName": "Update Ring Pilot - Impact Analysis Phase",
      "settingPath": "policies.windowsUpdate.pilotValidation",
      "policyType": "Intune",
      "policySubType": "WindowsUpdateRings",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"ring1Size\":\"3-5% of devices\",\"validationPeriod\":\"3-7 days\",\"successCriteria\":\"defined\",\"impactMetrics\":\"monitored\"}",
      "validationOperator": "==",
      "description": "Implements mandatory pilot phase for Windows updates where security and operational impacts are analyzed before broader deployment. Ring 1 serves as impact analysis validation before Ring 2 and 3 deployment.",
      "implementationGuide": "1. Configure Ring 1 Pilot Group (3-5% of devices, IT department):\n   - Create Azure AD group: 'Windows Update Ring 1 - Pilot'\n   - Add IT admin devices, help desk devices, and volunteer early adopters\n   - Ensure representation across different hardware models and configurations\n2. Configure Ring 1 Update Policy with immediate deployment:\n   - Quality updates: 0 days deferral\n   - Feature updates: 0 days deferral\n   - Assign to Ring 1 pilot group\n3. Establish Impact Analysis Validation Process:\n   - Monitor pilot devices for 3-7 days post-update\n   - Track key metrics:\n     * Device health scores (Endpoint Analytics)\n     * Application crashes or failures\n     * User-reported issues (help desk tickets)\n     * Security baseline compliance status\n     * Performance metrics (boot time, responsiveness)\n   - Define success criteria for progression:\n     * <5% device failure rate\n     * No critical security issues introduced\n     * <10% increase in help desk tickets\n     * All compliance policies still satisfied\n4. Document Impact Analysis:\n   - Create Impact Analysis Report template\n   - For each update cycle, document:\n     * Update KB numbers and description\n     * Security improvements included\n     * Known issues and mitigations\n     * Pilot results and metrics\n     * Go/no-go decision and rationale\n     * Approval to proceed to Ring 2\n5. Halt deployment if validation fails:\n   - Use Update Pause capability\n   - Investigate and remediate issues\n   - Re-validate before proceeding\n6. Store impact analyses in change management system",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/windows-10-update-rings"
    },
    {
      "settingName": "EndpointAnalytics.ChangeImpactMonitoring",
      "displayName": "Endpoint Analytics - Change Impact Monitoring",
      "settingPath": "reporting.endpointAnalytics.changeMonitoring",
      "policyType": "Intune",
      "policySubType": "EndpointAnalytics",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Endpoint Analytics to monitor device health, performance, and user experience metrics before and after configuration changes. Provides quantitative impact analysis data for change validation.",
      "implementationGuide": "1. Enable Endpoint Analytics:\n   - Navigate to Intune admin center > Reports > Endpoint analytics\n   - Click 'Start' to enable Endpoint Analytics\n   - Review data collection notice and confirm\n2. Configure data collection:\n   - Settings > Baseline management: Enable all recommended baselines\n   - Configure baseline scores for:\n     * Startup performance\n     * Application reliability\n     * Battery health (for laptops)\n3. Establish baseline metrics BEFORE changes:\n   - Navigate to Endpoint analytics > Overview\n   - Document current scores:\n     * Overall endpoint analytics score\n     * Startup performance score\n     * Application reliability score\n     * Device performance score\n   - Export baseline report: Reports > Endpoint analytics > Export\n4. Monitor impact AFTER changes deployed:\n   - Review same metrics 7-14 days post-deployment\n   - Compare to baseline\n   - Identify degradation:\n     * >10% decrease in startup performance\n     * >5% increase in application crashes\n     * >15% increase in devices with poor health score\n5. Use Device performance insights:\n   - View per-device performance in Endpoint analytics\n   - Identify devices negatively impacted by changes\n   - Drill down to specific performance issues\n6. Include Endpoint Analytics data in Impact Analysis reports\n7. Set up alerts for significant performance degradation\n8. Review trends monthly in change advisory board meetings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/analytics/scores"
    },
    {
      "settingName": "CompliancePolicy.PostChangeValidation",
      "displayName": "Compliance Policy - Post-Change Security Validation",
      "settingPath": "policies.compliance.postChangeValidation",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Monitors device compliance status after configuration changes to verify security requirements remain satisfied. Ensures changes do not degrade security posture or cause compliance violations.",
      "implementationGuide": "1. Establish baseline compliance metrics BEFORE changes:\n   - Navigate to Intune admin center > Devices > Monitor > Compliance status\n   - Document current metrics:\n     * Overall compliance percentage\n     * Number of compliant devices\n     * Number of non-compliant devices by policy\n     * Top compliance failures\n   - Export compliance report as baseline\n2. Deploy configuration changes using ring deployment model\n3. Monitor compliance impact AFTER each ring deployment:\n   - Review Compliance status dashboard daily during deployment\n   - Compare to baseline metrics\n   - Identify compliance degradation:\n     * Increased non-compliant device count\n     * New compliance failures appearing\n     * Specific compliance policies with increased failures\n4. Investigate compliance impacts:\n   - Click on affected compliance policy\n   - View 'Device status' to see affected devices\n   - Review specific failures: Settings > Device status > [Device] > View details\n   - Correlate failures to recent configuration changes\n5. Set up automated compliance alerts:\n   - Configure email alerts for compliance threshold violations\n   - Alert when compliance drops below 95%\n   - Alert for new critical compliance failures\n6. If compliance degradation detected:\n   - Halt further ring deployment\n   - Analyze root cause of compliance failures\n   - Determine if change caused security requirement violation\n   - Remediate or rollback change\n   - Re-validate compliance before proceeding\n7. Document post-change validation in Impact Analysis report:\n   - Compliance status before and after\n   - Any compliance issues introduced\n   - Remediation actions taken\n   - Final compliance validation results\n8. Review compliance trends in change advisory board meetings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/compliance-policy-monitor"
    },
    {
      "settingName": "SecurityBaseline.PostChangeAudit",
      "displayName": "Security Baseline Compliance - Post-Change Audit",
      "settingPath": "policies.securityBaseline.postChangeAudit",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Monitors security baseline compliance after system changes to verify baseline configurations remain properly applied and security posture is maintained or improved.",
      "implementationGuide": "1. Establish baseline security posture BEFORE changes:\n   - Navigate to Intune admin center > Endpoint security > Security baselines\n   - Select your deployed baseline (e.g., 'Security Baseline for Windows 10 and later')\n   - Click 'Monitor' > View baseline profile status\n   - Document metrics:\n     * Total devices assigned\n     * Devices succeeded (compliant with baseline)\n     * Devices with errors\n     * Devices with conflicts\n     * Percentage baseline compliance\n   - Review 'Per setting status' to see individual setting compliance\n   - Export baseline report for pre-change baseline\n2. Deploy configuration changes following ring model\n3. Monitor security baseline compliance AFTER each ring:\n   - Return to Security baselines > [Policy] > Monitor\n   - Compare current metrics to baseline\n   - Identify degradation:\n     * Increased errors or conflicts\n     * Decreased baseline compliance percentage\n     * Specific settings showing new failures\n4. Investigate baseline impacts:\n   - Click 'Device status' to see affected devices\n   - Click 'Per setting status' to identify affected settings\n   - Select setting > View 'Device and user check-in status'\n   - Correlate failures to recent changes\n5. Validate no security setting conflicts:\n   - Check for conflicts between:\n     * Security baseline and new configuration profiles\n     * Multiple configuration policies\n     * Update-induced setting changes\n6. If baseline compliance degraded:\n   - Determine if change caused conflict with baseline\n   - Resolve conflicts by:\n     * Adjusting new configuration policy\n     * Updating baseline if appropriate\n     * Removing conflicting settings\n   - Re-validate baseline compliance\n   - Do not proceed to next ring until resolved\n7. Document in Impact Analysis Report:\n   - Baseline compliance before and after\n   - Any conflicts or setting failures\n   - Resolution actions\n   - Final validation status\n8. Include baseline trends in monthly security reviews",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/security-baselines-monitor"
    },
    {
      "settingName": "UpdateReporting.ImpactAnalysis",
      "displayName": "Windows Update Reports - Impact Analysis Dashboard",
      "settingPath": "reporting.windowsUpdates.impactAnalysis",
      "policyType": "Intune",
      "policySubType": "Reporting",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Provides comprehensive reporting on Windows update deployment status, device health, and update-related issues to support impact analysis and post-change validation.",
      "implementationGuide": "1. Access Windows Update Reports:\n   - Navigate to Intune admin center > Reports > Windows updates\n   - Available reports:\n     * Windows update report (organizational)\n     * Windows update report (operational)\n     * Windows feature updates report\n     * Windows expedited updates report\n2. Configure Windows Update Report - Organizational:\n   - Provides high-level deployment status across all rings\n   - Metrics include:\n     * Update deployment state (Pending, Downloading, Installing, Installed, Failed)\n     * Device count by update status\n     * Update compliance percentage\n   - Use for overall deployment health assessment\n3. Configure Windows Update Report - Operational:\n   - Provides detailed per-device update status\n   - Shows specific update KB numbers installed\n   - Identifies devices with update failures\n   - Use to investigate specific deployment issues\n4. Review Feature Updates Report:\n   - Monitor feature update (major version) deployment\n   - Track progress of OS version upgrades\n   - Identify devices failing feature updates\n5. Create Impact Analysis Dashboard:\n   - Export key metrics before deployment (baseline)\n   - Monitor during Ring 1 pilot deployment:\n     * % devices successfully updated\n     * % devices with errors\n     * Average install time\n     * Devices pending restart\n   - Compare Ring 1 results to historical baselines\n   - Document anomalies or concerns\n6. Analyze deployment failures:\n   - Filter devices with 'Failed' or 'Error' status\n   - Click device to view update history and error details\n   - Document common failure patterns\n   - Include in impact analysis\n7. Set success criteria thresholds:\n   - >95% successful update installation\n   - <3% device failure rate\n   - No critical update errors\n8. Include update report metrics in:\n   - Pilot validation reports\n   - Impact Analysis documentation\n   - Change Advisory Board presentations\n9. Configure automated report exports:\n   - Schedule weekly update reports during deployment phases\n   - Email to change management team\n10. Review trends monthly to identify systemic issues",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/windows-update-reports"
    },
    {
      "settingName": "DefenderAlertsMonitoring.PostChangeValidation",
      "displayName": "Microsoft Defender Alerts - Post-Change Security Monitoring",
      "settingPath": "defender.alerts.postChangeMonitoring",
      "policyType": "Defender",
      "policySubType": "AlertMonitoring",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"monitoringEnabled\":true,\"baselineComparison\":true,\"alertThreshold\":\"increased\"}",
      "validationOperator": "==",
      "description": "Monitors Microsoft Defender security alerts and incidents before and after configuration changes to identify any security impacts or new attack vectors introduced by system modifications.",
      "implementationGuide": "1. Establish baseline security alert metrics BEFORE changes:\n   - Navigate to Microsoft Defender portal (security.microsoft.com)\n   - Go to Reports > General > Security report\n   - Document 30-day baseline metrics:\n     * Total alerts\n     * High/Medium/Low severity alert counts\n     * Top alert categories\n     * Average alerts per day\n     * Active incidents\n   - Export baseline security report\n2. Deploy configuration changes using ring model\n3. Monitor security alerts DURING and AFTER deployment:\n   - Review Defender portal daily during deployment phases\n   - Monitor for alert trends:\n     * Increase in alert volume\n     * New alert types appearing\n     * Increase in high-severity alerts\n     * New incident creation\n4. Compare post-change metrics to baseline:\n   - Calculate percentage change in alert volume\n   - Identify new alert categories\n   - Analyze alerts specific to changed configurations\n5. Investigate security impacts:\n   - Filter alerts by affected devices (Ring 1 pilot group)\n   - Review alert details and root causes\n   - Determine if alerts related to configuration changes:\n     * New security features triggering alerts\n     * Configuration errors creating vulnerabilities\n     * Unexpected security behavior changes\n6. Analyze specific alert types for change impact:\n   - Attack Surface Reduction (ASR) rule triggers\n   - Exploit protection alerts\n   - Network protection blocks\n   - Controlled folder access blocks\n   - Suspicious behavior detections\n7. If security alerts increase significantly (>20%):\n   - Halt further ring deployment\n   - Perform root cause analysis\n   - Determine if increase is:\n     * Expected (enhanced detection capabilities)\n     * Problematic (new vulnerabilities introduced)\n   - Adjust configuration or rollback if needed\n   - Re-validate before proceeding\n8. Document in Impact Analysis:\n   - Security alert metrics before and after\n   - New alert types introduced\n   - Security improvements from changes\n   - Any security concerns identified\n   - Validation that security posture maintained/improved\n9. Include security metrics in change approval process\n10. Review security trends in monthly security reviews",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/overview-endpoint-detection-response"
    },
    {
      "settingName": "EnablePrivilegedIdentityManagement",
      "displayName": "Privileged Identity Management - Require Approval for Role Activation",
      "settingPath": "EntraID.PIM.RoleSettings.RequireApproval",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires approval workflow before privileged roles (Global Admin, Intune Admin, etc.) can be activated, ensuring changes to privileged access are authorized",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Identity Governance > Privileged Identity Management\n2. Select Azure AD Roles > Roles > Select privileged role (e.g., Global Administrator)\n3. Select Role settings > Edit\n4. Under Activation, enable 'Require approval to activate'\n5. Add at least 2 approvers (do not rely on default Global Admins)\n6. Enable 'Require justification on activation'\n7. Set maximum activation duration to 8 hours or less\n8. Save settings and repeat for all highly privileged roles",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "ConditionalAccessForPrivilegedRoles",
      "displayName": "Conditional Access - MFA and Compliance for Privileged Accounts",
      "settingPath": "EntraID.ConditionalAccess.Policy",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"grantControls\":{\"operator\":\"AND\",\"builtInControls\":[\"mfa\",\"compliantDevice\"]}}",
      "validationOperator": "contains",
      "description": "Enforces MFA and device compliance requirements for users with privileged directory roles, restricting access for system changes to authorized, authenticated users on compliant devices",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Protection > Conditional Access > Policies\n2. Create new policy: 'Require MFA and Compliant Device for Privileged Roles'\n3. Assignments > Users: Select Directory roles > Include all privileged roles (Global Admin, Intune Admin, Security Admin, etc.)\n4. Assignments > Cloud apps: Select 'All cloud apps'\n5. Access controls > Grant: Select 'Grant access' and check both 'Require multifactor authentication' AND 'Require device to be marked as compliant'\n6. Access controls > Grant: Set multiple controls to 'Require all the selected controls'\n7. Session > Sign-in frequency: Set to 'Every time' for maximum security\n8. Enable policy: Set to 'On'\n9. Exclude at least one emergency access account",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/plan-conditional-access"
    },
    {
      "settingName": "AuthenticationContextForPIM",
      "displayName": "PIM - Authentication Context with Conditional Access",
      "settingPath": "EntraID.PIM.RoleSettings.AuthenticationContext",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "c1",
      "validationOperator": "==",
      "description": "Links PIM role activation to specific Conditional Access authentication contexts requiring reauthentication and stricter controls during privileged role activation for system changes",
      "implementationGuide": "1. Create Authentication Context: Entra admin center > Protection > Conditional Access > Authentication context > New authentication context\n2. Name: 'Privileged Role Activation' with ID 'c1'\n3. Create CA Policy: Conditional Access > New policy\n4. Name: 'Require Reauthentication for Privileged Activation'\n5. Assignments > Users: All users\n6. Assignments > Cloud apps or actions: Authentication context > Select 'Privileged Role Activation'\n7. Grant controls: Require MFA AND 'Sign-in frequency: Every time'\n8. Enable policy\n9. Configure in PIM: PIM > Azure AD Roles > Select role > Role settings > Edit\n10. Enable 'On activation, require Microsoft Entra Conditional Access authentication context'\n11. Select 'Privileged Role Activation' context\n12. Update role settings",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-change-default-settings"
    },
    {
      "settingName": "DisablePermanentPrivilegedRoles",
      "displayName": "PIM - Convert Permanent to Eligible Role Assignments",
      "settingPath": "EntraID.PIM.Assignments.EligibleOnly",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Eliminates standing privileged access by requiring Just-In-Time (JIT) activation for all privileged roles, ensuring access for system changes is time-bound and monitored",
      "implementationGuide": "1. Navigate to Entra admin center > Identity Governance > Privileged Identity Management\n2. Select Azure AD Roles > Assignments\n3. Review all 'Active assignments' (permanent roles)\n4. For each permanent privileged role assignment:\n   a. Select the assignment\n   b. Remove the permanent assignment\n   c. Add as 'Eligible assignment' instead\n   d. Set appropriate eligibility duration (typically 1 year)\n5. Ensure emergency access accounts remain permanent but are cloud-only and monitored\n6. Use PIM Discovery and Insights page to identify all permanent assignments\n7. Document justification for any remaining permanent assignments\n8. Configure PIM alerts for new permanent assignments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-deployment-plan"
    },
    {
      "settingName": "RestrictIntuneAdminRoles",
      "displayName": "Intune - Limit Device Configuration and Policy Admin Roles",
      "settingPath": "Intune.RBAC.RoleAssignments",
      "policyType": "Intune",
      "policySubType": "RoleBasedAccessControl",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"minimumRoles\":true,\"scopeTags\":\"required\"}",
      "validationOperator": "==",
      "description": "Restricts Intune administrative capabilities using built-in or custom RBAC roles with scope tags, limiting who can create or modify device configurations and compliance policies that affect system settings",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Tenant administration > Roles > All roles\n2. Review current role assignments: Select 'Assignments' for each role\n3. Identify administrators with full access roles (Intune Administrator, Policy and Profile manager)\n4. For device configuration changes, assign only these roles as needed:\n   - Policy and Profile Manager: Can manage compliance and configuration policies\n   - Endpoint Security Manager: Can manage security settings only\n5. Implement scope tags: Tenant administration > Roles > Scope tags\n6. Create scope tags for different device groups (e.g., 'Production', 'Test', 'Executives')\n7. When assigning roles, specify scope: Assignments > Scope (tags) > Select appropriate tags\n8. Remove broad 'All devices' assignments\n9. Document all role assignments and their justifications\n10. Review role assignments quarterly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/role-based-access-control"
    },
    {
      "settingName": "WindowsFirewallDomainInboundBlock",
      "displayName": "Windows Firewall - Block Inbound Connections (Domain Profile)",
      "settingPath": "Firewall.DomainProfile.DefaultInboundAction",
      "policyType": "Intune",
      "policySubType": "EndpointSecurityFirewall",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Block",
      "validationOperator": "==",
      "description": "Blocks all unsolicited inbound network connections on domain networks by default, implementing deny-by-default networking to reduce attack surface and prevent unauthorized services",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Firewall\n2. Create policy: Platform 'Windows 10, Windows 11, and Windows Server' > Profile 'Microsoft Defender Firewall'\n3. Configuration settings > Expand 'Firewall'\n4. Domain Profile settings:\n   - Enable Firewall: Yes\n   - Default Inbound Action: Block\n   - Default Outbound Action: Allow (to permit authorized traffic)\n   - Disable Stealth Mode: No (keep stealth mode enabled)\n   - Disable Inbound Notifications: Yes (suppress end-user notifications)\n5. Repeat configuration for Private Profile and Public Profile\n6. Name policy: 'Windows Firewall - Block Inbound (All Profiles)'\n7. Assign to: All Windows devices or appropriate device group\n8. Create separate policies for specific allow rules as needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "DisableBluetoothServices",
      "displayName": "Intune - Disable Bluetooth When Not Required",
      "settingPath": "DeviceConfiguration.Connectivity.Bluetooth",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "blocked",
      "validationOperator": "==",
      "description": "Disables Bluetooth functionality on Windows devices where not required for business operations, eliminating an unnecessary wireless protocol that can be exploited for unauthorized data transfer or device connection",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create > New Policy\n2. Platform: Windows 10 and later\n3. Profile type: Templates > Device restrictions\n4. Configuration settings > Connectivity:\n   - Bluetooth: Block\n   - Bluetooth discoverability: Block\n   - Bluetooth pre-pairing: Block\n   - Bluetooth advertising: Block (if available)\n5. Alternative using Settings Catalog:\n   - Configuration > Create > Settings Catalog\n   - Settings > Connectivity > Bluetooth\n   - Allow Bluetooth: Disabled\n6. Name: 'Windows - Disable Bluetooth'\n7. Assign to device groups where Bluetooth is not mission-essential\n8. Create separate allowing policy for devices requiring Bluetooth (e.g., executives with wireless peripherals)\n9. Document business justification for any exceptions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-restrictions-windows-10"
    },
    {
      "settingName": "DisableSMBv1Protocol",
      "displayName": "Windows - Disable SMBv1 Protocol",
      "settingPath": "DeviceConfiguration.CustomOMAURI.SMBv1",
      "policyType": "Intune",
      "policySubType": "CustomConfiguration",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "0",
      "validationOperator": "==",
      "description": "Disables the insecure SMBv1 file sharing protocol which has known vulnerabilities (WannaCry, NotPetya), removing an outdated protocol that is not necessary for modern Windows networking",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Configuration > Create\n2. Platform: Windows 10 and later\n3. Profile type: Templates > Custom\n4. Name: 'Windows - Disable SMBv1 Protocol'\n5. Add OMA-URI Setting:\n   - Name: Disable SMBv1 Client\n   - OMA-URI: ./Vendor/MSFT/Policy/Config/LanmanWorkstation/EnableInsecureGuestLogons\n   - Data type: Integer\n   - Value: 0\n6. Alternative using PowerShell script:\n   - Create Proactive Remediation or Platform Script\n   - Detection: Get-WindowsOptionalFeature -Online -FeatureName SMB1Protocol | Select State\n   - Remediation: Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol -NoRestart\n7. Assign to: All Windows devices\n8. CIS Benchmark reference: CIS Control 4.4.1\n9. Test in pilot group before broad deployment\n10. Verify no legacy systems require SMBv1",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows-server/storage/file-server/troubleshoot/detect-enable-and-disable-smbv1-v2-v3"
    },
    {
      "settingName": "RestrictMicrosoftStoreApps",
      "displayName": "Intune - Require Private Store Only",
      "settingPath": "DeviceConfiguration.App.Store.PrivateStoreOnly",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Restricts access to public Microsoft Store, allowing only organization-approved apps from private store, limiting software installation to mission-essential applications and preventing unauthorized functionality",
      "implementationGuide": "1. Configure Microsoft Store for Business (if not already set up):\n   - Navigate to businessstore.microsoft.com\n   - Sign in with admin account\n   - Set up private store for your organization\n2. Navigate to Microsoft Intune admin center > Devices > Configuration\n3. Create policy: Platform 'Windows 10 and later' > Profile 'Device restrictions'\n4. App Store settings:\n   - Require private store only: Yes\n   - App store auto-update: Block (control updates centrally)\n   - Trusted app installation: Allow (for LOB apps)\n   - Developer unlock: Block\n5. Using Settings Catalog (alternative/additional):\n   - Create > Settings Catalog\n   - Settings > App Runtime > 'Allow deployment operations in special profiles'\n   - Settings > App Runtime > 'Allow all trusted apps'\n6. Name: 'Windows - Microsoft Store Restrictions'\n7. Assign to: All corporate devices\n8. Curate approved apps in private store\n9. Communicate approved app list to users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-restrictions-windows-10"
    },
    {
      "settingName": "DisableUnnecessaryWindowsServices",
      "displayName": "Windows - Disable Non-Essential Services",
      "settingPath": "DeviceConfiguration.Services.Disabled",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[\"XboxNetApiSvc\",\"XblAuthManager\",\"XblGameSave\",\"RemoteRegistry\",\"RemoteAccess\"]",
      "validationOperator": "contains",
      "description": "Disables Windows services not required for business operations including Xbox services, remote registry, and other consumer-focused features, reducing attack surface and eliminating unnecessary functionality",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Configuration\n2. Create policy: Platform 'Windows 10 and later' > Profile 'Settings Catalog'\n3. Name: 'Windows - Disable Non-Essential Services'\n4. Add settings for each service:\n   Settings > System Services > [Service Name]\n   - Xbox Live services (XboxNetApiSvc, XblAuthManager, XblGameSave): Disabled\n   - Remote Registry (RemoteRegistry): Disabled\n   - Remote Access (RemoteAccess): Disabled if not using VPN\n   - Fax service: Disabled\n   - Windows Media Player Network Sharing: Disabled\n5. CIS Benchmark references:\n   - 5.4 (L1): Xbox Live Networking Service disabled\n   - 5.24 (L1): Remote Registry disabled\n6. Assign to: All corporate devices\n7. Test in pilot group first\n8. Document any services that must remain enabled for business requirements\n9. Review quarterly for additional services to disable",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-security-configuration-framework/windows-security-baselines"
    },
    {
      "settingName": "WindowsFirewallRulesReview",
      "displayName": "Firewall Rule Review and Management",
      "settingPath": "Intune.EndpointSecurity.Firewall.RuleReview",
      "policyType": "Intune",
      "policySubType": "EndpointSecurityFirewall",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"reviewFrequency\":\"Quarterly\",\"documentationRequired\":true}",
      "validationOperator": "==",
      "description": "Establishes process for quarterly review of all Windows Firewall rules deployed via Intune to identify and remove unnecessary or outdated port/protocol exceptions, maintaining least functionality principle over time",
      "implementationGuide": "1. Document current state:\n   - Navigate to Intune admin center > Endpoint security > Firewall\n   - Export all firewall rule policies\n   - Document business justification for each allow rule\n2. Create firewall rule naming standard:\n   - Format: [Purpose]-[Protocol]-[Port]-[Direction]\n   - Example: 'FileShare-TCP-445-Inbound'\n3. Implement rule categories:\n   - Critical (cannot be removed)\n   - Standard (required for normal operations)\n   - Temporary (time-bound exceptions)\n4. Establish quarterly review process:\n   - Review team: Security + Network + Application owners\n   - Review all Firewall policies in Endpoint Security\n   - Validate continued need for each rule\n   - Remove or disable rules no longer required\n   - Update rule descriptions with review date\n5. Use Intune Reports:\n   - Monitor > Device configuration > Select firewall policies\n   - Review compliance status\n6. Document review in change management system\n7. Maintain firewall rule inventory spreadsheet",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "WindowsDefenderApplicationControl",
      "displayName": "Windows Defender Application Control (WDAC) - Allow by Exception Policy",
      "settingPath": "Intune.AppControlForBusiness.WDACPolicy",
      "policyType": "Intune",
      "policySubType": "AppControlForBusiness",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Base policy with allow-by-exception mode",
      "validationOperator": "==",
      "description": "Implements Windows Defender Application Control with deny-all, permit-by-exception enforcement for application execution, controlling which applications and drivers can run based on code signing certificates and reputation",
      "implementationGuide": "1. Create WDAC Policy using WDAC Wizard:\n   - Download: https://webapp-wdac-wizard.azurewebsites.net/\n   - Policy Creator > Multiple Policy Format > Base Policy\n   - Select template: 'Allow Microsoft Mode' or 'Signed and Reputable Mode'\n   - Enable recommended options:\n     * Enabled:Audit Mode (for initial deployment)\n     * Enabled:Advanced Boot Options Menu\n     * Enabled:Update Policy Without Rebooting\n     * Disabled:Script Enforcement (initially, enable after testing)\n2. Build policy and export .xml and .cip files\n3. Convert to Base64 for Intune:\n   - PowerShell: [Convert]::ToBase64String([IO.File]::ReadAllBytes('policy.xml'))\n4. Deploy via Intune:\n   - Navigate to Endpoint security > App control for Business (Preview)\n   - Create policy > Enter Base64 XML data\n   - Name: 'WDAC - Base Allow Microsoft/Reputable'\n5. Enable Managed Installer:\n   - Policy > Managed Installer > Add > Enable for Intune\n   - This allows Intune-deployed apps automatically\n6. Start in Audit Mode for 30-60 days\n7. Review logs: Event Viewer > Applications and Services > Microsoft > Windows > CodeIntegrity > Operational\n8. Add supplemental policies for approved LOB apps\n9. Switch to Enforced mode after validation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/wdac-and-applocker-overview"
    },
    {
      "settingName": "AppLockerExecutableRules",
      "displayName": "AppLocker - Executable and DLL Rules",
      "settingPath": "Intune.AppLocker.Rules",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"executable\":\"configured\",\"dll\":\"configured\",\"defaultDeny\":true}",
      "validationOperator": "contains",
      "description": "Implements user-mode application control using AppLocker to restrict which executables, DLLs, and scripts can run, complementing WDAC with user-level granular controls for authorized software enforcement",
      "implementationGuide": "1. Navigate to Intune admin center > Endpoint security > App control for Business\n2. Create Supplemental Policy for AppLocker rules:\n   - Policy Type: Supplemental\n   - Name: 'AppLocker - Standard Rules'\n3. Configure default rules (minimum):\n   Executable Rules:\n   - Allow: Windows System files\n     Path: %windir%\\* (signed by Microsoft)\n   - Allow: Program Files\n     Path: %ProgramFiles%\\* (signed by Microsoft)\n   - Allow: Intune-managed apps\n     Publisher rule for approved vendors\n   DLL Rules:\n   - Allow: Windows System DLLs\n     Path: %windir%\\* (signed by Microsoft)\n   - Allow: Program Files DLLs\n     Path: %ProgramFiles%\\* (signed by Microsoft)\n4. Script Rules (PowerShell, VBS):\n   - Allow: Signed scripts from approved publishers\n   - Block: All unsigned scripts (or use AllSigned execution policy)\n5. Set enforcement mode:\n   - Start with 'Audit only'\n   - Monitor Event Viewer: Event Viewer > Applications and Services > Microsoft > Windows > AppLocker\n   - Add exceptions for legitimate business apps\n   - Change to 'Enforce rules' after 30-60 days\n6. Assign to device groups\n7. Document all allow rules and business justification",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/applocker/applocker-overview"
    },
    {
      "settingName": "IntuneManagedInstaller",
      "displayName": "Intune Managed Installer for Application Control",
      "settingPath": "Intune.ManagedInstaller.Enabled",
      "policyType": "Intune",
      "policySubType": "AppControlForBusiness",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Designates Intune as a trusted managed installer, automatically authorizing applications deployed through Intune for execution under WDAC/AppLocker policies, simplifying authorized software management while maintaining deny-by-default",
      "implementationGuide": "1. Enable via Endpoint Protection Profile:\n   - Navigate to Devices > Configuration > Create\n   - Platform: Windows 10 and later\n   - Profile: Endpoint Protection\n   - Microsoft Defender Application Control:\n     * Enable: 'Code integrity policies' > 'Enforce'\n     * Enable: 'Managed Installer'\n2. Alternative - Enable via App Control Policy:\n   - Endpoint security > App control for Business\n   - Managed Installer > Add\n   - Read instructions and confirm\n   - This enables managed installer for all enrolled devices\n3. Verify configuration:\n   - Registry: HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AppModel\\StateRepository\n   - Service: Check AppModel service is running\n4. Deploy applications through Intune:\n   - Apps > Windows apps > Add\n   - Any app deployed via Intune is automatically trusted\n5. Test:\n   - Deploy test app via Intune\n   - Verify it runs without AppLocker/WDAC blocks\n   - Verify manually downloaded apps are blocked\n6. Create AppLocker policy to enforce managed installer:\n   - Executable rule: Allow apps from Intune managed installer\n7. Monitor: Event Viewer > AppLocker logs for managed installer events",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/configure-authorized-apps-deployed-with-a-managed-installer"
    },
    {
      "settingName": "BlockConsumerMicrosoftStoreApps",
      "displayName": "Block Consumer Microsoft Store Apps",
      "settingPath": "DeviceConfiguration.Experience.ConsumerExperiences",
      "policyType": "Intune",
      "policySubType": "DeviceRestrictions",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Prevents installation of consumer applications from public Microsoft Store, enforcing that only organization-vetted applications can be installed, supporting authorized software policy",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration\n2. Create policy: Platform 'Windows 10 and later' > Profile 'Device restrictions'\n3. Configuration settings:\n   - Experience section:\n     * Block Windows consumer features: Yes\n     * Block manual unenrollment: Yes\n4. App Store settings:\n   - App store auto-update: Block\n   - Developer unlock: Block\n   - Require private store only: Yes (if private store configured)\n5. Alternative - Settings Catalog:\n   - Create > Settings Catalog\n   - Settings > Experience > 'Turn off Microsoft consumer experiences'\n   - Value: Enabled\n6. Configure Private Store (if using):\n   - Microsoft Store for Business integration\n   - Curate approved applications only\n7. Name: 'Windows - Block Consumer Apps and Features'\n8. Assign to: All corporate devices\n9. Alternative Group Policy for comparison:\n   - Computer Configuration > Administrative Templates > Windows Components > Cloud Content\n   - 'Turn off Microsoft consumer experiences': Enabled\n10. Test: Users should not see consumer app suggestions or be able to install consumer apps",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/configuration/device-restrictions-windows-10"
    },
    {
      "settingName": "PowerShellExecutionPolicy",
      "displayName": "PowerShell - Restricted Execution Policy",
      "settingPath": "DeviceConfiguration.PowerShell.ExecutionPolicy",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "AllSigned",
      "validationOperator": "==",
      "description": "Enforces PowerShell script execution policy requiring all scripts to be digitally signed by trusted publisher, preventing execution of unauthorized or malicious scripts while allowing signed organizational scripts",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Configuration\n2. Create policy: Platform 'Windows 10 and later' > Profile 'Settings Catalog'\n3. Name: 'Windows - PowerShell Execution Policy'\n4. Add setting:\n   - Settings > Administrative Templates > Windows Components > Windows PowerShell\n   - 'Turn on Script Execution': Enabled\n   - Execution Policy: 'Allow only signed scripts' (AllSigned)\n5. Alternative execution policies (in order of restrictiveness):\n   - AllSigned: Requires signature on all scripts (recommended)\n   - RemoteSigned: Local scripts run unsigned, downloaded must be signed\n   - Restricted: No scripts run (too restrictive)\n6. Configure code signing:\n   - Obtain code signing certificate from internal CA or public CA\n   - Sign organizational PowerShell scripts\n   - Distribute signing certificate to Trusted Publishers\n7. For Intune-deployed scripts:\n   - Scripts run in system context bypass execution policy\n   - But enforce for user-initiated scripts\n8. Assign to: All Windows devices\n9. Verify: PowerShell command 'Get-ExecutionPolicy -List'\n10. CIS Benchmark: 18.9.102.1.1 (L1) Configure execution policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies"
    },
    {
      "settingName": "ApplicationControlReviewProcess",
      "displayName": "Quarterly Application Control Policy Review",
      "settingPath": "Intune.AppControl.ReviewProcess",
      "policyType": "Intune",
      "policySubType": "ProcessControl",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"reviewFrequency\":\"Quarterly\",\"documentationRequired\":true,\"auditLogs\":\"required\"}",
      "validationOperator": "==",
      "description": "Establishes formal quarterly review process for all application control policies (WDAC, AppLocker, Managed Installer) to validate continued need for authorized applications and remove obsolete approvals",
      "implementationGuide": "1. Create review documentation template:\n   - Current WDAC/AppLocker policies inventory\n   - List of all allow rules and supplemental policies\n   - Business justification for each exception\n   - Last review date and reviewer\n   - Risk assessment for each allowed application\n2. Establish review team:\n   - Security team representative\n   - IT operations representative\n   - Application owners/business stakeholders\n3. Quarterly review process:\n   a. Export current policies:\n      - Endpoint security > App control > Export each policy\n   b. Review WDAC audit logs:\n      - Check blocked applications in audit mode\n      - Event Viewer > CodeIntegrity > Operational\n   c. Review AppLocker logs:\n      - Event Viewer > AppLocker logs\n      - Identify blocked applications and assess need\n   d. Analyze application usage:\n      - Use Endpoint Analytics for application inventory\n      - Identify unused authorized applications\n   e. Update policies:\n      - Remove applications no longer used\n      - Add newly approved applications\n      - Update code signing certificates\n4. Document review:\n   - Change management ticket for all modifications\n   - Maintain authorized software list\n   - Sign-off from security team\n5. Update Intune policies with changes\n6. Communicate changes to IT staff and users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/wdac-deployment-guide"
    },
    {
      "settingName": "IntuneDeviceInventoryPropertiesCatalog",
      "displayName": "Intune Device Inventory - Properties Catalog Collection",
      "settingPath": "Intune.DeviceInventory.PropertiesCatalog",
      "policyType": "Intune",
      "policySubType": "PropertiesCatalog",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"categories\":[\"CPU\",\"Memory\",\"Storage\",\"Network\",\"BIOS\",\"Battery\",\"OS\"]}",
      "validationOperator": "contains",
      "description": "Enables comprehensive hardware inventory collection via Intune Properties Catalog, installing Microsoft Device Inventory Agent to collect detailed component information updated every 24 hours for accurate system inventory",
      "implementationGuide": "1. Navigate to Intune admin center > Devices > Windows > Configuration\n2. Create policy: Platform 'Windows 10 and later' > Profile type 'Properties Catalog'\n3. Name: 'Device Inventory - Hardware Properties Collection'\n4. Click 'Add properties' and select categories:\n   Required categories (select ALL properties in each):\n   - Processor (CPU): Manufacturer, Speed, Cores, Threads\n   - Memory: Total Physical Memory, Available Memory\n   - Storage: Disk Capacity, Free Space, Disk Type (SSD/HDD)\n   - Network Adapter: MAC Address, IP Configuration, Adapter Type\n   - BIOS: Manufacturer, Version, Release Date, Serial Number\n   - Operating System: Version, Build, Edition, Install Date\n   - Battery (for laptops): Designed Capacity, Current Capacity, Cycle Count\n   Optional categories:\n   - Display: Resolution, Manufacturer\n   - TPM: Version, Manufacturer\n   - Secure Boot: Enabled status\n5. Assign to: All Windows devices\n6. Agent deployment:\n   - Microsoft Device Inventory Agent auto-installs\n   - Location: C:\\Program Files\\Microsoft Device Inventory Agent\n   - Data syncs every 24 hours\n7. View inventory:\n   - Devices > All devices > Select device > Monitor > Resource Explorer\n8. Data populates within 24 hours of policy assignment",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/device-inventory"
    },
    {
      "settingName": "AzureADDeviceRegistration",
      "displayName": "Azure AD Device Registration and Inventory",
      "settingPath": "EntraID.Devices.Registration",
      "policyType": "AzureAD",
      "policySubType": "DeviceManagement",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"registrationRequired\":true,\"inventoryTracking\":\"enabled\"}",
      "validationOperator": "==",
      "description": "Requires all organizational devices to register in Azure AD/Entra ID, creating centralized device inventory with device type, OS version, compliance status, last sign-in, and ownership information",
      "implementationGuide": "1. Configure device registration:\n   - Navigate to Entra admin center > Devices > Device settings\n   - Users may join devices to Azure AD: Yes (for corporate devices) or Selected groups\n   - Require Multi-Factor Authentication to register or join devices: Yes\n   - Maximum number of devices per user: 5 (adjust as needed)\n2. For Windows devices:\n   - Automatic enrollment in Intune during Azure AD join\n   - Settings > Accounts > Access work or school > Connect\n   - Join this device to Azure Active Directory\n3. For mobile devices:\n   - Users install Company Portal app\n   - Sign in with corporate credentials\n   - Device automatically registers\n4. View device inventory:\n   - Entra admin center > Devices > All devices\n   - Export device list: Select devices > Export\n5. Key inventory attributes captured:\n   - Device name, Device ID, Object ID\n   - OS and version\n   - Join type (Azure AD joined, Hybrid, Registered)\n   - Management type (Intune, Co-managed)\n   - Compliance state\n   - Last activity date\n   - Primary user\n   - Ownership (Corporate/Personal)\n6. Enable device activity reports:\n   - Monitoring > Sign-ins > Filter by device\n7. Configure stale device cleanup:\n   - Device settings > Delete devices:\n     * Delete devices with no activity in 90 days\n     * Maximum pending devices: 50",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/devices/overview"
    },
    {
      "settingName": "IntuneSoftwareInventory",
      "displayName": "Intune - Managed and Discovered Applications Inventory",
      "settingPath": "Intune.Apps.InventoryTracking",
      "policyType": "Intune",
      "policySubType": "ApplicationManagement",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"managedApps\":\"tracked\",\"discoveredApps\":\"tracked\",\"refreshInterval\":\"7 days\"}",
      "validationOperator": "==",
      "description": "Automatically inventories all installed applications on managed devices, including both Intune-deployed apps and discovered applications, providing software component accountability with version tracking",
      "implementationGuide": "1. Managed applications (Intune-deployed):\n   - Navigate to Apps > All apps\n   - Automatic tracking for all deployed applications\n   - View per-device: Apps > Select app > Device install status\n   - View per-app: Shows installation status, version, install date\n2. Discovered applications (all installed apps):\n   - Navigate to Apps > Monitor > Discovered apps\n   - Automatic collection every 7 days\n   - Shows: App name, Version, Publisher, Device count\n   - Export to CSV for reporting\n3. Per-device software inventory:\n   - Devices > All devices > Select device > Discovered apps\n   - Shows all software installed on that specific device\n4. Configure app inventory collection:\n   - Devices > Configuration > Create policy\n   - Platform: Windows 10 and later\n   - Settings Catalog > Device Management > 'Allow commercial data pipeline'\n   - Enable for inventory collection\n5. Software version tracking:\n   - Apps > Monitor > App install status\n   - Filter by version to identify out-of-date software\n6. Use Endpoint Analytics for advanced insights:\n   - Reports > Endpoint Analytics > Software inventory\n   - Identifies software usage, versions, and update requirements\n7. Export comprehensive software inventory:\n   - Apps > Discovered apps > Export\n   - Includes: Device name, App name, Version, Publisher, Install date\n8. Review frequency: Automated 7-day refresh cycle",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/apps/app-discovered-apps"
    },
    {
      "settingName": "EndpointAnalyticsEnrollment",
      "displayName": "Endpoint Analytics - Device and Software Insights",
      "settingPath": "Intune.EndpointAnalytics.Enrollment",
      "policyType": "Intune",
      "policySubType": "EndpointAnalytics",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Endpoint Analytics to provide enhanced device and software inventory with performance metrics, startup times, application reliability, and component health tracking for comprehensive system visibility",
      "implementationGuide": "1. Enable Endpoint Analytics:\n   - Navigate to Reports > Endpoint analytics\n   - Overview > Start\n   - Accept Microsoft Data Collection\n2. Enroll Intune-managed devices:\n   - Endpoint analytics > Settings > General\n   - Intune data collection policy: Enable\n   - Automatically applies to Windows 10/11 devices\n3. Configure data collection:\n   - Client requires:\n     * Windows 10 1903+ or Windows 11\n     * Connected User Experiences and Telemetry service (DiagTrack) enabled\n   - Diagnostic data level: Enhanced (for full insights) or Required (minimum)\n4. Available inventory reports:\n   - Devices > Device performance: Startup times, restart frequency\n   - Apps > Application reliability: Crash rates, version tracking\n   - Hardware > Resource performance: Memory, CPU, disk usage\n   - Recommended software: Updates needed, EOL software\n5. Device hardware inventory includes:\n   - Model, manufacturer, BIOS version\n   - Memory (total, available)\n   - Storage (capacity, free space, disk type)\n   - Battery health (for laptops)\n   - Display information\n6. View device-specific inventory:\n   - Endpoint analytics > Device performance\n   - Select device > View details\n7. Export inventory data:\n   - Each report section has export capability\n   - CSV format for further analysis\n8. Data refresh: Every 24 hours\n9. Retention: 30 days for detailed telemetry",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/analytics/"
    },
    {
      "settingName": "IntuneDeviceQuery",
      "displayName": "Intune Device Query - Real-Time Inventory",
      "settingPath": "Intune.DeviceQuery.Enabled",
      "policyType": "Intune",
      "policySubType": "AdvancedEndpointAnalytics",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables real-time device querying using KQL to retrieve immediate hardware, software, registry, and network configuration data for on-demand component verification and inventory validation",
      "implementationGuide": "1. License requirement:\n   - Intune Suite or Advanced Endpoint Analytics add-on\n   - Trial available: 90 days for 250 users\n   - Enable: Tenant administration > Intune add-ons > Advanced Endpoint Analytics\n2. Prerequisites:\n   - Devices enrolled in Intune\n   - Devices enrolled in Endpoint Analytics\n   - Admin permission: 'Managed Devices - Query' role\n3. Access device query:\n   - Devices > All devices > Select device\n   - Monitor > Device query\n4. Query examples for inventory:\n   \n   Hardware inventory:\n   ```\n   WMI('root\\cimv2', 'SELECT * FROM Win32_ComputerSystem')\n   | project Manufacturer, Model, TotalPhysicalMemory\n   ```\n   \n   Software inventory:\n   ```\n   RegistryInventory('HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall')\n   | project DisplayName, DisplayVersion, Publisher\n   ```\n   \n   Network configuration:\n   ```\n   WMI('root\\cimv2', 'SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled=True')\n   | project Description, IPAddress, MACAddress\n   ```\n   \n   Disk inventory:\n   ```\n   WMI('root\\cimv2', 'SELECT * FROM Win32_LogicalDisk WHERE DriveType=3')\n   | project DeviceID, VolumeName, Size, FreeSpace\n   ```\n5. Save common queries for reuse\n6. Export query results to CSV\n7. Use for inventory verification and ad-hoc reporting\n8. Query results return in seconds (near real-time)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/device-query"
    },
    {
      "settingName": "InventoryUpdateProcess",
      "displayName": "Automated Inventory Update on Component Changes",
      "settingPath": "Intune.Inventory.AutoUpdate",
      "policyType": "Intune",
      "policySubType": "ProcessControl",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"onInstallation\":\"automatic\",\"onRemoval\":\"automatic\",\"onUpdate\":\"automatic\",\"syncInterval\":\"24 hours\"}",
      "validationOperator": "==",
      "description": "Ensures inventory automatically updates when devices are enrolled, unenrolled, or modified, maintaining accurate component tracking during installations, removals, and system updates without manual intervention",
      "implementationGuide": "1. Device enrollment auto-inventory:\n   - When device enrolls in Intune, inventory starts automatically\n   - Initial sync within 24 hours\n   - Azure AD device object created immediately\n2. Configure automatic inventory triggers:\n   a. New device installation:\n      - Autopilot enrollment or manual enrollment\n      - Device registers in Azure AD\n      - Intune MDM enrollment completes\n      - Hardware inventory collection begins\n      - Software inventory starts discovery\n   \n   b. Application installation/removal:\n      - Intune tracks all app deployments in real-time\n      - Discovered apps refresh every 7 days\n      - Use Proactive Remediations for immediate updates if needed\n   \n   c. Device retirement/wipe:\n      - Device > Retire or Wipe\n      - Inventory record marked as retired\n      - Azure AD device disabled or deleted per retention policy\n   \n   d. Hardware changes:\n      - Properties Catalog agent detects changes every 24 hours\n      - Memory upgrades, storage changes auto-update\n3. Monitor inventory accuracy:\n   - Devices > Monitor > Device actions\n   - Verify sync status and last check-in time\n4. Set up inventory validation reports:\n   - Reports > Device compliance > Custom report\n   - Include: Device name, Last sync, Enrollment date\n   - Schedule: Weekly\n5. Configure stale device cleanup:\n   - Devices not checking in for 90+ days\n   - Auto-cleanup or flag for manual review\n6. Document inventory change process:\n   - Change management integration\n   - Notify when devices added/removed\n   - Quarterly reconciliation with asset management\n7. Inventory data retention:\n   - Active devices: Real-time\n   - Retired devices: 30 days (configurable)\n   - Deleted devices: 90 days in recycle bin",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/remote-actions/devices-wipe"
    },
    {
      "settingName": "sensitivityLabelsEnabled",
      "displayName": "Sensitivity Labels Enabled and Published",
      "settingPath": "microsoft.purview.informationProtection.labels.enabled",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Ensures sensitivity labels are created, configured, and published to classify and track CUI location across Microsoft 365 services including SharePoint, OneDrive, Teams, and Exchange",
      "implementationGuide": "1. Sign in to Microsoft Purview portal > Solutions > Information Protection\n2. Create sensitivity labels with appropriate CUI classifications (e.g., 'CUI', 'Controlled', 'Sensitive')\n3. Configure label settings including scope (Files & emails, Groups & sites)\n4. Create and publish label policy to target users/groups\n5. Assign admin units if using administrative units in Microsoft Entra ID\n6. Allow 24 hours for labels to propagate through services",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/create-sensitivity-labels"
    },
    {
      "settingName": "autoLabelingEnabled",
      "displayName": "Auto-Labeling Policies for CUI Detection",
      "settingPath": "microsoft.purview.informationProtection.autoLabeling.enabled",
      "policyType": "Purview",
      "policySubType": "AutoLabeling",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically applies sensitivity labels to content containing CUI based on sensitive information types (SITs) and trainable classifiers, ensuring consistent identification and tracking of CUI location",
      "implementationGuide": "1. Navigate to Microsoft Purview portal > Information Protection > Auto-labeling\n2. Create new auto-labeling policy for files/emails\n3. Define conditions using built-in SITs (SSN, credit cards, etc.) or custom classifiers for CUI patterns\n4. Configure detection criteria (All of these / Any of these)\n5. Select sensitivity label to apply when conditions are met\n6. Choose locations (Exchange, SharePoint, OneDrive)\n7. Set policy to simulation mode first, review results, then enable\n8. Monitor policy performance and adjust thresholds as needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/apply-sensitivity-label-automatically"
    },
    {
      "settingName": "dataClassificationDashboard",
      "displayName": "Data Classification Dashboard and Activity Explorer Enabled",
      "settingPath": "microsoft.purview.dataGovernance.insights.enabled",
      "policyType": "Purview",
      "policySubType": "DataGovernance",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Provides centralized visibility and reporting on sensitivity label usage, data classification distribution, and CUI location tracking across the Microsoft 365 environment through pre-built dashboards and activity monitoring",
      "implementationGuide": "1. Access Microsoft Purview portal > Data classification > Overview\n2. Review top sensitivity labels applied across organization\n3. Monitor label activity using Activity Explorer (Solutions > Information Protection > Activity Explorer)\n4. Configure alerts for label changes, downgrades, or removals\n5. Export reports for audit and compliance documentation\n6. Review label distribution by location (SharePoint sites, OneDrive accounts, Exchange mailboxes)\n7. Track user adoption and label coverage metrics\n8. Schedule regular reviews of classification insights",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/data-classification-overview"
    },
    {
      "settingName": "contentSearchAndEDiscovery",
      "displayName": "Content Search and eDiscovery for CUI Discovery",
      "settingPath": "microsoft.purview.compliance.contentSearch.enabled",
      "policyType": "Purview",
      "policySubType": "Compliance",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables comprehensive search and discovery of CUI across Microsoft 365 using KQL queries and custom keyword lists to locate, inventory, and document where sensitive information is stored and processed",
      "implementationGuide": "1. Navigate to Microsoft Purview portal > Solutions > Content search\n2. Create new content search with descriptive name\n3. Define search locations (Exchange, SharePoint, OneDrive, Teams)\n4. Build KQL query or use keyword lists to identify CUI patterns\n5. Add conditions for sensitivity labels if already applied\n6. Run search and review results for CUI locations\n7. Export results for documentation and inventory purposes\n8. Create retention policies based on CUI locations discovered\n9. Document findings including site URLs, mailbox names, file paths",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/ediscovery-content-search"
    },
    {
      "settingName": "purviewDataMapScanning",
      "displayName": "Purview Data Map Scanning for Data Discovery",
      "settingPath": "microsoft.purview.dataMap.scanning.enabled",
      "policyType": "Purview",
      "policySubType": "DataMap",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically scans and catalogs data sources including Azure Storage, SQL databases, SharePoint, and on-premises systems to identify, classify, and document where CUI is stored across the hybrid data estate",
      "implementationGuide": "1. Access Microsoft Purview portal > Data Map\n2. Register data sources (Azure Storage, SQL, SharePoint, on-premises)\n3. Create scan rule sets with CUI classification patterns\n4. Configure scan schedules (weekly, monthly) for continuous discovery\n5. Enable auto-labeling rules to apply sensitivity labels during scans\n6. Review scan results and classification reports in Data Estate Insights\n7. Correlate discovered CUI locations with sensitivity labels\n8. Export data catalog with CUI location metadata\n9. Configure alerts for new CUI discoveries or location changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/data-map-sensitivity-labels"
    },
    {
      "settingName": "namedLocationsConfigured",
      "displayName": "Named Locations for High-Risk Geographic Areas",
      "settingPath": "microsoft.graph.identity.conditionalAccess.namedLocations",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "configured",
      "validationOperator": "exists",
      "description": "Defines specific geographic locations or IP ranges identified as high-risk areas (e.g., countries with elevated cyber threat profiles) for use in Conditional Access policies to enforce stricter security requirements on devices accessing from those locations",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Named locations\n3. Create new named location with descriptive name (e.g., 'High-Risk Countries')\n4. Select 'Countries location' type\n5. Mark as 'Include unknown countries/regions' if desired\n6. Select all countries considered high-risk based on organizational policy and threat intelligence\n7. Or create IP-based locations for specific high-risk network ranges\n8. Enable 'Mark as trusted location' for known safe locations (inverse approach)\n9. Document location definitions in security policies\n10. Test policies in report-only mode before enforcement",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/location-condition"
    },
    {
      "settingName": "locationBasedConditionalAccess",
      "displayName": "Location-Based Conditional Access Policies for High-Risk Areas",
      "settingPath": "microsoft.graph.identity.conditionalAccess.policies",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"conditions\":{\"locations\":\"excludeTrusted\"},\"grantControls\":[\"mfa\",\"compliantDevice\"]}",
      "validationOperator": "contains",
      "description": "Enforces enhanced security requirements (MFA, device compliance, approved apps) when users access corporate resources from high-risk locations, and blocks or restricts access based on geographic risk profile",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center > Protection > Conditional Access > Policies\n2. Create new policy with name 'High-Risk Location Access Policy'\n3. Under Assignments > Users: Select 'All users' or specific groups traveling to high-risk areas\n4. Under Cloud apps: Select 'All cloud apps' or specific sensitive applications\n5. Under Conditions > Locations: Configure to Yes\n6. Include: 'Any location' or 'Selected locations' (high-risk named locations)\n7. Exclude: 'All trusted locations' and 'Selected locations' (known safe locations)\n8. Under Access controls > Grant: Select 'Grant access' with conditions:\n   - Require multifactor authentication\n   - Require device to be marked as compliant\n   - Require approved client app (optional)\n9. Set 'Require all the selected controls' or 'Require one of the selected controls' based on risk\n10. Enable policy in Report-only mode first, review impact, then set to 'On'",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-location"
    },
    {
      "settingName": "enhancedDeviceCompliance",
      "displayName": "Enhanced Device Compliance Policies for High-Risk Scenarios",
      "settingPath": "microsoft.graph.deviceManagement.deviceCompliancePolicies",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"passwordRequired\":true,\"passwordMinimumLength\":14,\"passwordComplexity\":\"high\",\"storageRequireEncryption\":true,\"securityRequireVerifyApps\":true,\"defenderEnabled\":true,\"defenderSignatureUpToDate\":true,\"osMinimumVersion\":\"latest\"}",
      "validationOperator": ">=",
      "description": "Defines stricter device compliance requirements (longer passwords, full disk encryption, up-to-date security, latest OS) that can be selectively enforced on devices used in high-risk travel scenarios through compliance policies and Conditional Access",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Compliance policies > Create policy\n3. Select platform (Windows, iOS, Android, macOS)\n4. Configure enhanced settings:\n   - Device Health: Require BitLocker/encryption, secure boot enabled\n   - Device Properties: Minimum OS version (latest stable)\n   - System Security: Firewall required, antivirus required and up-to-date\n   - Password: Minimum length 14+, complexity required, maximum password age\n   - Defender for Endpoint: Device threat level at or below 'Medium'\n5. Set Actions for noncompliance:\n   - Mark device noncompliant: Immediately\n   - Send email to end user: After 1 day\n   - Retire noncompliant device: After 30 days (optional for high-risk)\n6. Assign policy to groups containing users traveling to high-risk areas\n7. Monitor compliance status in Intune dashboard\n8. Combine with Conditional Access requiring compliant device",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started"
    },
    {
      "settingName": "remoteWipeCapability",
      "displayName": "Remote Wipe and Factory Reset for Compromised Devices",
      "settingPath": "microsoft.graph.deviceManagement.remoteActions.wipe",
      "policyType": "Intune",
      "policySubType": "RemoteActions",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables remote factory reset or selective wipe capabilities for devices returning from high-risk areas or suspected of tampering/compromise, allowing complete data erasure and device sanitization as a security requirement",
      "implementationGuide": "1. Ensure devices are enrolled in Microsoft Intune\n2. To wipe a device: Navigate to Devices > All devices\n3. Select the device returning from high-risk travel\n4. In device overview pane, select 'Wipe' from remote actions\n5. Choose wipe options:\n   - For full reset: Uncheck 'Retain enrollment state and user account'\n   - For selective wipe: Use 'Retire' action to remove only corporate data\n   - Enable 'Wipe device, and continue to wipe even if device loses power' for high-security scenarios\n6. For iOS/iPadOS: Optionally remove eSIM data plan\n7. For macOS: Enter 6-digit Recovery PIN and configure Obliteration Behavior\n8. Select 'Wipe' and confirm action (PIN won't be visible after wipe completes)\n9. Monitor wipe status in device actions history\n10. Re-enroll and reconfigure device after successful wipe before returning to normal use",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/remote-actions/device-wipe"
    },
    {
      "settingName": "deviceHealthAttestation",
      "displayName": "Device Health Attestation and Integrity Validation",
      "settingPath": "microsoft.graph.deviceManagement.deviceHealthAttestationState",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"bitLockerStatus\":\"enabled\",\"secureBootEnabled\":true,\"codeIntegrityEnabled\":true,\"bootDebuggingEnabled\":false}",
      "validationOperator": "==",
      "description": "Validates device integrity and detects tampering through hardware-backed attestation (TPM) to ensure devices returning from high-risk areas have not been compromised at the firmware or boot level",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Compliance policies\n2. Create or edit Windows 10/11 compliance policy\n3. Under Device Health section, configure:\n   - Require BitLocker: Require\n   - Require Secure Boot to be enabled: Require\n   - Require code integrity: Require\n   - Require Trusted Platform Module (TPM): Require\n4. Under Additional Settings:\n   - Boot debugging must be disabled: Require\n   - Allow Windows to enable DMA protections: Require\n5. For devices returning from travel, validate attestation status:\n   - Navigate to Devices > All devices > Select device\n   - Review Hardware tab for Device Health Attestation data\n   - Check for any integrity failures or anomalies\n6. For failed attestation: Perform remote wipe and factory reset\n7. Combine with Conditional Access policy requiring attestation pass\n8. Monitor device health attestation service logs in Azure Monitor",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows#device-health"
    },
    {
      "settingName": "defenderThreatLevel",
      "displayName": "Microsoft Defender for Endpoint Threat Level Requirements",
      "settingPath": "microsoft.graph.deviceManagement.deviceCompliancePolicies.advancedThreatProtectionRequiredSecurityLevel",
      "policyType": "Defender",
      "policySubType": "ThreatProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "medium",
      "validationOperator": "<=",
      "description": "Enforces device risk level assessment through Microsoft Defender for Endpoint integration, automatically marking devices noncompliant and blocking access if malware or threats are detected, especially critical for devices returning from high-risk areas",
      "implementationGuide": "1. Enable Microsoft Defender for Endpoint integration with Intune:\n   - Navigate to Endpoint security > Microsoft Defender for Endpoint\n   - Connect Intune to Defender for Endpoint tenant\n2. Create or edit device compliance policy\n3. Under Microsoft Defender for Endpoint section:\n   - Set 'Require the device to be at or under the machine risk score' to 'Medium' or 'Low'\n   - This enforces automatic compliance evaluation based on MDE threat detection\n4. Configure Conditional Access policy:\n   - Navigate to Endpoint security > Conditional Access\n   - Create policy requiring 'Require device to be marked as compliant'\n   - This blocks access when MDE detects threats\n5. When device returns from high-risk travel:\n   - MDE automatically scans for threats and malware\n   - If threats detected, device marked noncompliant\n   - Conditional Access blocks corporate resource access\n   - Automated remediation initiated or manual review required\n6. Monitor device risk in Microsoft Defender Security Center\n7. Investigate and remediate threats before restoring compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/advanced-threat-protection"
    },
    {
      "settingName": "blockLegacyAuthentication",
      "displayName": "Block Legacy Authentication",
      "settingPath": "conditionalAccess.policy.conditions.clientAppTypes",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"exchangeActiveSync\",\"other\"]",
      "validationOperator": "contains",
      "description": "Blocks legacy authentication protocols that do not support modern authentication methods including MFA. Legacy protocols like Basic Authentication, POP3, IMAP, and older Office clients are vulnerable to replay attacks and credential theft because they cannot enforce MFA or other replay-resistant mechanisms.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Policies\n3. Create new policy: 'Block Legacy Authentication'\n4. Under Assignments > Users: Select 'All users' (exclude break-glass accounts)\n5. Under Assignments > Cloud apps: Select 'All cloud apps'\n6. Under Conditions > Client apps: Select 'Exchange ActiveSync clients' and 'Other clients'\n7. Under Access controls > Grant: Select 'Block access'\n8. Enable policy and save\n9. Monitor sign-in logs to identify affected users before full enforcement\n10. Communicate with users to update to modern authentication clients",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/block-legacy-authentication"
    },
    {
      "settingName": "requireMfaAllUsers",
      "displayName": "Require MFA for All Users",
      "settingPath": "conditionalAccess.policy.grantControls.builtInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"mfa\"]",
      "validationOperator": "contains",
      "description": "Requires multi-factor authentication for all user accounts accessing cloud applications. MFA provides replay-resistant authentication through time-based one-time passwords (TOTP), push notifications with number matching, or cryptographic challenges that cannot be replayed by attackers intercepting authentication traffic.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Policies\n3. Create new policy: 'Require MFA for All Users'\n4. Under Assignments > Users: Select 'All users' (exclude break-glass accounts)\n5. Under Assignments > Cloud apps: Select 'All cloud apps'\n6. Under Access controls > Grant: Select 'Require multifactor authentication'\n7. Set 'Require all the selected controls'\n8. Enable policy in report-only mode initially\n9. Review sign-in logs for 2-4 weeks to assess impact\n10. Change policy to 'On' after validation\n11. Ensure users are registered for MFA before enforcement",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-all-users-mfa"
    },
    {
      "settingName": "phishingResistantMfaAdmins",
      "displayName": "Phishing-Resistant MFA for Administrators",
      "settingPath": "conditionalAccess.policy.grantControls.authenticationStrength",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Phishing-resistant MFA",
      "validationOperator": "==",
      "description": "Requires phishing-resistant MFA methods (FIDO2 security keys, Windows Hello for Business, Certificate-based Authentication) for administrator accounts. These methods use cryptographic protocols and hardware-backed security that are highly resistant to replay attacks and phishing.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Policies\n3. Create new policy: 'Require Phishing-Resistant MFA for Admins'\n4. Under Assignments > Users: Select 'Directory roles' and choose administrative roles (Global Admin, Security Admin, etc.)\n5. Under Assignments > Cloud apps: Select 'All cloud apps'\n6. Under Access controls > Grant: Select 'Require authentication strength'\n7. Choose 'Phishing-resistant MFA' strength (includes FIDO2, Windows Hello, Certificate-based auth)\n8. Exclude break-glass accounts configured with phishing-resistant methods\n9. Enable policy after ensuring admins have registered phishing-resistant methods\n10. Monitor for users unable to sign in and provide alternative phishing-resistant options",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-authentication-strengths"
    },
    {
      "settingName": "signInFrequencyAdmins",
      "displayName": "Sign-in Frequency for Administrators",
      "settingPath": "conditionalAccess.policy.sessionControls.signInFrequency",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"value\":1,\"type\":\"hours\",\"isEnabled\":true}",
      "validationOperator": "==",
      "description": "Requires administrators to re-authenticate every hour, limiting the window for session replay attacks. Frequent re-authentication with MFA ensures tokens cannot be replayed for extended periods and reduces the risk of session hijacking.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Policies\n3. Create or modify admin MFA policy\n4. Under Assignments > Users: Select 'Directory roles' and choose administrative roles\n5. Under Assignments > Cloud apps: Select 'All cloud apps'\n6. Under Session controls: Enable 'Sign-in frequency'\n7. Set frequency to '1 Hours' or '4 Hours' based on risk tolerance\n8. Ensure 'Require sign-in every time' is selected\n9. Save and enable policy\n10. Communicate change to administrators about increased authentication frequency",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime"
    },
    {
      "settingName": "persistentBrowserSession",
      "displayName": "Disable Persistent Browser Sessions for Administrators",
      "settingPath": "conditionalAccess.policy.sessionControls.persistentBrowser",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "never",
      "validationOperator": "==",
      "description": "Disables persistent browser sessions for administrators, requiring fresh authentication when browser is closed. Prevents long-lived session cookies that could be stolen and replayed by attackers to gain unauthorized access without re-authentication.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Policies\n3. Create or modify admin session policy\n4. Under Assignments > Users: Select 'Directory roles' and choose administrative roles\n5. Under Assignments > Cloud apps: Select 'All cloud apps'\n6. Under Session controls: Enable 'Persistent browser session'\n7. Select 'Never persistent' option\n8. Save and enable policy\n9. Test by closing browser and verifying re-authentication is required\n10. Communicate to administrators that 'Keep me signed in' option will be disabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime"
    },
    {
      "settingName": "auditLogsEnabled",
      "displayName": "Azure AD Audit Logs Enabled",
      "settingPath": "diagnosticSettings.logs.category",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"AuditLogs\"]",
      "validationOperator": "contains",
      "description": "Enables comprehensive audit logging for all user account lifecycle operations including creation, modification, deletion, and assignment of identifiers. Audit logs capture who authorized changes, when changes occurred, and what identifiers were assigned, providing complete accountability for identifier management as required by NIST 800-171.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Global Administrator\n2. Navigate to Identity > Monitoring & health > Diagnostic settings\n3. Select 'Add diagnostic setting'\n4. Provide name: 'Azure AD Audit Logs to Log Analytics'\n5. Under Logs, select 'AuditLogs' category\n6. Under Destination details, select 'Send to Log Analytics workspace'\n7. Select your Log Analytics workspace (create one if needed)\n8. Set retention period to at least 90 days (recommended: 1 year)\n9. Save the diagnostic setting\n10. Verify logs are flowing: Navigate to Log Analytics workspace > Logs > Query: AuditLogs | take 10",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs"
    },
    {
      "settingName": "inactiveUserDisable",
      "displayName": "Disable Inactive User Accounts",
      "settingPath": "conditionalAccess.policy.conditions.users.inactiveThreshold",
      "policyType": "AzureAD",
      "policySubType": "AccessReview",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 90,
      "validationOperator": "<=",
      "description": "Automatically reviews and disables user accounts that have been inactive for 90 days or more. Inactive accounts represent identifiers that are no longer in use and pose security risks. Regular reviews ensure identifiers are only active when needed and are properly managed throughout their lifecycle.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Identity Governance Administrator\n2. Navigate to Identity Governance > Access reviews\n3. Select 'New access review'\n4. Review type: 'Teams + Groups' or 'Applications'\n5. Under Scope, select groups containing all users\n6. Set Review type to 'All users'\n7. Under 'Inactive users (on tenant level only)': Enable and set to 90 days\n8. Set Duration: 30 days\n9. Set Recurrence: Monthly or Quarterly\n10. Under 'Upon completion settings': Select 'Auto apply results to resource'\n11. Select 'Disable user' for users who don't respond\n12. Start review\n13. Configure email notifications to reviewers and affected users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/create-access-review"
    },
    {
      "settingName": "deletedUserRetention",
      "displayName": "Deleted User Retention Period",
      "settingPath": "directory.settings.deletedUserRetentionDays",
      "policyType": "AzureAD",
      "policySubType": "DirectorySettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 30,
      "validationOperator": "==",
      "description": "Maintains deleted user accounts in soft-delete state for 30 days before permanent deletion. During this period, the identifier (UPN, Object ID) cannot be reused, preventing confusion and maintaining clear audit trails. After 30 days, identifiers are permanently removed and can only be reused after organization-defined period.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Global Administrator\n2. Navigate to Identity > Users > Deleted users\n3. Note: Azure AD automatically retains deleted users for 30 days (default, cannot be modified)\n4. To permanently delete immediately: Select user > Permanent delete > Confirm\n5. To restore within 30 days: Select user > Restore user > Confirm\n6. Configure organizational policy: Establish waiting period before allowing identifier reuse (e.g., 90 days after permanent deletion)\n7. Document policy in security procedures\n8. Train identity administrators on identifier reuse restrictions\n9. Use Graph API to monitor: GET https://graph.microsoft.com/v1.0/directory/deletedItems/microsoft.graph.user\n10. Create alerts for identifiers approaching reuse eligibility",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/fundamentals/users-restore"
    },
    {
      "settingName": "userTypeIdentification",
      "displayName": "User Status Identification (UserType)",
      "settingPath": "user.userType",
      "policyType": "AzureAD",
      "policySubType": "UserAttribute",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "[\"Member\",\"Guest\"]",
      "validationOperator": "in",
      "description": "Identifies user status through the userType attribute which distinguishes between internal employees (Member) and external users (Guest). This attribute is automatically set and enforced by Azure AD, enabling proper identification of individual status for access control, auditing, and compliance purposes.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as User Administrator\n2. Navigate to Identity > Users > All users\n3. For new internal employees: Create user with type 'Member' (default)\n4. For external collaborators: Use B2B invitation which automatically sets type 'Guest'\n5. View user type: Select user > Properties > Identity section\n6. Configure Conditional Access based on userType:\n   a. Navigate to Protection > Conditional Access\n   b. Create policy for Guest users with additional restrictions\n   c. Under Assignments > Users > Select users > User types\n   d. Select 'Guest or external users'\n7. Create report of user types:\n   GET https://graph.microsoft.com/v1.0/users?$select=userPrincipalName,userType\n8. Note: userType cannot be manually changed after creation\n9. For status changes: Delete and recreate user with correct type",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/external-id/user-properties"
    },
    {
      "settingName": "employeeTypeAttribute",
      "displayName": "Employee Type Classification",
      "settingPath": "user.employeeType",
      "policyType": "AzureAD",
      "policySubType": "UserAttribute",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "[\"Employee\",\"Contractor\",\"Vendor\",\"Partner\"]",
      "validationOperator": "in",
      "description": "Identifies individual status through the employeeType attribute which classifies users by employment relationship (Employee, Contractor, Vendor, Partner, etc.). This granular classification enables proper access control, conditional policies, and compliance reporting based on user status.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as User Administrator\n2. Navigate to Identity > Users > All users\n3. Select a user > Properties\n4. Under Job information section, locate 'Employee type' field\n5. Set appropriate value: Employee, Contractor, Vendor, Partner, or custom value\n6. Save changes\n7. Populate for all users via:\n   a. Manual update through portal\n   b. Sync from on-premises AD (employeeType attribute)\n   c. Graph API bulk update: PATCH https://graph.microsoft.com/v1.0/users/{id}\n   d. CSV import with employeeType column\n8. Configure Conditional Access policies based on employeeType:\n   a. Create policy for Contractors with limited access\n   b. Use filter: user.employeeType -eq 'Contractor'\n9. Create report: GET https://graph.microsoft.com/v1.0/users?$select=displayName,employeeType\n10. Establish organizational standards for employeeType values",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/graph/api/resources/user#properties"
    },
    {
      "settingName": "privilegedAccessReview",
      "displayName": "Access Reviews for Privileged Roles",
      "settingPath": "accessReviews.roleAssignments.recurrence",
      "policyType": "AzureAD",
      "policySubType": "AccessReview",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Monthly",
      "validationOperator": "==",
      "description": "Conducts monthly access reviews of privileged role assignments to ensure identifier assignments remain appropriate and authorized. Regular reviews verify that only authorized personnel retain privileged identifiers and that assignments are removed when no longer needed.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Identity Governance Administrator\n2. Navigate to Identity Governance > Access reviews\n3. Select 'New access review'\n4. Review type: 'Teams + Groups' > Select 'All Microsoft Entra roles'\n5. Scope: 'Select privileged roles'\n6. Select roles: Global Administrator, Privileged Role Administrator, Security Administrator, etc.\n7. Set Duration: 7 days\n8. Set Recurrence: Monthly\n9. Under Reviewers: Select 'Selected users or groups' (role owners or security team)\n10. Under Settings: Enable 'Require reviewer to provide justification'\n11. Under 'Upon completion settings': Set 'If reviewers don't respond' to 'Remove access'\n12. Enable 'Auto apply results to resource'\n13. Start review\n14. Configure email reminders at Day 3 and Day 6",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review"
    },
    {
      "settingName": "customBannedPasswordList",
      "displayName": "Custom Banned Passwords List",
      "settingPath": "authenticationMethods.password.customBannedPasswords",
      "policyType": "AzureAD",
      "policySubType": "PasswordProtection",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[]",
      "validationOperator": ">=",
      "description": "Maintains organization-specific list of banned passwords including company name, product names, common terms, and industry-specific vocabulary. Combined with Microsoft's global banned password list, this prevents users from selecting commonly-used, expected, or easily guessable passwords specific to the organization.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Authentication Administrator\n2. Navigate to Protection > Authentication methods > Password protection\n3. Under 'Custom banned password list': Set to 'Yes'\n4. Add terms to ban (up to 1,000 entries):\n   - Company name and variations\n   - Product/service names\n   - Location names (offices, cities)\n   - Industry-specific terms\n   - Common substitutions (P@ssw0rd, etc.)\n   - Previously breached organizational passwords\n5. Example entries: CompanyName, CompanyName123, ProductName, OfficeLoc\n6. Set 'Enforce custom list': Yes\n7. Save configuration\n8. Test: Attempt password change with banned term to verify enforcement\n9. Review and update list quarterly or when new terms identified\n10. Document update frequency in security procedures (recommended: quarterly)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-password-ban-bad"
    },
    {
      "settingName": "passwordProtectionEnforcement",
      "displayName": "Azure AD Password Protection Enforcement",
      "settingPath": "authenticationMethods.password.enableBannedPasswordCheck",
      "policyType": "AzureAD",
      "policySubType": "PasswordProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Enforced",
      "validationOperator": "==",
      "description": "Enforces Azure AD Password Protection which prevents users from setting passwords found on Microsoft's global banned password list (updated continuously based on real-world password attacks) and the organization's custom banned list. Verification occurs in real-time during password creation and changes.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Authentication Administrator\n2. Navigate to Protection > Authentication methods > Password protection\n3. Under 'Mode': Select 'Enforced' (not 'Audit')\n4. Verify 'Enable password protection on Windows Server Active Directory': Yes (for hybrid)\n5. Verify 'Enable custom banned password list': Yes\n6. Save configuration\n7. Test enforcement:\n   a. Attempt to set password with common term (e.g., 'Password123')\n   b. Verify rejection with message about password protection\n8. Monitor adoption:\n   a. Navigate to Reports > Authentication methods > Password protection\n   b. Review blocked password attempts\n9. For hybrid environments: Deploy Password Protection DC Agents\n10. Document enforcement policy in security procedures",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-password-ban-bad"
    },
    {
      "settingName": "passwordProtectionOnPremises",
      "displayName": "Password Protection for On-Premises AD",
      "settingPath": "authenticationMethods.password.enableBannedPasswordCheckOnPremises",
      "policyType": "AzureAD",
      "policySubType": "PasswordProtection",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Extends Azure AD Password Protection to on-premises Active Directory environments, ensuring password protection policies apply consistently across hybrid environments. DC agents enforce the same banned password lists and smart lockout policies on-premises as in the cloud.",
      "implementationGuide": "1. Prerequisites: Windows Server 2012 or later, Azure AD Connect\n2. Download Password Protection Proxy and DC Agent installers from Microsoft\n3. Install Password Protection Proxy:\n   a. Install on 2+ member servers (not DCs) for redundancy\n   b. Run installer as domain admin\n   c. Restart server after installation\n4. Register Proxy with Azure AD:\n   a. Open PowerShell as admin\n   b. Import-Module AzureADPasswordProtection\n   c. Register-AzureADPasswordProtectionProxy -AccountUpn admin@domain.com\n5. Install DC Agent on all Domain Controllers:\n   a. Run installer as domain admin\n   b. Restart DC after installation\n6. Register forest with Azure AD:\n   a. Register-AzureADPasswordProtectionForest -AccountUpn admin@domain.com\n7. Configure enforcement in Azure portal (step 1-6 from previous setting)\n8. Test on-premises password changes\n9. Monitor: Review DC Agent event logs (Event Viewer > Microsoft > AzureADPasswordProtection)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/howto-password-ban-bad-on-premises-deploy"
    },
    {
      "settingName": "tlsEncryptionRequired",
      "displayName": "TLS Encryption for Password Transmission",
      "settingPath": "authentication.protocol.requireTLS",
      "policyType": "AzureAD",
      "policySubType": "SecurityDefaults",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces TLS encryption for all authentication traffic to Azure AD, ensuring passwords are only transmitted over cryptographically protected channels (TLS 1.2+). Modern authentication protocols automatically enforce this requirement, and legacy protocols that don't support TLS are blocked.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Security Administrator\n2. Verify modern authentication is enforced:\n   a. Navigate to Protection > Conditional Access > Policies\n   b. Verify 'Block Legacy Authentication' policy exists and is enabled\n3. Verify TLS 1.2+ is required:\n   a. Azure AD automatically enforces TLS 1.2+ for all connections\n   b. No additional configuration needed for cloud-only environments\n4. For hybrid environments, configure TLS on-premises:\n   a. Enable TLS 1.2 on all DCs and ADFS servers\n   b. Disable TLS 1.0 and 1.1\n   c. Use PowerShell: New-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Server' -Name 'Enabled' -Value 1\n5. Test connections: Use SSL Labs or similar to verify TLS 1.2+\n6. Monitor sign-in logs for TLS version (available in Azure AD P1/P2)\n7. Document TLS requirements in security standards",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-authentication-authenticator-app"
    },
    {
      "settingName": "passwordHashStorage",
      "displayName": "Cryptographically Protected Password Storage",
      "settingPath": "directory.passwordHashSync",
      "policyType": "AzureAD",
      "policySubType": "PasswordStorage",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Azure AD stores passwords using salted, iterated PBKDF2-HMAC-SHA256 hashing, providing cryptographically strong protection. Passwords are never stored in plaintext or with reversible encryption. For hybrid environments, password hash sync replicates these protected hashes to the cloud.",
      "implementationGuide": "1. Azure AD automatically stores passwords with strong cryptographic protection\n2. For hybrid environments, enable Password Hash Sync:\n   a. Open Azure AD Connect on sync server\n   b. Select 'Customize synchronization options'\n   c. Sign in with Azure AD Global Admin credentials\n   d. Under 'Optional features', enable 'Password hash synchronization'\n   e. Complete wizard and let sync cycle run\n3. Verify sync status:\n   a. Sign in to Microsoft Entra admin center\n   b. Navigate to Identity > Hybrid management > Azure AD Connect\n   c. Verify 'Password hash sync' shows 'Enabled'\n   d. Check last sync timestamp\n4. Benefits of PHS:\n   - Leaked credential detection\n   - Seamless SSO capability\n   - Disaster recovery option\n   - No direct authentication to on-prem\n5. Document that Azure AD uses PBKDF2-HMAC-SHA256 with per-user salt\n6. Note: Passwords are NEVER transmitted or stored in reversible form",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/whatis-phs"
    },
    {
      "settingName": "forcePasswordChangeOnReset",
      "displayName": "Force Password Change After Reset",
      "settingPath": "authenticationMethods.passwordReset.requireChangeOnFirstSignIn",
      "policyType": "AzureAD",
      "policySubType": "SelfServicePasswordReset",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to select a new password on first sign-in after password reset or account recovery. Ensures temporary passwords are immediately replaced with user-selected passwords, preventing use of potentially compromised or weak temporary credentials.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Authentication Administrator\n2. For administrator-reset passwords:\n   a. Navigate to Identity > Users > All users\n   b. Select user > Reset password\n   c. Temporary password is auto-generated\n   d. 'Require this user to change their password when they first sign in' is CHECKED by default\n   e. Complete reset\n3. For Self-Service Password Reset (SSPR):\n   a. Navigate to Protection > Password reset\n   b. Verify 'Self-service password reset enabled' is 'All' or 'Selected'\n   c. SSPR automatically requires new password selection during reset\n   d. No temporary password is used - user creates new password immediately\n4. Verify force-change behavior:\n   a. Reset test user password\n   b. Sign in with temporary password\n   c. Confirm immediate prompt for new password\n5. This setting is enforced by default and cannot be disabled for cloud users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-sspr-howitworks"
    },
    {
      "settingName": "passwordMaskingEnabled",
      "displayName": "Password Field Masking",
      "settingPath": "authentication.ui.passwordMasking",
      "policyType": "AzureAD",
      "policySubType": "UISettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically obscures password characters with asterisks or dots during entry in all Azure AD authentication interfaces. Prevents shoulder surfing and visual capture of credentials on desktops, laptops, and mobile devices. This is enforced by default across all Microsoft authentication interfaces.",
      "implementationGuide": "1. Password masking is enforced by default in Azure AD/Microsoft Entra\n2. No configuration required - automatically applied to:\n   a. Azure portal sign-in\n   b. Microsoft 365 portal sign-in\n   c. Microsoft Authenticator app\n   d. Windows sign-in (Azure AD joined devices)\n   e. All Microsoft identity platform applications\n3. Verification steps:\n   a. Open browser in incognito/private mode\n   b. Navigate to portal.azure.com or office.com\n   c. Enter username\n   d. Begin typing password - verify characters are masked with bullets ()\n   e. Optional: Some browsers allow brief display (200ms) of last character typed\n4. For custom applications using Microsoft Identity Platform:\n   a. Use MSAL libraries which enforce password masking\n   b. Never implement custom password fields without masking\n5. Mobile devices: Verify masking works on iOS and Android\n6. This protection cannot be disabled - it's a core security control",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts"
    },
    {
      "settingName": "mfaNumberMatching",
      "displayName": "MFA Number Matching",
      "settingPath": "authenticationMethods.microsoftAuthenticator.numberMatchingRequired",
      "policyType": "AzureAD",
      "policySubType": "AuthenticationMethods",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires users to enter a number displayed on their sign-in screen into the Microsoft Authenticator app instead of simply approving a push notification. This obscures the authentication process from observers and prevents MFA fatigue attacks where attackers spam approval requests hoping users will accidentally approve.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Authentication Policy Administrator\n2. Navigate to Protection > Authentication methods > Microsoft Authenticator\n3. Under 'Configure' tab:\n   a. Set Status: 'Enabled'\n   b. Target: 'All users' (or specific groups)\n4. Under Authentication mode:\n   a. Enable 'Require number matching for push notifications': Yes\n   b. Set to 'Enabled' (not 'Microsoft managed')\n5. Additional context (optional):\n   a. Enable 'Show application name in push and passwordless notifications'\n   b. Enable 'Show geographic location in push and passwordless notifications'\n6. Save configuration\n7. Test with a user:\n   a. Sign in to portal\n   b. Complete MFA prompt\n   c. Verify number matching is required\n8. Communicate change to users before enforcement\n9. Monitor adoption via Authentication methods usage report\n10. This setting became default for all tenants in May 2023",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-mfa-number-match"
    },
    {
      "settingName": "limitedErrorMessages",
      "displayName": "Limited Authentication Error Details",
      "settingPath": "authentication.errorHandling.detailLevel",
      "policyType": "AzureAD",
      "policySubType": "SecurityDefaults",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Limited",
      "validationOperator": "==",
      "description": "Provides generic error messages for authentication failures that do not reveal whether a username exists or if the password was incorrect. Prevents attackers from enumerating valid usernames or determining which part of the authentication failed. Error codes are logged internally but not exposed to users.",
      "implementationGuide": "1. Azure AD enforces limited error messaging by default\n2. Failed authentication returns generic errors:\n   a. 'Your account or password is incorrect' (doesn't specify which)\n   b. Never reveals: 'This username does not exist'\n   c. Never reveals: 'Your password is incorrect'\n3. Verification:\n   a. Attempt sign-in with invalid username\n   b. Attempt sign-in with valid username, wrong password\n   c. Verify both show same generic message\n4. Error codes (AADSTS#####) are logged in sign-in logs but not displayed to end users\n5. Administrators can view detailed errors:\n   a. Sign in to Microsoft Entra admin center\n   b. Navigate to Identity > Monitoring > Sign-in logs\n   c. Select failed sign-in attempt\n   d. View detailed error code and description\n6. For custom applications:\n   a. Use MSAL libraries which handle errors appropriately\n   b. Never expose detailed Azure AD error messages to users\n   c. Log errors server-side for troubleshooting\n7. This behavior cannot be modified - it's a security control\n8. Document error handling in application security standards",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/develop/reference-error-codes"
    },
    {
      "settingName": "authenticationContextDisplay",
      "displayName": "Contextual Information Display in MFA",
      "settingPath": "authenticationMethods.microsoftAuthenticator.showContextualInformation",
      "policyType": "AzureAD",
      "policySubType": "AuthenticationMethods",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"showApplicationName\":true,\"showLocation\":true}",
      "validationOperator": "==",
      "description": "Displays application name and geographic location in Microsoft Authenticator push notifications to help users verify the authentication request is legitimate. While this provides some context, the actual approval still requires number matching which obscures the authentication from observers. The displayed information helps prevent social engineering but doesn't expose sensitive authentication secrets.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Authentication Policy Administrator\n2. Navigate to Protection > Authentication methods > Microsoft Authenticator\n3. Under 'Configure' tab, ensure Microsoft Authenticator is enabled\n4. Under 'Show additional context in notifications':\n   a. Enable 'Show application name in push and passwordless notifications'\n   b. Enable 'Show geographic location in push and passwordless notifications'\n5. These settings provide context WITHOUT exposing sensitive auth data:\n   - Application name: Shows which app is requesting auth\n   - Location: Shows approximate location of sign-in attempt\n   - Does NOT show: passwords, secrets, or authentication tokens\n6. Combined with number matching, provides both security and usability\n7. Save configuration\n8. Test with users:\n   a. Sign in from different location\n   b. Verify MFA prompt shows app name and location\n   c. User enters number from screen (number matching)\n9. Educate users: If location/app looks suspicious, deny the request\n10. These settings are recommended but optional enhancements",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-mfa-additional-context"
    },
    {
      "settingName": "AutomatedInvestigation",
      "displayName": "Automated Investigation and Response (AIR) - Full Automation",
      "settingPath": "security.microsoft.com/securitysettings/deviceManagement",
      "policyType": "Defender",
      "policySubType": "AutomatedInvestigation",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Full",
      "validationOperator": "==",
      "description": "Enables Microsoft Defender XDR to automatically investigate alerts and take remediation actions without manual approval. This setting ensures incidents are automatically analyzed and threats are contained, eradicated, and recovered from in real-time, supporting the preparation, detection, analysis, containment, eradication, and recovery phases of incident handling required by NIST 03.06.01.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. Go to Settings > Endpoints > Advanced features\n3. Under 'Automated Investigation', select 'Full - remediate threats automatically'\n4. Click 'Save preferences'\n5. For Defender for Office 365, go to Email & collaboration > Policies & rules > Threat policies > Automated investigation & response\n6. Select automation level 'Full - remediate threats automatically' for all device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/m365d-autoir"
    },
    {
      "settingName": "IncidentCorrelation",
      "displayName": "Microsoft Defender XDR Incident Correlation",
      "settingPath": "security.microsoft.com/incidents",
      "policyType": "Defender",
      "policySubType": "IncidentManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Defender XDR to automatically correlate related alerts from multiple workloads (Defender for Endpoint, Defender for Office 365, Defender for Identity, Defender for Cloud Apps) into unified incidents. This provides comprehensive visibility into the full attack story across devices, users, mailboxes, and cloud apps, enabling effective incident analysis and coordinated response across all vectors as required for incident handling preparation and detection phases.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. Go to Settings > Microsoft Defender XDR > Account\n3. Verify 'Microsoft Defender XDR' is turned on\n4. Under 'Incidents and alerts', ensure correlation is enabled\n5. Configure incident assignment and notification preferences\n6. Review Settings > Microsoft Defender XDR > Preview features to enable latest correlation capabilities\n7. Validate by checking Incidents page shows correlated alerts from multiple sources",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/investigate-incidents"
    },
    {
      "settingName": "ThreatIntelligence",
      "displayName": "Microsoft Threat Intelligence Integration",
      "settingPath": "security.microsoft.com/securitysettings/threat-intelligence",
      "policyType": "Defender",
      "policySubType": "ThreatIntelligence",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables integration with Microsoft Threat Intelligence to provide real-time threat indicators, context, and recommended response actions during incident investigations. This setting enhances the detection and analysis phase by providing security teams with up-to-date information about threat actors, attack techniques, indicators of compromise (IOCs), and proven remediation strategies, enabling more effective preparation and response to security incidents.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. Go to Settings > Endpoints > Advanced features\n3. Enable 'Threat intelligence' setting\n4. Go to Threat analytics (https://security.microsoft.com/threatanalytics3)\n5. Review analyst reports for latest threat intelligence\n6. Configure custom threat indicators under Settings > Endpoints > Indicators\n7. Set up alert notifications for high-priority threats\n8. Integrate with Microsoft Defender Threat Intelligence Premium if licensed for enhanced IOC feeds",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/threat-indicator-concepts"
    },
    {
      "settingName": "AutomatedRemediation",
      "displayName": "Automated Remediation Actions Configuration",
      "settingPath": "security.microsoft.com/preferences2/integration",
      "policyType": "Defender",
      "policySubType": "RemediationActions",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"QuarantineFile\",\"RemoveFile\",\"StopProcess\",\"IsolateDevice\",\"BlockUrl\",\"DisableUser\"]",
      "validationOperator": "contains",
      "description": "Configures which automated remediation actions Microsoft Defender XDR can execute during investigations. Critical actions include quarantining malicious files, removing threats, stopping malicious processes, isolating compromised devices, blocking malicious URLs, and disabling compromised user accounts. These automated actions directly implement the containment, eradication, and recovery phases of incident handling by automatically removing threats and preventing spread without requiring manual intervention.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. Go to Settings > Microsoft Defender XDR > Automated investigation and remediation\n3. For Defender for Endpoint: Settings > Endpoints > Device groups > Create/edit device group\n4. Set Automation level to 'Full - remediate threats automatically'\n5. Ensure the following remediation actions are enabled:\n   - Quarantine file\n   - Remove file\n   - Stop and quarantine process\n   - Isolate device\n   - Block URL\n   - Disable user account\n6. For Defender for Office 365: Email & collaboration > Threat policies > Automated investigation\n7. Configure similar remediation actions for email threats (soft delete, move to junk, block sender)\n8. Review Action Center regularly to monitor automated remediation effectiveness",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/m365d-autoir-actions"
    },
    {
      "settingName": "IncidentResponsePlaybooks",
      "displayName": "Security Playbooks and Automated Workflows",
      "settingPath": "security.microsoft.com/automation",
      "policyType": "Purview",
      "policySubType": "AutomationRules",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables security playbooks and automated workflows that define step-by-step procedures for responding to specific types of security incidents. Playbooks ensure consistent incident handling processes across the organization by automating investigation steps, evidence collection, notification procedures, and remediation actions. This supports the preparation phase by pre-defining response procedures and ensures all phases (detection, analysis, containment, eradication, recovery) follow documented, tested processes.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. For built-in playbooks: Go to Automated investigation under Email & collaboration\n3. Review available playbook types:\n   - User-reported phishing\n   - Malware in email\n   - Suspicious email forwarding\n   - Compromised user detection\n4. For custom workflows: Settings > Microsoft Defender XDR > Automation & orchestration\n5. Create custom automation rules for specific incident types\n6. Define automated actions such as:\n   - Assign to specific analyst or team\n   - Add tags for categorization\n   - Close low-severity incidents automatically\n   - Escalate high-severity incidents\n   - Notify stakeholders via email or Teams\n7. Test playbooks using simulated incidents to validate effectiveness\n8. Document playbook logic and decision trees for audit purposes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/m365d-autoir"
    },
    {
      "settingName": "UnifiedAuditLogIngestionEnabled",
      "displayName": "Microsoft 365 Unified Audit Log",
      "settingPath": "Get-AdminAuditLogConfig | UnifiedAuditLogIngestionEnabled",
      "policyType": "Purview",
      "policySubType": "AuditLog",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables the Microsoft 365 Unified Audit Log to capture, record, and retain thousands of user and admin operations performed across all Microsoft 365 services. This is the foundational requirement for tracking and documenting security incidents, providing comprehensive audit trails of activities across Exchange Online, SharePoint, OneDrive, Teams, Azure AD, Defender, and other services. Audit logs include timestamp, user, action, object, IP address, and result information essential for incident investigation and forensics.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell:\n   Connect-ExchangeOnline\n2. Verify audit logging status:\n   Get-AdminAuditLogConfig | Format-List UnifiedAuditLogIngestionEnabled\n3. If False, enable unified audit logging:\n   Set-AdminAuditLogConfig -UnifiedAuditLogIngestionEnabled $true\n4. Verify in Microsoft Purview portal (https://compliance.microsoft.com)\n5. Go to Solutions > Audit\n6. Confirm banner shows 'Start recording user and admin activity' is NOT displayed\n7. Wait up to 60 minutes for audit logging to fully activate\n8. Test by searching audit logs for recent activity\n9. Configure audit log retention policies under Audit > Retention policies for long-term retention (E5 license required for >90 days)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-solutions-overview"
    },
    {
      "settingName": "AlertPolicies",
      "displayName": "Security Alert Policies for Incident Detection",
      "settingPath": "compliance.microsoft.com/alertpolicies",
      "policyType": "Purview",
      "policySubType": "AlertPolicy",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"SuspiciousMailForwarding\",\"ElevatedAccountActivity\",\"MalwareDetected\",\"UnusualExternalSharing\",\"RansomwareActivity\"]",
      "validationOperator": "contains",
      "description": "Configures alert policies in Microsoft Purview to automatically detect and notify security teams about suspicious activities and potential security incidents. Critical alert policies monitor for suspicious mail forwarding rules, unusual admin activity, malware detection, excessive external sharing, potential ransomware activity, and other indicators of compromise. Alerts enable timely detection and reporting of incidents to the incident response team within defined timeframes.",
      "implementationGuide": "1. Navigate to Microsoft Purview portal (https://compliance.microsoft.com)\n2. Go to Solutions > Alerts > Alert policies\n3. Review and enable recommended default alert policies:\n   - Suspicious email forwarding activity\n   - Elevation of Exchange admin privilege\n   - Malware campaign detected after delivery\n   - Unusual volume of external file sharing\n   - Ransomware activity detected\n   - User restricted from sending email\n   - Forms phishing detected\n4. Configure each alert policy:\n   - Set severity level (High, Medium, Low)\n   - Define email notification recipients\n   - Set alert aggregation settings\n   - Configure threshold if applicable\n5. Create custom alert policies for organization-specific threats\n6. Test alerts by simulating conditions to verify notifications work\n7. Document notification procedures and escalation paths\n8. Review Alerts dashboard regularly to tune policy sensitivity",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/alert-policies"
    },
    {
      "settingName": "UserReportedMessages",
      "displayName": "User Submission of Suspicious Messages",
      "settingPath": "security.microsoft.com/securitysettings/userSubmission",
      "policyType": "Defender",
      "policySubType": "UserReporting",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Report Message and Report Phishing add-ins that allow end users to easily report suspicious emails, phishing attempts, and potential security incidents directly to the security team. User submissions are aggregated in the User reported messages page and can trigger automated investigations. This capability provides an incident response support resource that makes it easy for users to report potential incidents and receive feedback, fulfilling the requirement to offer incident reporting assistance to system users.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n2. Go to Email & collaboration > Policies & rules > Threat policies\n3. Select 'User reported message settings'\n4. Enable 'Microsoft Report Message and Report Phishing add-in':\n   - Select 'Use the built-in Report button'\n   - Choose where to send reported messages:\n     * Send to Microsoft for analysis\n     * Send to designated reporting mailbox\n     * Send to both\n5. Configure reporting mailbox:\n   - Specify email address (e.g., security@contoso.com)\n   - Ensure mailbox is monitored by security team\n6. Deploy Report Message add-in to users:\n   - Microsoft 365 Admin Center > Settings > Integrated apps\n   - Deploy 'Microsoft Report Message' add-in\n7. Configure user confirmation messages:\n   - Customize 'Thank you' message shown after submission\n   - Include information about what happens next\n8. Monitor User reported messages under Email & collaboration > Submissions\n9. Provide feedback to users on their submissions\n10. Create training materials showing users how to use Report Message button",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/user-submission"
    },
    {
      "settingName": "AuditLogRetention",
      "displayName": "Audit Log Retention Policies",
      "settingPath": "compliance.microsoft.com/auditlogsearch",
      "policyType": "Purview",
      "policySubType": "AuditRetention",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 365,
      "validationOperator": ">=",
      "description": "Configures retention period for audit logs in Microsoft Purview to ensure incident data is retained for sufficient duration to support investigations, forensics, compliance reporting, and trend analysis. Standard retention is 90 days (E3) or 365 days (E5). Custom audit log retention policies can extend retention up to 10 years for critical event types. Adequate retention ensures incident information remains available for documentation, reporting to authorities, and analysis of attack patterns over time.",
      "implementationGuide": "1. Navigate to Microsoft Purview portal (https://compliance.microsoft.com)\n2. Go to Solutions > Audit > Retention policies\n3. Review default retention periods:\n   - E3/Business: 90 days default\n   - E5: 365 days for Exchange, SharePoint, OneDrive, Azure AD\n4. Create custom audit log retention policy (E5 required):\n   - Click 'Create audit log retention policy'\n   - Name: 'Security Incident Audit Retention'\n   - Set retention duration: 365 days or longer\n   - Define record types to retain:\n     * AzureActiveDirectory (all)\n     * ExchangeAdmin\n     * ExchangeItem\n     * SharePoint\n     * OneDrive\n     * MicrosoftTeams\n     * Defender activities\n   - Add specific activities if needed (e.g., 'UserLoggedIn', 'FileMalwareDetected')\n   - Set priority to ensure policy applies\n5. For critical security events, create 10-year retention policy (requires add-on license)\n6. Verify policies are active and audit data is being retained\n7. Document retention policy for compliance and legal requirements\n8. Schedule regular exports of audit data to external SIEM or storage for backup",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies"
    },
    {
      "settingName": "AttackSimulationTraining",
      "displayName": "Attack Simulation Training Platform",
      "settingPath": "security.microsoft.com/attacksimulator",
      "policyType": "Defender",
      "policySubType": "AttackSimulation",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Attack Simulation Training in Microsoft Defender for Office 365 Plan 2 to conduct realistic but harmless phishing simulations and social engineering tests that evaluate the organization's incident response capability. Attack simulations test how users report suspicious messages, how security tools detect threats, how quickly alerts are generated, and how effectively the incident response team responds to simulated attacks. This directly implements incident response testing requirements by providing controlled testing of detection and response mechanisms.",
      "implementationGuide": "1. Verify licensing: Attack Simulation Training requires Microsoft 365 E5 or Defender for Office 365 Plan 2\n2. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n3. Go to Email & collaboration > Attack simulation training\n4. Review Overview tab to familiarize with capabilities:\n   - Recent simulations\n   - Simulated users vs non-simulated\n   - Training completion rates\n   - Repeat offenders\n5. Assign required permissions:\n   - Attack Simulation Administrator: Full control\n   - Attack Simulation Payload Author: Create payloads\n6. Configure Settings tab:\n   - Set up simulation launch preferences\n   - Define repeat offender threshold (default: 2 consecutive compromises)\n   - Configure end-user notifications\n7. Ensure Safe Links and Safe Attachments policies allow simulation URLs\n8. Create initial test simulation to validate platform functionality\n9. Document attack simulation schedule and testing procedures\n10. Integrate simulation results into incident response plan testing metrics",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulation-training-get-started"
    },
    {
      "settingName": "PhishingSimulations",
      "displayName": "Phishing Simulation Campaigns",
      "settingPath": "security.microsoft.com/attacksimulator?viewid=simulations",
      "policyType": "Defender",
      "policySubType": "SimulationCampaign",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"CredentialHarvest\",\"MalwareAttachment\",\"LinkInAttachment\",\"LinkToMalware\"]",
      "validationOperator": "contains",
      "description": "Configures and executes regular phishing simulation campaigns using various attack techniques to test incident detection and response procedures. Simulations use realistic phishing scenarios including credential harvesting, malware attachments, malicious links, and drive-by URLs. Each simulation tests whether users report suspicious messages, whether security systems generate alerts, and whether the incident response team detects and responds appropriately. Regular simulation campaigns provide ongoing testing of incident response effectiveness at defined frequencies.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal > Attack simulation training > Simulations tab\n2. Click 'Launch a simulation' to create new simulation:\n3. Select technique to test:\n   - Credential Harvest: Tests password phishing response\n   - Malware Attachment: Tests file-based threat detection\n   - Link in Attachment: Tests multi-stage attack detection\n   - Link to Malware: Tests URL-based threat response\n   - Drive-by URL: Tests automated malware download scenarios\n4. Configure simulation parameters:\n   - Name simulation: 'Q1 2025 Phishing Test - Credential Harvest'\n   - Select payload from library or create custom\n   - Target users: Start with pilot group, expand to organization\n   - Schedule launch: Immediate or scheduled\n5. Configure training assignment:\n   - Assign training to users who fall for simulation\n   - Select training modules based on technique\n   - Set training due date\n6. Configure landing pages:\n   - Customize message shown to compromised users\n   - Include education on how to identify phishing\n   - Add reporting instructions\n7. Configure notifications:\n   - Notify users before/during/after simulation\n   - Deliver training based on user actions\n8. Launch simulation and monitor progress\n9. Document simulation schedule (recommend monthly or quarterly)\n10. Review results to identify trends and improvement areas",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulation-training-simulations"
    },
    {
      "settingName": "SimulationAutomation",
      "displayName": "Automated Simulation Campaigns",
      "settingPath": "security.microsoft.com/attacksimulator?viewid=simulationautomation",
      "policyType": "Defender",
      "policySubType": "SimulationAutomation",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables automated simulation campaigns that run on defined schedules without manual intervention, ensuring consistent and regular testing of incident response capabilities. Simulation automations can be configured to launch randomized phishing simulations at specified frequencies (weekly, bi-weekly, monthly), automatically select payloads, target different user groups, and repeat for defined durations. Automation ensures that incident response testing occurs at the organization-defined frequency without requiring manual administration for each test.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal > Attack simulation training > Simulation automations tab\n2. Click 'Create automation' to set up automated testing:\n3. Configure automation details:\n   - Name: 'Monthly Phishing Response Test'\n   - Description: 'Automated testing of incident response capability per NIST 800-171 03.06.03'\n4. Select social engineering techniques:\n   - Choose multiple techniques to vary testing\n   - Credential Harvest (most common)\n   - Link in Attachment\n   - Malware Attachment\n5. Select payload strategy:\n   - Randomize: System selects different payloads each run\n   - Manual selection: Choose specific payloads to test\n   - Recommend randomized for varied testing\n6. Configure landing pages and training:\n   - Use default Microsoft landing pages\n   - Assign appropriate training modules\n   - Set training due dates\n7. Configure end-user notifications:\n   - Notification timing (before, during, after)\n   - Delivery preferences\n8. Set simulation schedule:\n   - Schedule type: Randomized or Fixed\n   - Frequency: Weekly, Bi-weekly, Monthly, Quarterly\n   - Start and end dates\n   - Days/times for simulation delivery\n9. Configure launch details:\n   - Use unique payloads for each campaign\n   - Target users: All users or specific groups\n   - Enable 'Target repeat offenders' for focused testing\n10. Submit automation and monitor execution\n11. Review automation results regularly to track trends",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulation-training-simulation-automations"
    },
    {
      "settingName": "SimulationReporting",
      "displayName": "Attack Simulation Insights and Reports",
      "settingPath": "security.microsoft.com/attacksimulator?viewid=insights",
      "policyType": "Defender",
      "policySubType": "SimulationReports",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Provides comprehensive reporting and analytics on simulation results including user compromise rates, message reporting rates, training completion rates, repeat offenders, and simulation coverage. Reports measure the effectiveness of incident detection and response procedures by tracking key metrics: time from simulation delivery to user reporting, detection by security tools, alert generation, and incident response team actions. Detailed reports enable organizations to identify weaknesses in their incident response capability and track improvement trends over time.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal > Attack simulation training > Overview tab\n2. Review key metrics dashboards:\n   - Recent simulations status\n   - Simulation coverage (simulated vs non-simulated users)\n   - Training completion rates\n   - Repeat offenders statistics\n3. Access detailed reports on Reports tab:\n   - Simulation impact: Shows user actions (reported, clicked, compromised)\n   - Training efficacy: Measures training completion and impact on behavior\n   - Behavior impact over time: Trends in user response\n4. Drill into specific simulation results:\n   - Click on simulation name to see details\n   - View user-level data: who clicked, who reported, who was compromised\n   - Review timeline of user actions\n   - Export user list for targeted training\n5. Use Attack simulation report (separate detailed report):\n   - Access from Reports > Email & collaboration\n   - View simulation details tab for individual campaign results\n   - Check user coverage tab for testing gaps\n   - Review training completion tab for training effectiveness\n6. Generate executive summaries:\n   - Export reports to PDF or CSV\n   - Create presentations showing improvement trends\n   - Document incident response testing outcomes\n7. Set up regular report review meetings with security team:\n   - Review simulation effectiveness\n   - Identify users needing additional training\n   - Assess incident detection and response times\n   - Track progress against baseline metrics\n8. Document findings and improvements in incident response plan\n9. Use reports as evidence for compliance audits",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulation-training-insights"
    },
    {
      "settingName": "TrainingCampaigns",
      "displayName": "Security Awareness Training Campaigns",
      "settingPath": "security.microsoft.com/attacksimulator?viewid=contentlibrary&contentType=training",
      "policyType": "Defender",
      "policySubType": "TrainingCampaign",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Provides security awareness training content integrated with simulation campaigns to educate users on recognizing and reporting security incidents. Training modules cover various topics including identifying phishing emails, recognizing social engineering tactics, proper incident reporting procedures, and secure behaviors. Training campaigns can be delivered proactively to all users or assigned automatically to users who fall for simulations. Effective training improves user participation in incident detection and reporting, which is a critical component of incident response capability.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal > Attack simulation training > Content library tab\n2. Review available training content:\n   - Select 'Trainings' to see available modules\n   - Over 85 training modules available in 30+ languages\n   - Categories: Phishing, Password security, Malware, Social engineering\n3. Create training-only campaigns (no simulation):\n   - Go to Training campaigns tab\n   - Click 'Create a training campaign'\n   - Name: 'Quarterly Incident Reporting Training'\n   - Select relevant training modules:\n     * 'How to recognize and report phishing emails'\n     * 'Security incident reporting procedures'\n     * 'Social engineering awareness'\n   - Target all users or specific groups\n   - Set training due date\n   - Configure notifications and reminders\n4. Integrate training with simulations:\n   - During simulation creation, assign training to compromised users\n   - Select training based on simulation technique:\n     * Credential harvest  Password security training\n     * Malware attachment  File security training\n     * Link-based  URL safety training\n   - Set automatic assignment rules\n5. Monitor training completion:\n   - Review Training completion card on Overview tab\n   - Track completion rates by department/user group\n   - Send reminders to users with overdue training\n6. Measure training effectiveness:\n   - Compare simulation results before/after training\n   - Track repeat offender rates after training\n   - Measure improvement in reporting rates\n7. Create custom training content if needed:\n   - Include organization-specific incident reporting procedures\n   - Add contact information for security team\n   - Document internal escalation paths\n8. Document training program as part of incident response testing\n9. Report training completion rates in compliance documentation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulation-training-training-campaigns"
    },
    {
      "settingName": "attackSimulationTrainingEnabled",
      "displayName": "Enable Attack Simulation Training",
      "settingPath": "microsoft.defender.office365.attackSimulation.enabled",
      "policyType": "Defender",
      "policySubType": "AttackSimulationTraining",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Attack Simulation Training in Microsoft Defender for Office 365 to provide automated phishing simulations and security awareness training to users, supporting incident response training requirements",
      "implementationGuide": "1. Navigate to Microsoft Defender portal at https://security.microsoft.com\n2. Go to Email & collaboration > Attack simulation training\n3. Verify Attack simulation training is enabled for your organization\n4. Ensure users have Microsoft Defender for Office 365 Plan 2 licenses\n5. Configure training modules and simulation campaigns",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-office-365/attack-simulation-training-get-started"
    },
    {
      "settingName": "trainingCampaignScheduled",
      "displayName": "Configure Periodic Training Campaigns",
      "settingPath": "microsoft.defender.office365.attackSimulation.trainingCampaigns",
      "policyType": "Defender",
      "policySubType": "AttackSimulationTraining",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "active",
      "validationOperator": "contains",
      "description": "Ensures training campaigns are scheduled and actively running to provide regular incident response training to all users at defined intervals",
      "implementationGuide": "1. In Microsoft Defender portal, go to Email & collaboration > Attack simulation training > Training tab\n2. Click 'Create new' to start new training campaign wizard\n3. Name the campaign and select target users or groups\n4. Select training modules covering incident recognition, reporting, and response\n5. Set training frequency (e.g., quarterly, semi-annually)\n6. Enable training completion tracking and reminders\n7. Save and launch the training campaign",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-office-365/attack-simulation-training-training-campaigns"
    },
    {
      "settingName": "simulationAutomationEnabled",
      "displayName": "Enable Simulation Automation",
      "settingPath": "microsoft.defender.office365.attackSimulation.automation",
      "policyType": "Defender",
      "policySubType": "SimulationAutomation",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables automated phishing simulations that provide hands-on incident response training by simulating real-world attacks and automatically assigning training based on user behavior",
      "implementationGuide": "1. Navigate to Email & collaboration > Attack simulation training > Simulation automations tab\n2. Click 'Create automation' to start wizard\n3. Name the automation and select simulation frequency\n4. Choose social engineering techniques (phishing, credential harvest, etc.)\n5. Select payloads and target user groups\n6. Configure automatic training assignment for users who fall for simulations\n7. Set randomized delivery schedules\n8. Review and enable the automation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-office-365/attack-simulation-training-simulation-automations"
    },
    {
      "settingName": "trainingModulesAssigned",
      "displayName": "Assign Role-Based Training Modules",
      "settingPath": "microsoft.defender.office365.attackSimulation.trainingModules.assignments",
      "policyType": "Defender",
      "policySubType": "TrainingModules",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "assigned",
      "validationOperator": "contains",
      "description": "Ensures appropriate training modules are assigned based on user roles (standard users, administrators, incident responders) with content covering incident recognition, reporting procedures, and response actions",
      "implementationGuide": "1. In Attack simulation training, go to Content library tab > Training modules\n2. Review available training modules for incident response topics\n3. Create training campaigns with role-specific modules:\n   - All Users: How to recognize and report incidents\n   - IT Staff: Incident handling and data collection\n   - Security Team: Forensics, reporting, recovery procedures\n4. Assign modules to appropriate user groups or roles\n5. Set completion deadlines and enable notifications\n6. Monitor training completion rates in reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-office-365/attack-simulation-training-training-modules"
    },
    {
      "settingName": "trainingCompletionTracking",
      "displayName": "Enable Training Completion Tracking and Reporting",
      "settingPath": "microsoft.defender.office365.attackSimulation.reporting.enabled",
      "policyType": "Defender",
      "policySubType": "TrainingReporting",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables comprehensive tracking and reporting of training completion rates, user performance metrics, and training effectiveness to verify compliance with training requirements",
      "implementationGuide": "1. Navigate to Attack simulation training > Reports tab\n2. Review training completion metrics for all campaigns\n3. Configure automated reports for:\n   - Training completion rates by user/group\n   - Simulation performance metrics\n   - Repeat offenders requiring additional training\n4. Set up notifications for incomplete training\n5. Export reports for compliance documentation\n6. Review training efficacy metrics to measure behavioral changes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-office-365/attack-simulation-training-insights"
    },
    {
      "settingName": "newUserTrainingAutomation",
      "displayName": "Automate Training for New Users and Role Changes",
      "settingPath": "microsoft.defender.office365.attackSimulation.newUserTraining",
      "policyType": "Defender",
      "policySubType": "AutomatedTrainingAssignment",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically assigns incident response training to new users within defined timeframe of account creation or role assignment, ensuring timely training delivery",
      "implementationGuide": "1. In Attack simulation training, configure simulation automations to target new users\n2. Set up automation rules to:\n   - Include users added to specific groups (e.g., 'All Employees')\n   - Trigger training campaigns for new hires within 30 days\n   - Assign role-specific training when users join IR teams\n3. Coordinate with Azure AD group policies for dynamic membership\n4. Configure training reminders and escalations\n5. Monitor completion rates for new user training\n6. Document training timelines for compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-office-365/attack-simulation-training-get-started"
    },
    {
      "settingName": "microsoftSentinelEnabled",
      "displayName": "Enable Microsoft Sentinel Incident Management",
      "settingPath": "microsoft.sentinel.workspace.enabled",
      "policyType": "Defender",
      "policySubType": "SentinelConfiguration",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Sentinel SIEM/SOAR capabilities providing centralized incident management, automated response workflows (playbooks), and incident tracking that implements the technical components of an incident response plan",
      "implementationGuide": "1. Navigate to Microsoft Defender portal or Azure portal\n2. Access Microsoft Sentinel service\n3. Create or connect to Log Analytics workspace\n4. Enable Microsoft Sentinel on the workspace\n5. Configure data connectors for Microsoft 365, Azure AD, Defender services\n6. Set up analytics rules for incident detection\n7. Configure incident settings and assignment policies\n8. Document Sentinel as part of organizational IR plan",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/sentinel/quickstart-onboard"
    },
    {
      "settingName": "incidentResponsePlaybooksConfigured",
      "displayName": "Configure Incident Response Playbooks",
      "settingPath": "microsoft.sentinel.playbooks.enabled",
      "policyType": "Defender",
      "policySubType": "SentinelPlaybooks",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "active",
      "validationOperator": "contains",
      "description": "Implements automated incident response playbooks (Logic Apps) that define and execute incident response procedures including containment, notification, investigation, and recovery actions according to the IR plan",
      "implementationGuide": "1. In Microsoft Sentinel, navigate to Automation > Playbook templates\n2. Review and deploy relevant playbook templates:\n   - Block compromised user\n   - Isolate compromised device\n   - Notify security team\n   - Create incident ticket\n3. Customize playbooks to match organization's IR procedures\n4. Configure authentication for connectors (Azure AD, Teams, etc.)\n5. Grant Microsoft Sentinel Automation Contributor role\n6. Test playbooks in development environment\n7. Document playbook workflows in IR plan\n8. Associate playbooks with automation rules",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/sentinel/automation/create-playbooks"
    },
    {
      "settingName": "automationRulesEnabled",
      "displayName": "Enable Incident Automation Rules",
      "settingPath": "microsoft.sentinel.automationRules.enabled",
      "policyType": "Defender",
      "policySubType": "SentinelAutomation",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "active",
      "validationOperator": "contains",
      "description": "Configures automation rules that automatically triage, assign, and orchestrate incident response based on incident characteristics, implementing the organization's defined incident classification and response procedures",
      "implementationGuide": "1. Navigate to Microsoft Sentinel > Automation\n2. Click 'Create' > 'Automation rule'\n3. Configure trigger: 'When incident is created' or 'When incident is updated'\n4. Set conditions based on:\n   - Severity (Critical, High, Medium, Low)\n   - Tactics (Initial Access, Persistence, etc.)\n   - Alert product names\n   - Affected entities\n5. Define actions:\n   - Assign to specific owner/team\n   - Add tags for categorization\n   - Change status/severity\n   - Run playbooks\n6. Set rule priority and expiration\n7. Document automation rules in IR plan",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/sentinel/automation/create-automation-rule"
    },
    {
      "settingName": "securityContactsConfigured",
      "displayName": "Configure Security Contact Information",
      "settingPath": "microsoft.defender.securityContacts",
      "policyType": "Defender",
      "policySubType": "SecurityContacts",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "configured",
      "validationOperator": "contains",
      "description": "Defines security contacts who receive incident notifications and alerts, ensuring incident information is shared with designated incident response personnel and organizational elements",
      "implementationGuide": "1. Navigate to Microsoft Defender portal > Settings > Microsoft Defender for Cloud\n2. Select 'Email notifications' under Environment settings\n3. Configure primary security contact:\n   - Email address for primary contact\n   - Phone number (optional)\n   - Notification preferences\n4. Add additional security contacts for redundancy\n5. Set notification rules for severity levels:\n   - High severity: Immediate notification\n   - Medium severity: Daily digest\n   - Low severity: Weekly summary\n6. Enable notifications for:\n   - Alerts and incidents\n   - Compliance notifications\n   - Recommendations\n7. Document contacts in IR plan distribution list",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/defender-for-cloud/configure-email-notifications"
    },
    {
      "settingName": "unifiedAuditLogEnabled",
      "displayName": "Enable Microsoft 365 Unified Audit Log",
      "settingPath": "microsoft.purview.audit.unifiedAuditLog.enabled",
      "policyType": "Purview",
      "policySubType": "AuditConfiguration",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables comprehensive audit logging across Microsoft 365 services providing forensic evidence and incident tracking data that supports incident investigation, documentation, and plan updates based on actual incident data",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Go to Solutions > Audit\n3. Click 'Start recording user and admin activity'\n4. Verify unified audit log is enabled\n5. Configure audit log retention:\n   - Standard retention: 180 days (E3)\n   - Extended retention: 1 year or 10 years (E5 with add-on)\n6. Set up audit log search access for IR team\n7. Create audit log alerts for critical activities\n8. Document audit logging in IR plan for evidence collection",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-enable-disable"
    },
    {
      "settingName": "incidentRbacConfigured",
      "displayName": "Configure Incident Response Role-Based Access Control",
      "settingPath": "microsoft.sentinel.rbac.roles",
      "policyType": "Defender",
      "policySubType": "SentinelRBAC",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "assigned",
      "validationOperator": "contains",
      "description": "Implements role-based access control for incident management that designates responsibilities to specific personnel roles and protects sensitive incident information from unauthorized disclosure",
      "implementationGuide": "1. Navigate to Microsoft Sentinel workspace\n2. Select 'Access control (IAM)' from left menu\n3. Assign appropriate roles to IR team members:\n   - Microsoft Sentinel Reader: View incidents, analytics rules\n   - Microsoft Sentinel Responder: Manage incidents, run queries\n   - Microsoft Sentinel Contributor: Full management except settings\n   - Security Admin: Full Sentinel access\n4. Create custom roles if needed for specific responsibilities\n5. Assign roles to Azure AD groups for easy management\n6. Configure Conditional Access policies for IR personnel\n7. Enable MFA for all IR team members\n8. Document role assignments in IR plan\n9. Review access quarterly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/sentinel/roles"
    },
    {
      "settingName": "incidentNotificationRules",
      "displayName": "Configure Incident Notification and Communication Rules",
      "settingPath": "microsoft.sentinel.notifications",
      "policyType": "Defender",
      "policySubType": "IncidentNotifications",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "configured",
      "validationOperator": "contains",
      "description": "Defines automated notification rules that alert designated personnel about incidents, implement communication chains, and ensure incident information sharing according to organizational policies and regulatory requirements",
      "implementationGuide": "1. In Microsoft Sentinel, create automation rules with notification actions\n2. Configure playbooks for incident notifications:\n   - Email notifications to security team\n   - Microsoft Teams messages to SOC channel\n   - Ticket creation in ITSM system\n   - Escalation to management for high-severity incidents\n3. Set up incident notification templates including:\n   - Incident ID and severity\n   - Affected systems and users\n   - Initial assessment\n   - Recommended actions\n4. Configure notification thresholds:\n   - Immediate: Critical/High severity\n   - Hourly digest: Medium severity\n   - Daily summary: Low severity\n5. Test notification workflows\n6. Document communication procedures in IR plan",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/sentinel/automation/automate-responses-with-playbooks"
    },
    {
      "settingName": "RequireDeviceCompliance",
      "displayName": "Require Antivirus and Antispyware Software",
      "settingPath": "deviceCompliancePolicy.systemSecurity.antivirusRequired",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces that maintenance devices must have active and up-to-date antivirus software registered with Windows Security Center before being used for system maintenance. This prevents malicious code on maintenance tools from entering the environment.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (intune.microsoft.com)\n2. Navigate to Devices > Compliance > Policies > Create Policy\n3. Select Platform: Windows 10 and later\n4. Under System Security settings, set:\n   - Require Antivirus = Require\n   - Require Antispyware = Require\n   - Real-time Protection = Require\n5. Assign to device groups used for maintenance activities\n6. Configure Conditional Access to block non-compliant devices",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "DefenderRealTimeProtection",
      "displayName": "Microsoft Defender Real-Time Protection",
      "settingPath": "windowsSecurityBaseline.microsoftDefenderAntivirus.realTimeProtection",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enabled",
      "validationOperator": "==",
      "description": "Enables real-time scanning and monitoring for malware on devices used for maintenance tasks. Real-time protection automatically scans files and processes as they are accessed, preventing malicious maintenance tools from executing.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint Security > Security Baselines\n3. Select 'Security Baseline for Windows 10 and later'\n4. Create profile and configure:\n   - Microsoft Defender Antivirus > Real-time Protection: Enable\n   - Turn on real-time protection: Yes\n   - Monitor file and program activity: Yes\n5. Assign to all device groups\n6. Monitor deployment status",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/protect/security-baselines"
    },
    {
      "settingName": "DefenderSignatureUpdate",
      "displayName": "Require Up-to-Date Security Intelligence",
      "settingPath": "deviceCompliancePolicy.defenderForEndpoint.signatureOutOfDate",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces that Microsoft Defender security intelligence definitions must be current on maintenance devices. Outdated signatures cannot detect the latest malware that may be present on maintenance tools or media.",
      "implementationGuide": "1. In Microsoft Intune admin center, go to Devices > Compliance > Policies\n2. Create or edit Windows 10/11 compliance policy\n3. Under Microsoft Defender for Endpoint section:\n   - Require security intelligence to be up to date: Require\n4. Set Actions for noncompliance:\n   - Mark device non-compliant: Immediately\n5. Assign to maintenance device groups\n6. Configure Conditional Access to require compliant devices",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/protect/compliance-policy-create-windows#microsoft-defender-for-endpoint"
    },
    {
      "settingName": "AuditMaintenanceAccess",
      "displayName": "Audit Privileged Maintenance Activity",
      "settingPath": "auditLogs.directoryAudits.privilegedRoleAssignment",
      "policyType": "AzureAD",
      "policySubType": "AuditLogging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables comprehensive audit logging for privileged role assignments and maintenance activities. Tracks who approved maintenance tools, when they were used, and which administrative accounts performed maintenance tasks.",
      "implementationGuide": "1. Sign in to Azure portal (portal.azure.com)\n2. Navigate to Microsoft Entra ID > Audit logs\n3. Verify that audit logging is enabled (default)\n4. Configure audit log retention:\n   - Go to Microsoft Entra ID > Diagnostic settings\n   - Add diagnostic setting\n   - Select 'AuditLogs' and 'SignInLogs'\n   - Send to Log Analytics workspace for retention > 90 days\n5. Create alerts for privileged maintenance activities\n6. Configure Microsoft Sentinel for advanced monitoring (optional)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/concept-audit-logs"
    },
    {
      "settingName": "CloudDeliveredProtection",
      "displayName": "Microsoft Defender Cloud-Delivered Protection",
      "settingPath": "windowsSecurityBaseline.microsoftDefenderAntivirus.cloudDeliveredProtection",
      "policyType": "Defender",
      "policySubType": "AntivirusPolicy",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enabled",
      "validationOperator": "==",
      "description": "Enables cloud-delivered protection for Microsoft Defender, providing near-instantaneous threat detection for new malware on maintenance tools. Uses machine learning and cloud intelligence to identify emerging threats that may not yet be in local signature databases.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint Security > Antivirus\n3. Create new policy for Windows 10 and later\n4. Configure Cloud Protection settings:\n   - Cloud-delivered protection level: High\n   - Cloud Extended Timeout: 50 seconds\n   - Submit samples consent: Send safe samples automatically\n5. Assign to all Windows device groups\n6. Monitor threat detections in Microsoft Defender portal",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/cloud-protection-microsoft-defender-antivirus"
    },
    {
      "settingName": "RequireMFAPrivilegedRoles",
      "displayName": "MFA Required for Privileged Roles (Conditional Access)",
      "settingPath": "conditionalAccess.policies.requireMFAforPrivilegedRoles",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"grantControls\":{\"builtInControls\":[\"mfa\"],\"operator\":\"AND\"}}",
      "validationOperator": "==",
      "description": "Enforces multi-factor authentication for all privileged administrative roles when establishing remote maintenance sessions. This directly satisfies the NIST requirement for MFA in nonlocal maintenance and diagnostic sessions.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center (entra.microsoft.com)\n2. Navigate to Protection > Conditional Access > Policies\n3. Create new policy: 'Require MFA for Privileged Roles Remote Maintenance'\n4. Configure Assignments:\n   - Users: Include > Select Directory roles:\n     * Global Administrator\n     * Privileged Role Administrator\n     * Security Administrator\n     * Exchange Administrator\n     * SharePoint Administrator\n     * Intune Administrator\n   - Exclude emergency access accounts\n5. Cloud apps: All cloud apps\n6. Access controls > Grant:\n   - Require multi-factor authentication\n7. Enable policy: On\n8. Test with non-production admin account first",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-admin-mfa"
    },
    {
      "settingName": "PhishingResistantMFA",
      "displayName": "Phishing-Resistant MFA for Privileged Roles",
      "settingPath": "conditionalAccess.authenticationStrength.phishingResistant",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"authenticationStrength\":\"phishingResistant\",\"allowedMethods\":[\"fido2\",\"windowsHello\",\"certificateBasedAuthentication\"]}",
      "validationOperator": "contains",
      "description": "Requires phishing-resistant authentication methods (FIDO2 security keys, Windows Hello for Business, or certificate-based auth) for privileged roles. This provides replay-resistant authentication as required by NIST, preventing session replay attacks during remote maintenance.",
      "implementationGuide": "1. In Microsoft Entra admin center, go to Protection > Authentication methods\n2. Enable phishing-resistant methods:\n   - FIDO2 security keys: Enable for administrators group\n   - Windows Hello for Business: Enable for all users\n   - Certificate-based authentication: Configure if using PKI\n3. Go to Protection > Conditional Access\n4. Create/edit privileged role MFA policy\n5. Under Grant controls > Require authentication strength:\n   - Select 'Phishing-resistant MFA'\n6. Assign to privileged role groups\n7. Provide FIDO2 keys to administrators\n8. Monitor sign-in logs for compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-authentication-strengths"
    },
    {
      "settingName": "SessionTimeout",
      "displayName": "Browser Session Timeout for Administrative Users",
      "settingPath": "conditionalAccess.sessionControls.signInFrequency",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"value\":3,\"type\":\"hours\",\"isEnabled\":true,\"persistentBrowser\":\"never\"}",
      "validationOperator": "<=",
      "description": "Enforces automatic session termination after 3 hours of activity for privileged administrative accounts performing remote maintenance. Sessions do not persist across browser closures, requiring re-authentication for each new session.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center\n2. Navigate to Protection > Conditional Access > Policies\n3. Create policy: 'Admin Session Timeout for Remote Maintenance'\n4. Assignments:\n   - Users: Select directory roles (all privileged roles)\n   - Cloud apps: All cloud apps\n   - Conditions > Client apps: Browser\n5. Session controls:\n   - Sign-in frequency: 3 hours\n   - Persistent browser session: Never\n6. Enable policy\n7. Communicate to administrators about re-authentication requirements\n8. CIS Benchmark recommendation: 3 hours or less",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime"
    },
    {
      "settingName": "AuditNonlocalAccess",
      "displayName": "Audit Remote Privileged Access",
      "settingPath": "auditLogs.signInLogs.privilegedRoleSignIns",
      "policyType": "AzureAD",
      "policySubType": "AuditLogging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Captures comprehensive sign-in logs for all privileged role authentications, including source IP, location, device, MFA details, and session duration. Essential for monitoring and approving nonlocal maintenance activities.",
      "implementationGuide": "1. Sign in to Azure portal\n2. Navigate to Microsoft Entra ID > Diagnostic settings\n3. Add diagnostic setting named 'Privileged Access Audit'\n4. Log categories:\n   - SignInLogs: Enable\n   - AuditLogs: Enable\n   - RiskyUsers: Enable\n   - UserRiskEvents: Enable\n5. Destination:\n   - Send to Log Analytics workspace (90+ day retention)\n   - Archive to storage account (optional, 1+ year)\n6. Create alert rules for privileged sign-ins from:\n   - Unfamiliar locations\n   - High-risk sign-ins\n   - Failed MFA attempts\n7. Review weekly in Microsoft Entra ID Protection",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs"
    },
    {
      "settingName": "RequireCompliantDevice",
      "displayName": "Require Managed Device for Remote Admin Access",
      "settingPath": "conditionalAccess.policies.requireCompliantDevice",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"grantControls\":{\"builtInControls\":[\"compliantDevice\",\"domainJoinedDevice\"],\"operator\":\"OR\"}}",
      "validationOperator": "contains",
      "description": "Restricts remote maintenance access to organization-managed and compliant devices only. Prevents privileged access from unmanaged personal devices that may lack security controls or contain malware.",
      "implementationGuide": "1. Ensure device compliance policies are configured in Intune\n2. Sign in to Microsoft Entra admin center\n3. Navigate to Protection > Conditional Access\n4. Create policy: 'Require Managed Device for Admin Access'\n5. Assignments:\n   - Users: Select directory roles (privileged roles)\n   - Cloud apps: All cloud apps\n6. Grant controls:\n   - Require device to be marked as compliant: OR\n   - Require Microsoft Entra hybrid joined device: OR\n   - (Select 'Require one of the selected controls')\n7. Enable policy after testing\n8. CIS Benchmark Level 2 recommendation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-compliant-device"
    },
    {
      "settingName": "RemoteDesktopAuditing",
      "displayName": "Audit Remote Desktop Protocol Connections",
      "settingPath": "windowsSecurityBaseline.auditPolicy.logonLogoff.auditOtherLogonLogoffEvents",
      "policyType": "Defender",
      "policySubType": "AuditPolicy",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Success and Failure",
      "validationOperator": "==",
      "description": "Enables detailed auditing of Remote Desktop Protocol (RDP) and other remote access sessions used for system maintenance. Logs successful and failed remote connection attempts, session duration, and disconnection events.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint Security > Security Baselines\n3. Select 'Security Baseline for Windows 10 and later'\n4. Create/edit profile\n5. Under Audit Policies > Logon/Logoff:\n   - Audit Other Logon/Logoff Events: Success and Failure\n   - Audit Logon: Success and Failure\n   - Audit Logoff: Success\n   - Audit Special Logon: Success and Failure\n6. Under Remote Desktop Services:\n   - Enable RDP event logging\n7. Assign to all Windows servers and administrative workstations\n8. Forward logs to SIEM for centralized monitoring",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-other-logon-logoff-events"
    },
    {
      "settingName": "PrivilegedIdentityManagement",
      "displayName": "Azure AD Privileged Identity Management (PIM) for Maintenance Roles",
      "settingPath": "privilegedIdentityManagement.roleSettings.eligibleAssignments",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"assignmentType\":\"eligible\",\"permanentAssignments\":0}",
      "validationOperator": "==",
      "description": "Implements just-in-time privileged access management for maintenance personnel. Administrators are assigned eligible (not permanent) roles and must explicitly activate them when maintenance is required, with time-limited access and justification requirements.",
      "implementationGuide": "1. Ensure Azure AD Premium P2 licensing for all privileged users\n2. Sign in to Azure portal (portal.azure.com)\n3. Navigate to Microsoft Entra Privileged Identity Management\n4. Go to Azure AD roles > Roles\n5. For each privileged role used for maintenance:\n   - Global Administrator\n   - Privileged Role Administrator  \n   - Security Administrator\n   - Exchange Administrator\n   - SharePoint Administrator\n   - Intune Administrator\n6. Remove permanent active assignments\n7. Add eligible assignments with:\n   - Maximum activation duration: 4-8 hours\n   - Require justification on activation\n   - Require approval for activation (for Global Admin)\n   - Require MFA on activation\n8. Configure access reviews (monthly)\n9. Train administrators on activation process",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure"
    },
    {
      "settingName": "RequireApprovalGlobalAdmin",
      "displayName": "Require Approval for Global Administrator Activation",
      "settingPath": "privilegedIdentityManagement.roleSettings.globalAdministrator.activationRequirements",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"approvalRequired\":true,\"approvers\":\"minimumTwo\"}",
      "validationOperator": "==",
      "description": "Enforces approval workflow for Global Administrator role activation, preventing unauthorized elevation to the highest privilege level. Two-person rule ensures that critical maintenance activities require oversight and approval from trusted administrators.",
      "implementationGuide": "1. In Azure portal, go to PIM > Azure AD roles > Settings\n2. Select 'Global Administrator' role\n3. Click Edit > Activation tab\n4. Configure activation requirements:\n   - Require approval to activate: Yes\n   - Select approvers: Add at least 2 security administrators\n   - Require justification: Yes\n   - Require ticket information: Yes (optional)\n   - Require Azure MFA: Yes\n5. Under Assignment tab:\n   - Require approval to assign: Yes\n   - Require justification: Yes\n6. Update settings\n7. Document approval process for emergency scenarios\n8. CIS Benchmark v4.0 recommendation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-approval-workflow"
    },
    {
      "settingName": "AccessReviewsPrivilegedRoles",
      "displayName": "Monthly Access Reviews for Privileged Roles",
      "settingPath": "identityGovernance.accessReviews.privilegedRoles",
      "policyType": "AzureAD",
      "policySubType": "AccessReviews",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"frequency\":\"monthly\",\"reviewersType\":\"manager\",\"autoApplyDecisions\":false}",
      "validationOperator": "==",
      "description": "Implements periodic review of privileged role assignments to ensure maintenance personnel still require elevated access. Managers review and attest to the continued need for each user's privileged access, automatically removing access for users who leave or change roles.",
      "implementationGuide": "1. Requires Azure AD Premium P2 licensing\n2. Sign in to Azure portal\n3. Navigate to Identity Governance > Access reviews\n4. Create access review:\n   - Review name: 'Monthly Privileged Role Review for Maintenance'\n   - Frequency: Monthly\n   - Duration: 7 days\n5. Scope: Select all privileged directory roles:\n   - Global Administrator\n   - Privileged Role Administrator\n   - Security Administrator\n   - All other administrative roles\n6. Reviewers: Group owners or managers\n7. Settings:\n   - Require justification: Yes\n   - Remove access if reviewers don't respond: No (for safety)\n   - Send notifications to reviewers\n8. Enable and monitor completion rates\n9. CIS Benchmark recommendation: Monthly (changed from weekly in v4.0)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/access-reviews-overview"
    },
    {
      "settingName": "CloudOnlyPrivilegedAccounts",
      "displayName": "Require Cloud-Only Privileged Accounts",
      "settingPath": "users.privilegedAccounts.onPremisesSyncEnabled",
      "policyType": "AzureAD",
      "policySubType": "UserManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Ensures privileged maintenance accounts are cloud-only (not synchronized from on-premises Active Directory). Prevents on-premises compromise from affecting cloud administrative access and provides better audit trails and conditional access enforcement.",
      "implementationGuide": "1. Audit current privileged accounts:\n   - Sign in to Azure portal\n   - Navigate to Microsoft Entra ID > Roles and administrators\n   - For each privileged role, view assignments\n   - Identify accounts with onPremisesSyncEnabled = true\n2. Create cloud-only replacement accounts:\n   - Naming convention: admin-[username]-cloud@domain.com\n   - No Azure AD Connect synchronization\n   - Assign required licenses (Azure AD Premium P2)\n3. Transfer privileged role assignments to cloud-only accounts\n4. Configure PIM for cloud-only accounts\n5. Remove on-premises accounts from privileged roles\n6. Update documentation and runbooks\n7. Microsoft Security Baseline requirement",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/how-to-connect-sync-feature-prevent-accidental-deletes"
    },
    {
      "settingName": "LimitPrivilegedRoleCount",
      "displayName": "Limit Number of Global Administrators",
      "settingPath": "directoryRoles.globalAdministrator.memberCount",
      "policyType": "AzureAD",
      "policySubType": "RoleManagement",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 5,
      "validationOperator": "<=",
      "description": "Restricts the number of Global Administrators to maximum 5 users (minimum 2 for redundancy). Reduces attack surface by limiting the number of accounts with complete system control for maintenance activities.",
      "implementationGuide": "1. Review current Global Administrator assignments:\n   - Sign in to Azure portal\n   - Microsoft Entra ID > Roles and administrators\n   - Select 'Global Administrator' role\n   - Document all current members\n2. Identify minimum required Global Admins:\n   - Recommendation: 2-5 accounts\n   - Include 2 emergency access (break-glass) accounts\n   - Keep 2-3 active administrator accounts\n3. Remove unnecessary assignments:\n   - Evaluate if users need Global Admin or less privileged role\n   - Use specific roles: Exchange Admin, Security Admin, etc.\n4. Implement PIM for remaining Global Admins (eligible only)\n5. Configure alerting for new Global Admin assignments\n6. Document justification for each Global Admin\n7. Review quarterly in access reviews\n8. Microsoft Security Baseline and CIS Benchmark requirement",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/security-planning"
    },
    {
      "settingName": "PrivilegedRoleActivationAlerts",
      "displayName": "Alert on Privileged Role Activation",
      "settingPath": "privilegedIdentityManagement.alerts.roleActivation",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"alertsEnabled\":true,\"recipients\":\"securityTeam\"}",
      "validationOperator": "==",
      "description": "Generates real-time alerts when privileged roles are activated for maintenance activities. Security team receives immediate notification with activation details including who, what role, when, and justification provided.",
      "implementationGuide": "1. Sign in to Azure portal\n2. Navigate to Microsoft Entra Privileged Identity Management\n3. Go to Azure AD roles > Alerts > Settings\n4. Configure these alerts:\n   - 'Roles are being activated too frequently'\n   - 'Administrators aren't using their privileged roles'\n   - 'Potential stale accounts in a privileged role'\n5. For each alert:\n   - Enable: Yes\n   - Severity: High\n   - Recipients: Add security team distribution list\n6. Configure email settings:\n   - Notification recipients: Security Operations Center\n   - Include activation link in email: Yes\n7. Test alerts with activation\n8. Integrate with Microsoft Sentinel for advanced correlation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts"
    },
    {
      "settingName": "RequireDeviceEncryption",
      "displayName": "Require BitLocker Encryption via Device Compliance",
      "settingPath": "deviceCompliancePolicy.properties.requireBitLocker",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces BitLocker encryption on Windows devices to protect system media containing CUI at rest. Uses Device Health Attestation (DHA) service to validate encryption status at the TPM level.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Compliance policies > Create policy\n3. Select Platform: Windows 10 and later\n4. Under Device Health section, set 'Require BitLocker' to 'Require'\n5. Configure 'Require encryption of data storage on device' to 'Require' as secondary validation\n6. Assign policy to device groups\n7. Note: Device reboot required after BitLocker enablement for compliance reporting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "BitLockerOSDriveEncryption",
      "displayName": "BitLocker Operating System Drive Encryption Policy",
      "settingPath": "endpointProtection.bitLocker.operatingSystemDrives",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"encryptionMethod\":\"xtsAes256\",\"startupAuthenticationRequired\":true,\"minimumPinLength\":6,\"recoveryOptions\":{\"enableRecoveryInformationSaveToStore\":true,\"recoveryInformationToStore\":\"passwordAndKey\",\"blockDataRecoveryAgent\":false}}",
      "validationOperator": "contains",
      "description": "Configures BitLocker encryption for operating system drives with XTS-AES 256-bit encryption, startup authentication, and recovery key backup to Azure AD/Entra ID. Ensures secure storage of system media containing CUI.",
      "implementationGuide": "1. Navigate to Endpoint security > Disk encryption > Create Policy\n2. Select Platform: Windows 10 and later, Profile: BitLocker\n3. Configure OS Drive Settings:\n   - Encryption method: XTS-AES 256-bit\n   - Additional authentication at startup: Require\n   - Minimum PIN length: 6 characters\n4. Configure Recovery Options:\n   - Save BitLocker recovery information to Azure AD: Enable\n   - Store recovery information: Backup recovery passwords and key packages\n5. Assign to device groups\n6. Verify recovery keys stored in Azure AD device properties",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices"
    },
    {
      "settingName": "BitLockerFixedDriveEncryption",
      "displayName": "BitLocker Fixed Data Drive Encryption Policy",
      "settingPath": "endpointProtection.bitLocker.fixedDrives",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"encryptionMethod\":\"xtsAes256\",\"requireEncryptionForWriteAccess\":true,\"recoveryOptions\":{\"enableRecoveryInformationSaveToStore\":true,\"recoveryInformationToStore\":\"passwordAndKey\"}}",
      "validationOperator": "contains",
      "description": "Enforces BitLocker encryption on fixed data drives to protect stored CUI. Requires encryption before write access is granted, preventing unencrypted data storage.",
      "implementationGuide": "1. In BitLocker policy, navigate to Fixed Data Drive Settings\n2. Configure:\n   - Encryption method: XTS-AES 256-bit\n   - Block write access to drives not protected by BitLocker: Enable\n3. Configure Recovery Options:\n   - Save BitLocker recovery information to Azure AD: Enable\n   - Store recovery information: Backup recovery passwords and key packages\n4. Set 'Allow standard users to enable encryption during Azure AD join': Enable\n5. Deploy policy to device groups\n6. Validate via Intune Encryption Report",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices"
    },
    {
      "settingName": "BitLockerRemovableDriveEncryption",
      "displayName": "BitLocker Removable Drive Encryption Enforcement",
      "settingPath": "endpointProtection.bitLocker.removableDrives",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"encryptionMethod\":\"aesCbc256\",\"requireEncryptionForWriteAccess\":true,\"blockCrossOrganizationWriteAccess\":true}",
      "validationOperator": "contains",
      "description": "Requires BitLocker encryption on removable drives before write access is permitted. Prevents CUI from being written to unencrypted removable media (USB drives, external drives).",
      "implementationGuide": "1. In BitLocker policy, navigate to Removable Data Drive Settings\n2. Configure:\n   - Encryption method: AES-CBC 256-bit (for compatibility with non-Windows systems)\n   - Deny write access to removable drives not protected by BitLocker: Enable\n   - Block write access to devices configured in another organization: Enable\n3. Configure user options:\n   - Allow users to suspend and decrypt BitLocker: Block\n4. Deploy to device groups\n5. Test with unencrypted USB drive to verify write blocking\n6. Educate users on BitLocker To Go setup process",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices"
    },
    {
      "settingName": "RemovableDiskDenyWriteAccess",
      "displayName": "Block Write Access to Removable Storage",
      "settingPath": "deviceConfiguration.storage.removableDiskDenyWriteAccess",
      "policyType": "Intune",
      "policySubType": "AttackSurfaceReduction",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enabled",
      "validationOperator": "==",
      "description": "Blocks write access to removable storage devices (USB drives) to prevent unauthorized copying of CUI to external media. Users can read from removable media but cannot write data to it.",
      "implementationGuide": "1. Sign in to Intune admin center\n2. Navigate to Endpoint security > Attack surface reduction\n3. Select Create Policy > Platform: Windows 10 and later > Profile: Device Control\n4. Provide policy Name and Description\n5. Under Storage settings, configure:\n   - Removable Disk Deny Write Access: Enabled\n6. Assign policy to device groups (start with pilot group)\n7. Monitor via Endpoint security > Attack surface reduction > Policy name\n8. Validate: Users can read from USB but cannot write/copy files to USB drives\n9. Note: Does not block read access, only write operations",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-asr-policy"
    },
    {
      "settingName": "RemovableStorageBlocked",
      "displayName": "Block Removable Storage via Device Restrictions",
      "settingPath": "deviceConfiguration.deviceRestrictions.general.storageBlockRemovableStorage",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Completely blocks use of removable storage devices (USB drives, external drives) on managed devices. Provides strictest control over media access for high-security environments.",
      "implementationGuide": "1. Navigate to Devices > Configuration > Create > New Policy\n2. Select Platform: Windows 10 and later\n3. Select Profile type: Templates > Device restrictions\n4. Provide policy Name and Description\n5. Under Configuration settings > General:\n   - Removable storage: Block\n6. Optionally configure related settings:\n   - USB connections (except for charging): Block\n7. Assign to device groups requiring highest security\n8. Test with USB device to verify complete blocking\n9. Note: This is an alternative to write-only blocking for environments requiring complete USB restriction",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-windows-10"
    },
    {
      "settingName": "EndpointDLPRemovableMediaBlocking",
      "displayName": "DLP Policy - Block Sensitive Data Copy to Removable Media",
      "settingPath": "dlpPolicy.conditions.contentContainsSensitiveInformation.actions.blockAccess",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"action\":\"BlockAccess\",\"location\":\"Devices\",\"activities\":[\"CopyToRemovableMedia\"]}",
      "validationOperator": "contains",
      "description": "Prevents copying of files containing CUI or sensitive information to removable storage devices. Uses content inspection to identify sensitive data and blocks transfer to USB/external media.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal\n2. Navigate to Data loss prevention > Policies > Create policy\n3. Select template or Custom policy\n4. Name: Block Sensitive Data to Removable Media\n5. Configure Locations:\n   - Turn on: Devices\n6. Define policy conditions:\n   - Content contains: Sensitive info types (e.g., Social Security Number, Credit Card, Custom SITs)\n   - Add sensitivity labels if using Information Protection\n7. Configure Actions:\n   - Activity: Copy to removable USB device\n   - Action: Block with override / Block\n8. Set User notifications: Enable with policy tips\n9. Assign to user groups\n10. Test: Try copying sensitive file to USB device\n11. Monitor in Activity Explorer and DLP Alerts",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/endpoint-dlp-learn-about"
    },
    {
      "settingName": "PreventDeviceInstallation",
      "displayName": "Prevent Installation of Removable Devices",
      "settingPath": "deviceConfiguration.deviceInstallation.preventInstallationOfMatchingDeviceIDs",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"preventInstallationOfDevicesNotDescribedByOtherPolicySettings\":true,\"allowedDeviceSetupClasses\":[]}",
      "validationOperator": "contains",
      "description": "Prevents installation of unauthorized removable storage devices by blocking device driver installation. Only explicitly allowed devices can be installed, enforcing strict device control.",
      "implementationGuide": "1. Navigate to Devices > Configuration > Create policy\n2. Select Platform: Windows 10 and later\n3. Select Profile type: Settings catalog\n4. Name: Restrict USB Device Installation\n5. Add settings from Device Installation category:\n   - 'Prevent installation of devices not described by other policy settings': Enable\n   - 'Allow installation of devices using drivers that match these device setup classes': Configure with approved classes (keyboard, mouse if needed)\n   - 'Allow installation of devices that match any of these Device IDs': Add approved USB device IDs\n6. To find device IDs: Device Manager > Properties > Hardware IDs\n7. Assign to device groups\n8. Test: Attempt to install non-approved USB device\n9. Monitor: Review setupapi.dev.log on devices for blocked installations",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/settings-catalog-restrict-usb"
    },
    {
      "settingName": "RemovableStorageDeviceGroups",
      "displayName": "Configure Authorized Removable Storage Device Groups",
      "settingPath": "purview.endpointDLP.settings.removableUsbDeviceGroups",
      "policyType": "Purview",
      "policySubType": "EndpointDLPSettings",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[{\"groupName\":\"Approved Corporate USB Devices\",\"matchType\":\"DeviceId\",\"descriptors\":[{\"vendorId\":\"organization-specific\",\"productId\":\"organization-specific\"}]}]",
      "validationOperator": "contains",
      "description": "Defines groups of authorized removable storage devices based on Vendor ID, Product ID, Serial Number, or Hardware ID. Enables granular DLP policies with device-level exceptions.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal\n2. Go to Settings > Data Loss Prevention > Endpoint DLP settings\n3. Select 'Removable USB device groups'\n4. Create new device group:\n   - Name: Approved Corporate USB Devices\n   - Description: Company-issued encrypted USB drives\n5. Add device identifiers:\n   - Match type: Select from Vendor ID, Product ID, Serial Number, Device ID, Hardware ID, or Instance Path ID\n   - Get values from Device Manager on Windows device\n6. Repeat for different device groups (e.g., Executive USB devices)\n7. Reference these groups in DLP policies under 'Exceptions'\n8. Test: Copy sensitive file to device in approved group (should allow)\n9. Test: Copy to unapproved device (should block)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-configure-endpoint-settings"
    },
    {
      "settingName": "ConditionalAccessDeviceFilter",
      "displayName": "Conditional Access Device Filter - Require Managed Devices",
      "settingPath": "conditionalAccessPolicy.conditions.devices.deviceFilter",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"mode\":\"include\",\"rule\":\"device.isManaged -eq True\"}",
      "validationOperator": "contains",
      "description": "Restricts resource access to Intune-managed devices with enforced media access controls. Ensures only devices with proper removable storage policies can access CUI resources.",
      "implementationGuide": "1. Navigate to Azure AD > Security > Conditional Access\n2. Create new policy: Require Managed Devices for CUI Access\n3. Configure:\n   - Users: Include users with CUI access\n   - Cloud apps: Select apps containing CUI\n4. Under Conditions > Device state (preview):\n   - Configure: Yes\n   - Select 'Require device to be hybrid Azure AD joined or compliant'\n5. Under Conditions > Filter for devices:\n   - Configure: Yes\n   - Rule: device.isManaged -eq True\n6. Grant controls:\n   - Require device to be marked as compliant\n   - Require Hybrid Azure AD joined device\n7. Session: Configure as needed\n8. Enable policy\n9. Test with unmanaged device to verify blocking\n10. Monitor sign-in logs for policy application",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-grant"
    },
    {
      "settingName": "DeviceWipeAction",
      "displayName": "Remote Wipe Device - Full Factory Reset",
      "settingPath": "deviceManagement.remoteActions.wipe",
      "policyType": "Intune",
      "policySubType": "RemoteAction",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"wipeAction\":\"full\",\"retainEnrollmentState\":false,\"retainUserAccount\":false,\"obliterateSetting\":\"doObliterate\"}",
      "validationOperator": "contains",
      "description": "Performs full factory reset of device, removing all data, apps, and settings. BitLocker encryption is removed during the process. Use for device decommissioning, loss, theft, or repurposing to ensure complete data sanitization.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > All devices\n3. Select device to be sanitized\n4. Click 'Wipe' action in device overview pane\n5. Configure wipe options:\n   - Wipe device, but keep enrollment state and user account: Leave UNCHECKED for full sanitization\n   - Wipe device, and continue to wipe even if device loses power: CHECK for high-security scenarios\n6. Enter confirmation text and click Wipe\n7. Important: For Windows 11 21H2+, see Note about Windows.old folder issue\n8. Verify wipe completion status in Device Actions monitor\n9. After wipe: Remove device from Intune if not reusing\n10. Document wipe action in asset disposal records\n11. CRITICAL: Before wiping Azure AD joined device, backup BitLocker recovery keys",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/remote-actions/devices-wipe"
    },
    {
      "settingName": "AutopilotReset",
      "displayName": "Windows Autopilot Reset for Device Reuse",
      "settingPath": "deviceManagement.remoteActions.autopilotReset",
      "policyType": "Intune",
      "policySubType": "RemoteAction",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Performs Autopilot reset to remove user files and settings while retaining device in Autopilot deployment program. Maintains device encryption and organizational connection. Suitable for device reassignment within organization.",
      "implementationGuide": "1. Prerequisite: Device must be registered in Windows Autopilot service\n2. In Intune admin center, navigate to Devices > All devices\n3. Select target device\n4. Click 'Autopilot reset' from actions menu\n5. Choose reset type:\n   - Local Autopilot reset (initiated by user at device)\n   - Remote Autopilot reset (initiated by admin)\n6. Confirm reset action\n7. Device will:\n   - Remove user installed apps, data, and settings\n   - Retain device management enrollment\n   - Retain Azure AD/Entra ID join\n   - Retain provisioning packages\n   - Keep BitLocker encryption (does not decrypt)\n8. After reset, device automatically goes through OOBE\n9. Apply to new user\n10. Monitor reset status in Intune\n11. Note: More secure than Fresh Start but less complete than full Wipe",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/autopilot/windows-autopilot-reset"
    },
    {
      "settingName": "RetireDeviceAction",
      "displayName": "Retire Device - Remove Company Data Only",
      "settingPath": "deviceManagement.remoteActions.retire",
      "policyType": "Intune",
      "policySubType": "RemoteAction",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Removes company data, apps, and MDM policies from device while preserving user personal data. Suspends BitLocker on Azure AD joined devices. Use for BYOD devices or employee separation when device ownership transfers to user.",
      "implementationGuide": "1. Navigate to Devices > All devices in Intune admin center\n2. Select device to retire\n3. Click 'Retire' action\n4. Confirm retirement\n5. Retire action will:\n   - Remove company data (emails, apps, profiles)\n   - Remove MDM enrollment\n   - For Azure AD joined devices: Suspend BitLocker (backup recovery key first!)\n   - Keep user personal data intact\n   - Remove device from Intune management\n6. For corporate-owned devices being returned: Use Wipe instead\n7. Document retire action in HR/IT records\n8. Monitor retire status in Device actions\n9. After retire: Consider removing Azure AD device record\n10. CRITICAL: This is partial sanitization - only use when device ownership transfers to user\n11. For devices with highly sensitive CUI, use full Wipe instead",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/remote-actions/devices-wipe"
    },
    {
      "settingName": "BitLockerKeyRotation",
      "displayName": "BitLocker Recovery Key Rotation",
      "settingPath": "deviceManagement.remoteActions.rotateBitLockerKeys",
      "policyType": "Intune",
      "policySubType": "RemoteAction",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Rotates BitLocker recovery keys on managed devices to invalidate previous keys. Critical sanitization step when device has been compromised, lost then recovered, or when rotating keys as security measure. Prevents use of old recovery keys to access encrypted data.",
      "implementationGuide": "1. Prerequisite: BitLocker must be enabled and managed by Intune\n2. Prerequisite: User must have 'Rotate BitLockerKeys' permission in Intune RBAC role\n3. Navigate to Devices > All devices\n4. Select device\n5. From device actions, select 'Rotate BitLocker keys' (preview)\n6. Confirm key rotation\n7. Process:\n   - Device generates new BitLocker recovery key\n   - New key uploaded to Azure AD/Entra ID\n   - Old recovery key invalidated\n8. Verify new key in Azure AD device properties\n9. Document key rotation in security logs\n10. Use cases:\n   - Device was lost then recovered\n   - Suspected key compromise\n   - Regular key rotation policy (e.g., annually)\n   - Before device reassignment\n11. Note: Does not decrypt/re-encrypt drive, only rotates recovery keys",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices"
    },
    {
      "settingName": "AutomaticDeviceCleanup",
      "displayName": "Automatic Device Cleanup Rules",
      "settingPath": "deviceManagement.settings.deviceCompliancePolicy.deviceCleanupRules",
      "policyType": "Intune",
      "policySubType": "TenantAdministration",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"daysInactive\":90}",
      "validationOperator": "contains",
      "description": "Automatically removes stale or inactive device records from Intune after specified period of inactivity. Ensures device inventory hygiene and prevents accumulation of orphaned device records that may retain CUI metadata.",
      "implementationGuide": "1. Navigate to Tenant administration > Device cleanup rules\n2. Configure cleanup settings:\n   - Delete devices that haven't checked in for this many days: Set to 90 days (adjust based on policy)\n3. Click Save\n4. Behavior:\n   - Devices are hidden/concealed from Intune reports\n   - Device records removed from management\n   - Does NOT trigger wipe or retire actions on actual devices\n   - BitLocker keys and device metadata removed\n5. Important notes:\n   - Rule does not trigger BitLocker suspension\n   - Cleanup is for record keeping only\n   - Actual device sanitization must be done separately via Wipe/Retire\n6. Use in combination with proper device disposal procedures\n7. Document cleanup threshold in data retention policy\n8. Monitor cleanup activity in audit logs\n9. Review cleanup settings quarterly\n10. Coordinate with asset management team on device disposal workflows",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/remote-actions/devices-wipe"
    },
    {
      "settingName": "SensitivityLabelPolicyEnabled",
      "displayName": "Enable Sensitivity Label Policy",
      "settingPath": "Microsoft.Purview.InformationProtection.SensitivityLabelPolicy.Enabled",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables sensitivity label policies for the organization to mark CUI with distribution limitations and handling caveats. This is the foundational setting that allows sensitivity labels to be applied to documents and emails containing CUI.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Navigate to Solutions > Information Protection > Label policies\n3. Create a new label policy or verify existing policy is published\n4. Ensure the policy is published to All users or specific groups handling CUI\n5. Configure mandatory labeling if required by organizational policy\n6. Verify labels appear in Microsoft 365 applications (Word, Excel, Outlook)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/create-sensitivity-labels"
    },
    {
      "settingName": "SensitivityLabelsWithContentMarking",
      "displayName": "Configure Sensitivity Labels with Content Marking",
      "settingPath": "Microsoft.Purview.SensitivityLabel.ProtectionSettings.ContentMarking",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"headerEnabled\":true,\"footerEnabled\":true,\"watermarkEnabled\":true}",
      "validationOperator": "contains",
      "description": "Configures sensitivity labels to apply visual markings (headers, footers, watermarks) to documents and emails containing CUI. These markings display distribution limitations and handling caveats directly on the content.",
      "implementationGuide": "1. In Microsoft Purview compliance portal, go to Solutions > Information Protection > Labels\n2. Create or edit sensitivity labels for different CUI classifications (e.g., CUI Basic, CUI Specified)\n3. Under Protection settings, select 'Apply content marking'\n4. Configure Header: Add text like 'CUI//DISTRIBUTION: [RESTRICTIONS]'\n5. Configure Footer: Add text with handling instructions\n6. Configure Watermark: Add 'CONTROLLED UNCLASSIFIED INFORMATION' text\n7. Customize font size, color, and alignment as needed\n8. Save and publish the label\n9. Test by applying label to a document and verifying markings appear",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/sensitivity-labels-office-apps#content-marking"
    },
    {
      "settingName": "AutoLabelingPolicyForCUI",
      "displayName": "Automatic Labeling Policy for CUI",
      "settingPath": "Microsoft.Purview.AutoLabelingPolicy.Enabled",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables automatic labeling policies that detect CUI based on sensitive information types and trainable classifiers, ensuring all CUI is consistently marked. This prevents unintentional failure to mark media containing CUI.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal > Information Protection > Auto-labeling\n2. Click 'Create auto-labeling policy'\n3. Name the policy (e.g., 'CUI Auto-Labeling')\n4. Choose locations: Exchange, SharePoint, OneDrive\n5. Define conditions using Sensitive Info Types relevant to CUI (e.g., SSN, ITAR data, export-controlled information)\n6. Select the appropriate sensitivity label to apply automatically\n7. Choose simulation mode first to test policy effectiveness\n8. Review simulation results (wait 48 hours for initial scan)\n9. Turn on policy for enforcement after validation\n10. Monitor via Activity Explorer for effectiveness",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/apply-sensitivity-label-automatically"
    },
    {
      "settingName": "MandatoryLabelingEnabled",
      "displayName": "Require Labels on Documents and Emails",
      "settingPath": "Microsoft.Purview.LabelPolicy.MandatoryLabeling",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces mandatory labeling requirement for all documents and emails, ensuring users cannot save or send content without applying a sensitivity label. This prevents unmarked CUI from being created or shared.",
      "implementationGuide": "1. Go to Microsoft Purview compliance portal > Information Protection > Label policies\n2. Select or create a label policy\n3. Under Policy settings, enable 'Require users to apply a label to their email and documents'\n4. Enable 'Require users to apply a label to their Power BI content'\n5. Optionally enable 'Provide users with a link to a custom help page' for labeling guidance\n6. Configure default label for email and documents (e.g., 'General' or lowest sensitivity)\n7. Save and publish the policy\n8. Communicate change to users with training materials\n9. Test enforcement in Outlook and Office applications\n10. Monitor compliance via Activity Explorer",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/sensitivity-labels-office-apps#require-users-to-apply-a-label-to-their-email-and-documents"
    },
    {
      "settingName": "LabelPersistenceEnabled",
      "displayName": "Enable Label Persistence Across Platforms",
      "settingPath": "Microsoft.Purview.SensitivityLabel.Persistence",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Ensures sensitivity labels and their associated markings persist when documents are downloaded, copied, or moved across platforms. The label metadata travels with the file, maintaining marking integrity throughout the document lifecycle.",
      "implementationGuide": "1. Verify built-in labeling is enabled in Microsoft 365 Apps for Enterprise (version 1910 or later)\n2. Navigate to Microsoft Purview compliance portal > Information Protection\n3. Verify 'Enable Office file support for labels' is enabled\n4. For legacy support, enable 'Turn on sensitivity labels for Office files in SharePoint and OneDrive'\n5. Test by: (a) Applying a label to a document, (b) Downloading the file, (c) Opening in different applications, (d) Verifying label persists\n6. For PDF support, ensure 'Apply a sensitivity label to PDF documents' is configured\n7. Monitor label activity via Content Explorer\n8. Configure DLP policies to prevent label removal",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/sensitivity-labels-sharepoint-onedrive-files"
    },
    {
      "settingName": "SensitivityLabelEncryptionEnabled",
      "displayName": "Enable Encryption for Sensitivity Labels",
      "settingPath": "Microsoft.Purview.SensitivityLabel.Encryption.Enabled",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Configures sensitivity labels to apply encryption protection to documents and emails containing CUI during transport. Encryption ensures that CUI remains protected even when transported outside controlled areas (via email, cloud storage, or removable media).",
      "implementationGuide": "1. In Microsoft Purview compliance portal, go to Information Protection > Labels\n2. Create or edit a sensitivity label designated for CUI\n3. Under Protection settings, select 'Apply or remove encryption'\n4. Choose encryption settings: 'Assign permissions now' for predefined permissions\n5. Configure permissions: Select users/groups who can access encrypted content\n6. Set access rights: Co-Author, Reviewer, Viewer, or custom permissions\n7. Set 'User access to content expires': Configure based on organizational policy (e.g., Never or specific duration)\n8. For offline access, configure 'Allow offline access' appropriately\n9. Save and publish the label\n10. Test by applying label to document and sharing externally\n11. Verify recipient can only access with proper authentication",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/encryption-sensitivity-labels"
    },
    {
      "settingName": "OMEConfigurationEnabled",
      "displayName": "Enable Office Message Encryption (OME)",
      "settingPath": "Exchange.TransportRule.OME.Enabled",
      "policyType": "AzureAD",
      "policySubType": "ExchangeOnline",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Office Message Encryption for Exchange Online to protect email messages containing CUI during transport. OME provides end-to-end encryption for emails sent outside the organization, ensuring CUI remains protected during electronic transport.",
      "implementationGuide": "1. Verify Azure Information Protection (AIP) is activated for the tenant\n2. Connect to Exchange Online PowerShell\n3. Run: Test-IRMConfiguration to verify OME prerequisites\n4. Enable OME: Set-IRMConfiguration -AzureRMSLicensingEnabled $true\n5. In Exchange admin center, go to Mail flow > Rules\n6. Create transport rule for OME encryption:\n   - Name: 'Encrypt CUI Emails'\n   - Apply this rule if: The message contains sensitive information types (configure CUI-related SITs)\n   - Do the following: Modify the message security > Apply Office 365 Message Encryption and rights protection > Encrypt\n7. Test by sending an email matching the rule criteria to an external address\n8. Verify external recipient receives encrypted message with authentication requirement\n9. Monitor encrypted message usage via Message Trace",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/email-encryption"
    },
    {
      "settingName": "DLPPolicyEmailEncryption",
      "displayName": "DLP Policy - Encrypt Emails Containing CUI",
      "settingPath": "Microsoft.Purview.DLP.Policy.EncryptAction",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"action\":\"Encrypt\",\"scope\":\"ExternalSharing\"}",
      "validationOperator": "contains",
      "description": "Configures Data Loss Prevention policy to automatically encrypt email messages containing CUI when transported outside the organization. DLP automatically detects CUI and applies encryption, ensuring protection during transport without user intervention.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal > Data loss prevention > Policies\n2. Create policy: 'Auto-Encrypt CUI in Email'\n3. Choose locations: Exchange email\n4. Define rules:\n   - Condition: Content contains > Sensitive info types (select CUI-relevant types: SSN, ITAR data, etc.)\n   - OR: Content contains > Sensitivity labels (select labels for CUI)\n   - Advanced rule: Recipient is external\n5. Actions: Restrict access or encrypt content > Encrypt email messages\n6. User notifications: Configure policy tip warning users about encryption\n7. Incident reports: Send alerts to compliance team\n8. Set policy mode: Start with 'Test it out with policy tips'\n9. Monitor for 1-2 weeks, review DLP reports\n10. Switch to enforcement: Turn policy on fully\n11. Monitor via DLP Reports and Activity Explorer",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-email-encryption"
    },
    {
      "settingName": "TLSRequiredForExternalEmail",
      "displayName": "Require TLS for External Email Connections",
      "settingPath": "Exchange.TransportRule.TLS.Required",
      "policyType": "AzureAD",
      "policySubType": "ExchangeOnline",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces Transport Layer Security (TLS) encryption for all external email connections, ensuring emails are encrypted in transit between mail servers. This provides baseline encryption protection for CUI during email transport.",
      "implementationGuide": "1. Sign in to Exchange admin center (https://admin.exchange.microsoft.com)\n2. Navigate to Mail flow > Connectors\n3. For outbound connector (Office 365 to partner organization):\n   - Click New connector\n   - Connection from: Office 365, To: Partner organization\n   - Name: 'Outbound TLS Required'\n   - Use MX record or specify smart host\n   - Security restrictions: 'Always use TLS' (required)\n   - Certificate verification: 'Issued by a trusted certificate authority'\n4. Create additional connectors for specific partner domains requiring TLS\n5. Alternatively, use mail flow rules:\n   - Mail flow > Rules > Create rule\n   - Apply to messages sent to people outside the organization\n   - Do the following: Modify message properties > Set security level to TLS required\n6. Test by sending email to external domain and checking message headers for TLS\n7. Monitor via Message Trace for TLS connection failures",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/exchange/mail-flow-best-practices/use-connectors-to-configure-mail-flow/set-up-connectors-to-route-mail#require-tls-to-secure-email"
    },
    {
      "settingName": "DLPAuditingForMediaTransport",
      "displayName": "DLP Audit and Logging for Media Transport",
      "settingPath": "Microsoft.Purview.DLP.AuditLog.Enabled",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables comprehensive audit logging of DLP events related to CUI transport activities. Captures detailed records of when CUI-containing files are shared, emailed, or downloaded, providing accountability for media transport activities.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal > Audit\n2. Ensure Unified Audit Log is turned on (required for DLP audit logging)\n3. Go to Data loss prevention > Policies\n4. For each DLP policy protecting CUI:\n   - Edit policy settings\n   - Under Advanced DLP rules, ensure 'Send incident reports in email' is enabled\n   - Configure recipients: Security team, compliance officers\n   - Enable 'Include incident details'\n5. Configure Activity explorer:\n   - Go to Information Protection > Activity explorer\n   - Verify data is being collected for: File copied to removable media, File sent in email, File uploaded to cloud, File shared externally\n6. Set up DLP alerts:\n   - Go to Alerts > Alert policies\n   - Create alerts for high-severity DLP policy matches\n7. Create custom audit log search for transport activities:\n   - Audit > Search\n   - Activities: DLP policy match, File accessed, File downloaded, File shared externally\n8. Export audit logs regularly for long-term retention\n9. Review Activity Explorer weekly for unusual transport patterns",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/dlp-configure-view-alerts-policies"
    },
    {
      "settingName": "ContentExplorerForMediaTracking",
      "displayName": "Enable Content Explorer for CUI Media Tracking",
      "settingPath": "Microsoft.Purview.ContentExplorer.Enabled",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Content Explorer to provide visibility into all CUI-labeled content and its location across the organization. This helps maintain accountability by tracking where CUI media exists and monitoring its movement.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal > Content explorer\n2. Verify 'Content explorer' is enabled (E5 license required)\n3. Grant permissions:\n   - Go to Microsoft Purview > Permissions\n   - Add users to 'Content Explorer Content Viewer' role group (for viewing file details)\n   - Add users to 'Content Explorer List Viewer' role group (for viewing summaries only)\n4. In Content Explorer, configure filters:\n   - Filter by sensitivity labels used for CUI\n   - Filter by location: Exchange, SharePoint, OneDrive\n   - Filter by retention labels if applicable\n5. Use Content Explorer to:\n   - Identify all CUI-labeled content\n   - Track which labels are most used\n   - Identify files that may need reclassification\n   - Monitor for unusual distribution patterns\n6. Export reports regularly for compliance documentation\n7. Create custom Power BI reports using Content Explorer data API\n8. Review Content Explorer monthly to ensure CUI inventory is accurate",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/data-classification-content-explorer"
    },
    {
      "settingName": "RemovableStorageAccess",
      "displayName": "Block Removable Storage Devices",
      "settingPath": "DeviceConfiguration.Windows.RemovableStorage.DenyAccess",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Block",
      "validationOperator": "==",
      "description": "Restricts or blocks the use of removable storage devices (USB drives, external hard drives, SD cards) on Windows devices. This prevents unauthorized use of removable media that could contain or receive CUI.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://intune.microsoft.com)\n2. Navigate to Devices > Configuration profiles > Create profile\n3. Platform: Windows 10 and later\n4. Profile type: Templates > Device restrictions\n5. Under General settings, configure:\n   - Removable storage: Block\n   - USB connection (mobile only): Block (if applicable)\n6. Under Storage settings:\n   - Removable storage: Block\n7. Alternatively, use Settings Catalog profile:\n   - Create profile > Settings catalog\n   - Add setting: Storage > Removable Disk Classes > Deny All Access\n8. Assign policy to appropriate device groups (all devices or specific groups)\n9. Set applicability rules if needed (e.g., only for devices handling CUI)\n10. Monitor deployment status\n11. Test by attempting to access USB drive on enrolled device\n12. For exceptions, create separate policy with 'Allow' for specific approved devices or users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-windows-10#storage"
    },
    {
      "settingName": "BitLockerRemovableDrivesEncryption",
      "displayName": "Require BitLocker Encryption for Removable Drives",
      "settingPath": "DeviceConfiguration.Windows.BitLocker.RemovableDrivesEncryption.Required",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enable",
      "validationOperator": "==",
      "description": "Requires BitLocker encryption for all removable drives before they can be written to or accessed. This ensures that if removable media is used (when permitted), CUI stored on it is protected through encryption.",
      "implementationGuide": "1. In Microsoft Intune admin center, go to Endpoint security > Disk encryption\n2. Create policy > Platform: Windows 10 and later > Profile: BitLocker\n3. Configure BitLocker base settings:\n   - Enable full disk encryption for OS and fixed data drives: Yes\n   - Require device encryption: Yes\n4. Configure BitLocker removable drive settings:\n   - Removable drive encryption: Enable\n   - Block write access to removable data-drives not protected by BitLocker: Block\n   - Deny write access to devices configured in another organization: Yes\n5. Configure encryption method:\n   - Encryption method: XTS-AES 256-bit (recommended for NIST compliance)\n6. For recovery options:\n   - Allow users to suspend and decrypt BitLocker protection: Block\n   - Configure BitLocker recovery information to store in AD: Required (if applicable)\n7. Assign policy to device groups\n8. Monitor compliance via Endpoint security dashboard\n9. Test by connecting USB drive - should prompt for BitLocker encryption\n10. Verify write-blocking works for unencrypted removable drives",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices"
    },
    {
      "settingName": "AllowedUSBDevicesByVID_PID",
      "displayName": "Allow Only Approved USB Devices (Device ID)",
      "settingPath": "DeviceConfiguration.Windows.ControlledFolder.AllowedDevices",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "OrganizationDefinedDeviceList",
      "validationOperator": "in",
      "description": "Configures a whitelist of approved USB devices using Vendor ID (VID) and Product ID (PID), allowing only organization-issued removable media. This enforces the requirement that removable media have an identifiable owner.",
      "implementationGuide": "1. Identify approved USB device VID/PID:\n   - Connect approved device to test machine\n   - Open Device Manager > USB device > Properties > Details > Hardware IDs\n   - Note VID and PID (e.g., VID_0781&PID_5581 for SanDisk)\n2. In Intune admin center, create Configuration profile:\n   - Platform: Windows 10 and later\n   - Profile type: Templates > Custom\n3. Add OMA-URI settings for device control:\n   - Name: Allow Approved USB Devices\n   - OMA-URI: ./Vendor/MSFT/Defender/Configuration/DeviceControl/PolicyGroups\n   - Data type: String (XML)\n   - Value: (XML defining approved device VIDs/PIDs)\n4. Alternatively use Settings Catalog:\n   - Defender > Device Control > Device Installation\n   - Configure 'Allow installation of devices that match any of these device IDs'\n   - Add approved device VID_XXXX&PID_YYYY entries\n5. Block all other devices:\n   - Configure 'Prevent installation of devices not described by other policy settings': Enabled\n6. Assign policy to device groups\n7. Test with both approved and non-approved USB devices\n8. Monitor via Endpoint security reports\n9. Maintain inventory of approved devices with serial numbers (identifiable owners)",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/administrative-templates-windows"
    },
    {
      "settingName": "USBWriteProtection",
      "displayName": "Enable Write Protection for Removable Storage",
      "settingPath": "DeviceConfiguration.Windows.RemovableStorage.WriteProtection",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enable",
      "validationOperator": "==",
      "description": "Configures write protection for removable storage devices, allowing read access but preventing data from being written to removable media. This controls the use of removable media by preventing CUI from being copied to unauthorized removable storage.",
      "implementationGuide": "1. In Microsoft Intune admin center, go to Devices > Configuration profiles\n2. Create profile > Settings catalog\n3. Add settings category: Storage\n4. Configure settings:\n   - 'Removable Disks: Deny write access': Enabled\n5. Or use Administrative Templates profile:\n   - Profile type: Templates > Administrative Templates\n   - Navigate to: System > Removable Storage Access\n   - Configure: 'Removable Disks: Deny write access' = Enabled\n6. For exceptions, create separate policies:\n   - Use Windows Filtering Platform (WFP) to allow specific applications to write\n   - Or create exemption groups for authorized users\n7. Assign policy to device groups handling CUI\n8. Test by attempting to copy file to USB drive (should be blocked)\n9. Test read access to ensure files can still be opened from USB\n10. Monitor enforcement via device configuration reports\n11. Document exceptions and approvals for audit trail",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/administrative-templates-windows"
    },
    {
      "settingName": "DefenderDeviceControlPolicy",
      "displayName": "Microsoft Defender Device Control Policy",
      "settingPath": "DeviceConfiguration.Windows.Defender.DeviceControl.Enabled",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"defaultEnforcement\":\"Deny\"}",
      "validationOperator": "contains",
      "description": "Configures Microsoft Defender for Endpoint device control policies to manage removable storage and peripheral device usage. Provides granular control over what types of removable media can be used and under what conditions.",
      "implementationGuide": "1. Ensure devices are onboarded to Microsoft Defender for Endpoint\n2. In Microsoft 365 Defender portal (security.microsoft.com), go to Settings > Endpoints > Device control\n3. Enable Device Control feature\n4. In Intune, create Device Control policy:\n   - Endpoint security > Attack surface reduction > Create Policy\n   - Platform: Windows 10, Windows 11, and Windows Server\n   - Profile: Device control\n5. Configure device classes to control:\n   - Removable storage: Deny (or Allow with conditions)\n   - CD/DVD: Deny\n   - Windows Portable Devices: Deny\n   - Bluetooth: Allow (or customize)\n6. Configure exceptions/allow rules:\n   - Create groups for authorized devices (by VID/PID)\n   - Create groups for authorized users\n   - Define read-only access for specific scenarios\n7. Configure audit-only mode initially for testing:\n   - Set Default Enforcement to 'Audit'\n   - Monitor for 2-4 weeks via Defender Advanced Hunting\n8. Switch to enforcement mode:\n   - Set Default Enforcement to 'Deny'\n   - Create allow rules for legitimate use cases\n9. Monitor device control events via Advanced Hunting:\n   - Query: DeviceEvents | where ActionType has 'DeviceControl'\n10. Create alerts for policy violations\n11. Maintain documentation of approved devices and authorized users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/device-control-overview"
    },
    {
      "settingName": "ConditionalAccessBlockUnmanagedDevices",
      "displayName": "Conditional Access - Block Access from Unmanaged Devices",
      "settingPath": "ConditionalAccess.GrantControls.RequireCompliantDevice",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces Conditional Access policy requiring device compliance before accessing Microsoft 365 resources. This ensures only devices under management (with enforced removable media controls) can access CUI, preventing access from uncontrolled devices with unrestricted media use.",
      "implementationGuide": "1. Sign in to Azure portal (portal.azure.com) or Entra admin center\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create new policy: 'Block Unmanaged Device Access'\n4. Configure Assignments:\n   - Users: All users (or specific groups handling CUI)\n   - Cloud apps: All cloud apps (or specific M365 apps: Office 365, SharePoint, Exchange)\n   - Conditions: Device platforms: All platforms\n5. Configure Access controls:\n   - Grant: Require device to be marked as compliant (checked)\n   - OR: Require Hybrid Azure AD joined device (checked)\n   - For multiple controls: Require one of the selected controls\n6. Configure Session controls (optional):\n   - Use app enforced restrictions (for SharePoint/Exchange)\n7. Enable policy:\n   - Set 'Enable policy' to 'Report-only' initially\n   - Test for 1-2 weeks, review sign-in logs\n   - Switch to 'On' for enforcement\n8. Create break-glass account exemption for emergency access\n9. Test policy:\n   - Attempt access from non-compliant device (should be blocked)\n   - Attempt access from compliant device (should succeed)\n10. Monitor via Azure AD sign-in logs and Conditional Access insights\n11. Document policy exceptions and review quarterly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/require-managed-devices"
    },
    {
      "settingName": "accessReviews",
      "displayName": "Access Reviews for Privileged Roles",
      "settingPath": "properties.settings.recurrence",
      "policyType": "AzureAD",
      "policySubType": "IdentityGovernance",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "quarterly",
      "validationOperator": "==",
      "description": "Configures recurring access reviews for privileged Azure AD roles to ensure only authorized individuals retain elevated access. Supports periodic rescreening by requiring regular review and confirmation of role assignments.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Privileged Role Administrator\n2. Navigate to Identity Governance > Privileged Identity Management\n3. Select 'Azure AD Roles' under Manage\n4. Select 'Access reviews' and click 'New'\n5. Configure review:\n   - Select privileged roles (Global Admin, Privileged Role Admin, etc.)\n   - Set recurrence to 'Quarterly'\n   - Select reviewers (managers or designated approvers)\n   - Enable 'Auto apply results to resource'\n   - Set 'If reviewers don't respond' to 'Remove access'\n6. Click 'Start' to create recurring review",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-create-roles-and-resource-roles-review"
    },
    {
      "settingName": "continuousAccessEvaluation",
      "displayName": "Continuous Access Evaluation (CAE)",
      "settingPath": "properties.conditions.clientAppTypes",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables near real-time token revocation when user accounts are disabled or deleted. CAE reduces the standard token lifetime from 1 hour to minutes, ensuring terminated users lose access almost immediately upon account disablement.",
      "implementationGuide": "1. CAE is automatically enabled for Azure AD Premium P1/P2 tenants\n2. Ensure applications support CAE (Microsoft 365 apps do by default)\n3. Sign in to Microsoft Entra admin center\n4. Navigate to Protection > Conditional Access > Policies\n5. Verify existing policies use 'All cloud apps' to enable CAE\n6. CAE automatically evaluates critical events:\n   - User account disabled/deleted\n   - Password changed\n   - High-risk users detected\n   - User removed from location/group\n7. No additional configuration needed; CAE works with existing CA policies",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-continuous-access-evaluation"
    },
    {
      "settingName": "signInFrequency",
      "displayName": "Sign-in Frequency - Session Controls",
      "settingPath": "properties.sessionControls.signInFrequency",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"value\":1,\"type\":\"hours\",\"isEnabled\":true}",
      "validationOperator": "==",
      "description": "Enforces reauthentication every 1 hour for all users, ensuring that disabled accounts cannot maintain active sessions beyond this period. When combined with account disablement, this guarantees session termination within the defined timeframe.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Conditional Access Administrator\n2. Navigate to Protection > Conditional Access > Policies\n3. Create new policy: 'Session Timeout - 1 Hour'\n4. Under Assignments > Users: Select 'All users' (exclude break-glass accounts)\n5. Under Assignments > Cloud apps: Select 'All cloud apps'\n6. Under Access controls > Session:\n   - Click 'Sign-in frequency'\n   - Set to '1 hour'\n   - Enable 'Sign-in frequency'\n7. Set 'Enable policy' to 'On' and click Create\n8. Note: Use shorter intervals (e.g., 30 minutes) for highly sensitive environments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-session-lifetime"
    },
    {
      "settingName": "privilegedIdentityManagement",
      "displayName": "Just-in-Time (JIT) Privileged Access",
      "settingPath": "properties.roleSettings.activationRules.maximumDuration",
      "policyType": "AzureAD",
      "policySubType": "PrivilegedIdentityManagement",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "PT8H",
      "validationOperator": "<=",
      "description": "Enforces time-limited privileged role assignments with JIT activation, ensuring that privileged access automatically expires. When personnel are terminated or transferred, their pending activations are automatically revoked, and no new activations can be requested from disabled accounts.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as Privileged Role Administrator\n2. Navigate to Identity Governance > Privileged Identity Management\n3. Select 'Azure AD Roles' under Manage\n4. Select 'Settings' and choose a privileged role (e.g., Global Administrator)\n5. Click 'Edit' and configure:\n   - Activation maximum duration: 8 hours (or less)\n   - Require approval to activate: Enabled\n   - Require justification on activation: Enabled\n   - Require ticket information on activation: Optional\n6. Under 'Assignment':\n   - Allow permanent active assignment: Disabled\n   - Allow permanent eligible assignment: Disabled\n   - Expire eligible assignments after: 180 days maximum\n7. Click 'Update' and repeat for all privileged roles",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure"
    },
    {
      "settingName": "corporateWipeOnTermination",
      "displayName": "Automatic Device Wipe on Account Deletion",
      "settingPath": "properties.actions.wipe",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically wipes corporate data from managed devices when user accounts are deleted, ensuring that company data is removed from devices and preventing unauthorized access to cached information. This retrieves organizational property by removing corporate data.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Compliance policies > Policies\n3. Create new compliance policy for each platform (Windows, iOS, Android)\n4. Configure compliance settings (device health, encryption, etc.)\n5. Under 'Actions for noncompliance':\n   - Add action: 'Retire the noncompliant device'\n   - Schedule: Immediately after noncompliance\n6. When user account is deleted:\n   - Device automatically becomes noncompliant\n   - Intune issues retire command\n   - Corporate data is wiped from device\n7. For BYOD: Use 'Selective wipe' to remove only company data\n8. For Corporate devices: Use 'Full wipe' to factory reset",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/remote-actions/devices-wipe"
    },
    {
      "settingName": "namedLocations",
      "displayName": "Named Locations - Trusted Corporate Locations",
      "settingPath": "identity.conditionalAccess.namedLocations",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "At least one named location defined with corporate IP ranges marked as trusted",
      "validationOperator": "exists",
      "description": "Defines trusted physical locations (headquarters, branch offices) by IP address ranges. This provides logical access control that correlates with physical location, supporting the requirement to maintain lists of authorized facility access locations. In cloud/hybrid environments, this complements physical access controls by restricting M365 access to users connecting from authorized corporate network locations.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as at least a Conditional Access Administrator\n2. Browse to Protection > Conditional Access > Named Locations\n3. Select '+ IP ranges location'\n4. Provide a descriptive name (e.g., 'Corporate HQ' or 'Branch Office - NY')\n5. Add IPv4/IPv6 address ranges for each physical location in CIDR format\n6. Check 'Mark as trusted location'\n7. Click Create\n8. Repeat for each authorized physical facility location\n9. Document the mapping between named locations and actual physical facilities",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network"
    },
    {
      "settingName": "conditionalAccessPolicy",
      "displayName": "Conditional Access - Require Access from Trusted Locations",
      "settingPath": "identity.conditionalAccess.policies",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"conditions\":{\"locations\":{\"includeLocations\":[\"All\"],\"excludeLocations\":[\"AllTrusted\"]}},\"grantControls\":{\"operator\":\"OR\",\"builtInControls\":[\"mfa\",\"compliantDevice\"]}}",
      "validationOperator": "==",
      "description": "Enforces stronger authentication requirements (MFA or device compliance) when users access M365 from locations outside trusted corporate facilities. This provides compensating controls for access from non-authorized physical locations, ensuring that users connecting from untrusted locations must provide additional authentication factors. Aligns with the principle that physical access authorizations should be verified before granting system access.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as at least a Conditional Access Administrator\n2. Browse to Protection > Conditional Access > Policies\n3. Select 'New policy'\n4. Name: 'Block or Restrict Access from Untrusted Locations'\n5. Under Assignments > Users: Select 'All users' (exclude break-glass accounts)\n6. Under Assignments > Cloud apps: Select 'All cloud apps'\n7. Under Conditions > Locations: Include 'Any location', Exclude 'All trusted locations'\n8. Under Grant: Select 'Require multifactor authentication' OR 'Require device to be marked as compliant'\n9. Set Enable policy to 'Report-only' initially for testing\n10. After validation, set to 'On'\n11. Click Create",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-location"
    },
    {
      "settingName": "deviceCompliancePolicyWindows",
      "displayName": "Intune Device Compliance Policy - Windows",
      "settingPath": "deviceManagement.deviceCompliancePolicies",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"requirePasswordType\":\"deviceDefault\",\"passwordMinimumLength\":8,\"firewallRequired\":true,\"antivirusRequired\":true,\"antiSpywareRequired\":true,\"defenderEnabled\":true,\"securityBlockJailbrokenDevices\":true}",
      "validationOperator": "==",
      "description": "Establishes baseline security requirements for Windows devices before they can be marked as compliant and granted access to M365 resources. This policy defines the security posture required for devices to receive 'authorization' to access systems, similar to how physical access authorizations require verification of credentials. Only devices meeting these requirements can be considered 'authorized devices' for system access.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Compliance policies > Policies\n3. Click 'Create Policy'\n4. Platform: Select 'Windows 10 and later'\n5. Settings > Device Health:\n   - Require BitLocker: Yes\n   - Require Secure Boot: Yes\n6. Settings > Device Properties:\n   - Minimum OS version: Set to supported version\n7. Settings > System Security:\n   - Require password: Yes\n   - Minimum password length: 8 or higher\n   - Firewall: Require\n   - Antivirus: Require\n   - Antispyware: Require\n   - Microsoft Defender Antimalware: Require\n8. Set Actions for noncompliance (mark noncompliant immediately)\n9. Assign to appropriate device groups\n10. Review and create",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "deviceCompliancePolicyiOS",
      "displayName": "Intune Device Compliance Policy - iOS/iPadOS",
      "settingPath": "deviceManagement.deviceCompliancePolicies",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "iOS",
      "dataType": "object",
      "expectedValue": "{\"passcodeRequired\":true,\"passcodeMinimumLength\":6,\"securityBlockJailbrokenDevices\":true,\"osMinimumVersion\":\"15.0\",\"deviceThreatProtectionEnabled\":true,\"deviceThreatProtectionRequiredSecurityLevel\":\"secured\"}",
      "validationOperator": "==",
      "description": "Defines security compliance requirements for iOS/iPadOS devices accessing M365 resources. Ensures mobile devices meet organizational security standards before being granted access authorization, preventing compromised or non-compliant devices from accessing CUI. Acts as authorization credential verification for mobile endpoints, ensuring only devices meeting security requirements can access systems.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Compliance policies > Policies\n3. Click 'Create Policy'\n4. Platform: Select 'iOS/iPadOS'\n5. Settings > Device Health:\n   - Jailbroken devices: Block\n6. Settings > Device Properties:\n   - Minimum OS version: 15.0 or later\n7. Settings > System Security:\n   - Require a password: Yes\n   - Minimum password length: 6 or higher\n   - Password complexity: Require numeric or alphanumeric\n8. Settings > Device Security:\n   - Mobile Threat Defense: Enable if available\n   - Required threat level: Secured\n9. Set Actions for noncompliance\n10. Assign to iOS device groups\n11. Review and create",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-ios"
    },
    {
      "settingName": "deviceCompliancePolicyAndroid",
      "displayName": "Intune Device Compliance Policy - Android",
      "settingPath": "deviceManagement.deviceCompliancePolicies",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Android",
      "dataType": "object",
      "expectedValue": "{\"passwordRequired\":true,\"passwordMinimumLength\":6,\"securityBlockJailbrokenDevices\":true,\"osMinimumVersion\":\"8.0\",\"storageRequireEncryption\":true,\"deviceThreatProtectionEnabled\":true,\"deviceThreatProtectionRequiredSecurityLevel\":\"secured\"}",
      "validationOperator": "==",
      "description": "Establishes compliance requirements for Android devices before granting access to M365 resources. Blocks rooted devices, enforces encryption, and requires minimum security standards to ensure only authorized, secure devices can access organizational systems. Provides device-level access authorization analogous to physical access credentials.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Compliance policies > Policies\n3. Click 'Create Policy'\n4. Platform: Select 'Android device administrator' or 'Android Enterprise'\n5. Settings > Device Health:\n   - Rooted devices: Block\n6. Settings > Device Properties:\n   - Minimum OS version: 8.0 or later\n7. Settings > System Security:\n   - Require a password: Yes\n   - Minimum password length: 6 or higher\n   - Encryption of data storage: Require\n8. Settings > Device Security:\n   - Mobile Threat Defense: Enable if available\n   - Required threat level: Secured\n9. Set Actions for noncompliance\n10. Assign to Android device groups\n11. Review and create",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-android"
    },
    {
      "settingName": "signInLogsEnabled",
      "displayName": "Azure AD Sign-in Logs - Enabled and Retained",
      "settingPath": "reports.signIns",
      "policyType": "AzureAD",
      "policySubType": "Logging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables comprehensive logging of all user sign-in attempts to M365 services, including location (IP address), device information, application accessed, and success/failure status. These logs serve as the digital equivalent of physical access logs, providing audit trails for investigating suspicious access patterns and security incidents. Sign-in logs support the requirement to review access logs for anomalous activities such as access from unusual locations, repeated failed attempts, or access outside normal hours.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as at least a Reports Reader\n2. Browse to Identity > Monitoring & health > Sign-in logs\n3. Verify logs are being collected (enabled by default in Azure AD Premium)\n4. Configure log retention:\n   - Navigate to Azure Active Directory > Diagnostic settings\n   - Click 'Add diagnostic setting'\n   - Select 'SignInLogs'\n   - Send to Log Analytics workspace for long-term retention (30-90 days minimum)\n5. Configure alerts for suspicious activities:\n   - Create Azure Monitor alerts for failed sign-ins\n   - Set up alerts for sign-ins from unfamiliar locations\n   - Configure alerts for impossible travel scenarios\n6. Document log review procedures and frequency\n7. Assign appropriate roles (Security Reader, Reports Reader) for log access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/concept-sign-ins"
    },
    {
      "settingName": "auditLogsEnabled",
      "displayName": "Azure AD Audit Logs - Enabled with Long-term Retention",
      "settingPath": "reports.auditLogs",
      "policyType": "AzureAD",
      "policySubType": "Logging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables audit logging of all administrative and security-related activities in Azure AD, including user/group changes, policy modifications, role assignments, and access reviews. Audit logs complement sign-in logs by capturing configuration changes and administrative actions that could affect access controls. Supports investigation of security incidents by providing a complete audit trail of changes to access authorizations and security configurations.",
      "implementationGuide": "1. Sign in to Microsoft Entra admin center as at least a Reports Reader\n2. Browse to Identity > Monitoring & health > Audit logs\n3. Verify logs are being collected (enabled by default in Azure AD Premium)\n4. Configure extended retention:\n   - Navigate to Azure Active Directory > Diagnostic settings\n   - Click 'Add diagnostic setting'\n   - Select 'AuditLogs'\n   - Send to Log Analytics workspace for long-term retention (minimum 90 days, recommend 1 year)\n5. Configure key audit activities to monitor:\n   - User account changes (creation, modification, deletion)\n   - Role assignments and privilege escalations\n   - Conditional Access policy changes\n   - Named location modifications\n   - Device registration/deregistration events\n6. Set up automated alerts for critical audit events\n7. Document audit log review schedule",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/concept-audit-logs"
    },
    {
      "settingName": "identityProtectionEnabled",
      "displayName": "Azure AD Identity Protection - Risk Detection Enabled",
      "settingPath": "security.identityProtection",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Azure AD Identity Protection to automatically detect and respond to identity-based risks including impossible travel, atypical travel, anonymous IP address usage, malicious IP addresses, and unfamiliar sign-in properties. Identity Protection analyzes trillions of signals to identify suspicious access patterns that may indicate compromised credentials or unauthorized access attempts. This provides automated monitoring analogous to video surveillance and intrusion detection systems in physical facilities.",
      "implementationGuide": "1. Verify Azure AD Premium P2 licensing (required for Identity Protection)\n2. Sign in to Microsoft Entra admin center as at least a Security Administrator\n3. Browse to Protection > Identity Protection\n4. Review the Identity Protection dashboard:\n   - Risky users\n   - Risky sign-ins\n   - Risk detections\n5. Enable risk detection (enabled by default with P2 licensing)\n6. Configure risk-based policies:\n   - User risk policy (recommend: High risk requires password change)\n   - Sign-in risk policy (recommend: Medium and above requires MFA)\n7. Configure notifications:\n   - Navigate to Identity Protection > Settings > Alerts\n   - Enable 'Users at risk detected alerts'\n   - Add recipients (security team email addresses)\n   - Enable 'Weekly digest'\n8. Review risky sign-ins daily\n9. Document incident response procedures for risk detections",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/overview-identity-protection"
    },
    {
      "settingName": "impossibleTravelDetection",
      "displayName": "Identity Protection - Impossible Travel Risk Detection",
      "settingPath": "security.identityProtection.riskDetections.impossibleTravel",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "enabled",
      "validationOperator": "==",
      "description": "Detects sign-ins from geographically distant locations within an impossible timeframe, indicating potential credential theft or unauthorized access. Impossible travel detection identifies when a user signs in from Location A, then signs in from Location B within a time period shorter than physically possible to travel between locations. This is a critical indicator of compromised credentials or concurrent unauthorized access, similar to detecting presence at multiple physical facilities simultaneously.",
      "implementationGuide": "1. Ensure Azure AD Identity Protection is enabled (requires Premium P2)\n2. Sign in to Microsoft Entra admin center\n3. Browse to Protection > Identity Protection > Risk detections\n4. Impossible Travel detection is enabled by default\n5. Configure sign-in risk policy to respond:\n   - Browse to Identity Protection > Sign-in risk policy\n   - Set risk level: High and Medium\n   - Require multifactor authentication\n6. Review impossible travel detections:\n   - Navigate to Identity Protection > Risky sign-ins\n   - Filter by Risk detection type: 'Impossible travel'\n7. Investigate flagged incidents:\n   - Review user's sign-in history\n   - Verify legitimate business travel vs. compromise\n   - Confirm with user if necessary\n   - Dismiss false positives or confirm compromise\n8. Document response procedures for impossible travel alerts",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks"
    },
    {
      "settingName": "atypicalTravelDetection",
      "displayName": "Identity Protection - Atypical Travel Risk Detection",
      "settingPath": "security.identityProtection.riskDetections.atypicalTravel",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "enabled",
      "validationOperator": "==",
      "description": "Identifies sign-ins from locations that are atypical for the user based on historical behavior patterns. Atypical travel detection learns each user's normal sign-in locations over time and flags access from unusual locations as potentially suspicious. This is analogous to physical security monitoring that identifies when individuals access areas they don't normally access or appear at facilities outside their regular patterns, supporting detection of unauthorized access attempts.",
      "implementationGuide": "1. Ensure Azure AD Identity Protection is enabled with Premium P2 licensing\n2. Allow 14-day learning period for new users (system learns normal behavior)\n3. Atypical travel detection is automatically enabled\n4. Configure response policy:\n   - Browse to Identity Protection > Sign-in risk policy\n   - Include Medium risk level\n   - Require MFA for atypical locations\n5. Review atypical travel detections:\n   - Navigate to Identity Protection > Risky sign-ins\n   - Filter by Risk detection type: 'Atypical travel'\n6. Investigate flagged sign-ins:\n   - Compare to user's normal sign-in patterns\n   - Consider business justifications (travel, remote work)\n   - Contact user to verify legitimate access\n   - Dismiss or confirm based on investigation\n7. Adjust Named Locations to reduce false positives:\n   - Add remote work locations to named locations\n   - Mark VPN exit points as known locations",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks"
    },
    {
      "settingName": "anonymousIPDetection",
      "displayName": "Identity Protection - Anonymous IP Address Detection",
      "settingPath": "security.identityProtection.riskDetections.anonymousIP",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "enabled",
      "validationOperator": "==",
      "description": "Detects sign-ins from anonymous IP addresses including Tor browsers, anonymizer VPNs, and proxy services. Anonymous IP usage indicates attempts to hide identity and location, which is inherently suspicious for users accessing organizational resources. This is equivalent to detecting individuals attempting to obscure their identity or bypass physical security controls when accessing facilities, warranting additional scrutiny and authentication requirements.",
      "implementationGuide": "1. Ensure Azure AD Identity Protection is enabled\n2. Anonymous IP detection operates in real-time (no configuration needed)\n3. Configure response policy:\n   - Browse to Identity Protection > Sign-in risk policy\n   - Set to trigger on Medium risk and above\n   - Require MFA when anonymous IP detected\n4. Review anonymous IP sign-ins:\n   - Navigate to Identity Protection > Risky sign-ins\n   - Filter by 'Anonymous IP address'\n5. Investigate all anonymous IP access:\n   - Determine if legitimate (rare for business use)\n   - Most anonymous IP access indicates malicious intent\n   - Contact user immediately to verify\n   - Consider blocking if confirmed unauthorized\n6. Consider blocking anonymous IP access entirely:\n   - Create Conditional Access policy\n   - Condition: Locations > Any location\n   - Exclude: All trusted locations\n   - Include: Anonymous proxy detection\n   - Action: Block access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks"
    },
    {
      "settingName": "maliciousIPDetection",
      "displayName": "Identity Protection - Malicious IP Address Detection",
      "settingPath": "security.identityProtection.riskDetections.maliciousIP",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "enabled",
      "validationOperator": "==",
      "description": "Identifies sign-ins from IP addresses known to be associated with malicious activities, including high rates of authentication failures, botnet command-and-control servers, or IP addresses flagged by threat intelligence feeds. Access from malicious IPs indicates active attack attempts or compromised credentials being used from hostile infrastructure. This is equivalent to detecting unauthorized individuals or known threats attempting to breach physical facility security.",
      "implementationGuide": "1. Ensure Azure AD Identity Protection is enabled\n2. Malicious IP detection operates automatically using Microsoft threat intelligence\n3. Configure immediate response:\n   - Browse to Identity Protection > Sign-in risk policy\n   - Set to trigger on High risk\n   - Action: Block access (recommended) or require MFA\n4. Review malicious IP detections:\n   - Navigate to Identity Protection > Risky sign-ins\n   - Filter by 'Malicious IP address'\n5. Respond to malicious IP access:\n   - Treat all malicious IP detections as confirmed incidents\n   - Immediately reset user password\n   - Review user's recent activity for indicators of compromise\n   - Revoke all active sessions\n   - Contact user to verify account status\n   - Document incident for security review\n6. Consider IP blocking:\n   - Use Conditional Access to block known malicious IP ranges\n   - Integrate with SIEM for broader threat response",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks"
    },
    {
      "settingName": "unfamiliarSignInProperties",
      "displayName": "Identity Protection - Unfamiliar Sign-in Properties Detection",
      "settingPath": "security.identityProtection.riskDetections.unfamiliarProperties",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "enabled",
      "validationOperator": "==",
      "description": "Detects sign-ins with properties that differ significantly from the user's normal sign-in patterns, including new devices, browsers, operating systems, IP addresses, or authentication methods. Unfamiliar properties indicate potential account compromise or unauthorized access from devices/locations not previously associated with the user. Similar to physical security monitoring that identifies unfamiliar individuals or unusual access patterns, this detection flags anomalous digital access characteristics.",
      "implementationGuide": "1. Ensure Azure AD Identity Protection is enabled with Premium P2\n2. Allow 14-day learning period for baseline establishment\n3. Unfamiliar sign-in properties detection is automatically enabled\n4. Configure response:\n   - Browse to Identity Protection > Sign-in risk policy\n   - Include Low, Medium, and High risk\n   - Require MFA for unfamiliar properties\n5. Review detections:\n   - Navigate to Identity Protection > Risky sign-ins\n   - Filter by 'Unfamiliar sign-in properties'\n6. Investigate unfamiliar sign-in properties:\n   - Check if user registered new device\n   - Verify if legitimate travel or location change\n   - Confirm if user switched browsers/devices\n   - Contact user to verify if uncertain\n7. Reduce false positives:\n   - Ensure device registration is encouraged\n   - Register corporate VPN exit IPs as named locations\n   - Educate users on device registration importance\n8. Document investigation outcomes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks"
    },
    {
      "settingName": "cloudAppSecurityImpossibleTravel",
      "displayName": "Defender for Cloud Apps - Impossible Travel Activity Policy",
      "settingPath": "cloudAppSecurity.policies.impossibleTravel",
      "policyType": "Defender",
      "policySubType": "CloudAppSecurity",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"severity\":\"medium\",\"alertSent\":true}",
      "validationOperator": "==",
      "description": "Detects activities performed by a user from multiple locations within a timeframe shorter than the time it would take to travel between those locations. Defender for Cloud Apps provides enhanced impossible travel detection across all cloud applications, not just Azure AD sign-ins. This provides comprehensive monitoring for suspicious access patterns across the entire M365 ecosystem including SharePoint, OneDrive, Teams, and Exchange Online.",
      "implementationGuide": "1. Ensure Defender for Cloud Apps licensing (included in E5)\n2. Sign in to Microsoft 365 Defender portal\n3. Navigate to Cloud Apps > Policies > Policy management\n4. The 'Impossible travel activity' policy is enabled by default\n5. Review and customize policy:\n   - Click on 'Impossible travel activity' policy\n   - Verify 'Status: Enabled'\n   - Set Severity to 'Medium' or 'High'\n   - Ensure 'Send alert as email' is checked\n   - Add recipients for alerts\n6. Configure sensitivity:\n   - Adjust 'Minimum risk score' if needed\n   - Consider user context (frequent travelers may need adjustments)\n7. Review alerts:\n   - Navigate to Cloud Apps > Alerts\n   - Filter for 'Impossible travel' alerts\n8. Investigate flagged activities:\n   - Review user's cloud app activities across all services\n   - Check for data exfiltration or suspicious file access\n   - Correlate with Azure AD sign-in logs\n9. Document response procedures",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy"
    },
    {
      "settingName": "secureScore.enabled",
      "displayName": "Microsoft Secure Score Monitoring Enabled",
      "settingPath": "Microsoft365Defender.SecureScore",
      "policyType": "Defender",
      "policySubType": "SecureScore",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Secure Score to provide continuous risk assessment and security posture measurement across M365 environment. Secure Score aggregates security findings and provides actionable recommendations to identify and mitigate risks.",
      "implementationGuide": "1. Navigate to Microsoft 365 Defender portal (https://security.microsoft.com)\n2. Go to Secure Score dashboard\n3. Review initial score and recommendations\n4. Enable monitoring for all recommended actions\n5. Configure automatic score calculation (runs every 8 hours)\n6. Set up alerts for score changes and new recommendations\n7. Review score regularly as part of risk assessment process",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/microsoft-secure-score"
    },
    {
      "settingName": "vulnerabilityManagement.baselineAssessment.enabled",
      "displayName": "Defender Vulnerability Management Baseline Assessment",
      "settingPath": "DefenderForEndpoint.VulnerabilityManagement.BaselineAssessment",
      "policyType": "Defender",
      "policySubType": "VulnerabilityManagement",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables continuous security baseline assessment against CIS benchmarks and STIG standards. Provides real-time compliance monitoring and identifies security misconfigurations that increase risk of CUI exposure.",
      "implementationGuide": "1. Navigate to Microsoft 365 Defender portal\n2. Go to Vulnerability management > Baselines assessment\n3. Click 'Create profile' button\n4. Select appropriate OS (Windows 10, 11, or Server)\n5. Choose CIS Benchmark (Level 1 recommended for most organizations)\n6. Select configurations to include in profile\n7. Choose device groups to assess\n8. Submit and monitor compliance results\n9. Review baseline assessment results as part of regular risk assessments",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-vulnerability-management/tvm-security-baselines"
    },
    {
      "settingName": "identityProtection.riskPolicy.enabled",
      "displayName": "Azure AD Identity Protection Risk Policies Enabled",
      "settingPath": "AzureAD.IdentityProtection.RiskPolicy",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Azure AD Identity Protection to detect and assess identity-based risks including compromised credentials, impossible travel, malicious IP addresses, and anomalous sign-in behavior. Provides continuous risk scoring for users and sign-ins to identify potential unauthorized access to CUI.",
      "implementationGuide": "1. Navigate to Azure AD admin center (https://aad.portal.azure.com)\n2. Go to Security > Identity Protection\n3. Enable 'User risk policy'\n4. Configure user risk level threshold (Medium or High)\n5. Enable 'Sign-in risk policy'\n6. Configure sign-in risk level threshold (Medium or High)\n7. Set remediation action (Require MFA and/or password change)\n8. Enable 'MFA registration policy' for all users\n9. Review risk detections regularly (daily recommended)\n10. Export risk data to SIEM or logging solution for audit trail",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks"
    },
    {
      "settingName": "complianceManager.assessments.enabled",
      "displayName": "Microsoft Purview Compliance Manager Assessments",
      "settingPath": "Purview.ComplianceManager.Assessments",
      "policyType": "Purview",
      "policySubType": "ComplianceManager",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Purview Compliance Manager to conduct continuous compliance assessments against regulatory frameworks (NIST 800-171, ISO 27001, etc.). Provides risk scoring based on control implementation status and identifies compliance gaps that create risk of CUI exposure.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Go to Compliance Manager\n3. Review initial compliance score based on M365 data protection baseline\n4. Create assessment for NIST 800-171 Rev 3\n5. Assign improvement actions to responsible personnel\n6. Configure assessment frequency (quarterly minimum recommended)\n7. Enable continuous monitoring for all controls\n8. Review compliance score trends as part of risk assessment process\n9. Export assessment reports for audit evidence\n10. Update assessments when significant changes occur",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/compliance-manager"
    },
    {
      "settingName": "vulnerabilityManagement.exposureScore.monitoring",
      "displayName": "Microsoft Defender Exposure Score Monitoring",
      "settingPath": "DefenderForEndpoint.VulnerabilityManagement.ExposureScore",
      "policyType": "Defender",
      "policySubType": "VulnerabilityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Exposure Score monitoring which provides real-time risk assessment of organization's vulnerability exposure. Aggregates vulnerability data, threat intelligence, and breach likelihood to quantify risk of system compromise and CUI exposure.",
      "implementationGuide": "1. Navigate to Microsoft 365 Defender portal\n2. Go to Vulnerability management > Dashboard\n3. Review Exposure Score (0-1000 scale)\n4. Analyze exposure distribution by severity\n5. Enable automatic score calculation (continuous)\n6. Configure alerts for significant score changes (>10% increase)\n7. Review top security recommendations to reduce exposure\n8. Monitor exposure trends over time (weekly/monthly)\n9. Export exposure data for risk assessment documentation\n10. Integrate score into regular risk assessment reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-vulnerability-management/tvm-exposure-score"
    },
    {
      "settingName": "vulnerabilityManagement.scanning.enabled",
      "displayName": "Microsoft Defender Vulnerability Management Scanning",
      "settingPath": "DefenderForEndpoint.VulnerabilityManagement.Scanning",
      "policyType": "Defender",
      "policySubType": "VulnerabilityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables continuous vulnerability scanning across all endpoints using Microsoft Defender Vulnerability Management. Provides agentless, real-time vulnerability detection for software, configurations, missing patches, and security weaknesses using CVE database and Microsoft threat intelligence.",
      "implementationGuide": "1. Navigate to Microsoft 365 Defender portal\n2. Go to Settings > Endpoints > Advanced features\n3. Enable 'Microsoft Defender Vulnerability Management'\n4. Verify devices are onboarded to Defender for Endpoint\n5. Go to Vulnerability management > Dashboard\n6. Confirm continuous scanning is active (real-time, no schedule needed)\n7. Review discovered vulnerabilities organized by CVE\n8. Configure vulnerability severity thresholds\n9. Enable automatic vulnerability database updates (daily)\n10. Set up alerts for new critical/high vulnerabilities\n11. Monitor scan coverage to ensure all devices are assessed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-vulnerability-management/defender-vulnerability-management"
    },
    {
      "settingName": "vulnerabilityManagement.automaticUpdates.enabled",
      "displayName": "Automatic Vulnerability Database Updates",
      "settingPath": "DefenderForEndpoint.VulnerabilityManagement.AutomaticUpdates",
      "policyType": "Defender",
      "policySubType": "VulnerabilityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables automatic updates to the vulnerability scanning database including CVE definitions, software version mappings, and threat intelligence. Ensures vulnerability scans include latest known vulnerabilities without manual intervention.",
      "implementationGuide": "1. Navigate to Microsoft 365 Defender portal\n2. Go to Vulnerability management > Settings\n3. Verify 'Automatic updates' is enabled (default enabled)\n4. Confirm update frequency is set to daily minimum\n5. Review update log to verify successful updates\n6. Enable notifications for failed updates\n7. Monitor for new vulnerability definitions being applied\n8. Verify CVE database version is current\n9. Test scanning detects recently published CVEs\n10. Document update schedule for audit evidence",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-vulnerability-management/tvm-software-inventory"
    },
    {
      "settingName": "compliance.policy.deviceComplianceRequired",
      "displayName": "Intune Device Compliance Policy Required",
      "settingPath": "Intune.Compliance.DeviceComplianceRequired",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires all devices to meet compliance policies that include vulnerability checks such as minimum OS version, required security updates, encryption status, and threat level. Non-compliant devices are blocked from accessing corporate resources until vulnerabilities are remediated.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center (https://intune.microsoft.com)\n2. Go to Devices > Compliance policies\n3. Create policy for each platform (Windows, iOS, Android)\n4. Configure minimum OS version requirements\n5. Set 'Require device to be at or under device threat level' to Medium\n6. Enable 'Firewall required'\n7. Set 'Encryption of data storage on device' to Required\n8. Configure 'Microsoft Defender for Endpoint integration' if available\n9. Set compliance check frequency to Daily\n10. Configure Conditional Access to block non-compliant devices\n11. Set grace period for remediation (24-48 hours recommended)\n12. Assign policies to all users/devices",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started"
    },
    {
      "settingName": "updateRings.windowsUpdate.automaticUpdates",
      "displayName": "Windows Update Automatic Updates Enabled",
      "settingPath": "Intune.UpdateRings.WindowsUpdate.AutomaticUpdates",
      "policyType": "Intune",
      "policySubType": "UpdateRings",
      "platform": "Windows",
      "dataType": "integer",
      "expectedValue": 4,
      "validationOperator": "==",
      "description": "Configures Windows Update to automatically download and install security updates and patches. Setting value 4 enables 'Auto download and schedule the install' which ensures timely vulnerability remediation without user intervention.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Go to Devices > Windows > Update rings\n3. Create new update ring policy\n4. Set 'Automatic update behavior' to 'Auto download and schedule install'\n5. Configure 'Quality update deferral period' to 0-7 days maximum\n6. Set 'Feature update deferral period' to 0-30 days\n7. Enable 'Automatic update maintenance window' with appropriate hours\n8. Configure 'Deadline for feature updates' to 7 days\n9. Configure 'Deadline for quality updates' to 3 days\n10. Set 'Grace period' to 2 days for user-initiated restarts\n11. Enable 'Update notifications' to inform users\n12. Assign policy to all Windows devices\n13. Monitor update installation status regularly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/windows-update-for-business-configure"
    },
    {
      "settingName": "defenderForEndpoint.realTimeProtection.enabled",
      "displayName": "Microsoft Defender Real-Time Protection",
      "settingPath": "DefenderForEndpoint.RealTimeProtection",
      "policyType": "Defender",
      "policySubType": "AntivirusPolicy",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Defender real-time protection which continuously monitors for malware, exploits, and vulnerabilities. Provides real-time scanning of files, processes, and network activity to detect and block exploitation of known vulnerabilities.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center\n2. Go to Endpoint security > Antivirus\n3. Create Microsoft Defender Antivirus policy\n4. Set 'Turn on real-time protection' to Enabled\n5. Set 'Scan all downloaded files and attachments' to Enabled\n6. Enable 'Monitor file and program activity'\n7. Set 'Turn on behavior monitoring' to Enabled\n8. Configure 'Cloud-delivered protection' to Enabled\n9. Set 'Scan archive files' to Enabled\n10. Enable 'Scan removable drives during full scan'\n11. Assign policy to all Windows devices\n12. Monitor protection status in Microsoft 365 Defender portal\n13. Review detection and prevention events regularly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-real-time-protection-microsoft-defender-antivirus"
    },
    {
      "settingName": "vulnerabilityManagement.securityRecommendations.tracking",
      "displayName": "Vulnerability Management Security Recommendations",
      "settingPath": "DefenderForEndpoint.VulnerabilityManagement.SecurityRecommendations",
      "policyType": "Defender",
      "policySubType": "VulnerabilityManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables security recommendations feature which provides prioritized, actionable remediation guidance for discovered vulnerabilities. Tracks remediation status, assigns remediation tasks, and measures time-to-remediation to ensure vulnerabilities are addressed within required timeframes.",
      "implementationGuide": "1. Navigate to Microsoft 365 Defender portal\n2. Go to Vulnerability management > Recommendations\n3. Review security recommendations sorted by risk score\n4. Enable 'Remediation tracking' for all recommendations\n5. Configure remediation SLAs: Critical (24-48 hours), High (7 days), Medium (30 days)\n6. Assign recommendations to IT staff using 'Request remediation' feature\n7. Track remediation progress in dashboard\n8. Enable 'Exception management' for accepted risks\n9. Configure email notifications for new critical vulnerabilities\n10. Export remediation reports weekly for compliance evidence\n11. Monitor 'Mean time to remediate' metric\n12. Review recommendation compliance rate monthly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-vulnerability-management/tvm-security-recommendation"
    },
    {
      "settingName": "EnableDomainNetworkFirewall",
      "displayName": "Enable Domain Network Firewall",
      "settingPath": "FirewallPolicy.FirewallProfileDomain.EnableFirewall",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces Windows Firewall for domain network profile to monitor and control communications at network boundaries. This is a foundational boundary protection control that filters network traffic.",
      "implementationGuide": "1. Navigate to Intune > Endpoint security > Firewall > Create Policy\n2. Select Windows 10 and later > Microsoft Defender Firewall\n3. Configure Firewall Profile Domain settings\n4. Set 'Enable Firewall' to 'Yes'\n5. Set 'Default Inbound Action' to 'Block'\n6. Assign to device groups and deploy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "EnablePrivateNetworkFirewall",
      "displayName": "Enable Private Network Firewall",
      "settingPath": "FirewallPolicy.FirewallProfilePrivate.EnableFirewall",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces Windows Firewall for private network profile to protect devices when connected to internal networks. Ensures consistent boundary protection across network contexts.",
      "implementationGuide": "1. Navigate to Intune > Endpoint security > Firewall > Create Policy\n2. Select Windows 10 and later > Microsoft Defender Firewall\n3. Configure Firewall Profile Private settings\n4. Set 'Enable Firewall' to 'Yes'\n5. Set 'Default Inbound Action' to 'Block'\n6. Assign to device groups and deploy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "EnablePublicNetworkFirewall",
      "displayName": "Enable Public Network Firewall",
      "settingPath": "FirewallPolicy.FirewallProfilePublic.EnableFirewall",
      "policyType": "Intune",
      "policySubType": "EndpointProtection",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces Windows Firewall for public network profile with most restrictive settings. Critical for protecting devices on untrusted networks and implementing network separation.",
      "implementationGuide": "1. Navigate to Intune > Endpoint security > Firewall > Create Policy\n2. Select Windows 10 and later > Microsoft Defender Firewall\n3. Configure Firewall Profile Public settings\n4. Set 'Enable Firewall' to 'Yes'\n5. Set 'Default Inbound Action' to 'Block'\n6. Set 'Disable Inbound Notifications' to 'True'\n7. Assign to device groups and deploy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "NamedLocations",
      "displayName": "Named Locations (Trusted Network Boundaries)",
      "settingPath": "ConditionalAccess.NamedLocations",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "configured",
      "validationOperator": "exists",
      "description": "Defines trusted IP ranges representing organizational network boundaries. Enables Conditional Access policies to enforce network-based access controls and identify connections from external systems.",
      "implementationGuide": "1. Navigate to Azure AD > Security > Conditional Access > Named locations\n2. Click '+ IP ranges location'\n3. Provide name for the location (e.g., 'Corporate Network')\n4. Add public IPv4/IPv6 address ranges for organizational networks\n5. Check 'Mark as trusted location' for internal networks\n6. Create and verify the configuration\n7. Use in Conditional Access policies to enforce network restrictions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-assignment-network"
    },
    {
      "settingName": "RequireCompliantDevicePolicy",
      "displayName": "Require Managed Devices for Cloud Access",
      "settingPath": "ConditionalAccess.GrantControls.DeviceCompliance",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces that only Intune-managed and compliant devices can access cloud resources. Implements managed interface requirement by ensuring devices meet security standards before connecting to external systems.",
      "implementationGuide": "1. Navigate to Azure AD > Security > Conditional Access > Policies\n2. Click '+ New policy'\n3. Name: 'Require Compliant Device - All Users'\n4. Assignments > Users: Select 'All users' (exclude break-glass accounts)\n5. Cloud apps: Select 'All cloud apps'\n6. Conditions > Locations: Configure to apply from 'Any location'\n7. Grant: Select 'Require device to be marked as compliant'\n8. Enable policy and create",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-compliant-device"
    },
    {
      "settingName": "BlockLegacyAuthenticationPolicy",
      "displayName": "Block Legacy Authentication Protocols",
      "settingPath": "ConditionalAccess.BlockLegacyAuth",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Blocks legacy authentication protocols (POP, IMAP, SMTP, etc.) that cannot enforce modern security controls. Prevents unmanaged connections to external systems through non-compliant interfaces.",
      "implementationGuide": "1. Navigate to Azure AD > Security > Conditional Access > Policies\n2. Click '+ New policy'\n3. Name: 'Block Legacy Authentication - All Users'\n4. Assignments > Users: Select 'All users' (exclude service accounts if necessary)\n5. Cloud apps: Select 'All cloud apps'\n6. Conditions > Client apps: Select 'Exchange ActiveSync clients' and 'Other clients'\n7. Grant: Select 'Block access'\n8. Enable policy and create\n9. Monitor for 30 days before enforcing to identify dependencies",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-block-legacy"
    },
    {
      "settingName": "RequireBitLocker",
      "displayName": "Require BitLocker Drive Encryption",
      "settingPath": "DeviceCompliance.BitLockerEnabled",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires BitLocker encryption on all drives to prevent unauthorized information transfer from storage media. Protects data at rest and prevents residual data exposure when storage resources are reallocated.",
      "implementationGuide": "1. Navigate to Intune > Devices > Compliance policies > Create Policy\n2. Select Windows 10 and later\n3. Under Device Health settings, set 'Require BitLocker' to 'Require'\n4. Configure Actions for noncompliance (recommend immediate marking as non-compliant)\n5. Assign to device groups\n6. Deploy encryption policy separately via Endpoint security > Disk encryption to enforce BitLocker",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "BitLockerEncryptionMethod",
      "displayName": "BitLocker Encryption Cipher Strength",
      "settingPath": "EndpointSecurity.DiskEncryption.EncryptionMethod",
      "policyType": "Intune",
      "policySubType": "DiskEncryption",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "XTS-AES 256-bit",
      "validationOperator": "==",
      "description": "Enforces XTS-AES 256-bit encryption for BitLocker to ensure strong cryptographic protection of data at rest. Prevents recovery of information from shared storage resources through cryptanalysis.",
      "implementationGuide": "1. Navigate to Intune > Endpoint security > Disk encryption > Create Policy\n2. Select Windows 10 and later > BitLocker\n3. Under BitLocker > BitLocker Drive Encryption settings\n4. Set 'Encryption Method' to 'XTS-AES 256-bit'\n5. Apply to OS drives, fixed drives, and removable drives\n6. Configure 'Require device to backup recovery information to Azure AD' to 'Yes'\n7. Assign to device groups and deploy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices"
    },
    {
      "settingName": "RequireSecureBoot",
      "displayName": "Require Secure Boot",
      "settingPath": "DeviceCompliance.SecureBootEnabled",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires UEFI Secure Boot to prevent unauthorized code execution during system boot. Protects boot-time memory and system resources from malicious modification that could enable information transfer attacks.",
      "implementationGuide": "1. Navigate to Intune > Devices > Compliance policies > Create Policy\n2. Select Windows 10 and later\n3. Under Device Properties, set 'Require Secure Boot to be enabled on the device' to 'Require'\n4. Configure Actions for noncompliance\n5. Assign to device groups\n6. Note: Secure Boot must be enabled in device UEFI/BIOS - compliance policy validates the setting",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "EnableMemoryIntegrityHVCI",
      "displayName": "Enable Memory Integrity (HVCI)",
      "settingPath": "EndpointSecurity.AccountProtection.HypervisorEnforcedCodeIntegrity",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enabled with UEFI lock",
      "validationOperator": "==",
      "description": "Enables Hypervisor-Protected Code Integrity (HVCI) to isolate kernel memory and prevent manipulation of shared memory resources. Uses virtualization-based security to protect against kernel-level information leakage.",
      "implementationGuide": "1. Navigate to Intune > Endpoint security > Security baselines\n2. Select 'Security Baseline for Windows 10 and later'\n3. Create new profile or edit existing\n4. Under 'Virtualization Based Technology' settings\n5. Set 'Hypervisor Enforced Code Integrity' to 'Enabled with UEFI lock'\n6. Set 'Enable Virtualization Based Security' to 'Enable'\n7. Set 'Require Platform Security Features' to 'Secure Boot and DMA'\n8. Assign to device groups and deploy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/hardware-security/enable-virtualization-based-protection-of-code-integrity"
    },
    {
      "settingName": "EnableCredentialGuard",
      "displayName": "Enable Credential Guard",
      "settingPath": "EndpointSecurity.AccountProtection.CredentialGuard",
      "policyType": "Intune",
      "policySubType": "AccountProtection",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Enabled with UEFI lock",
      "validationOperator": "==",
      "description": "Enables Credential Guard using virtualization-based security to isolate credentials in protected memory. Prevents credential theft from LSASS memory, protecting sensitive information in shared system resources.",
      "implementationGuide": "1. Navigate to Intune > Endpoint security > Account protection\n2. Create Policy > Windows 10 and later > Account protection\n3. Under Device Guard settings\n4. Set 'Turn on Credential Guard' to 'Enable with UEFI lock'\n5. Optionally configure via Security baseline under 'Device Guard' section\n6. Assign to device groups\n7. Devices must meet hardware requirements: TPM 2.0, UEFI, Virtualization support\n8. Deploy and verify with msinfo32.exe on endpoints",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/identity-protection/credential-guard/configure"
    },
    {
      "settingName": "EnableDomainFirewall",
      "displayName": "Enable Windows Defender Firewall for Domain Profile",
      "settingPath": "FirewallRules.DomainProfile.EnableFirewall",
      "policyType": "Intune",
      "policySubType": "EndpointSecurity-Firewall",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Windows Defender Firewall for domain networks, enforcing deny-by-default network traffic filtering to prevent unauthorized inbound connections.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Firewall\n2. Create new Windows Firewall policy or use Security Baseline\n3. Configure Domain Profile > Enable Firewall = True\n4. Assign policy to appropriate device groups\n5. Verify deployment status in device compliance reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "EnablePrivateFirewall",
      "displayName": "Enable Windows Defender Firewall for Private Profile",
      "settingPath": "FirewallRules.PrivateProfile.EnableFirewall",
      "policyType": "Intune",
      "policySubType": "EndpointSecurity-Firewall",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Windows Defender Firewall for private networks, ensuring deny-by-default traffic filtering on home and private network connections.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Firewall\n2. Create new Windows Firewall policy or use Security Baseline\n3. Configure Private Profile > Enable Firewall = True\n4. Assign policy to appropriate device groups\n5. Monitor compliance through Intune reporting dashboard",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "EnablePublicFirewall",
      "displayName": "Enable Windows Defender Firewall for Public Profile",
      "settingPath": "FirewallRules.PublicProfile.EnableFirewall",
      "policyType": "Intune",
      "policySubType": "EndpointSecurity-Firewall",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Windows Defender Firewall for public networks with strictest deny-by-default settings, providing maximum protection on untrusted public networks.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Firewall\n2. Create new Windows Firewall policy or use Security Baseline\n3. Configure Public Profile > Enable Firewall = True\n4. Assign policy to all managed Windows devices\n5. Validate firewall status using Intune device compliance reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "DefaultInboundActionDomain",
      "displayName": "Default Inbound Action for Domain Profile - Block",
      "settingPath": "FirewallRules.DomainProfile.DefaultInboundAction",
      "policyType": "Intune",
      "policySubType": "EndpointSecurity-Firewall",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Block",
      "validationOperator": "==",
      "description": "Configures default inbound action to Block for domain networks, implementing deny-by-default policy. Only explicitly allowed connections through firewall rules will be permitted.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Firewall\n2. Open Windows Firewall policy or Security Baseline\n3. Configure Domain Profile > Default Inbound Action = Block\n4. Create explicit allow rules for required business applications\n5. Test connectivity and adjust allow rules as needed\n6. Monitor blocked connections in Windows Event Viewer",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "DefaultInboundActionPrivate",
      "displayName": "Default Inbound Action for Private Profile - Block",
      "settingPath": "FirewallRules.PrivateProfile.DefaultInboundAction",
      "policyType": "Intune",
      "policySubType": "EndpointSecurity-Firewall",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Block",
      "validationOperator": "==",
      "description": "Configures default inbound action to Block for private networks, ensuring deny-by-default traffic control on home and trusted private connections.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Firewall\n2. Open Windows Firewall policy or Security Baseline\n3. Configure Private Profile > Default Inbound Action = Block\n4. Create allow rules for necessary applications and services\n5. Validate remote access and file sharing work as expected\n6. Review firewall logs for legitimate blocked traffic",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "DefaultInboundActionPublic",
      "displayName": "Default Inbound Action for Public Profile - Block",
      "settingPath": "FirewallRules.PublicProfile.DefaultInboundAction",
      "policyType": "Intune",
      "policySubType": "EndpointSecurity-Firewall",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Block",
      "validationOperator": "==",
      "description": "Configures default inbound action to Block for public networks, providing maximum protection with strictest deny-by-default policy on untrusted networks.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Firewall\n2. Open Windows Firewall policy or Security Baseline\n3. Configure Public Profile > Default Inbound Action = Block\n4. Minimize allow rules for public profile (most restrictive)\n5. Ensure VPN and remote access apps have necessary rules\n6. Test device connectivity on public networks\n7. Document all public profile allow rules with business justification",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-firewall-policy"
    },
    {
      "settingName": "RequireDeviceEncryption",
      "displayName": "Require BitLocker Encryption on Windows Devices",
      "settingPath": "DeviceCompliance.SystemSecurity.RequireEncryption",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires BitLocker encryption to be enabled on Windows devices to protect CUI data at rest. Non-compliant devices are blocked from accessing corporate resources through Conditional Access integration.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Devices > Compliance policies\n2. Create Windows compliance policy\n3. Configure System Security > Require encryption of data storage on device = Require\n4. Set Actions for noncompliance (e.g., block access after 1 day)\n5. Assign to all Windows device groups\n6. Configure Conditional Access to require compliant devices\n7. Monitor compliance status in Intune dashboard",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices"
    },
    {
      "settingName": "BitLockerOSDriveEncryptionMethod",
      "displayName": "BitLocker Operating System Drive Encryption Method",
      "settingPath": "Encryption.BitLocker.SystemDrivesEncryptionType",
      "policyType": "Intune",
      "policySubType": "EndpointSecurity-DiskEncryption",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "XTS-AES 256-bit",
      "validationOperator": "==",
      "description": "Configures BitLocker to use XTS-AES 256-bit encryption for operating system drives, providing strong cryptographic protection for CUI stored on system volumes.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Disk encryption\n2. Create new BitLocker policy or use Security Baseline\n3. Configure BitLocker > Select encryption method for operating system drives = XTS-AES 256-bit\n4. Configure recovery key escrow to Azure AD\n5. Assign policy to Windows device groups\n6. Allow 24-48 hours for encryption to complete\n7. Verify encryption status in Intune encryption report",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices"
    },
    {
      "settingName": "BitLockerFixedDriveEncryptionMethod",
      "displayName": "BitLocker Fixed Data Drive Encryption Method",
      "settingPath": "Encryption.BitLocker.FixedDrivesEncryptionType",
      "policyType": "Intune",
      "policySubType": "EndpointSecurity-DiskEncryption",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "XTS-AES 256-bit",
      "validationOperator": "==",
      "description": "Configures BitLocker to use XTS-AES 256-bit encryption for fixed data drives, ensuring all internal storage volumes containing CUI are cryptographically protected.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Disk encryption\n2. Open BitLocker policy or Security Baseline\n3. Configure BitLocker > Select encryption method for fixed data drives = XTS-AES 256-bit\n4. Enable 'Deny write access to fixed drives not protected by BitLocker'\n5. Configure recovery key backup to Azure AD\n6. Assign to all Windows devices with fixed data drives\n7. Monitor encryption status through Intune reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices"
    },
    {
      "settingName": "BitLockerRemovableDriveEncryptionMethod",
      "displayName": "BitLocker Removable Drive Encryption Method",
      "settingPath": "Encryption.BitLocker.RemovableDrivesEncryptionType",
      "policyType": "Intune",
      "policySubType": "EndpointSecurity-DiskEncryption",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "AES-CBC 256-bit",
      "validationOperator": "==",
      "description": "Configures BitLocker to use AES-CBC 256-bit encryption for removable drives, protecting CUI on USB drives and external storage devices.",
      "implementationGuide": "1. Navigate to Microsoft Intune admin center > Endpoint security > Disk encryption\n2. Open BitLocker policy\n3. Configure BitLocker > Select encryption method for removable data drives = AES-CBC 256-bit\n4. Enable 'Deny write access to removable drives not protected by BitLocker'\n5. Configure password policy for removable drives\n6. Assign to all Windows devices\n7. Educate users on encrypting USB drives before storing CUI",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/encrypt-devices"
    },
    {
      "settingName": "RequireCompliantDeviceForEncryption",
      "displayName": "Conditional Access - Require Compliant Device",
      "settingPath": "ConditionalAccess.SessionControls.RequireCompliantDevice",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires devices to be compliant (including encryption requirements) before accessing Microsoft 365 resources. This ensures only encrypted devices can access and store CUI in cloud services.",
      "implementationGuide": "1. Navigate to Azure AD admin center > Security > Conditional Access\n2. Create new Conditional Access policy\n3. Assignments > Users: Include all users handling CUI\n4. Cloud apps: Select Microsoft 365 services (Exchange, SharePoint, OneDrive, Teams)\n5. Conditions: All device platforms\n6. Grant controls > Require device to be marked as compliant\n7. Enable policy and monitor sign-in logs\n8. Review blocked sign-ins and remediate non-compliant devices",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-policy-compliant-device"
    },
    {
      "settingName": "AzureRMSEnabled",
      "displayName": "Microsoft Purview Message Encryption - Enable Azure RMS",
      "settingPath": "IRMConfiguration.AzureRMSLicensingEnabled",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Azure Rights Management Service for Microsoft Purview Message Encryption, allowing encrypted email transmission and ensuring CUI in emails remains encrypted during transmission and when stored in mailboxes.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell with Global Admin or Compliance Admin credentials\n2. Run: Get-IRMConfiguration to check current status\n3. Run: Set-IRMConfiguration -AzureRMSLicensingEnabled $true\n4. Verify with: Test-IRMConfiguration -Sender <email> -Recipient <email>\n5. Configure mail flow rules in Exchange admin center for automatic encryption\n6. Create encryption rules based on sensitivity labels or content inspection\n7. Test encrypted message sending and receiving\n8. Monitor encrypted messages through Message Trace",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/set-up-new-message-encryption-capabilities"
    },
    {
      "settingName": "IdleSessionTimeout",
      "displayName": "M365 Idle Session Timeout for Web Apps",
      "settingPath": "Settings.OrgSettings.SecurityPrivacy.IdleSessionTimeout",
      "policyType": "AzureAD",
      "policySubType": "TenantSettings",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 180,
      "validationOperator": "<=",
      "description": "Automatically signs out users from Microsoft 365 web apps after a specified period of inactivity. This setting applies to web-based apps including Outlook Web App, SharePoint Online, OneDrive, Office.com, and admin centers. The timeout prevents unauthorized access to CUI when users leave sessions unattended.",
      "implementationGuide": "1. Sign in to Microsoft 365 admin center (admin.microsoft.com)\n2. Navigate to Settings > Org settings > Security & privacy tab\n3. Select 'Idle session timeout'\n4. Enable 'Turn on to set the period of inactivity for users to be signed off of Office web apps'\n5. Set timeout to 3 hours (180 minutes) or less\n6. Click 'Save'\n\nNote: This setting applies only to web apps, not desktop or mobile applications.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/idle-session-timeout-web-apps"
    },
    {
      "settingName": "SignInFrequency",
      "displayName": "Conditional Access - Sign-in Frequency",
      "settingPath": "ConditionalAccess.SessionControls.SignInFrequency",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 8,
      "validationOperator": "<=",
      "description": "Controls how long users can remain signed in before being required to reauthenticate when accessing Microsoft 365 resources. This prevents prolonged network sessions and ensures users must actively authenticate to maintain access to CUI.",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center (entra.microsoft.com)\n2. Go to Protection > Conditional Access > Policies\n3. Create new policy or edit existing\n4. Under 'Assignments', select target users and cloud apps\n5. Under 'Access controls > Session', select 'Sign-in frequency'\n6. Set to 8 hours or less\n7. Enable policy and save\n\nRecommended: Apply to all users accessing sensitive data or configure separate policies for different risk levels.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session"
    },
    {
      "settingName": "PersistentBrowserSession",
      "displayName": "Conditional Access - Disable Persistent Browser Sessions",
      "settingPath": "ConditionalAccess.SessionControls.PersistentBrowserSession",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Prevents users from remaining signed in after closing and reopening browser windows. When disabled, users must reauthenticate each time they start a new browser session, ensuring network connections terminate when browsers are closed.",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center (entra.microsoft.com)\n2. Go to Protection > Conditional Access > Policies\n3. Create new policy or edit existing session control policy\n4. Under 'Assignments', select target users and cloud apps\n5. Under 'Access controls > Session', select 'Persistent browser session'\n6. Set to 'Never persistent'\n7. Enable policy and save\n\nBest practice: Apply this to all users, especially for unmanaged devices accessing CUI.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session"
    },
    {
      "settingName": "IdleSessionTimeoutUnmanagedDevices",
      "displayName": "Conditional Access - Idle Timeout for Unmanaged Devices",
      "settingPath": "ConditionalAccess.SessionControls.AppEnforcedRestrictions",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces idle session timeout specifically on unmanaged devices accessing Office 365. This Conditional Access policy works in conjunction with tenant-level idle timeout settings to ensure sessions on higher-risk devices are terminated after inactivity. CIS Benchmark Level 1 recommends 3 hours or less for unmanaged devices.",
      "implementationGuide": "1. First, configure tenant-level idle session timeout (see AZ-SC-001)\n2. Navigate to Microsoft Entra admin center\n3. Go to Protection > Conditional Access > Policies\n4. Create new policy named 'Idle Session Timeout - Unmanaged Devices'\n5. Under 'Users', select 'All users'\n6. Under 'Cloud apps', select 'Office 365'\n7. Under 'Conditions > Client apps', select 'Browser' only\n8. Under 'Conditions > Filter for devices', select 'Exclude devices marked as compliant'\n9. Under 'Session', select 'Use app enforced restrictions'\n10. Enable policy and save\n\nRequires: Azure AD Premium P1 or P2 license for device-based conditional access",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/idle-session-timeout-web-apps"
    },
    {
      "settingName": "BitLockerRecoveryKeyBackup",
      "displayName": "BitLocker - Backup Recovery Keys to Azure AD",
      "settingPath": "Intune.EndpointSecurity.DiskEncryption.BitLocker.RecoveryOptions.BackupRecoveryPasswordToAAD",
      "policyType": "Intune",
      "policySubType": "DiskEncryption",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically backs up BitLocker recovery keys to Azure AD/Entra ID when encryption is enabled. This ensures cryptographic keys are stored centrally in Microsoft's cloud, providing secure key storage and access management. Recovery keys are encrypted and can only be accessed by authorized administrators.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (intune.microsoft.com)\n2. Navigate to Endpoint security > Disk encryption\n3. Create new policy or edit existing BitLocker policy\n4. Select Platform: Windows 10 and later\n5. Select Profile: BitLocker\n6. Under 'BitLocker - Operating System Drive Settings':\n   - Enable 'Operating system drive recovery'\n   - Set 'Recovery Key File Creation' to 'Blocked'\n   - Set 'BitLocker recovery information to store' to 'Backup recovery passwords and key packages'\n   - Enable 'Recovery information to store to Azure AD before enabling BitLocker' = 'Required'\n7. Assign to device groups\n8. Save policy\n\nVerification: Check device BitLocker keys in Entra ID > Devices > [Device] > Recovery keys",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/encrypt-devices"
    },
    {
      "settingName": "BitLockerKeyRotation",
      "displayName": "BitLocker - Automatic Recovery Key Rotation",
      "settingPath": "Intune.EndpointSecurity.DiskEncryption.BitLocker.RecoveryOptions.RotateBitLockerKeys",
      "policyType": "Intune",
      "policySubType": "DiskEncryption",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically rotates BitLocker recovery keys after each use. When a recovery key is used to unlock a device, the system generates a new recovery key and backs it up to Azure AD. This implements key lifecycle management and reduces the risk of compromised keys being reused.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Disk encryption\n3. Edit existing BitLocker policy\n4. Under 'BitLocker - Operating System Drive Settings':\n   - Enable 'Configure recovery password rotation' = 'Enable rotation on Azure AD-joined devices'\n5. Save policy\n6. To manually rotate keys:\n   - Go to Devices > All devices > [Device]\n   - Select 'Rotate BitLocker keys' from remote actions\n   - Confirm rotation\n\nNote: Automatic rotation requires Windows 10 version 1909 or later. Manual rotation available for Windows 10 1909+.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/encrypt-devices"
    },
    {
      "settingName": "AzureKeyVaultForRecoveryKeys",
      "displayName": "Azure Key Vault - Backup BitLocker Keys",
      "settingPath": "AzureKeyVault.Secrets.BitLockerRecoveryKeys",
      "policyType": "AzureAD",
      "policySubType": "KeyManagement",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Backs up BitLocker recovery keys from Entra ID to Azure Key Vault for additional redundancy and compliance requirements. This provides a secondary secure storage location for cryptographic keys with enhanced access controls, audit logging, and retention policies. Critical for organizations that need to retain keys even after device deletion from Entra ID.",
      "implementationGuide": "1. Create Azure Key Vault:\n   - Navigate to Azure Portal\n   - Create new Key Vault resource\n   - Enable Azure role-based access control (RBAC)\n   - Enable soft delete and purge protection\n\n2. Configure permissions:\n   - Assign 'Key Vault Secrets Officer' role to automation account managed identity\n   - Assign 'Key Vault Secrets User' role to administrators who need recovery access\n\n3. Create Azure Automation Runbook:\n   - Create Automation Account with System-Assigned Managed Identity\n   - Grant Microsoft Graph permissions: DeviceManagementManagedDevices.Read.All, BitlockerKey.Read.All\n   - Import PowerShell script to backup keys from Entra ID to Key Vault\n   - Schedule runbook to run daily\n\n4. Verify backup:\n   - Check Key Vault secrets for BitLocker keys\n   - Keys stored as: BitLocker-{DeviceName}-{SerialNumber}\n   - Verify tags contain device metadata\n\nReference script: https://github.com/ugurkocde/IntunePolicyBackup",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/key-vault/general/overview"
    },
    {
      "settingName": "BitLockerTPMValidation",
      "displayName": "BitLocker - TPM Platform Validation",
      "settingPath": "Intune.EndpointSecurity.DiskEncryption.BitLocker.SystemDriveSettings.TPMStartupPINRequired",
      "policyType": "Intune",
      "policySubType": "DiskEncryption",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Require startup PIN with TPM",
      "validationOperator": "==",
      "description": "Requires TPM (Trusted Platform Module) validation with startup PIN before releasing BitLocker encryption keys. This implements secure key storage using hardware-based cryptographic key protection. The TPM stores the key in hardware and only releases it when platform integrity is verified.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Disk encryption\n3. Edit BitLocker policy\n4. Under 'BitLocker - Operating System Drive Settings':\n   - Set 'Startup authentication required' = 'Yes'\n   - Set 'Compatible TPM startup' = 'Required'\n   - Set 'Compatible TPM startup PIN' = 'Required'\n   - Set 'Compatible TPM startup key' = 'Blocked'\n   - Set 'Compatible TPM startup key and PIN' = 'Blocked'\n   - Set 'Minimum PIN length' = 6 or more\n5. Save and assign policy\n\nNote: Devices must have TPM 1.2 or 2.0. Check device compliance before deployment.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-group-policy-settings"
    },
    {
      "settingName": "CertificateLifecycleManagement",
      "displayName": "Azure AD - Certificate-Based Authentication Lifecycle",
      "settingPath": "AzureAD.Identity.AuthenticationMethods.Certificate",
      "policyType": "AzureAD",
      "policySubType": "AuthenticationMethods",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Manages the lifecycle of certificates used for authentication, including issuance, renewal, and revocation. Certificate-based authentication provides strong cryptographic key management for user and device authentication. Azure AD integrates with PKI infrastructure to enforce certificate policies and key management requirements.",
      "implementationGuide": "1. Navigate to Microsoft Entra admin center\n2. Go to Protection > Authentication methods > Certificate-based authentication\n3. Enable certificate-based authentication\n4. Configure certificate authorities:\n   - Upload trusted root CA certificates\n   - Configure certificate validation rules\n   - Set username binding (Subject or Subject Alternative Name)\n5. Configure certificate lifecycle settings:\n   - Set certificate validity period requirements\n   - Configure automatic certificate renewal notifications\n   - Enable certificate revocation list (CRL) checking\n6. Create Conditional Access policy:\n   - Require certificate-based authentication for sensitive resource access\n   - Enforce for privileged accounts\n7. Save configuration\n\nNote: Requires Azure AD Premium P1 or P2",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-certificate-based-authentication"
    },
    {
      "settingName": "BitLockerEncryptionEnabled",
      "displayName": "BitLocker - Require Encryption for OS Drive",
      "settingPath": "Intune.EndpointSecurity.DiskEncryption.BitLocker.RequireDeviceEncryption",
      "policyType": "Intune",
      "policySubType": "DiskEncryption",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires BitLocker encryption for operating system drives on Windows devices. BitLocker uses AES-256 encryption to protect data at rest, preventing unauthorized access to CUI stored on device hard drives. Encryption is transparent to users and encrypts entire volumes including system files, hibernation files, and page files.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (intune.microsoft.com)\n2. Navigate to Endpoint security > Disk encryption\n3. Create policy: Platform = Windows 10 and later, Profile = BitLocker\n4. Configure settings:\n   - 'Encrypt devices' = 'Require'\n   - 'BitLocker base settings' > 'Warning for other disk encryption' = 'Block'\n   - 'Operating system drive' > 'Operating system drive encryption method' = 'XTS-AES 256-bit'\n   - 'Operating system drive' > 'Startup authentication required' = 'Yes'\n5. Set recovery options (see control 03.13.10 settings)\n6. Assign to device groups\n7. Create compliance policy:\n   - Devices > Compliance policies > Create policy\n   - Platform = Windows 10 and later\n   - Settings > System Security > 'Require BitLocker' = 'Require'\n   - Set non-compliance actions\n8. Save policies\n\nVerification: Devices > All devices > [Device] > Encryption report",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/encrypt-devices"
    },
    {
      "settingName": "BitLockerFixedDriveEncryption",
      "displayName": "BitLocker - Fixed Data Drive Encryption",
      "settingPath": "Intune.EndpointSecurity.DiskEncryption.BitLocker.FixedDriveSettings",
      "policyType": "Intune",
      "policySubType": "DiskEncryption",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "XTS-AES 256-bit",
      "validationOperator": "==",
      "description": "Requires AES-256 encryption for fixed data drives (non-OS drives) where CUI may be stored. Extends cryptographic protection beyond the OS drive to all internal fixed drives, ensuring comprehensive data protection.",
      "implementationGuide": "1. In the same BitLocker policy (see IN-SC-004)\n2. Under 'BitLocker - Fixed Data Drive Settings':\n   - Enable 'Fixed data drive recovery'\n   - Set 'Block write access to fixed data-drives not protected by BitLocker' = 'Yes'\n   - Set 'Fixed drive encryption method' = 'XTS-AES 256-bit'\n   - Configure recovery options same as OS drive\n3. Save policy\n\nNote: This setting ensures all fixed drives containing CUI are encrypted, not just the operating system drive.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-overview"
    },
    {
      "settingName": "TLS12Minimum",
      "displayName": "Exchange Online - Minimum TLS Version 1.2",
      "settingPath": "ExchangeOnline.TransportConfig.TLSMinimumVersion",
      "policyType": "Purview",
      "policySubType": "ExchangeTransport",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "1.2",
      "validationOperator": ">=",
      "description": "Enforces TLS 1.2 or higher for all email communications in Exchange Online. TLS (Transport Layer Security) provides cryptographic protection for CUI in transit by encrypting email messages between mail servers and clients. Older TLS versions (1.0, 1.1) have known vulnerabilities and should not be used.",
      "implementationGuide": "1. Connect to Exchange Online PowerShell:\n   Install-Module -Name ExchangeOnlineManagement\n   Connect-ExchangeOnline\n\n2. Configure minimum TLS version:\n   Set-TransportConfig -TLSMinimumVersion 1.2\n\n3. Verify setting:\n   Get-TransportConfig | Select TLSMinimumVersion\n\n4. For client connections, also configure:\n   Set-OrganizationConfig -SmtpClientAuthenticationDisabled $false\n\n5. Monitor TLS usage:\n   - Use Exchange Online message trace\n   - Review TLS connection logs\n   - Identify clients using older TLS versions\n\nNote: Microsoft 365 supports TLS 1.2 and 1.3. TLS 1.0 and 1.1 are deprecated as of October 2022.",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/technical-reference-details-about-encryption"
    },
    {
      "settingName": "DLPEncryptionPolicy",
      "displayName": "Purview DLP - Encrypt Content with Sensitivity Labels",
      "settingPath": "Purview.DLP.Policy.Actions.EncryptContent",
      "policyType": "Purview",
      "policySubType": "DataLossPrevention",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Automatically applies encryption to content containing CUI using Microsoft Purview Data Loss Prevention policies and sensitivity labels. Uses AES-256 encryption with rights management to protect documents and emails. Encryption is applied based on content classification and can restrict access, copying, printing, and forwarding.",
      "implementationGuide": "1. Navigate to Microsoft Purview compliance portal (compliance.microsoft.com)\n2. Go to Information protection > Labels\n3. Create sensitivity label with encryption:\n   - Name: 'Confidential - CUI'\n   - Enable encryption\n   - Set permissions: Authenticated users or specific users/groups\n   - Configure usage rights (view, edit, copy, print restrictions)\n\n4. Create auto-labeling policy:\n   - Go to Information protection > Auto-labeling\n   - Choose label created above\n   - Configure conditions to detect CUI:\n     - Use sensitive information types (SSN, credit card, etc.)\n     - Use trainable classifiers\n     - Use keywords related to CUI\n   - Select locations: Exchange, SharePoint, OneDrive, Devices\n   - Set policy to 'Turn on policy' (not simulation)\n\n5. Create DLP policy with encryption action:\n   - Go to Data loss prevention > Policies\n   - Create policy, select CUI-related templates\n   - Add condition: Content contains > Sensitivity labels > [CUI label]\n   - Add action: 'Restrict access or encrypt the content'\n   - Configure notifications and incident reports\n   - Save and enable policy\n\n6. Educate users on sensitivity labels",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/encryption"
    },
    {
      "settingName": "OMEEnabled",
      "displayName": "Office 365 Message Encryption (OME)",
      "settingPath": "Purview.MessageEncryption.Enabled",
      "policyType": "Purview",
      "policySubType": "MessageEncryption",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Office 365 Message Encryption for email containing CUI sent to external recipients. OME uses Azure Rights Management (Azure RMS) to apply AES-256 encryption and access controls to email messages. External recipients can view encrypted messages through a secure web portal even if they don't have Microsoft 365.",
      "implementationGuide": "1. Verify Azure Rights Management is activated:\n   Connect-AipService\n   Enable-AipService\n\n2. Navigate to Microsoft Purview compliance portal\n3. Go to Data loss prevention > Policies\n4. Create mail flow rule (can also be done in Exchange admin center):\n   - Name: 'Encrypt CUI emails to external recipients'\n   - Apply rule when: Recipient is located > Outside the organization\n   - AND: Message contains sensitive information > [CUI-related types]\n   - OR: Subject or body matches patterns > [CUI keywords]\n   - Do the following: Modify message security > Apply Office 365 Message Encryption\n   - Set encryption template: 'Encrypt' or 'Do Not Forward'\n\n5. Optional - Configure OME branding:\n   - Set-OMEConfiguration -Identity default\n   - Configure custom branding, logos, disclaimer text\n\n6. Test encryption:\n   - Send test email to external recipient\n   - Verify encryption is applied\n   - Confirm external recipient can access via portal\n\n7. Monitor encrypted messages in Exchange message trace",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/ome"
    },
    {
      "settingName": "AES256EncryptionDefault",
      "displayName": "Microsoft Purview - AES-256 CBC Default Encryption",
      "settingPath": "Purview.InformationProtection.DefaultEncryption",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "AES256-CBC",
      "validationOperator": "==",
      "description": "Ensures Microsoft Purview Information Protection uses AES-256 with Cipher Block Chaining (CBC) mode as the default encryption algorithm. As of October 2023, AES256-CBC is the default for all new Office documents and emails. This provides FIPS 140-2 validated cryptographic protection for all labeled content.",
      "implementationGuide": "1. For Microsoft 365 Apps version 16.0.16227 or later:\n   - AES256-CBC is default, no configuration needed\n   - Verify by checking encrypted document properties\n\n2. For earlier versions (2013-2021), configure via Group Policy:\n   - Download Office Administrative Templates\n   - Configure: User Configuration > Policies > Administrative Templates\n   - Microsoft Office 2016 > Security Settings\n   - Enable 'Set encryption mode for Office Open XML files'\n   - Select 'AES 256, 256-bit'\n\n3. For Cloud Policy (Microsoft 365 Apps):\n   - Navigate to Microsoft 365 Apps admin center\n   - Create cloud policy\n   - Add setting: 'Encryption mode for Office Open XML'\n   - Set to 'AES256-CBC'\n\n4. Verify encryption:\n   - Create test document with sensitivity label\n   - Check document encryption properties\n   - Confirm AES-256 is used\n\n5. For MIP SDK applications:\n   - Update to MIP SDK 1.13 or later\n   - AES256-CBC is automatic in later versions\n\nNote: Backwards compatibility maintained for documents encrypted with older algorithms",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/technical-reference-details-about-encryption"
    },
    {
      "settingName": "LetAppsAccessCamera",
      "displayName": "Camera Access - User in Control",
      "settingPath": "Privacy.LetAppsAccessCamera",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "User is in control",
      "validationOperator": "==",
      "description": "Allows users to control which applications can access the device camera, preventing unauthorized remote activation of cameras on Windows devices. Users can grant or deny camera access per application.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Configuration > Create > New Policy\n3. Select Platform: Windows 10 and later\n4. Select Profile type: Device restrictions\n5. Under General, configure 'Camera' to 'User is in control'\n6. Assign to appropriate device groups\n7. Verify deployment status",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-windows-10"
    },
    {
      "settingName": "LetAppsAccessMicrophone",
      "displayName": "Microphone Access - User in Control",
      "settingPath": "Privacy.LetAppsAccessMicrophone",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "User is in control",
      "validationOperator": "==",
      "description": "Allows users to control which applications can access the device microphone, preventing unauthorized remote activation of microphones on Windows devices. Users can grant or deny microphone access per application.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Configuration > Create > New Policy\n3. Select Platform: Windows 10 and later\n4. Select Profile type: Device restrictions\n5. Under General, configure 'Microphone' to 'User is in control'\n6. Assign to appropriate device groups\n7. Verify deployment status",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-windows-10"
    },
    {
      "settingName": "LetAppsAccessCamera_ForceAllowTheseApps",
      "displayName": "Force Allow Camera for Approved Apps",
      "settingPath": "Privacy.LetAppsAccessCamera_ForceAllowTheseApps",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[\"MSTeams_8wekyb3d8bbwe\"]",
      "validationOperator": "contains",
      "description": "Defines the explicit list of applications authorized to access the camera (organizational exceptions to the prohibition on remote activation). Example includes Microsoft Teams for business collaboration needs.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Configuration > Create > Settings Catalog\n3. Search for 'Let Apps Access Camera'\n4. Select 'Let Apps Access Camera Force Allow These Apps'\n5. Add PackageFamilyName for approved apps (e.g., MSTeams_8wekyb3d8bbwe)\n6. Include 'NonPackaged' if Win32 apps need camera access\n7. Assign to appropriate groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-privacy"
    },
    {
      "settingName": "LetAppsAccessMicrophone_ForceAllowTheseApps",
      "displayName": "Force Allow Microphone for Approved Apps",
      "settingPath": "Privacy.LetAppsAccessMicrophone_ForceAllowTheseApps",
      "policyType": "Intune",
      "policySubType": "SettingsCatalog",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[\"MSTeams_8wekyb3d8bbwe\"]",
      "validationOperator": "contains",
      "description": "Defines the explicit list of applications authorized to access the microphone (organizational exceptions). Example includes Microsoft Teams for business collaboration and conferencing.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Configuration > Create > Settings Catalog\n3. Search for 'Let Apps Access Microphone'\n4. Select 'Let Apps Access Microphone Force Allow These Apps'\n5. Add PackageFamilyName for approved apps (e.g., MSTeams_8wekyb3d8bbwe)\n6. Include 'NonPackaged' if Win32 apps need microphone access\n7. Assign to appropriate groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-privacy"
    },
    {
      "settingName": "Camera_BlockInDeviceRestrictions",
      "displayName": "Block Camera on Devices",
      "settingPath": "DeviceRestrictions.Camera",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Controls whether the device camera can be used at all. Set to 'Not configured' or 'Allow' to permit controlled camera usage with per-app permissions. Blocking completely prevents any camera use including authorized collaboration tools.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Devices > Configuration > Device Restrictions policy\n3. Select Platform (Windows, iOS, Android)\n4. Under General settings, configure 'Camera' to 'Not configured' or 'Allow'\n5. Note: Complete blocking prevents authorized collaboration tools\n6. Use per-app privacy settings instead for granular control\n7. Assign to device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/configuration/device-restrictions-configure"
    },
    {
      "settingName": "EnableSmartScreen",
      "displayName": "Enable Microsoft Defender SmartScreen",
      "settingPath": "SmartScreen.EnableSmartScreen",
      "policyType": "Defender",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Defender SmartScreen to monitor and control mobile code by checking websites, downloads, and applications against reputation lists. SmartScreen evaluates JavaScript, Java applets, and other mobile code technologies for malicious behavior before allowing execution.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Security Baseline for Windows 10 and later'\n4. Create profile or edit existing\n5. Under Microsoft Defender SmartScreen settings, set 'Turn on Windows Defender SmartScreen' to 'Enable'\n6. Configure 'Prevent bypassing prompts' to 'Yes'\n7. Assign to device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/security/operating-system-security/virus-and-threat-protection/microsoft-defender-smartscreen/"
    },
    {
      "settingName": "PreventSmartScreenPromptOverride",
      "displayName": "Prevent Bypassing SmartScreen Prompts for Sites",
      "settingPath": "SmartScreen.PreventSmartScreenPromptOverride",
      "policyType": "Defender",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Prevents users from bypassing Microsoft Defender SmartScreen warnings about potentially malicious websites that may contain mobile code. This enforces organizational control over acceptable mobile code sources.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Microsoft Edge baseline' or Windows security baseline\n4. Under SmartScreen settings, enable 'Prevent bypassing prompts for sites'\n5. Set to 'Enabled' to block user overrides\n6. This forces users to comply with SmartScreen blocks\n7. Assign policy to user/device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/deployedge/microsoft-edge-security-smartscreen"
    },
    {
      "settingName": "PreventSmartScreenPromptOverrideForFiles",
      "displayName": "Prevent Bypassing SmartScreen Warnings for Downloads",
      "settingPath": "SmartScreen.PreventSmartScreenPromptOverrideForFiles",
      "policyType": "Defender",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Prevents users from bypassing Microsoft Defender SmartScreen warnings about downloading potentially malicious files that may contain mobile code. Enforces control over mobile code file downloads.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Microsoft Edge baseline' or Windows security baseline\n4. Under SmartScreen settings, enable 'Prevent bypassing prompts for downloads'\n5. Set to 'Enabled' to block file download overrides\n6. Users cannot bypass warnings on unverified executables or mobile code\n7. Assign policy to groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/deployedge/microsoft-edge-security-smartscreen"
    },
    {
      "settingName": "SmartScreenPuaProtection",
      "displayName": "Block Potentially Unwanted Applications",
      "settingPath": "SmartScreen.SmartScreenPuaProtection",
      "policyType": "Defender",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Configures Microsoft Defender SmartScreen to block potentially unwanted applications (PUAs) that may contain mobile code. PUAs include applications with bundled mobile code that exhibit unwanted behaviors.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Microsoft Edge baseline'\n4. Under SmartScreen settings, enable 'Configure SmartScreen to block potentially unwanted apps'\n5. Set to 'Enabled'\n6. Also enable in Windows Security via Endpoint Protection profile\n7. Assign to device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/detect-block-potentially-unwanted-apps-microsoft-defender-antivirus"
    },
    {
      "settingName": "AllowScriptedWindowsSecurityPromptBroadcasting",
      "displayName": "Block Scripted Security Prompts",
      "settingPath": "InternetExplorer.AllowScriptedWindowsSecurityPromptBroadcasting",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Prevents malicious mobile code (JavaScript, VBScript) from generating fake security prompts that could trick users into downloading malicious code or providing credentials.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Security Baseline for Windows 10 and later'\n4. Under Internet Explorer settings, find 'Allow scripted windows security prompts'\n5. Set to 'Disable' to prevent scripted prompts\n6. Apply to all security zones (Internet, Intranet, Trusted, Restricted)\n7. Assign policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/security-baseline-settings-mdm-all"
    },
    {
      "settingName": "DisableActiveXControlsInProtectedMode",
      "displayName": "Disable Unsafe ActiveX Controls",
      "settingPath": "InternetExplorer.DisableActiveXControlsInProtectedMode",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Disables unsafe ActiveX controls (a form of mobile code) in Internet Explorer Protected Mode, preventing execution of potentially malicious mobile code components.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Security Baseline for Windows 10 and later'\n4. Under Internet Explorer settings, configure ActiveX controls:\n   - Disable 'ActiveX controls marked safe for scripting' in Internet zone\n   - Enable 'Protected Mode' for all zones\n5. Set script Active X controls to 'Disable' for Internet and Restricted zones\n6. Assign policy to device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/security-baseline-settings-mdm-all"
    },
    {
      "settingName": "MinimumTLSVersion",
      "displayName": "Minimum TLS Version 1.2",
      "settingPath": "InternetExplorer.MinimumTLSVersion",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "TLS 1.2",
      "validationOperator": ">=",
      "description": "Enforces TLS 1.2 as the minimum encryption protocol for communications sessions, protecting session authenticity and preventing downgrade attacks. TLS 1.2 provides strong cryptographic authentication and prevents MITM attacks, session hijacking, and insertion of false information.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Security Baseline for Windows 10 and later'\n4. Under Internet Explorer settings:\n   - Set 'Turn off encryption support' to 'Enabled'\n   - Set 'Secure Protocol combinations' to 'Use TLS 1.1 and TLS 1.2' or 'Use TLS 1.2 only'\n5. For Microsoft Edge, use Edge baseline with 'Minimum SSL version' = 'TLS 1.2'\n6. Assign policy to all device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/security-baseline-settings-mdm-all"
    },
    {
      "settingName": "EdgeMinimumSSLVersion",
      "displayName": "Microsoft Edge Minimum SSL Version",
      "settingPath": "MicrosoftEdge.SSLVersionMin",
      "policyType": "Intune",
      "policySubType": "EdgeBaseline",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "tls1.2",
      "validationOperator": "==",
      "description": "Enforces TLS 1.2 as the minimum supported SSL/TLS version in Microsoft Edge browser for all communications sessions. Prevents use of weak protocols (SSL 3.0, TLS 1.0, TLS 1.1) that are vulnerable to session hijacking and MITM attacks.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Microsoft Edge security baseline'\n4. Under Security settings, configure:\n   - 'Minimum SSL version enabled' = 'TLS 1.2'\n5. Optionally configure 'SSLVersionMax' = 'tls1.3' to allow TLS 1.3\n6. Apply to all users and devices\n7. Verify with edge://settings/privacy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/security-baseline-settings-edge"
    },
    {
      "settingName": "EdgeSSLErrorOverrideAllowed",
      "displayName": "Block SSL Error Override",
      "settingPath": "MicrosoftEdge.SSLErrorOverrideAllowed",
      "policyType": "Intune",
      "policySubType": "EdgeBaseline",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Prevents users from bypassing SSL/TLS certificate errors in Microsoft Edge, ensuring session authenticity by enforcing certificate validation. Certificate errors can indicate MITM attacks or compromised session authenticity.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Microsoft Edge security baseline'\n4. Configure 'Allow users to proceed from SSL warning page' to 'Disabled'\n5. This blocks users from clicking through certificate warnings\n6. Certificate validation is critical for session authenticity\n7. Assign to all users",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/deployedge/microsoft-edge-policies#sslversionmin"
    },
    {
      "settingName": "NetworkSecurityMinimumSessionSecurity_NTLMSSP_Clients",
      "displayName": "Network Security - NTLM Session Security for Clients",
      "settingPath": "LocalPoliciesSecurityOptions.NetworkSecurity_MinimumSessionSecurityForNTLMSSPBasedClients",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Require NTLM and 128-bit encryption",
      "validationOperator": "==",
      "description": "Enforces 128-bit encryption and NTLM v2 session security for NTLMSSP-based client communications, protecting session authenticity by requiring strong encryption and authentication that prevents session hijacking.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Security Baseline for Windows 10 and later'\n4. Under Local Policies Security Options, configure:\n   - 'Network security: Minimum session security for NTLM SSP based clients' = 'Require NTLM and 128-bit encryption'\n5. This ensures strong session authentication and encryption\n6. Assign to all domain-joined devices\n7. Verify with Group Policy results",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/security-baseline-settings-mdm-all"
    },
    {
      "settingName": "NetworkSecurityMinimumSessionSecurity_NTLMSSP_Servers",
      "displayName": "Network Security - NTLM Session Security for Servers",
      "settingPath": "LocalPoliciesSecurityOptions.NetworkSecurity_MinimumSessionSecurityForNTLMSSPBasedServers",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "Require NTLM and 128-bit encryption",
      "validationOperator": "==",
      "description": "Enforces 128-bit encryption and NTLM v2 session security for NTLMSSP-based server communications, ensuring both ends of the session use strong authentication to protect session authenticity.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Security Baseline for Windows 10 and later'\n4. Under Local Policies Security Options, configure:\n   - 'Network security: Minimum session security for NTLM SSP based servers' = 'Require NTLM and 128-bit encryption'\n5. This enforces server-side session protection\n6. Assign to all Windows servers and endpoints\n7. Test with network authentication scenarios",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/security-baseline-settings-mdm-all"
    },
    {
      "settingName": "ConditionalAccess_RequireCompliantDevices",
      "displayName": "Require Compliant Devices for Session Access",
      "settingPath": "ConditionalAccess.GrantControls.BuiltInControls",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"compliantDevice\"]",
      "validationOperator": "contains",
      "description": "Requires devices to be Intune-compliant before establishing authenticated sessions to cloud resources. Device compliance includes encryption, security baselines, and certificate requirements that protect session authenticity.",
      "implementationGuide": "1. Sign in to Azure AD admin center\n2. Navigate to Azure AD > Security > Conditional Access\n3. Create new policy or edit existing\n4. Under Conditions, select target users and cloud apps\n5. Under Grant controls, select 'Require device to be marked as compliant'\n6. Enable policy and set to 'Report-only' first for testing\n7. Monitor sign-ins, then enable enforcement",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-policy-compliant-device"
    },
    {
      "settingName": "Update ring for Windows 10 and later",
      "displayName": "Windows Update for Business - Automatic Quality Updates",
      "settingPath": "Microsoft.Management.Services.IntuneWindowsAgent.UpdateRing",
      "policyType": "Intune",
      "policySubType": "Update Rings",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"automaticUpdateMode\":\"Auto install and restart at maintenance time\",\"qualityUpdatesDeferralPeriodInDays\":0,\"featureUpdatesDeferralPeriodInDays\":0,\"automaticUpdateFrequency\":\"Daily\"}",
      "validationOperator": "==",
      "description": "Enforces automatic installation of Windows quality and security updates with minimal deferral to ensure systems receive critical patches promptly. This setting ensures compliance with NIST requirement to install security-relevant updates within organization-defined timeframes.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://intune.microsoft.com)\n2. Navigate to Devices > Windows > Update rings for Windows 10 and later\n3. Click 'Create profile' and provide a descriptive name\n4. Under Quality Updates, set 'Quality update deferral period' to 0 days\n5. Set 'Automatic update behavior' to 'Auto install and restart at maintenance time'\n6. Configure maintenance windows if needed to minimize business disruption\n7. Assign to appropriate device groups (production devices)\n8. Click 'Create' to deploy the policy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/windows-update-for-business-configure"
    },
    {
      "settingName": "Security baselines for Windows",
      "displayName": "Security Baseline - MDM Security Baseline for Windows",
      "settingPath": "Microsoft.Management.Services.IntuneWindowsAgent.SecurityBaseline",
      "policyType": "Intune",
      "policySubType": "Security Baselines",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"baselineVersion\":\"Latest\",\"automaticUpdates\":\"Enabled\"}",
      "validationOperator": "==",
      "description": "Deploys Microsoft security baseline configurations which include automatic update settings recommended by Microsoft security teams. Ensures devices maintain secure configurations aligned with industry best practices for vulnerability management.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Security Baseline for Windows 10 and later'\n4. Click 'Create profile'\n5. Accept default secure settings or customize as needed\n6. Ensure 'Configure Automatic Updates' is set to 'Auto download and schedule install'\n7. Assign to device groups\n8. Review baseline regularly and update to latest version when available\n9. Use 'Change Version' feature to upgrade existing profiles to latest baseline",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/intune/intune-service/protect/security-baselines"
    },
    {
      "settingName": "Microsoft Defender Antivirus signature update frequency",
      "displayName": "Defender Antivirus - Automatic Definition Updates",
      "settingPath": "Defender.SignatureUpdateInterval",
      "policyType": "Intune",
      "policySubType": "Antivirus Policy",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 8,
      "validationOperator": "<=",
      "description": "Configures automatic and frequent updates of Microsoft Defender Antivirus definitions (signatures) to protect against newly discovered malware. Updates occur multiple times daily, ensuring protection against the latest threats within hours of discovery.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Antivirus > Create Policy\n3. Select Platform: 'Windows 10, Windows 11, and Windows Server'\n4. Select Profile: 'Microsoft Defender Antivirus'\n5. Under Security Intelligence Updates section:\n   - Set 'Signature Update Interval' to 8 hours or less\n   - Enable 'Allow real-time security intelligence updates'\n   - Set 'Security intelligence location' to 'Microsoft Update'\n6. Assign to all Windows devices\n7. Monitor deployment status in Device Status reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/manage-protection-updates-microsoft-defender-antivirus"
    },
    {
      "settingName": "Windows Autopatch enrollment",
      "displayName": "Windows Autopatch - Automated Update Management",
      "settingPath": "Microsoft.Management.Services.WindowsAutopatch",
      "policyType": "Intune",
      "policySubType": "Windows Autopatch",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Windows Autopatch service which automates the deployment and monitoring of Windows quality updates, feature updates, and driver updates. Microsoft manages the update deployment schedule using deployment rings to ensure updates are tested and deployed safely.",
      "implementationGuide": "1. Verify licensing: Requires Windows 10/11 Enterprise E3+ or Microsoft 365 E3+\n2. Sign in to Microsoft Intune admin center\n3. Navigate to Tenant administration > Windows Autopatch > Tenant enrollment\n4. Review prerequisites and resolve any 'Not ready' status items\n5. Click 'Enroll' to enable Windows Autopatch\n6. Configure deployment rings (Test, First, Fast, Broad) for staged rollout\n7. Monitor update deployment progress and health metrics in Autopatch dashboard\n8. Allow Microsoft to manage update schedules automatically",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/windows/deployment/windows-autopatch/overview/windows-autopatch-overview"
    },
    {
      "settingName": "Defender platform and engine update channel",
      "displayName": "Defender Updates - Platform and Engine Update Channels",
      "settingPath": "Defender.PlatformUpdatesChannel",
      "policyType": "Intune",
      "policySubType": "Antivirus Policy",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Current Channel (Broad)",
      "validationOperator": "==",
      "description": "Configures update channels for Microsoft Defender Antivirus platform and engine updates. Current Channel (Broad) provides tested and validated updates with minimal delay, ensuring devices receive critical security improvements promptly while maintaining stability.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Antivirus\n3. Create new policy: Platform 'Windows 10, Windows 11, and Windows Server'\n4. Select Profile: 'Microsoft Defender Antivirus' or 'Defender Update controls'\n5. Configure update channels:\n   - Platform Updates Channel: 'Current Channel (Broad)'\n   - Engine Updates Channel: 'Current Channel (Broad)'\n   - Security Intelligence Updates Channel: 'Current Channel (Broad)'\n6. Assign to device groups\n7. Monitor update version compliance using Device Status reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/manage-gradual-rollout"
    },
    {
      "settingName": "Microsoft 365 Apps security baseline",
      "displayName": "Security Baseline for Microsoft 365 Apps",
      "settingPath": "Microsoft.Management.Services.IntuneOfficeApps.SecurityBaseline",
      "policyType": "Intune",
      "policySubType": "Security Baselines",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"baselineVersion\":\"Latest\",\"automaticUpdates\":\"Enabled\"}",
      "validationOperator": "==",
      "description": "Deploys security baseline for Microsoft 365 Apps (Office applications) which includes settings for automatic updates of Office applications. Ensures Office apps receive security patches and vulnerability fixes in alignment with Microsoft security recommendations.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Security baselines\n3. Select 'Security Baseline for Microsoft 365 Apps for Enterprise'\n4. Click 'Create profile'\n5. Review and accept Microsoft-recommended settings\n6. Verify 'Update Channel' is set to 'Current Channel' or 'Monthly Enterprise Channel'\n7. Assign to user groups or device groups\n8. Monitor compliance and update to latest baseline version when available\n9. Use 'Change Version' to upgrade profiles as new baselines are released",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365-apps/security/security-baseline"
    },
    {
      "settingName": "Real-time protection",
      "displayName": "Microsoft Defender Antivirus - Real-time Protection",
      "settingPath": "Defender.AllowRealtimeMonitoring",
      "policyType": "Intune",
      "policySubType": "Antivirus Policy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables real-time protection in Microsoft Defender Antivirus to continuously monitor files, downloads, and processes for malicious code. Real-time protection scans files as they are accessed, downloaded, or executed at system entry points, providing immediate detection and blocking of threats.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center (https://intune.microsoft.com)\n2. Navigate to Endpoint security > Antivirus > Create Policy\n3. Select Platform: 'Windows 10, Windows 11, and Windows Server'\n4. Select Profile: 'Microsoft Defender Antivirus'\n5. Under Real-time Protection section:\n   - Set 'Turn on real-time protection' to 'Allowed' (Enabled)\n   - Set 'Monitoring for incoming and outgoing files' to 'Monitor all files'\n   - Set 'Turn on behavior monitoring' to 'Allowed' (Enabled)\n6. Assign to all Windows device groups\n7. Verify deployment using Device Status reports\n8. Validate on client using PowerShell: Get-MpComputerStatus | select RealTimeProtectionEnabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/configure-real-time-protection-microsoft-defender-antivirus"
    },
    {
      "settingName": "Cloud-delivered protection",
      "displayName": "Microsoft Defender Antivirus - Cloud Protection Service",
      "settingPath": "Defender.AllowCloudProtection",
      "policyType": "Intune",
      "policySubType": "Antivirus Policy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables cloud-delivered protection which provides near-instant detection and blocking of new and emerging malware. When a suspicious file is encountered, Defender can query Microsoft's cloud intelligence for real-time threat analysis, providing protection against zero-day threats before traditional signature updates are available.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Antivirus > Create Policy\n3. Select Platform: 'Windows 10, Windows 11, and Windows Server'\n4. Select Profile: 'Microsoft Defender Antivirus'\n5. Under Cloud Protection section:\n   - Set 'Turn on cloud-delivered protection' to 'Allowed' (Enabled)\n   - Set 'Cloud block level' to 'High' or 'High plus'\n   - Set 'Extended cloud check' to 50 seconds\n6. Ensure network connectivity to Defender cloud service endpoints\n7. Assign to all Windows device groups\n8. Monitor effectiveness through Defender security reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/cloud-protection-microsoft-defender-antivirus"
    },
    {
      "settingName": "Automatic sample submission",
      "displayName": "Microsoft Defender Antivirus - Automatic Sample Submission",
      "settingPath": "Defender.SubmitSamplesConsent",
      "policyType": "Intune",
      "policySubType": "Antivirus Policy",
      "platform": "All",
      "dataType": "integer",
      "expectedValue": 1,
      "validationOperator": ">=",
      "description": "Configures automatic submission of suspicious file samples to Microsoft for analysis. When Defender encounters potentially malicious files, it automatically submits them to Microsoft's cloud service for deep analysis, contributing to threat intelligence and receiving rapid classification results.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Antivirus > Create Policy\n3. Select Platform: 'Windows 10, Windows 11, and Windows Server'\n4. Select Profile: 'Microsoft Defender Antivirus'\n5. Under Automatic Sample Submission section:\n   - Set 'Submit samples consent' to 'Send safe samples automatically' (value: 1) or 'Send all samples automatically' (value: 3)\n6. Review organizational data handling policies\n7. Assign to device groups\n8. Document submission policy in security procedures\n9. Monitor sample submissions in Microsoft Defender Security Center",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/configure-block-at-first-sight-microsoft-defender-antivirus"
    },
    {
      "settingName": "Scheduled quick scan",
      "displayName": "Microsoft Defender Antivirus - Daily Quick Scan",
      "settingPath": "Defender.ScheduleScanDay",
      "policyType": "Intune",
      "policySubType": "Antivirus Policy",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"scanType\":\"Quick\",\"scanDay\":\"Daily\",\"scanTime\":\"120\"}",
      "validationOperator": "==",
      "description": "Configures daily scheduled quick scans to complement real-time protection. Quick scans check common locations where malware typically resides, providing an additional layer of detection for persistent threats that may have evaded real-time protection or were dormant during initial detection.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Antivirus > Create Policy\n3. Select Platform: 'Windows 10, Windows 11, and Windows Server'\n4. Select Profile: 'Microsoft Defender Antivirus'\n5. Under Scheduled Scans section:\n   - Set 'Run a scheduled scan' to 'Yes'\n   - Set 'Scan type' to 'Quick scan'\n   - Set 'Day of week to run scan' to '0' (Every day)\n   - Set 'Time of day to run scan' to '120' (2:00 AM) or preferred time\n6. Enable 'Check for signature updates before running scan'\n7. Assign to all Windows device groups\n8. Monitor scan completion rates in compliance reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/schedule-antivirus-scans"
    },
    {
      "settingName": "Remediation actions",
      "displayName": "Microsoft Defender Antivirus - Automatic Remediation",
      "settingPath": "Defender.ThreatSeverityDefaultAction",
      "policyType": "Intune",
      "policySubType": "Antivirus Policy",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"severe\":\"Quarantine\",\"high\":\"Quarantine\",\"moderate\":\"Quarantine\",\"low\":\"Quarantine\"}",
      "validationOperator": "==",
      "description": "Configures automatic remediation actions when malicious code is detected. Defender automatically quarantines or removes detected threats based on severity level, preventing malware execution and spread without requiring user intervention. This ensures rapid response to malicious code detection.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Antivirus > Create Policy\n3. Select Platform: 'Windows 10, Windows 11, and Windows Server'\n4. Select Profile: 'Microsoft Defender Antivirus'\n5. Under Remediation section:\n   - Set 'Action to take on potentially unwanted apps' to 'Block'\n   - Configure threat severity actions:\n     * Severe threats: 'Quarantine'\n     * High threats: 'Quarantine'\n     * Moderate threats: 'Quarantine'\n     * Low threats: 'Quarantine'\n   - Set 'Days to retain quarantined malware' to 30+ days\n6. Assign to all Windows device groups\n7. Configure alert policies for quarantined items requiring review",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/configure-remediation-microsoft-defender-antivirus"
    },
    {
      "settingName": "Behavior monitoring",
      "displayName": "Microsoft Defender Antivirus - Behavior Monitoring",
      "settingPath": "Defender.AllowBehaviorMonitoring",
      "policyType": "Intune",
      "policySubType": "Antivirus Policy",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables behavioral monitoring which uses heuristics and machine learning to detect suspicious activities and malicious behaviors even when specific malware signatures are not available. This provides protection against polymorphic malware, zero-day threats, and fileless attacks.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Antivirus > Create Policy\n3. Select Platform: 'Windows 10, Windows 11, and Windows Server'\n4. Select Profile: 'Microsoft Defender Antivirus'\n5. Under Real-time Protection section:\n   - Set 'Turn on behavior monitoring' to 'Allowed' (Enabled)\n   - Ensure 'Turn on process scanning when real-time protection is enabled' is 'Allowed'\n6. Under Cloud Protection:\n   - Verify 'Cloud-delivered protection' is enabled (enhances behavioral detection)\n7. Assign to all Windows device groups\n8. Monitor behavioral detections in Defender threat analytics",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/configure-real-time-protection-microsoft-defender-antivirus"
    },
    {
      "settingName": "Attack surface reduction rules",
      "displayName": "Microsoft Defender - Attack Surface Reduction Rules",
      "settingPath": "Defender.AttackSurfaceReductionRules",
      "policyType": "Defender",
      "policySubType": "Attack Surface Reduction",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[\"Block executable content from email client and webmail\",\"Block Office applications from creating executable content\",\"Block Office applications from injecting code into other processes\",\"Block JavaScript or VBScript from launching downloaded executable content\"]",
      "validationOperator": "contains",
      "description": "Configures Attack Surface Reduction (ASR) rules to block common malware delivery and execution vectors. ASR rules prevent malicious code from exploiting vulnerable applications and user behaviors, significantly reducing the attack surface for malware infections.",
      "implementationGuide": "1. Sign in to Microsoft Intune admin center\n2. Navigate to Endpoint security > Attack surface reduction > Create Policy\n3. Select Platform: 'Windows 10, Windows 11, and Windows Server'\n4. Select Profile: 'Attack surface reduction rules'\n5. Configure key rules to 'Block' mode:\n   - Block executable content from email client and webmail: GUID: BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550\n   - Block Office applications from creating executable content: GUID: 3B576869-A4EC-4529-8536-B80A7769E899\n   - Block Office applications from injecting code: GUID: 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84\n   - Block JavaScript/VBScript launching executables: GUID: D3E037E1-3EB8-44C8-A917-57927947596D\n6. Start in 'Audit' mode for testing, then switch to 'Block' mode\n7. Assign to device groups\n8. Monitor ASR events and adjust exclusions as needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction-rules-reference"
    },
    {
      "settingName": "Microsoft Defender threat intelligence integration",
      "displayName": "Defender XDR - Threat Intelligence and Analytics",
      "settingPath": "Defender.ThreatIntelligence",
      "policyType": "Defender",
      "policySubType": "Threat Intelligence",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables integration with Microsoft's threat intelligence feeds which continuously receive security alerts and advisories from global threat data sources including CISA, FBI, NSA, and other security organizations. Threat intelligence is automatically applied to Microsoft Defender for Endpoint, providing real-time threat detection based on external security advisories.",
      "implementationGuide": "1. Sign in to Microsoft Defender portal (https://security.microsoft.com)\n2. Navigate to Settings > Microsoft Defender XDR > Threat Intelligence\n3. Verify 'Microsoft Threat Intelligence' is enabled (enabled by default with Defender licensing)\n4. Navigate to Threat analytics to view current threat intelligence reports\n5. Review threat intelligence sources:\n   - Microsoft Defender Threat Intelligence\n   - CISA Cybersecurity Advisories\n   - Industry threat intelligence feeds\n6. Configure custom threat indicators if needed (Settings > Endpoints > Indicators)\n7. Enable email notifications for threat intelligence updates\n8. Review threat analytics reports regularly for relevant threats and recommended actions",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/threat-analytics"
    },
    {
      "settingName": "Microsoft Defender alert policies",
      "displayName": "Microsoft 365 Defender - Alert Policies and Notifications",
      "settingPath": "Defender.AlertPolicies",
      "policyType": "Defender",
      "policySubType": "Alert Policy",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"Malware campaign detected after delivery\",\"Suspicious connector activity\",\"Suspicious email sending patterns detected\",\"Suspicious Email Forwarding Activity\",\"User restricted from sending email\"]",
      "validationOperator": "contains",
      "description": "Configures Microsoft 365 Defender alert policies to generate and disseminate internal security alerts. Alert policies automatically detect suspicious activities and security events, notifying administrators of potential threats requiring investigation or response.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Navigate to Policies > Alert policies\n3. Review and enable required alert policies, minimum requirements per CISA SCB:\n   - Malware campaign detected after delivery (High severity)\n   - Suspicious connector activity (Medium severity)\n   - Suspicious email sending patterns detected (Medium severity)\n   - User restricted from sending email (High severity)\n4. For each alert policy, click to edit:\n   - Set Status to 'On'\n   - Configure email recipients for notifications\n   - Set appropriate severity thresholds\n5. Navigate to Microsoft Defender portal (https://security.microsoft.com)\n6. Configure additional Defender for Endpoint alert policies\n7. Test alert delivery by triggering test events\n8. Document alert response procedures",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/compliance/alert-policies"
    },
    {
      "settingName": "Email notifications for security alerts",
      "displayName": "Defender XDR - Alert Email Notifications",
      "settingPath": "Defender.AlertNotifications",
      "policyType": "Defender",
      "policySubType": "Notification Settings",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"enabled\":true,\"severity\":[\"High\",\"Medium\"],\"recipients\":\"SecurityTeam@organization.com\"}",
      "validationOperator": "==",
      "description": "Configures automatic email notifications when security alerts are triggered in Microsoft Defender XDR. Notifications ensure security personnel are promptly informed of detected threats, enabling rapid response to security incidents. Supports dissemination of internal security alerts to appropriate organizational roles.",
      "implementationGuide": "1. Sign in to Microsoft Defender portal (https://security.microsoft.com)\n2. Navigate to Settings > Microsoft Defender XDR > Email notifications\n3. Click 'Add item' to create notification rule\n4. Configure notification settings:\n   - Rule name: Descriptive name (e.g., 'High Severity Security Alerts')\n   - Alert severity: Select 'High' and 'Medium' at minimum\n   - Device groups: Select 'All devices' or specific groups\n   - Recipients: Add email addresses or distribution lists\n5. Enable 'Send test email' to verify configuration\n6. Create separate notification rules for different severity levels if needed\n7. Document recipients and escalation procedures\n8. Review notification settings quarterly and update recipients as needed",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/configure-email-notifications"
    },
    {
      "settingName": "Microsoft Defender incident response",
      "displayName": "Defender XDR - Automated Investigation and Response",
      "settingPath": "Defender.AutomatedInvestigation",
      "policyType": "Defender",
      "policySubType": "Automation Settings",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "Full - remediate threats automatically",
      "validationOperator": "==",
      "description": "Configures automated investigation and response (AIR) capabilities to automatically investigate security alerts and take remediation actions. AIR analyzes alerts, correlates incidents, and implements security directives automatically, reducing response time for known threats.",
      "implementationGuide": "1. Sign in to Microsoft Defender portal (https://security.microsoft.com)\n2. Navigate to Settings > Endpoints > Advanced features\n3. Verify 'Automated Investigation' is enabled\n4. Navigate to Settings > Endpoints > Device groups\n5. For each device group, configure automation level:\n   - Select device group\n   - Under 'Automation level', choose 'Full - remediate threats automatically' for production systems\n   - Or choose 'Semi - require approval for any remediation' for sensitive systems\n6. Configure automated investigation settings:\n   - Enable 'Automatically resolve alerts'\n   - Set appropriate threat severity thresholds\n7. Review pending actions in Action Center regularly\n8. Monitor AIR investigation results in Incidents queue\n9. Tune automation rules based on false positive rates",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/automated-investigations"
    },
    {
      "settingName": "Audit log retention policy",
      "displayName": "Microsoft Purview - Audit Log Retention",
      "settingPath": "Purview.AuditLogRetention",
      "policyType": "Purview",
      "policySubType": "Audit and Log Management",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"retentionPeriod\":365,\"recordTypes\":[\"All\"],\"enabled\":true}",
      "validationOperator": ">=",
      "description": "Configures retention of Microsoft 365 audit logs to maintain records of security events, alerts, and activities. Audit logs capture security-relevant events that support investigation of security alerts and provide evidence of security advisory implementation. Per OMB M-21-31, federal agencies must retain logs for 12 months in active storage plus 18 months in cold storage.",
      "implementationGuide": "1. Sign in to Microsoft Purview compliance portal (https://compliance.microsoft.com)\n2. Navigate to Solutions > Audit\n3. Verify 'Audit' is turned on\n4. Navigate to Audit log retention policies\n5. Click 'Create audit log retention policy'\n6. Configure retention settings:\n   - Policy name: Descriptive name\n   - Record types: Select 'All activities' or specific security-related activities\n   - Retention duration: Set to 365 days minimum (or longer per requirements)\n   - Priority: Set appropriate priority if multiple policies exist\n7. Assign policy to users or groups (All users recommended)\n8. Review and create policy\n9. Verify policy is applied using PowerShell: Get-UnifiedAuditLogRetentionPolicy",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies"
    },
    {
      "settingName": "Azure AD sign-in risk policy",
      "displayName": "Entra ID - Sign-in Risk-based Conditional Access",
      "settingPath": "AzureAD.ConditionalAccess.SignInRiskPolicy",
      "policyType": "AzureAD",
      "policySubType": "Conditional Access",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"state\":\"enabled\",\"riskLevels\":[\"high\",\"medium\"],\"controls\":\"require MFA or block\"}",
      "validationOperator": "==",
      "description": "Configures conditional access policy based on sign-in risk detected by Azure AD Identity Protection. Risk-based policies automatically respond to threat intelligence indicating compromised credentials or suspicious sign-in patterns, implementing security directives to protect accounts from unauthorized access.",
      "implementationGuide": "1. Verify Azure AD Premium P2 licensing (required for Identity Protection)\n2. Sign in to Entra admin center (https://entra.microsoft.com)\n3. Navigate to Protection > Conditional Access\n4. Click 'New policy' and configure:\n   - Name: 'Block or require MFA for risky sign-ins'\n   - Users: Include all users, exclude emergency access accounts\n   - Cloud apps: All cloud apps\n   - Conditions > Sign-in risk: Select 'High' and 'Medium'\n   - Access controls > Grant: Select 'Require multi-factor authentication' or 'Block access'\n5. Set 'Enable policy' to 'Report-only' initially for testing\n6. Monitor report-only results for 2-4 weeks\n7. Switch to 'On' after validation\n8. Configure risk event detection settings in Identity Protection",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-risk"
    },
    {
      "settingName": "UnifiedAuditLogIngestionEnabled",
      "displayName": "Microsoft Purview Unified Audit Logging",
      "settingPath": "UnifiedAuditLogConfig.UnifiedAuditLogIngestionEnabled",
      "policyType": "Purview",
      "policySubType": "AuditLogging",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables unified audit logging in Microsoft Purview to capture and record user and admin activities across Microsoft 365 services. This setting is fundamental for detecting attacks, monitoring system access, and identifying unauthorized use by providing comprehensive audit trails for security investigations and compliance monitoring.",
      "implementationGuide": "1. Navigate to Microsoft Purview Compliance Portal (https://compliance.microsoft.com)\n2. Select 'Audit' under Solutions\n3. If auditing is not enabled, click 'Start recording user and admin activity' banner\n4. Alternatively, use PowerShell: Connect-ExchangeOnline, then run Set-AdminAuditLogConfig -UnifiedAuditLogIngestionEnabled $true\n5. Verify with: Get-AdminAuditLogConfig | Format-List UnifiedAuditLogIngestionEnabled\n6. Note: Changes may take up to 60 minutes to take effect",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/audit-log-enable-disable"
    },
    {
      "settingName": "DisableRealtimeMonitoring",
      "displayName": "Defender Real-Time Protection",
      "settingPath": "microsoft.policies.sensors.microsoftDefenderAntivirus.disableRealtimeMonitoring",
      "policyType": "Defender",
      "policySubType": "Antivirus",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Enables real-time protection in Microsoft Defender Antivirus to continuously monitor file and process activity for malicious behavior. Real-time protection detects attacks as they occur, identifies malware propagation, and blocks unauthorized executables, providing immediate threat detection required for system monitoring.",
      "implementationGuide": "1. Navigate to Microsoft Intune Admin Center (https://intune.microsoft.com)\n2. Select Endpoint Security > Antivirus\n3. Create or edit Microsoft Defender Antivirus profile\n4. In Configuration settings, expand 'Real-time Protection'\n5. Set 'Turn on real-time protection' to 'Yes'\n6. Set 'Turn on behavior monitoring' to 'Yes'\n7. Assign policy to appropriate device groups\n8. Verify with PowerShell: Get-MpComputerStatus | select RealTimeProtectionEnabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/configure-real-time-protection-microsoft-defender-antivirus"
    },
    {
      "settingName": "DisableBehaviorMonitoring",
      "displayName": "Defender Behavior Monitoring",
      "settingPath": "microsoft.policies.sensors.microsoftDefenderAntivirus.disableBehaviorMonitoring",
      "policyType": "Defender",
      "policySubType": "Antivirus",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": false,
      "validationOperator": "==",
      "description": "Enables behavior monitoring in Microsoft Defender Antivirus to detect suspicious activities and attack patterns through heuristic analysis. Behavior monitoring identifies unusual system behavior that may indicate attacks, including fileless malware, living-off-the-land techniques, and advanced persistent threats that traditional signature-based detection might miss.",
      "implementationGuide": "1. Navigate to Microsoft Intune Admin Center\n2. Select Endpoint Security > Antivirus\n3. Create or edit Microsoft Defender Antivirus profile\n4. In Configuration settings, expand 'Real-time Protection'\n5. Set 'Turn on behavior monitoring' to 'Yes'\n6. Ensure 'Monitoring for incoming and outgoing files' is set to 'Monitor all files'\n7. Assign policy to device groups\n8. Verify with PowerShell: Get-MpComputerStatus | select BehaviorMonitorEnabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/configure-protection-features-microsoft-defender-antivirus"
    },
    {
      "settingName": "AllowCloudProtection",
      "displayName": "Defender Cloud-Delivered Protection",
      "settingPath": "microsoft.policies.sensors.microsoftDefenderAntivirus.allowCloudProtection",
      "policyType": "Defender",
      "policySubType": "Antivirus",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables cloud-delivered protection in Microsoft Defender Antivirus to leverage Microsoft's global threat intelligence for near-instant detection and blocking of new and emerging threats. Cloud protection provides access to machine learning models, behavioral analysis, and threat intelligence that detect zero-day attacks and indicators of compromise within seconds.",
      "implementationGuide": "1. Navigate to Microsoft Intune Admin Center\n2. Select Endpoint Security > Antivirus\n3. Create or edit Microsoft Defender Antivirus profile\n4. In Configuration settings, expand 'Cloud Protection'\n5. Set 'Turn on cloud-delivered protection' to 'Yes'\n6. Set 'Cloud-delivered protection level' to 'High' or 'High+'\n7. Set 'Submit samples consent' to 'Send safe samples automatically'\n8. Assign policy to device groups\n9. Verify with PowerShell: Get-MpComputerStatus | select CloudProtectionEnabled",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-endpoint/enable-cloud-protection-microsoft-defender-antivirus"
    },
    {
      "settingName": "SignInLogsEnabled",
      "displayName": "Azure AD Sign-In Logs Monitoring",
      "settingPath": "azureAD.diagnosticSettings.logs.category.SignInLogs.enabled",
      "policyType": "AzureAD",
      "policySubType": "DiagnosticSettings",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Azure AD sign-in log collection to monitor authentication activities and detect unauthorized access attempts, suspicious sign-ins, and risky connections. Sign-in logs capture detailed information about user authentication including IP addresses, locations, devices, and authentication methods, essential for detecting unauthorized connections and system misuse.",
      "implementationGuide": "1. Navigate to Azure Portal (https://portal.azure.com)\n2. Select Azure Active Directory > Diagnostic settings\n3. Add diagnostic setting or edit existing\n4. Under Logs, enable 'SignInLogs', 'NonInteractiveUserSignInLogs', and 'ServicePrincipalSignInLogs'\n5. Configure destination: Log Analytics workspace, Storage account, or Event Hub\n6. Set retention period (minimum 90 days recommended)\n7. Save diagnostic settings\n8. Verify logs appear in destination within 15 minutes",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/concept-sign-ins"
    },
    {
      "settingName": "IdentityProtectionEnabled",
      "displayName": "Azure AD Identity Protection Risk Detection",
      "settingPath": "azureAD.identityProtection.policies.signInRiskPolicy.state",
      "policyType": "AzureAD",
      "policySubType": "IdentityProtection",
      "platform": "All",
      "dataType": "string",
      "expectedValue": "enabled",
      "validationOperator": "==",
      "description": "Enables Azure AD Identity Protection to automatically detect and respond to identity-based risks including compromised accounts, risky sign-ins, and attack indicators. Identity Protection uses machine learning and Microsoft's threat intelligence to detect unusual sign-in patterns, leaked credentials, anonymous IP usage, malware-linked IPs, and impossible travel scenarios that indicate attacks or unauthorized connections.",
      "implementationGuide": "1. Navigate to Azure Portal (https://portal.azure.com)\n2. Select Azure Active Directory > Security > Identity Protection\n3. Select 'Sign-in risk policy'\n4. Set 'Sign-in risk' level to 'Medium and above' or 'High'\n5. Under Access controls, select 'Allow access' and 'Require multi-factor authentication'\n6. Set 'Enforce Policy' to 'On'\n7. Configure 'User risk policy' similarly with 'Require password change'\n8. Review 'Risky sign-ins' and 'Risky users' reports regularly\n9. Note: Requires Azure AD Premium P2 license",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/entra/id-protection/overview-identity-protection"
    },
    {
      "settingName": "complianceManagerNIST800171Assessment",
      "displayName": "Compliance Manager NIST 800-171 Assessment Template",
      "settingPath": "purview.complianceManager.assessments",
      "policyType": "Purview",
      "policySubType": "ComplianceManager",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Microsoft Purview Compliance Manager provides structured assessment templates for NIST 800-171 Rev 3 that guide organizations in documenting policies and procedures across all security control families. The assessment tracks implementation status, provides improvement actions, and maintains documentation of organizational policies.",
      "implementationGuide": "1. Sign in to Microsoft Purview portal (compliance.microsoft.com) as Compliance Administrator\n2. Navigate to Compliance Manager > Assessments\n3. Select 'Create assessment' and choose NIST SP 800-171 Rev 3 template\n4. Configure assessment group and name (e.g., 'NIST 800-171 Rev 3 Implementation')\n5. Assign roles (Assessors, Contributors, Readers) to appropriate personnel\n6. Document policies and procedures for each control family in improvement actions\n7. Upload policy documents as evidence\n8. Set review schedule (e.g., annually) for policy updates\n9. Track completion status and compliance score",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/compliance-manager-assessments"
    },
    {
      "settingName": "informationProtectionPolicies",
      "displayName": "Microsoft Purview Information Protection Policies",
      "settingPath": "purview.informationProtection.policies",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Information Protection policies in Purview define and enforce data classification, labeling, and protection requirements. These policies document how CUI and sensitive information should be handled throughout its lifecycle, supporting the policy and procedure requirements for data protection.",
      "implementationGuide": "1. Navigate to Microsoft Purview portal > Information Protection\n2. Create sensitivity labels for CUI classification (e.g., Confidential, Highly Confidential)\n3. Configure label policies defining:\n   - Mandatory labeling requirements\n   - Default labels for documents and emails\n   - Label inheritance settings\n   - Encryption and access control requirements\n4. Document policy scope and applicability in policy descriptions\n5. Assign policies to appropriate user groups\n6. Enable label policy analytics to monitor compliance\n7. Establish review cycle (minimum annually) for policy updates\n8. Publish policies to users with training materials",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/information-protection"
    },
    {
      "settingName": "conditionalAccessPolicies",
      "displayName": "Azure AD Conditional Access Security Policies",
      "settingPath": "azureAD.conditionalAccess.policies",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ">=3",
      "validationOperator": ">=",
      "description": "Conditional Access policies define and enforce access control requirements for CUI systems. These policies document organizational requirements for authentication, device compliance, and access conditions, implementing the access control policy framework required by NIST 800-171.",
      "implementationGuide": "1. Sign in to Azure Portal (portal.azure.com) as Global Administrator\n2. Navigate to Azure Active Directory > Security > Conditional Access\n3. Create baseline security policies:\n   - Policy 1: Require MFA for all users\n   - Policy 2: Block legacy authentication\n   - Policy 3: Require compliant or hybrid joined devices\n4. Document each policy with clear descriptions and rationale\n5. Configure policy to report-only mode initially for testing\n6. Test policies with pilot group\n7. Enable policies (set to 'On')\n8. Document policy review schedule (recommend quarterly)\n9. Export policy configurations as documentation\n10. Store policy documentation in secure location accessible to auditors",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/overview"
    },
    {
      "settingName": "deviceCompliancePolicies",
      "displayName": "Intune Device Compliance Policies",
      "settingPath": "intune.deviceCompliance.policies",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "All",
      "dataType": "array",
      "expectedValue": ">=1",
      "validationOperator": ">=",
      "description": "Device compliance policies define and enforce organizational requirements for device security configuration. These policies document minimum security standards that devices must meet to access CUI, supporting the policy framework for system and device protection.",
      "implementationGuide": "1. Sign in to Microsoft Endpoint Manager admin center (endpoint.microsoft.com)\n2. Navigate to Devices > Compliance policies > Policies\n3. Create compliance policy for each platform (Windows, iOS, Android):\n   - Windows 10/11: Require BitLocker, password requirements, firewall enabled\n   - iOS/iPadOS: Require passcode, jailbreak detection\n   - Android: Require encryption, Google Play Protect\n4. Document policy settings and rationale in policy description\n5. Configure compliance actions (mark non-compliant, notify users)\n6. Assign policies to appropriate device groups\n7. Test policies with pilot devices\n8. Monitor compliance status in Intune dashboard\n9. Schedule quarterly policy review\n10. Document exceptions and approved deviations",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started"
    },
    {
      "settingName": "intuneSecurityBaselines",
      "displayName": "Intune Security Baseline Policies",
      "settingPath": "intune.securityBaselines.policies",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Security baseline policies provide Microsoft-recommended security configurations that document and enforce organizational security standards. These pre-configured policies implement industry best practices and document the security requirements for Windows devices processing CUI.",
      "implementationGuide": "1. Navigate to Microsoft Endpoint Manager admin center\n2. Go to Endpoint security > Security baselines\n3. Select 'Windows 10 and later Security Baseline'\n4. Click 'Create profile'\n5. Configure baseline settings:\n   - Review and accept default settings (Microsoft recommended)\n   - Customize settings if organizational requirements differ\n   - Document any deviations from baseline with justification\n6. Name the profile clearly (e.g., 'Windows Security Baseline - NIST 800-171')\n7. Add detailed description documenting purpose and scope\n8. Assign to Windows device groups\n9. Monitor deployment status and compliance\n10. Schedule annual baseline review to adopt updated versions\n11. Export baseline configuration for documentation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/security-baselines"
    },
    {
      "settingName": "retentionPoliciesDocumentation",
      "displayName": "Microsoft Purview Retention Policies",
      "settingPath": "purview.dataLifecycle.retentionPolicies",
      "policyType": "Purview",
      "policySubType": "DataLifecycle",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Retention policies document and enforce organizational requirements for information lifecycle management. These policies define how long CUI and other information must be retained, supporting compliance with record retention requirements and documenting information management procedures.",
      "implementationGuide": "1. Navigate to Microsoft Purview portal > Data Lifecycle Management\n2. Go to Microsoft 365 > Retention policies\n3. Create retention policy for CUI:\n   - Click 'New retention policy'\n   - Name: 'CUI Retention Policy'\n   - Choose locations (Exchange, SharePoint, OneDrive, Teams)\n   - Define retention period (e.g., 7 years for CUI)\n   - Configure retention actions (retain and delete, or retain only)\n4. Document policy scope and business justification\n5. Create additional policies for different information types\n6. Assign policies using adaptive scopes or specific locations\n7. Test policy with sample content\n8. Enable policy\n9. Monitor retention status\n10. Schedule annual policy review\n11. Document policy in organizational records management plan",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/retention-policies-sharepoint"
    },
    {
      "settingName": "complianceManagerSystemSecurityPlan",
      "displayName": "Compliance Manager System Security Plan Documentation",
      "settingPath": "purview.complianceManager.assessments.ssp",
      "policyType": "Purview",
      "policySubType": "ComplianceManager",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Compliance Manager provides a framework for documenting the complete system security plan including system boundaries, components, threats, requirements, and implemented safeguards. The assessment workflow supports ongoing review and updates to the security plan.",
      "implementationGuide": "1. Sign in to Microsoft Purview portal as Compliance Administrator\n2. Navigate to Compliance Manager > Assessments\n3. Open NIST 800-171 Rev 3 assessment (or create if not exists)\n4. For control 03.15.02, document system security plan components:\n   - System boundary definition and constituent components\n   - Information types (CUI categories processed)\n   - Identified threats specific to organization\n   - Operational environment and system dependencies\n   - Security requirements overview\n   - Implemented safeguards (reference other controls)\n   - Roles and responsibilities matrix\n5. Upload SSP document as evidence\n6. Set implementation status to 'Implemented'\n7. Configure review schedule (annual minimum)\n8. Assign assessors to review SSP annually\n9. Track SSP updates in assessment history\n10. Restrict access to assessment to authorized personnel only",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/compliance-manager-assessments"
    },
    {
      "settingName": "microsoftSecureScore",
      "displayName": "Microsoft Secure Score",
      "settingPath": "defender.secureScore.enabled",
      "policyType": "Defender",
      "policySubType": "SecureScore",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Microsoft Secure Score provides continuous assessment of the security posture of M365 environment, identifying implemented safeguards and improvement opportunities. This tool helps document current security controls and plan future improvements as required by the system security plan.",
      "implementationGuide": "1. Sign in to Microsoft 365 Defender portal (security.microsoft.com)\n2. Navigate to Secure Score dashboard\n3. Review current score and improvement actions\n4. Document current score in system security plan as baseline\n5. For each improvement action:\n   - Review recommended action and rationale\n   - Determine if applicable to organization\n   - Document decision (implement, risk accept, mitigate differently)\n   - Assign owner for implementation\n6. Create plan to address priority improvement actions\n7. Document planned safeguards in SSP\n8. Schedule quarterly Secure Score reviews\n9. Track score changes over time\n10. Export Secure Score report for SSP documentation\n11. Include Secure Score trend analysis in annual SSP review",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/microsoft-secure-score"
    },
    {
      "settingName": "azureADSecurityDefaults",
      "displayName": "Azure AD Security Defaults Configuration",
      "settingPath": "azureAD.security.defaults",
      "policyType": "AzureAD",
      "policySubType": "SecurityConfiguration",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "documented",
      "validationOperator": "==",
      "description": "Azure AD security configuration (either Security Defaults or Conditional Access policies) provides baseline identity protection that must be documented in the system security plan. This documents authentication requirements and identity protection safeguards.",
      "implementationGuide": "1. Sign in to Azure Portal as Global Administrator\n2. Navigate to Azure Active Directory > Properties\n3. Document current security configuration:\n   - If Security Defaults enabled: Document default protections (MFA, legacy auth blocking)\n   - If using Conditional Access: Export all CA policy configurations\n4. Create SSP section documenting identity protection:\n   - Authentication methods enabled (MFA, passwordless)\n   - Conditional Access policy summary\n   - Identity Protection settings (risk policies)\n   - Privileged Identity Management configuration\n5. Document identity architecture:\n   - Azure AD Connect (hybrid) or cloud-only\n   - Federation configuration if applicable\n   - External collaboration settings\n6. Include identity roles and responsibilities\n7. Document MFA coverage and exceptions\n8. Export Azure AD sign-in logs retention policy\n9. Include identity security in annual SSP review",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/security-defaults"
    },
    {
      "settingName": "intuneDeviceInventory",
      "displayName": "Intune Device Inventory and Configuration",
      "settingPath": "intune.devices.inventory",
      "policyType": "Intune",
      "policySubType": "DeviceManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Intune maintains comprehensive inventory of managed devices including hardware, software, and compliance status. This inventory is essential for documenting system components and boundaries required in the system security plan.",
      "implementationGuide": "1. Sign in to Microsoft Endpoint Manager admin center\n2. Navigate to Devices > All devices\n3. Export device inventory including:\n   - Device name, type, OS version\n   - Enrollment date and status\n   - Compliance status\n   - Last check-in date\n   - Primary user\n4. Document device categories in SSP:\n   - Endpoints accessing CUI (laptops, desktops, mobile)\n   - Operating systems and versions supported\n   - Device ownership model (corporate, BYOD)\n5. Navigate to Devices > Monitor > Device compliance\n6. Export compliance reports\n7. Document in SSP:\n   - Total managed devices\n   - Device compliance policies applied\n   - Non-compliant devices and remediation status\n8. Include device inventory in SSP appendix\n9. Configure automated device inventory reports (monthly)\n10. Update SSP device inventory during annual review",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/remote-actions/device-inventory"
    },
    {
      "settingName": "dataSensitivityClassification",
      "displayName": "Microsoft Purview Data Classification",
      "settingPath": "purview.dataClassification.overview",
      "policyType": "Purview",
      "policySubType": "DataGovernance",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Data classification in Purview identifies and catalogs CUI and sensitive information types across the M365 environment. This classification is required to document information types processed, stored, and transmitted by the system.",
      "implementationGuide": "1. Navigate to Microsoft Purview portal\n2. Go to Data Classification > Overview\n3. Review detected sensitive information types:\n   - CUI categories identified\n   - Personally Identifiable Information (PII)\n   - Financial information\n   - Health information\n4. Navigate to Content explorer to review:\n   - Documents containing CUI by sensitivity label\n   - Locations storing CUI (SharePoint, OneDrive, Exchange)\n   - User access to CUI\n5. Export data classification reports\n6. Document in SSP:\n   - CUI categories processed (e.g., Export Control, Privacy, FOUO)\n   - Sensitive information types present\n   - Primary storage locations\n   - Data flows (how CUI moves through system)\n   - Data retention requirements\n7. Create data flow diagram showing CUI movement\n8. Update data classification documentation quarterly\n9. Include data maps in SSP appendix",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/data-classification-overview"
    },
    {
      "settingName": "azureADRoleAssignments",
      "displayName": "Azure AD Role Assignments and Responsibilities",
      "settingPath": "azureAD.roles.assignments",
      "policyType": "AzureAD",
      "policySubType": "IdentityGovernance",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Azure AD role assignments document individuals with administrative responsibilities for the M365 system. These assignments must be documented in the SSP to identify system roles and responsibilities as required by NIST 800-171.",
      "implementationGuide": "1. Sign in to Azure Portal as Global Administrator\n2. Navigate to Azure Active Directory > Roles and administrators\n3. Export role assignments for key administrative roles:\n   - Global Administrator\n   - Security Administrator\n   - Compliance Administrator\n   - Exchange Administrator\n   - SharePoint Administrator\n   - Intune Administrator\n   - User Administrator\n4. Document in SSP roles and responsibilities section:\n   - Role name and description\n   - Assigned personnel (name, title, department)\n   - Role responsibilities\n   - Delegation authority\n5. If using Privileged Identity Management (PIM):\n   - Document eligible vs. permanent assignments\n   - Maximum activation duration\n   - Approval requirements\n6. Create RACI matrix for security functions\n7. Document escalation procedures\n8. Include contact information for critical roles\n9. Review role assignments quarterly\n10. Update SSP when role assignments change",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/roles/permissions-reference"
    },
    {
      "settingName": "sspAccessProtection",
      "displayName": "System Security Plan Document Protection",
      "settingPath": "sharepoint.sensitivityLabels.cui",
      "policyType": "Purview",
      "policySubType": "InformationProtection",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Sensitivity labels with encryption protect the system security plan document from unauthorized disclosure. The SSP contains sensitive security information that must be protected with access controls and encryption as required by NIST 800-171.",
      "implementationGuide": "1. Navigate to Microsoft Purview portal > Information Protection\n2. Create sensitivity label for SSP:\n   - Label name: 'CUI - System Security Plan'\n   - Description: 'For system security plans and security documentation'\n   - Scope: Files & emails, Meetings\n3. Configure label settings:\n   - Enable encryption\n   - Assign permissions: Security team and auditors (Co-Author)\n   - Remove permissions: External users, Public access\n   - Enable content marking (header: 'CONTROLLED UNCLASSIFIED INFORMATION')\n   - Prevent label removal\n4. Publish label policy to security administrators\n5. Store SSP in protected SharePoint library:\n   - Create 'Security Documentation' library\n   - Apply sensitivity label to library default\n   - Configure access: Security team only\n   - Enable versioning (major versions)\n   - Enable approval workflow for changes\n6. Apply label to SSP document\n7. Configure Azure Information Protection unified labeling scanner for compliance\n8. Monitor label usage in Data Classification reports\n9. Audit SSP access quarterly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/purview/encryption-sensitivity-labels"
    },
    {
      "settingName": "azureADTermsOfUse",
      "displayName": "Azure AD Terms of Use Policy",
      "settingPath": "azureAD.conditionalAccess.termsOfUse",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Azure AD Terms of Use provides a mechanism to present rules of behavior to users and require documented acceptance before granting access to M365 services and CUI. The acceptance is logged and auditable, satisfying the acknowledgment requirement.",
      "implementationGuide": "1. Create Rules of Behavior PDF document including:\n   - Acceptable use policy for M365 and CUI systems\n   - Responsibilities for protecting CUI\n   - Prohibited activities (data sharing, unauthorized access)\n   - Mobile device usage requirements\n   - Password and authentication requirements\n   - Incident reporting procedures\n   - Consequences for violations\n2. Sign in to Azure Portal as Conditional Access Administrator\n3. Navigate to Azure AD > Security > Conditional Access > Terms of use\n4. Click 'New terms'\n5. Configure Terms of Use:\n   - Display name: 'M365 Rules of Behavior - CUI Systems'\n   - Upload PDF document (max 10MB, recommended 24pt font)\n   - Language: Select appropriate language\n   - Require users to expand terms: Yes\n   - Require users to consent on every device: Yes (if multi-device access)\n   - Expire consents: Yes (annually)\n   - Duration before re-acceptance required: 365 days\n6. Save Terms of Use\n7. Create Conditional Access policy:\n   - Name: 'Require Terms of Use Acceptance'\n   - Users: All users (or specific groups)\n   - Cloud apps: All cloud apps (or specific M365 apps)\n   - Grant control: Require terms of use\n8. Enable policy after testing\n9. Monitor acceptance in Azure AD audit logs\n10. Review and update ToU document annually",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/terms-of-use"
    },
    {
      "settingName": "conditionalAccessRequireToU",
      "displayName": "Conditional Access Policy Requiring Terms of Use",
      "settingPath": "azureAD.conditionalAccess.policies.requireToU",
      "policyType": "AzureAD",
      "policySubType": "ConditionalAccess",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Conditional Access policy enforces Terms of Use acceptance before granting access to CUI systems. This ensures no user can access CUI without first acknowledging the rules of behavior.",
      "implementationGuide": "1. Sign in to Azure Portal as Conditional Access Administrator\n2. Navigate to Azure AD > Security > Conditional Access > Policies\n3. Click 'New policy'\n4. Configure policy:\n   - Name: 'Enforce Rules of Behavior for CUI Access'\n   - Description: 'Require ToU acceptance for all M365 services'\n5. Assignments:\n   - Users: Include 'All users'\n   - Exclude: Emergency access accounts only\n   - Cloud apps: Select 'All cloud apps' OR specific apps:\n     * Office 365\n     * Microsoft Teams\n     * SharePoint Online\n     * Exchange Online\n6. Access controls:\n   - Grant: Grant access\n   - Require terms of use: Select 'M365 Rules of Behavior - CUI Systems'\n7. Session: Leave default\n8. Enable policy: 'Report-only' (for testing)\n9. Test with pilot users:\n   - Verify ToU is presented at login\n   - Verify access blocked without acceptance\n   - Check acceptance is logged\n10. Change policy to 'On' after successful testing\n11. Monitor policy effectiveness in Conditional Access Insights\n12. Review policy annually when ToU is updated",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/overview"
    },
    {
      "settingName": "intuneEnrollmentTermsAndConditions",
      "displayName": "Intune Terms and Conditions for Device Enrollment",
      "settingPath": "intune.enrollment.termsAndConditions",
      "policyType": "Intune",
      "policySubType": "EnrollmentRestrictions",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Intune Terms and Conditions require users to accept device usage policies before enrolling devices. This ensures device-based access to CUI requires acceptance of rules of behavior specific to mobile and endpoint devices.",
      "implementationGuide": "1. Sign in to Microsoft Endpoint Manager admin center\n2. Navigate to Devices > Enrollment > Terms and Conditions\n3. Click 'Create'\n4. Configure terms:\n   - Name: 'Device Usage Policy - CUI Systems'\n   - Description: 'Rules of behavior for devices accessing CUI'\n   - Display name for end users: 'Device Usage Agreement'\n5. Enter terms and conditions text:\n   - Device security requirements\n   - Acceptable use for corporate and BYOD devices\n   - Remote wipe authorization\n   - Monitoring and logging disclosure\n   - Data protection responsibilities\n   - Lost/stolen device reporting\n6. Set title and summary\n7. Version: 1.0 (increment when updated)\n8. Require users to re-accept on updates: Yes\n9. Assign to groups:\n   - All users (or specific device user groups)\n10. Save and publish\n11. Users will see terms during device enrollment:\n    - In Company Portal app\n    - During Intune enrollment process\n12. Monitor acceptance status:\n    - Devices > Monitor > Terms and Conditions\n    - View accepted/declined/pending status\n13. Export acceptance reports for audit\n14. Review and update terms annually",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/enrollment/terms-and-conditions-create"
    },
    {
      "settingName": "termsOfUseAuditLogs",
      "displayName": "Terms of Use Acceptance Audit Logs",
      "settingPath": "azureAD.auditLogs.termsOfUse",
      "policyType": "AzureAD",
      "policySubType": "AuditLogs",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Azure AD audit logs capture all Terms of Use acceptance events, providing documented evidence of user acknowledgment. These logs are essential for compliance verification and must be retained according to organizational policy.",
      "implementationGuide": "1. Sign in to Azure Portal as Security Administrator\n2. Navigate to Azure AD > Monitoring > Audit logs\n3. Filter for Terms of Use activities:\n   - Activity: 'User agreed to Terms of Use'\n   - Activity: 'User declined Terms of Use'\n   - Date range: As required\n4. Review audit log entries containing:\n   - User principal name\n   - Date/time of acceptance\n   - Terms of Use name\n   - IP address\n   - Device information\n5. Export logs for compliance documentation:\n   - Click 'Download' for CSV or JSON format\n   - Store securely with minimum 1 year retention\n6. Configure log retention:\n   - Navigate to Azure AD > Diagnostic settings\n   - Send to Log Analytics workspace (recommended)\n   - Retention: Minimum 1 year, recommend 7 years for CUI\n7. Create Log Analytics query for ToU reporting:\n   - Query all acceptances in date range\n   - Identify users who haven't accepted\n   - Monitor declined acceptances\n8. Schedule monthly report for security team:\n   - ToU acceptance completion rate\n   - New users requiring acceptance\n   - Pending acceptances\n9. Include ToU acceptance metrics in compliance reporting\n10. Review logs quarterly for anomalies",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-audit-logs"
    },
    {
      "settingName": "rulesOfBehaviorDocumentManagement",
      "displayName": "Rules of Behavior Document Version Control",
      "settingPath": "sharepoint.documentLibrary.versionControl",
      "policyType": "Purview",
      "policySubType": "ContentManagement",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "SharePoint version control and approval workflow manages the Rules of Behavior document, supporting the requirement to review and update the rules at defined frequencies. Version history provides audit trail of changes.",
      "implementationGuide": "1. Create SharePoint library for policy documents:\n   - Navigate to Security team SharePoint site\n   - Create library: 'Security Policies'\n2. Enable versioning:\n   - Library Settings > Versioning settings\n   - Document Version History: Create major and minor versions\n   - Require Check Out: Yes\n   - Require content approval: Yes\n3. Upload Rules of Behavior document:\n   - Version 1.0 - Initial version\n   - Apply metadata:\n     * Document Type: Rules of Behavior\n     * Review Date: Annual\n     * Next Review: [Date]\n     * Owner: Security Manager\n4. Configure approval workflow:\n   - Library Settings > Workflow Settings\n   - Create approval workflow for document changes\n   - Approvers: Security Manager, Legal, Compliance\n5. Apply sensitivity label to document:\n   - Label: 'Internal Use Only' or 'Confidential'\n6. Set up alerts:\n   - Alert when document is modified\n   - Alert 30 days before review date\n7. Create review schedule:\n   - Annual review (minimum)\n   - Review after significant policy changes\n   - Review after security incidents\n8. Document review process:\n   - Update document as needed\n   - Update version number\n   - Submit for approval\n   - Re-export to PDF for ToU\n   - Update Azure AD ToU\n   - Force re-acceptance in Conditional Access\n9. Maintain version history (no deletion)\n10. Archive superseded versions for compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/sharepoint/governance/versioning-content-approval-and-check-out-planning"
    },
    {
      "settingName": "touComplianceReporting",
      "displayName": "Terms of Use Compliance Reporting",
      "settingPath": "azureAD.reporting.termsOfUse",
      "policyType": "AzureAD",
      "policySubType": "Reporting",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Terms of Use reporting provides visibility into acceptance status across the organization. Regular reporting ensures all users with CUI access have acknowledged the rules of behavior and identifies any users requiring attention.",
      "implementationGuide": "1. Sign in to Azure Portal as Security Reader (minimum)\n2. Navigate to Azure AD > Security > Conditional Access > Terms of use\n3. Select Terms of Use policy name\n4. Click 'View accepted terms'\n5. Export current acceptance status:\n   - Download CSV with all user acceptances\n   - Columns: User, Accepted Date, Accepted Version, IP Address\n6. Create PowerShell script for automated reporting:\n   ```powershell\n   Connect-AzureAD\n   $touId = '<ToU ID>'\n   $acceptances = Get-AzureADUserTOUAcceptance -Id $touId\n   $acceptances | Export-Csv 'ToU-Report.csv'\n   ```\n7. Schedule monthly compliance report:\n   - Total users requiring ToU\n   - Users who accepted (%)  \n   - Users pending acceptance\n   - Users who declined\n   - Expired acceptances requiring renewal\n8. Create action list:\n   - Follow up with pending users\n   - Investigate declined acceptances\n   - Process expired acceptances\n9. Include metrics in monthly security dashboard:\n   - ToU acceptance completion rate\n   - Trend over time\n   - Average time to acceptance for new users\n10. Report compliance to management quarterly\n11. Include ToU metrics in annual compliance report",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/terms-of-use"
    },
    {
      "settingName": "securityBaseline",
      "displayName": "Deploy Windows Security Baseline",
      "settingPath": "securityBaseline.assigned",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Ensures Windows Security Baseline is deployed to enforce secure system configuration standards based on Microsoft security engineering principles, including secure boot, credential protection, and least functionality.",
      "implementationGuide": "1. Navigate to Endpoint Security > Security baselines in Microsoft Intune admin center\n2. Select 'Security Baseline for Windows 10 and later'\n3. Create a new baseline profile with organizational security requirements\n4. Configure settings for: Secure Boot, BitLocker, Windows Defender, Account policies, Network security\n5. Assign to device groups\n6. Monitor compliance via Intune compliance dashboard",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/security-baselines"
    },
    {
      "settingName": "requireSecureBoot",
      "displayName": "Require Secure Boot Enabled",
      "settingPath": "deviceHealthAttestation.secureBoot",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enforces Secure Boot requirement to ensure devices boot with trusted firmware, implementing security engineering principle of establishing a hardware root of trust.",
      "implementationGuide": "1. Navigate to Devices > Compliance policies > Create policy in Intune\n2. Select Platform: Windows 10 and later\n3. Under Device Health, configure 'Require Secure Boot to be enabled on the device' = Require\n4. Set Actions for noncompliance (e.g., mark noncompliant immediately)\n5. Assign to device groups\n6. Devices without Secure Boot will be marked non-compliant",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "requireBitLocker",
      "displayName": "Require BitLocker Drive Encryption",
      "settingPath": "deviceHealthAttestation.bitLocker",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires BitLocker encryption on all system drives, implementing security engineering principle of data protection at rest using cryptographic mechanisms.",
      "implementationGuide": "1. Navigate to Devices > Compliance policies > Create policy\n2. Select Platform: Windows 10 and later\n3. Under Device Health, configure 'Require BitLocker' = Require\n4. Optionally configure encryption method via Configuration profile\n5. Set Actions for noncompliance\n6. Assign to device groups\n7. Note: Device must reboot after encryption for compliance detection",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows#device-health"
    },
    {
      "settingName": "leastFunctionalityPorts",
      "displayName": "Disable Unnecessary Ports and Services",
      "settingPath": "configuration.portConfiguration",
      "policyType": "Intune",
      "policySubType": "DeviceConfiguration",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "[\"SMBv1Disabled\",\"UnsignedDriversBlocked\",\"UnnecessaryServicesDisabled\"]",
      "validationOperator": "contains",
      "description": "Implements least functionality principle by disabling unnecessary protocols (SMBv1), blocking unsigned drivers, and disabling non-essential services to reduce attack surface.",
      "implementationGuide": "1. Deploy Windows Security Baseline which includes:\n   - Disable SMBv1 client and server\n   - Block unsigned drivers\n   - Disable unnecessary Windows services\n2. Navigate to Endpoint security > Security baselines\n3. Create baseline profile and configure:\n   - Configure SMB v1 client driver = Disable driver\n   - Configure SMB v1 server = Disabled\n4. Assign to device groups\n5. Monitor compliance",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/security-baseline-settings-mdm-all"
    },
    {
      "settingName": "windowsDefenderATP",
      "displayName": "Deploy Microsoft Defender for Endpoint Baseline",
      "settingPath": "securityBaseline.defenderATP",
      "policyType": "Intune",
      "policySubType": "SecurityBaseline",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Deploys Microsoft Defender for Endpoint security baseline to enforce threat detection, attack surface reduction, and security monitoring principles across endpoints.",
      "implementationGuide": "1. Navigate to Endpoint Security > Security baselines\n2. Select 'Security Baseline for Microsoft Defender for Endpoint'\n3. Create new profile with settings:\n   - Enable all Attack Surface Reduction rules\n   - Configure Network protection = Enable\n   - Enable Exploit protection\n   - Configure Controlled folder access\n4. Assign to device groups\n5. Monitor via Microsoft Defender portal",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/security-baseline-settings-defender"
    },
    {
      "settingName": "minimumOSVersion",
      "displayName": "Require Supported Windows Version",
      "settingPath": "deviceProperties.osMinimumVersion",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "10.0.22631.0",
      "validationOperator": ">=",
      "description": "Enforces minimum Windows 11 23H2 version to ensure devices run supported operating systems with active vendor support and security updates. Windows 10 reached end of support October 14, 2025.",
      "implementationGuide": "1. Navigate to Devices > Compliance policies > Create policy\n2. Select Platform: Windows 10 and later\n3. Under Device Properties, configure:\n   - Minimum OS version: 10.0.22631.0 (Windows 11 23H2)\n   - This ensures only supported Windows versions are compliant\n4. Set Actions for noncompliance:\n   - Mark device noncompliant: Immediately\n   - Send email to end user: After 3 days\n   - Remotely lock device: After 7 days\n5. Assign to all device groups\n6. Monitor compliance via Intune dashboard",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows"
    },
    {
      "settingName": "validOperatingSystemBuilds",
      "displayName": "Enforce Current Patch Level Compliance",
      "settingPath": "deviceProperties.validOperatingSystemBuilds",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "array",
      "expectedValue": "current_quarter_patches",
      "validationOperator": "in",
      "description": "Requires devices to run recent, supported Windows builds within current quarter to ensure security patches are applied and components are not outdated.",
      "implementationGuide": "1. Navigate to Devices > Compliance policies > Create policy\n2. Select Platform: Windows 10 and later\n3. Under Device Properties, configure Valid operating system builds:\n   - Add entry for each supported Windows version (11 22H2, 11 23H2)\n   - Minimum build: Latest cumulative update from 3 months ago\n   - Maximum build: Latest available cumulative update\n4. Example entries:\n   - Windows 11 23H2: Min 10.0.22631.XXXX, Max 10.0.22631.YYYY\n5. Update monthly as new patches release\n6. Set grace period of 14 days for noncompliance\n7. Assign to device groups",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows#valid-operating-system-builds"
    },
    {
      "settingName": "windowsUpdatePolicies",
      "displayName": "Configure Automatic Windows Updates",
      "settingPath": "updateRing.automaticUpdateBehavior",
      "policyType": "Intune",
      "policySubType": "UpdateRing",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "AutoInstallAndRebootAtScheduledTime",
      "validationOperator": "==",
      "description": "Enforces automatic installation of Windows updates to ensure system components are kept current with latest security patches and vendor support.",
      "implementationGuide": "1. Navigate to Devices > Windows > Update rings for Windows 10 and later\n2. Create update ring policy with settings:\n   - Automatic update behavior: Auto install and restart at scheduled time\n   - Quality update deferral period: 0-7 days\n   - Feature update deferral period: 0-30 days\n   - Deadline for quality updates: 7 days\n   - Deadline for feature updates: 14 days\n3. Configure maintenance window for restarts\n4. Assign to device groups\n5. Monitor update compliance via Windows Updates reports",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/windows-update-for-business-configure"
    },
    {
      "settingName": "minimumDefenderVersion",
      "displayName": "Require Current Microsoft Defender Version",
      "settingPath": "deviceHealthSecurity.defenderMinimumVersion",
      "policyType": "Intune",
      "policySubType": "DeviceCompliance",
      "platform": "Windows",
      "dataType": "string",
      "expectedValue": "4.18.24000.0",
      "validationOperator": ">=",
      "description": "Enforces minimum Microsoft Defender anti-malware version to ensure security components are current and supported with latest threat definitions.",
      "implementationGuide": "1. Navigate to Devices > Compliance policies > Create policy\n2. Select Platform: Windows 10 and later\n3. Under System Security, configure:\n   - Microsoft Defender Antimalware: Required\n   - Microsoft Defender Antimalware minimum version: 4.18.24000.0 (or current version)\n4. This ensures Defender engine is current and supported\n5. Set Actions for noncompliance\n6. Assign to device groups\n7. Update minimum version quarterly as new versions release",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows#microsoft-defender-for-endpoint"
    },
    {
      "settingName": "deviceEnrollmentRestriction",
      "displayName": "Block Enrollment of Unsupported OS Versions",
      "settingPath": "enrollment.restrictions.platformRestriction",
      "policyType": "Intune",
      "policySubType": "EnrollmentRestriction",
      "platform": "Windows",
      "dataType": "object",
      "expectedValue": "{\"minOSVersion\":\"10.0.22621.0\",\"blockUnsupportedVersions\":true}",
      "validationOperator": "==",
      "description": "Prevents enrollment of devices running unsupported Windows versions, ensuring only devices with vendor support can access organizational resources.",
      "implementationGuide": "1. Navigate to Devices > Enrollment > Enrollment device platform restrictions\n2. Select Windows restrictions (or create new restriction)\n3. Configure Platform settings:\n   - Minimum version: 10.0.22621.0 (Windows 11 22H2 minimum)\n   - Block personally owned devices: Consider enabling\n4. This prevents unsupported OS versions from enrolling\n5. Assign restriction to All Users\n6. Users with unsupported OS will receive error during enrollment",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/mem/intune/enrollment/enrollment-restrictions-set"
    },
    {
      "settingName": "endOfSupportDetection",
      "displayName": "Monitor End-of-Support Systems via Defender",
      "settingPath": "defenderVulnerability.endOfSupportDetection",
      "policyType": "Defender",
      "policySubType": "VulnerabilityManagement",
      "platform": "Windows",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Microsoft Defender Vulnerability Management to detect and report on systems and software components approaching or past end-of-support dates.",
      "implementationGuide": "1. Ensure Microsoft Defender for Endpoint is deployed\n2. Navigate to Microsoft Defender portal > Vulnerability management\n3. Enable Software inventory collection\n4. Configure recommendations to alert on:\n   - Operating systems approaching end-of-support\n   - Applications past end-of-support\n   - Outdated software versions\n5. Create remediation tasks for identified unsupported components\n6. Review Vulnerability Management dashboard weekly\n7. Integrate with Intune for automated remediation",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender-vulnerability-management/"
    },
    {
      "settingName": "appGovernanceEnabled",
      "displayName": "Enable App Governance for OAuth Apps",
      "settingPath": "appGovernance.enabled",
      "policyType": "Defender",
      "policySubType": "CloudAppSecurity",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables App Governance in Defender for Cloud Apps to monitor and control OAuth-enabled external applications accessing Microsoft 365 data, ensuring external services comply with security requirements.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal > Settings > Cloud Apps > App governance\n2. Select 'Turn on app governance'\n3. Wait up to 10 hours for data collection to complete\n4. Verify prerequisite: Defender for Cloud Apps license\n5. Connect Microsoft 365 connector if not already connected\n6. Review discovered OAuth apps in App governance > Overview\n7. Configure policies for high-privilege apps\n8. Monitor alerts for risky external application behavior",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-cloud-apps/app-governance-get-started"
    },
    {
      "settingName": "oAuthAppPermissionPolicies",
      "displayName": "Create OAuth App Permission Policies",
      "settingPath": "cloudApps.oAuthPolicy.permissions",
      "policyType": "Defender",
      "policySubType": "CloudAppSecurity",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"HighPermissionMonitoring\",\"UncommonAppAlerts\",\"ExternalPublisherReview\"]",
      "validationOperator": "contains",
      "description": "Implements OAuth app policies to alert on external applications with high-severity permissions, uncommon usage, or from external publishers, ensuring external services meet security requirements.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal > Cloud Apps > Policies > Policy management\n2. Create OAuth app policy:\n   a. High Permission Apps:\n      - App permissions: Permission level = High severity\n      - Community use = Uncommon\n      - Actions: Generate alert and notify admin\n   b. External Publisher Apps:\n      - App permissions: Publisher = External\n      - Permission level = High or Medium\n      - Actions: Generate alert for review\n   c. Rarely Used Apps:\n      - Last authorized: Not in last 90 days\n      - Actions: Generate alert and mark for review\n3. Configure alert recipients\n4. Enable policies\n5. Review alerts weekly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-cloud-apps/app-permission-policy"
    },
    {
      "settingName": "cloudAppDiscovery",
      "displayName": "Enable Cloud App Discovery and Shadow IT Detection",
      "settingPath": "cloudApps.discovery.enabled",
      "policyType": "Defender",
      "policySubType": "CloudAppSecurity",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Enables Cloud Discovery to identify unsanctioned external cloud services (Shadow IT) accessing organizational data, ensuring all external services are documented and monitored per security requirements.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal > Cloud Apps > Cloud Discovery\n2. Configure data sources:\n   - Option A: Deploy Defender for Endpoint for automatic log collection\n   - Option B: Configure log upload from firewalls/proxies\n3. Enable continuous reports\n4. Review discovered cloud apps dashboard\n5. Categorize apps as Sanctioned, Unsanctioned, or Under Review\n6. Create policies to:\n   - Alert on new high-risk cloud apps\n   - Block unsanctioned cloud storage\n   - Monitor data uploaded to external services\n7. Review Cloud Discovery score weekly",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-cloud-apps/set-up-cloud-discovery"
    },
    {
      "settingName": "appGovernanceCompliancePolicies",
      "displayName": "Enforce App Compliance Policies",
      "settingPath": "appGovernance.compliancePolicies",
      "policyType": "Defender",
      "policySubType": "CloudAppSecurity",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"HighPrivilegeAppReview\",\"OverprivilegedAppDetection\",\"DataExfiltrationMonitoring\"]",
      "validationOperator": "contains",
      "description": "Creates app governance compliance policies to continuously monitor external applications for overprivileged permissions, unusual data access patterns, and potential data exfiltration to external services.",
      "implementationGuide": "1. Navigate to App governance > Overview > Policies\n2. Create compliance policies:\n   a. Overprivileged Apps:\n      - Condition: Apps with unused high-privilege permissions\n      - Action: Alert and require justification\n   b. High Data Transfer:\n      - Condition: Apps transferring >1GB data in 24 hours\n      - Action: Alert security team\n   c. New High Privilege Apps:\n      - Condition: Newly authorized apps with Mail.ReadWrite or Files.ReadWrite.All\n      - Action: Automatic approval workflow required\n3. Configure automated actions:\n   - Disable app if policy violated\n   - Notify app owner and security team\n4. Review policy violations daily",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-cloud-apps/app-governance-manage-app-governance"
    },
    {
      "settingName": "adminConsentWorkflow",
      "displayName": "Enable Admin Consent Workflow for Apps",
      "settingPath": "entraID.adminConsentWorkflow.enabled",
      "policyType": "AzureAD",
      "policySubType": "EnterpriseApps",
      "platform": "All",
      "dataType": "boolean",
      "expectedValue": true,
      "validationOperator": "==",
      "description": "Requires administrator review and approval for external applications requesting organizational data access, ensuring external services are vetted before accessing systems.",
      "implementationGuide": "1. Navigate to Azure AD > Enterprise applications > Consent and permissions > Admin consent settings\n2. Configure:\n   - Users can request admin consent to apps they are unable to consent to: Yes\n   - Select users to review admin consent requests: Specify security team\n   - Selected users will receive email notifications for requests: Yes\n   - Consent request expires after: 30 days\n3. Consider blocking user consent for all apps (requires admin consent for all)\n4. Configure consent policy:\n   - Block consent for apps from unverified publishers\n   - Require admin consent for high-risk permissions\n5. Review consent requests in Admin consent requests blade\n6. Document approval criteria for external applications",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/configure-admin-consent-workflow"
    },
    {
      "settingName": "riskBasedConsentPolicy",
      "displayName": "Configure Risk-Based Consent Policies",
      "settingPath": "entraID.appConsent.riskBasedPolicy",
      "policyType": "AzureAD",
      "policySubType": "EnterpriseApps",
      "platform": "All",
      "dataType": "object",
      "expectedValue": "{\"blockUnverifiedPublishers\":true,\"blockHighRiskPermissions\":true,\"requireGroupOwnerConsent\":false}",
      "validationOperator": "==",
      "description": "Implements risk-based app consent policies to block external applications from unverified publishers or requesting high-risk permissions without admin review.",
      "implementationGuide": "1. Navigate to Azure AD > Enterprise applications > Consent and permissions > User consent settings\n2. Configure permission classification:\n   - Do not allow user consent: Recommended (requires admin approval)\n   - OR Allow user consent for apps from verified publishers, for selected permissions (low risk only)\n3. Configure risk-based restrictions:\n   - Block consent from unverified publishers: Enable\n   - Block high-risk permissions (Mail.ReadWrite, Files.ReadWrite.All, etc.)\n4. Define low-risk permissions users can consent to:\n   - User.Read\n   - openid, profile, email\n5. All other permissions require admin consent\n6. Monitor consent activity via Sign-in logs",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/configure-user-consent"
    },
    {
      "settingName": "sensitiveInfoTypeProtection",
      "displayName": "Monitor External Service Data Sharing",
      "settingPath": "cloudApps.dlp.externalSharing",
      "policyType": "Defender",
      "policySubType": "CloudAppSecurity",
      "platform": "All",
      "dataType": "array",
      "expectedValue": "[\"BlockCUIToExternalApps\",\"AlertOnSensitiveDataSharing\"]",
      "validationOperator": "contains",
      "description": "Creates DLP policies in Defender for Cloud Apps to monitor and control sharing of CUI/sensitive data with external cloud applications, ensuring external services comply with data protection requirements.",
      "implementationGuide": "1. Navigate to Microsoft Defender portal > Cloud Apps > Policies > Policy management\n2. Create File policy for external sharing:\n   - Policy name: Block CUI sharing to external apps\n   - Filter: Files shared with external domains\n   - Content inspection: Sensitive information types (SSN, Credit Card, CUI labels)\n   - Actions: Block download, Alert admin, Quarantine file\n3. Create Activity policy:\n   - Policy name: Alert on sensitive data access by OAuth apps\n   - Filter: OAuth apps accessing files with sensitivity labels\n   - Actions: Alert security team\n4. Configure governance actions:\n   - Revoke app permissions if policy violated\n   - Notify file owner\n5. Review policy matches daily",
      "microsoftDocUrl": "https://learn.microsoft.com/en-us/defender-cloud-apps/data-protection-policies"
    }
  ]
}