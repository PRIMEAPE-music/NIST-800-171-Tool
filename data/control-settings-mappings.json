{
  "version": "NIST SP 800-171 Revision 3 (Enhanced)",
  "lastUpdated": "2025-11-15",
  "totalControls": 26,
  "mappingStrategy": "keyword-based",
  "description": "Enhanced keyword-based settings search with dual-strategy matching for both legacy policies and Settings Catalog policies",
  "controls": [
    {
      "controlId": "03.01.01",
      "controlTitle": "Account Management",
      "priority": "Critical",
      "settingsMappings": [
        {
          "id": "03.01.01-001",
          "description": "Conditional Access state enforcement",
          "policyTypes": ["AzureAD"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["state"]
          },
          "validation": {
            "expectedValue": ["enabled", "enabledForReportingButNotEnforced"],
            "operator": "in",
            "dataType": "string",
            "allowedValues": ["enabled", "enabledForReportingButNotEnforced"]
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Enforce access controls through Conditional Access",
            "rationale": "Enabled Conditional Access policies enforce account management controls"
          }
        }
      ]
    },
    {
      "controlId": "03.01.02",
      "controlTitle": "Account Management - Inactivity",
      "priority": "High",
      "settingsMappings": [
        {
          "id": "03.01.02-001",
          "description": "Idle session timeout configuration",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["password", "inactivity", "lock"]
          },
          "validation": {
            "expectedValue": 15,
            "operator": "<=",
            "dataType": "integer",
            "allowedValues": [5, 10, 15, 30]
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Lock screen after period of inactivity",
            "rationale": "Prevents unauthorized access through unattended sessions"
          }
        }
      ]
    },
    {
      "controlId": "03.01.03",
      "controlTitle": "Disable Accounts",
      "priority": "High",
      "settingsMappings": [
        {
          "id": "03.01.03-001",
          "description": "Account modifications blocked",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["account", "block", "modification"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "Control account lifecycle",
            "rationale": "Prevents unauthorized account modifications"
          }
        }
      ]
    },
    {
      "controlId": "03.01.05",
      "controlTitle": "Least Privilege",
      "priority": "Critical",
      "settingsMappings": [
        {
          "id": "03.01.05-001",
          "description": "Grant controls enforcement in Conditional Access",
          "policyTypes": ["AzureAD"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["grant", "controls"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "Implement least privilege through access controls",
            "rationale": "Grant controls limit access to minimum necessary"
          }
        }
      ]
    },
    {
      "controlId": "03.01.06",
      "controlTitle": "Privileged Accounts",
      "priority": "Critical",
      "settingsMappings": [
        {
          "id": "03.01.06-001",
          "description": "Conditional Access conditions for privileged users",
          "policyTypes": ["AzureAD"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["conditions"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "Enhanced controls for privileged accounts",
            "rationale": "Conditions in CA policies can target privileged roles"
          }
        }
      ]
    },
    {
      "controlId": "03.01.09",
      "controlTitle": "Wireless Access",
      "priority": "High",
      "settingsMappings": [
        {
          "id": "03.01.09-001",
          "description": "WiFi connection to configured networks only",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["wifi", "connect", "configured"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Control wireless network access",
            "rationale": "Ensures only approved wireless networks are used"
          }
        }
      ]
    },
    {
      "controlId": "03.01.10",
      "controlTitle": "Encrypt Wireless Access",
      "priority": "High",
      "settingsMappings": [
        {
          "id": "03.01.10-001",
          "description": "WiFi encryption requirement",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["wifi", "configured", "networks"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "Encrypt wireless communications",
            "rationale": "Configured networks should use WPA2/WPA3 encryption"
          }
        }
      ]
    },
    {
      "controlId": "03.01.12",
      "controlTitle": "Remote Access",
      "priority": "Critical",
      "settingsMappings": [
        {
          "id": "03.01.12-001",
          "description": "Conditional Access for remote locations",
          "policyTypes": ["AzureAD"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["conditions"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "Control remote access",
            "rationale": "CA conditions can include location-based policies"
          }
        }
      ]
    },
    {
      "controlId": "03.01.18",
      "controlTitle": "Control Mobile Device Connection",
      "priority": "High",
      "settingsMappings": [
        {
          "id": "03.01.18-001",
          "description": "Device compliance requirement",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["require", "device"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Require compliant devices for connection",
            "rationale": "Only compliant devices can access organizational resources"
          }
        },
        {
          "id": "03.01.18-002",
          "description": "Healthy device report requirement",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["require", "healthy", "device"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Verify device health before allowing connection",
            "rationale": "Requires device health attestation"
          }
        }
      ]
    },
    {
      "controlId": "03.01.20",
      "controlTitle": "External Connections",
      "priority": "Medium",
      "settingsMappings": [
        {
          "id": "03.01.20-001",
          "description": "Block external data roaming",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["cellular", "data", "roaming"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Low",
            "nistRequirement": "Control external network connections",
            "rationale": "Prevents data exfiltration through cellular roaming"
          }
        }
      ]
    },
    {
      "controlId": "03.01.22",
      "controlTitle": "Control Information Posting",
      "priority": "Medium",
      "settingsMappings": [
        {
          "id": "03.01.22-001",
          "description": "Block store automatic downloads",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["store", "block", "automatic"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Low",
            "nistRequirement": "Control information posting to public systems",
            "rationale": "Prevents automatic downloads from app stores"
          }
        }
      ]
    },
    {
      "controlId": "03.03.01",
      "controlTitle": "System Audit Logging",
      "priority": "High",
      "settingsMappings": [
        {
          "id": "03.03.01-001",
          "description": "Conditional Access state tracking",
          "policyTypes": ["AzureAD"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["state", "modified"]
          },
          "validation": {
            "expectedValue": ["enabled", "enabledForReportingButNotEnforced"],
            "operator": "in",
            "dataType": "string"
          },
          "compliance": {
            "confidence": "Low",
            "nistRequirement": "Enable audit logging",
            "rationale": "CA policies with state=enabled generate audit logs"
          }
        }
      ]
    },
    {
      "controlId": "03.03.08",
      "controlTitle": "Protect Audit Information",
      "priority": "High",
      "settingsMappings": [
        {
          "id": "03.03.08-001",
          "description": "Block content and settings erase",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["device", "block", "erase"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Low",
            "nistRequirement": "Protect audit information from unauthorized deletion",
            "rationale": "Prevents users from erasing device content including logs"
          }
        }
      ]
    },
    {
      "controlId": "03.05.01",
      "controlTitle": "Baseline Configuration",
      "priority": "High",
      "settingsMappings": [
        {
          "id": "03.05.01-001",
          "description": "OS minimum version enforcement",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["os", "minimum", "version", "operating", "system", "build"]
          },
          "validation": {
            "expectedValue": "10.0",
            "operator": ">=",
            "dataType": "string"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Establish baseline configurations",
            "rationale": "Minimum OS version ensures security baseline"
          }
        },
        {
          "id": "03.05.01-002",
          "description": "Secure boot enabled requirement",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["secure", "boot", "enabled", "uefi", "firmware"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Enforce secure baseline configuration",
            "rationale": "Secure Boot ensures system integrity"
          }
        },
        {
          "id": "03.05.01-003",
          "description": "Code integrity enabled requirement",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["code", "integrity", "enabled", "hypervisor", "hvci"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Enforce secure baseline configuration",
            "rationale": "Code integrity prevents unauthorized code execution"
          }
        }
      ]
    },
    {
      "controlId": "03.05.07",
      "controlTitle": "Security Patches",
      "priority": "Critical",
      "settingsMappings": [
        {
          "id": "03.05.07-001",
          "description": "Automatic update mode configuration",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["automatic", "update", "mode", "windows", "patch"]
          },
          "validation": {
            "expectedValue": ["autoInstallAtMaintenanceTime", "autoInstallAndRebootAtMaintenanceTime", "autoInstallAndRebootAtScheduledTime"],
            "operator": "in",
            "dataType": "string"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Install security updates automatically",
            "rationale": "Automatic updates ensure timely patching"
          }
        },
        {
          "id": "03.05.07-002",
          "description": "Quality updates deferral period",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["quality", "updates", "deferral", "patch", "delay"]
          },
          "validation": {
            "expectedValue": 7,
            "operator": "<=",
            "dataType": "integer"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Apply security patches promptly",
            "rationale": "Low deferral ensures quick security update deployment"
          }
        },
        {
          "id": "03.05.07-003",
          "description": "Deadline for quality updates",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["deadline", "quality", "updates", "patch", "install"]
          },
          "validation": {
            "expectedValue": 7,
            "operator": "<=",
            "dataType": "integer"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Enforce security patch installation within timeframe",
            "rationale": "Deadline ensures patches are installed promptly"
          }
        }
      ]
    },
    {
      "controlId": "03.05.11",
      "controlTitle": "Malicious Code Protection",
      "priority": "Critical",
      "settingsMappings": [
        {
          "id": "03.05.11-001",
          "description": "Early launch anti-malware driver",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["early", "launch", "malware", "defender", "antivirus", "antimalware", "protection"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "Deploy anti-malware protection",
            "rationale": "Early launch anti-malware prevents rootkits"
          }
        }
      ]
    },
    {
      "controlId": "03.07.04",
      "controlTitle": "MFA for Privileged Accounts",
      "priority": "Critical",
      "settingsMappings": [
        {
          "id": "03.07.04-001",
          "description": "Grant controls requiring MFA",
          "policyTypes": ["AzureAD"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["grant", "controls"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "MFA for privileged access",
            "rationale": "Grant controls can enforce MFA requirements"
          }
        }
      ]
    },
    {
      "controlId": "03.10.07",
      "controlTitle": "Control Portable Storage",
      "priority": "Medium",
      "settingsMappings": [
        {
          "id": "03.10.07-001",
          "description": "Block camera on iOS devices",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["camera", "blocked"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Low",
            "nistRequirement": "Control portable storage and recording devices",
            "rationale": "Camera restrictions prevent unauthorized data capture"
          }
        }
      ]
    },
    {
      "controlId": "03.13.08",
      "controlTitle": "Cryptographic Protection",
      "priority": "High",
      "settingsMappings": [
        {
          "id": "03.13.08-001",
          "description": "iCloud encrypted backup requirement",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["icloud", "encrypted", "backup"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "Use approved cryptographic mechanisms",
            "rationale": "Encrypted backups protect data in transit and at rest"
          }
        }
      ]
    },
    {
      "controlId": "03.13.11",
      "controlTitle": "Encrypt CUI at Rest",
      "priority": "Critical",
      "settingsMappings": [
        {
          "id": "03.13.11-001",
          "description": "BitLocker encryption requirement",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["bitlocker", "enabled", "encrypt", "encryption", "disk"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Encrypt CUI at rest",
            "rationale": "BitLocker protects data on lost or stolen devices"
          }
        },
        {
          "id": "03.13.11-002",
          "description": "Storage encryption requirement",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["storage", "require", "encryption", "encrypt", "disk", "device"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "High",
            "nistRequirement": "Encrypt CUI at rest",
            "rationale": "Storage encryption ensures all data is encrypted"
          }
        }
      ]
    },
    {
      "controlId": "03.14.02",
      "controlTitle": "Malicious Code Protection",
      "priority": "Critical",
      "settingsMappings": [
        {
          "id": "03.14.02-001",
          "description": "Early launch anti-malware enabled",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["early", "launch", "malware", "enabled", "defender", "antivirus", "antimalware", "protection"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "Deploy anti-malware software",
            "rationale": "Early launch protection prevents boot-time malware"
          }
        }
      ]
    },
    {
      "controlId": "03.14.03",
      "controlTitle": "Update Malicious Code Protection",
      "priority": "High",
      "settingsMappings": [
        {
          "id": "03.14.03-001",
          "description": "Microsoft update service allowed",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["microsoft", "update", "service", "allowed", "defender", "signature", "antivirus"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "Update malicious code protection mechanisms",
            "rationale": "Microsoft Update ensures latest security definitions"
          }
        }
      ]
    },
    {
      "controlId": "03.16.01",
      "controlTitle": "System Security Planning",
      "priority": "Medium",
      "settingsMappings": [
        {
          "id": "03.16.01-001",
          "description": "Password expiration policy",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["password", "expiration", "days"]
          },
          "validation": {
            "expectedValue": 365,
            "operator": "<=",
            "dataType": "integer"
          },
          "compliance": {
            "confidence": "Low",
            "nistRequirement": "Maintain security planning documentation",
            "rationale": "Password expiration policy documents security requirements"
          }
        }
      ]
    },
    {
      "controlId": "03.16.02",
      "controlTitle": "Rules of Behavior",
      "priority": "Low",
      "settingsMappings": [
        {
          "id": "03.16.02-001",
          "description": "App store password requirement",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["store", "require", "password"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Low",
            "nistRequirement": "Establish rules of behavior",
            "rationale": "Password requirements enforce acceptable use"
          }
        }
      ]
    },
    {
      "controlId": "03.17.01",
      "controlTitle": "Supply Chain Risk Assessment",
      "priority": "Medium",
      "settingsMappings": [
        {
          "id": "03.17.01-001",
          "description": "Block app store installs",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["store", "block", "install"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Medium",
            "nistRequirement": "Assess supply chain risks",
            "rationale": "Blocking app store installs prevents unauthorized software"
          }
        }
      ]
    },
    {
      "controlId": "03.17.03",
      "controlTitle": "Authenticity of Components",
      "priority": "Medium",
      "settingsMappings": [
        {
          "id": "03.17.03-001",
          "description": "Require password for app store",
          "policyTypes": ["Intune"],
          "searchStrategy": {
            "mode": "keyword",
            "settingNameKeywords": ["store", "require", "password"]
          },
          "validation": {
            "expectedValue": true,
            "operator": "==",
            "dataType": "boolean"
          },
          "compliance": {
            "confidence": "Low",
            "nistRequirement": "Verify authenticity of components",
            "rationale": "Password requirement adds authentication to app installs"
          }
        }
      ]
    }
  ]
}
